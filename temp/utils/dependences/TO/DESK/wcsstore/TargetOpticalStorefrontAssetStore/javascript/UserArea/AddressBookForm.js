dojo.require("wc.render.RefreshController"),dojo.require("wc.render.Context"),dojo.require("wc.widget.RefreshArea"),dojo.addOnLoad(function(){wc.render.getContextById("default")||wc.render.declareContext("default",{},""),AddressBookFormJS.declareRefreshController("addressDisplayAreaController","addressDisplayAreaAction","AjaxAddressBookForm"),AddressBookFormJS.declareRefreshController("addressFormAreaController","addressFormAreaAction","AjaxAccountAddressForm"),AddressBookFormJS.declareRefreshController("billing_statesDisplayAreaController","statesDisplayAreaAction","AjaxAddressStatesDisplay"),AddressBookFormJS.declareRefreshController("shipping_statesDisplayAreaController","statesDisplayAreaAction","AjaxAddressStatesDisplay")}),AddressBookFormJS={langId:"-1",storeId:"",catalogId:"",addressDeleted:"false",addressNew:"false",pageVar:"",setCommonParameters:function(e,s,r){this.langId=e,this.storeId=s,this.catalogId=r},getControllerActionHandler:function(e,s){console.debug("entering getControllerActionHandler(controller, handlerKey, actionName): "+s);var r=AddressBookFormJS[s+"s"][e];return r?function(e,s,a){r(e,s,a)}:function(e,s,r){console.debug("empty handler. This is a no-op")}},declareRefreshController:function(e,s,r){console.debug("entering AddressBookFormJS.declareRefreshController with action name = "+s+" and controller id = "+e),wc.render.getRefreshControllerById(e)?console.debug("controller with id = "+e+" already exists. No declaration will be done"):wc.render.declareRefreshController({id:e,renderContext:wc.render.getContextById("default"),url:r,renderContextChangedHandler:function(r,a){console.debug("entering renderContextChangedHandler for "+e);var l=this.renderContext;Common.getRenderContextProperty(l,s)?(Common.getRenderContextProperty(l,"url")&&(this.url=Common.getRenderContextProperty(l,"url")),AddressBookFormJS.getControllerActionHandler(Common.getRenderContextProperty(l,s),s)(r,a,this),delete l.properties[s],delete l.properties.url):console.debug("no "+s+" is specified. This handler will not be called. Exiting...")},modelChangedHandler:function(e,r){AddressBookFormJS.getControllerActionHandler("handleModelChange",s)(e,r,this),cursor_clear()}})},addressFormAreaActions:{create:function(e,s,r){s.refresh(r.renderContext.properties),r.renderContext.properties.addressFormAreaState="create"},edit:function(e,s,r){console.debug("starting to getting editing area"),s.refresh(r.renderContext.properties),r.renderContext.properties.addressFormAreaState="edit"},clean:function(e,s,r){s.setInnerHTML(""),r.renderContext.properties.addressFormAreaState="clean"},handleModelChange:function(e,s,r){s.setInnerHTML(""),r.renderContext.properties.addressFormAreaState="clean"}},addressDisplayAreaActions:{reload:function(e,s,r){console.debug("reloading "+s),s.refresh(r.renderContext.properties)},handleModelChange:function(e,s,r){console.debug("reloading "+s),s.refresh(r.renderContext.properties)}},statesDisplayAreaActions:{countryUpdated:function(e,s,r){console.debug("IN countryUpdated handler: message = "+e);var a=r.renderContext.properties.paramPrefix;s.widgetId.match(a)?(console.debug("matchin paramPrefix: "+a+" refreshing "+s.widgetId),s.refresh(r.renderContext.properties)):console.debug("no maching paramPrefix "+a)}},toggleAddressDisplay:function(e,s,r){console.debug("toggle address display");var a=e.options[e.selectedIndex].value;dojo.forEach(dojo.query("."+s),function(e){var s=r+a;e.id==s&&"MyBillingAddress"!=a?e.style.display="block":e.style.display="none"})},updateAddressArea:function(e){console.debug("to update with params: "+e),wc.render.updateContext("default",e),console.debug("updateArea done")},updateAddress:function(e,s){for(var r=document.forms[e],a=0;a<r.sbAddress.length;a++)r.sbAddress[a].checked&&(r.addressType.value=r.sbAddress[a].value);if(""!=r.addressType.value){if(this.validateForm(r)){if(console.debug("creating with form id = "+e+" and  address display url is: "+s),dojo.require("wc.service.common"),wc.service.declare({id:"updateAddressBook",actionId:"updateAddressBook",url:"AjaxPersonChangeServiceAddressAdd",formId:e,successHandler:function(e){AddressBookFormJS.pageVar="addressbook",cursor_clear()},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}}),!submitRequest())return;cursor_wait(),wc.service.invoke("updateAddressBook")}}else MessageHelper.displayErrorMessage(MessageHelper.messages.AB_SELECT_ADDRTYPE)},newUpdateAddressBook:function(e,s){for(var r=document.forms[e],a=0;a<r.sbAddress.length;a++)r.sbAddress[a].checked&&(r.addressType.value=r.sbAddress[a].value);if(""!=r.addressType.value){if(this.validateForm(r)){if(console.debug("creating with form id = "+e+" and  address display url is: "+s),dojo.require("wc.service.common"),wc.service.declare({id:"updateAddress",actionId:"updateAddress",url:"AjaxPersonChangeServiceAddressAdd",formId:e,successHandler:function(e){AddressBookFormJS.addressNew="true",cursor_clear()},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}}),!submitRequest())return;cursor_wait(),wc.service.invoke("updateAddress")}}else MessageHelper.displayErrorMessage(MessageHelper.messages.AB_SELECT_ADDRTYPE)},showFooterNew:function(){hideElementById("content_footer"),showElementById("addnew_content_footer")},showFooter:function(){showElementById("content_footer"),hideElementById("addnew_content_footer")},newDeleteAddress:function(e,s,r){var a=document.getElementById(e);if(a.value!=a.options[0].value)if(""!=a.value){var l=[];l.storeId=this.storeId,l.catalogId=this.catalogId,l.addressId=a.value,l.URL=r,dojo.require("wc.service.common"),wc.service.declare({id:"AddressDelete",actionId:"AddressDelete",url:s,successHandler:function(e){AddressBookFormJS.addressDeleted="true",wc.render.getRefreshControllerById("MyAccountCenterLinkDisplay_Controller").url=r,cursor_clear()},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}}),submitRequest()&&(cursor_wait(),wc.service.invoke("AddressDelete",l))}else MessageHelper.formErrorHandleClient(e,MessageHelper.messages.ERROR_SELECTADDRESS);else MessageHelper.formErrorHandleClient(e,MessageHelper.messages.ERROR_DEFAULTADDRESS)},populateTextFields:function(e,s,r){if("block"==document.getElementById("adding").style.display){var a=document.getElementById("adding");hideElementById(a),document.getElementById("normal").style.display="block"}for(var l=e.options[e.selectedIndex].value,d=r.sbAddress,t=0;t<d.length;t++)d[t].value==s[l].addressType&&(d[t].checked="checked");r.nickName.value=s[l].nickName,r.firstName.value=s[l].firstName,r.lastName.value=s[l].lastName,r.address1.value=s[l].address1,r.address2.value=s[l].address2,r.country.value=s[l].country,r.zipCode.value=s[l].zipCode,r.email1.value=s[l].email1,r.phone1.value=s[l].phone1,r.city.value=s[l].city,AddressHelper.loadStatesUI("AddressForm","","stateDiv","state"),r.state.value=s[l].state,r.middleName&&(r.middleName.value=s[l].middleName),document.getElementById("addr_title").innerHTML="<h2 class='status_msg'>"+s[l].nickName+"</h2>"},populateTextFieldsOnLoad:function(e,s,r){for(var a=e.options[e.selectedIndex].value,l=r.sbAddress,d=0;d<l.length;d++)l[d].value==s[a].addressType&&(l[d].checked="checked");r.nickName.value=s[a].nickName,r.firstName.value=s[a].firstName,r.lastName.value=s[a].lastName,r.address1.value=s[a].address1,r.address2.value=s[a].address2,r.state.value=s[a].state,r.country.value=s[a].country,r.zipCode.value=s[a].zipCode,r.email1.value=s[a].email1,r.phone1.value=s[a].phone1,r.city.value=s[a].city,r.middleName&&(r.middleName.value=s[a].middleName),AddressHelper.loadStatesUI("AddressForm","","stateDiv","state",!0),document.getElementById("addr_title").innerHTML="<h2 class='status_msg'>"+s[a].nickName+"</h2>"},clearTextFields:function(e){e.nickName.value="",e.firstName.value="",e.lastName.value="",e.address1.value="",e.address2.value="",e.city.value="",e.state.value="",e.country.value="",e.zipCode.value="",e.email1.value="",e.phone1.value="",e.middleName&&(e.middleName.value="")},submitForm:function(e,s){for(var r=0;r<e.sbAddress.length;r++)e.sbAddress[r].checked&&("Shipping"==e.sbAddress[r].value&&(e.addressType.value="Shipping"),"Billing"==e.sbAddress[r].value&&(e.addressType.value="Billing"),"ShippingAndBilling"==e.sbAddress[r].value&&(e.addressType.value="ShippingAndBilling"));if(""!=e.addressType.value){if(s&&AddressHelper.setStateDivName("stateDiv1"),this.validateForm(e)){if(s||(e.addressId.value=document.getElementById("addressId").value),!submitRequest())return;e.submit(),e.nickName.value="",e.firstName.value="",e.lastName.value="",e.address1.value="",e.address2.value="",e.city.value="",e.state.value="",e.country.value="",e.zipCode.value="",e.email1.value="",e.phone1.value="",e.middleName&&(e.middleName.value="")}}else MessageHelper.displayErrorMessage(MessageHelper.messages.AB_SELECT_ADDRTYPE)},showAdd:function(){var e=document.getElementById("normal");hideElementById(e),document.getElementById("adding").style.display="block"},removeAddress:function(e,s){var r=document.getElementById(s);if(r.value!=r.options[0].value){var a=document.forms[e];a.addressId.value=r.value,submitRequest()&&a.submit()}else MessageHelper.formErrorHandleClient(s,MessageHelper.messages.ERROR_DEFAULTADDRESS)},validateForm:function(e){return alert("xx"),AddressHelper.validateAddressForm(e)},copyBillingFormNew:function(e,s){var r=document.forms[e],a=document.forms[s],l=document.getElementById("SameShippingAndBillingAddress");l.checked&&(hideElementById("shippingAddressCreateEditFormDiv_1"),a.firstName.value=r.firstName.value,a.lastName.value=r.lastName.value,a.address1.value=r.address1.value,a.address2.value=r.address2.value,a.city.value=r.city.value,dojo.isIE?document.getElementById("stateDiv2").firstChild.value=document.getElementById("stateDiv1").firstChild.value:a.state.value=r.state.value,a.zipCode.value=r.zipCode.value,a.country.value=r.country.value,a.phone1.value=r.phone1.value,a.email1.value=r.email1.value,r.middleName&&(a.middleName.value=r.middleName.value)),l.checked||(showElementById("shippingAddressCreateEditFormDiv_1"),a.firstName.value="",a.lastName.value="",a.address1.value="",a.address2.value="",a.city.value="",dojo.isIE?document.getElementById("stateDiv2").firstChild.value="":a.state.value="",a.zipCode.value="",a.phone1.value="",a.email1.value="",a.middleName&&(a.middleName.value=""))},copyBillingFormNewCustom:function(e,s,r){var a=document.forms[e],l=document.forms[s],d=(document.forms[r],document.getElementById("SameShippingAndBillingAddressCustom"));if(d.checked){l.firstName.value=a.firstName.value,l.lastName.value=a.lastName.value,l.address1.value=a.address1.value,l.address2.value=a.address2.value,l.city.value=a.city.value;var t=$("#"+e).find(':input[name="state"]').val();$("#"+s).find(':input[name="state"]').val(t),l.zipCode.value=a.zipCode.value,l.phone1.value=a.phone1.value,l.email1.value=a.email1.value,l.phone_1.value=a.phone_1.value,l.phone_2.value=a.phone_2.value,l.phone_3.value=a.phone_3.value,a.middleName&&(l.middleName.value=a.middleName.value)}d.checked||(l.firstName.value="",l.lastName.value="",l.address1.value="",l.address2.value="",l.city.value="",$("#"+s).find(':input[name="state"]').val(""),l.zipCode.value="",l.phone1.value="",l.email1.value="",l.phone_1.value="",l.phone_2.value="",l.phone_3.value="",l.middleName&&(l.middleName.value=""))},saveTAHAddress:function(){var e=$("#TAHCreateForm")[0],s=e.billingPhone1_1.value+e.billingPhone1_2.value+e.billingPhone1_3.value;$("#billingPhone").val(s)},phoneTAHValidation:function(e){var s="#"+e;return $(s+"Phone1_1").val().length>0||$(s+"Phone1_2").val().length>0||$(s+"Phone1_3").val().length>0}},$(document).ready(function(){$("#TAHCreateForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",ignore:"",rules:{billingFirstName:{required:!0},billingLastName:{required:!0},billingAddress1:{required:!0},billingCity:{required:!0},billingState:{required:!0},billingZipCode:{required:!0,postalFormatCheck:!0},billingEmail:{required:!0,email:!0},billingPhone1_1:{required:!0,minlength:3},billingPhone1_2:{required:!0,minlength:3},billingPhone1_3:{required:!0,minlength:4},cardType:{required:!0},cardNumber:{required:!0},cc_cvc:{required:!0}},messages:{shippingFirstName:MessageHelper.messages.ERROR_MISSING_FIRST_NAME,shippingLastName:MessageHelper.messages.ERROR_MISSING_LAST_NAME,shippingAddress1:MessageHelper.messages.ERROR_MISSING_ADDRESS,shippingCity:MessageHelper.messages.ERROR_MISSING_CITY,shippingState:MessageHelper.messages.ERROR_MISSING_STATE,shippingZipCode:{required:MessageHelper.messages.ERROR_MISSING_ZIP_CODE,postalFormatCheck:MessageHelper.messages.ERROR_INVALID_ZIP_CODE},shippingEmail:{required:MessageHelper.messages.ERROR_INVALID_EMAIL,email:MessageHelper.messages.ERROR_INVALID_EMAIL},billingFirstName:MessageHelper.messages.ERROR_MISSING_FIRST_NAME,billingLastName:MessageHelper.messages.ERROR_MISSING_LAST_NAME,billingAddress1:MessageHelper.messages.ERROR_MISSING_ADDRESS,billingCity:MessageHelper.messages.ERROR_MISSING_CITY,billingState:MessageHelper.messages.ERROR_MISSING_STATE,billingZipCode:{required:MessageHelper.messages.ERROR_MISSING_ZIP_CODE,postalFormatCheck:MessageHelper.messages.ERROR_INVALID_ZIP_CODE},billingEmail:{required:MessageHelper.messages.ERROR_INVALID_EMAIL,email:MessageHelper.messages.ERROR_INVALID_EMAIL},billingPhone1_1:MessageHelper.messages.ERROR_INVALID_PHONE,billingPhone1_2:MessageHelper.messages.ERROR_INVALID_PHONE,billingPhone1_3:MessageHelper.messages.ERROR_INVALID_PHONE,shippingPhone1_1:MessageHelper.messages.ERROR_INVALID_PHONE,shippingPhone1_2:MessageHelper.messages.ERROR_INVALID_PHONE,shippingPhone1_3:MessageHelper.messages.ERROR_INVALID_PHONE},errorPlacement:function(e,s){"billingPhone1_1"==s.attr("name")||"billingPhone1_2"==s.attr("name")||"billingPhone1_3"==s.attr("name")?e.insertAfter($("#billingPhone1_3")):e.insertAfter(s),$(e).attr("aria-live","rude")},submitHandler:function(e){var s=new Date,r=s.getMonth()+1,a=s.getFullYear(),l=$("#expiryMonth").val(),d=$("#expiryYear").val();a>d?$("#ccError").text(MessageHelper.messages.EDPPaymentMethods_INVALID_EXPIRY_DATE).attr("aria-live","rude").show():d==a&&r>l?$("#ccError").text(MessageHelper.messages.EDPPaymentMethods_INVALID_EXPIRY_DATE).attr("aria-live","rude").show():($("#ccError").hide(),AddressBookFormJS.saveTAHAddress(),e.submit())}}),$(".countrySelect").on("change keyup",function(e){"CA"==$("#"+e.target.id).val()?$("#"+e.target.id).siblings(".CAOptInMessage").show():$("#"+e.target.id).siblings(".CAOptInMessage").hide()}),$("#newsletterSection a").on("click",function(e){showRegisterModal();var s=$("#newsletterSection input[type='text']#__prjid5_signUpButton")[0].value;s&&($("#logonId_regModal")[0].value=s,$("#logonIdVerify")[0].value=s)}),$("#emailOffersSignupForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",ignore:"",rules:{first_name:{required:!0},last_name:{required:!0},recipientEmail:{required:!0,email:!0},verifyEmail:{required:!0,equalTo:"#recipientEmail"}},messages:{first_name:MessageHelper.messages.ERROR_MISSING_FIRST_NAME,last_name:MessageHelper.messages.ERROR_MISSING_LAST_NAME,recipientEmail:{required:MessageHelper.messages.ERROR_INVALID_EMAIL,email:MessageHelper.messages.ERROR_INVALID_EMAIL},verifyEmail:{required:MessageHelper.messages.ERROR_INVALID_EMAIL,equalTo:MessageHelper.messages.ERROR_EMAIL_NOT_MATCH}},errorPlacement:function(e,s){e.insertAfter(s),$(e).attr("aria-live","rude")},submitHandler:function(e){var s=$(e),r=$(".successMessageEmail"),a=$(".subscribed"),l=$(".logged");a.hide(),l.hide(),r.hide();var d=$("input[name=age]:checked").val();if("no"!=d&&null!=d)return constants.ajaxParams.loggedIn?$(".emailSignup .logged").show():$.ajax({url:getAbsoluteURL(!1)+"TOEmailSubscription",data:s.serialize(),dataType:"json",type:"post",complete:function(e){try{var a=$.parseJSON(e.responseText);"true"==a.success?"_ERR_EMAIL_ALREADY_SUBSCRIBED"==a.info?$(".emailSignup .subscribed").show():(r.html("<span></span>"+MessageHelper.messages.EMAIL_SIGNUP_SUCCESS).show(),r.detach().insertAfter(s),$("#emailOffersSignupForm").hide()):MessageHelper.displayErrorMessage(constants.error.ajax)}catch(e){MessageHelper.displayErrorMessage(constants.error.ajax)}}}),!1;$("#ageError").text(MessageHelper.messages.ERROR_UNDER_13).attr("aria-live","rude").show()}})});
//# sourceMappingURL=AddressBookForm.js.map