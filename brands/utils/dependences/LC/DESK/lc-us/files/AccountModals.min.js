$(document).ready((function(){AccountModalsJS.setupRegistrationModal(),AccountModalsJS.setupRegistrationValidation();try{$(".modalSignIn").live("click",(function(){var f=$("#modalLoginForm");return f.not(":visible")&&(f=$(".modalSignIn:visible").parents("#modalLoginForm")),f.valid(),f.submit(),!1})),$(".modalRegSubmit").live("click",(function(){var f=$("#modalRegistrationForm");return $("#favModalRegistrationForm").length&&(f=$("#favModalRegistrationForm")),f.valid(),f.submit(),!1}))}catch(e){-1==window.location.href.indexOf("ScheduleExamView")?console.error("Logged: "+e):console.log("OEE - No account modal find.")}})),AccountModalsJS={logonFormSubmit:function(logonForm){var f=$(logonForm);utag_data.form_name="logon modal",utag_data.form_field=error_list;if(f.valid()){for(var data=f.serializeArray(),newData=[],originalURL=null,i=0;i<data.length;i++){var d=data[i];"receiveEmail"==d.name&&"on"==d.value&&(d.value=!0,!0),"URL"==d.name?(originalURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})):newData.push(d)}$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.passwordExpired&&"1"==data.passwordExpired)$("#examSignInSection").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block"),obj={id:"Error",Error_Source:"User",Error_Code:"Login",Error_Message:"Your password has expired"},tealium_data2track.push(obj);else if(data.success){var nextUrl=originalURL;nextUrl.length&&"#"==nextUrl.charAt(nextUrl.length-1)&&(nextUrl=nextUrl.substring(0,x.length-1)),utagData={site_events:{authentication_complete:!0},authentication_status:"authenticated",registration_status:"registered"};try{var obj={id:"WCS-D-Login"}}catch(err){obj={id:"WCS-D-Login-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-Login",tealium_data2track.push(obj)}callTrackAnalytics(utagData),window.location=nextUrl}else obj={id:"Error",Error_Source:"User",Error_Code:"Form Filling Error - Login",Error_Details:"Wrong Email, Wrong Password - "+data.errorMessage,Error_Message:data.errorMessage},tealium_data2track.push(obj),$(".examLogOnFailureResponseMessageDiv").html(data.errorMessage)},error:function(jqXHR,textStatus,errorThrown){$(".examLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.")}})}return!1},signInClickEvent:function(){return $("#registerSection, #signInLink, .ForgotPasswordSection").hide(),$(".createAccountModalLink, #signInSection").show(),$(".signInEmail").focus(),$("#signInModal").is(":visible")&&-1!=signinWidth&&$("#signInModal").dialog({width:signinWidth}).dialog("option","position","center"),!1},setupRegistrationModal:function(){var actualModalWidth=-1==modalWidth?490:modalWidth;try{var signInModal=$("#signInModal");signInModal.dialog({modal:!0,width:actualModalWidth,autoOpen:!1,open:function(){signInModal.removeClass("hide"),signInModal.find("form").each((function(){$(this).validate().resetForm()})),null!=modalWidth&&($(".ui-widget-overlay").addClass("black"),$(".ui-widget-overlay").bind("click",(function(e){return e.preventDefault(),!1})))},close:function(){$(".ui-widget-overlay").removeClass("black"),null!=modalWidth&&$(".ui-widget-overlay").unbind("click")}}),signInModal.find("input[name=URL]").val(document.location.href);var favSignInModal=$("#favoriteSignInModal");favSignInModal.dialog({modal:!0,width:490,autoOpen:!1,open:function(){favSignInModal.find("form").each((function(){$(this).validate().resetForm()}))}}),favSignInModal.find("input[name=URL]").val(document.location.href),$("#openFavSignIn").on("click",(function(e){e.preventDefault(),favSignInModal.dialog("open"),$(".signInLink").click()})),$("#openFavRegister").on("click",(function(e){e.preventDefault(),favSignInModal.dialog("open"),$(".createAccountModalLink").click()})),$(".createAccountModalLink").click((function(){return $("#signInSection, .createAccountModalLink, .ForgotPasswordSection").hide(),$("#favoriteSignInModal").removeClass("hide"),$("#signInLink, #registerSection").show(),$(".createEmailAccount").focus(),$("#signInModal").is(":visible")&&-1!=modalWidth&&$("#signInModal").dialog({width:modalWidth}).dialog("option","position","center"),!1})),$("#signInLink, .signInLink").click(AccountModalsJS.signInClickEvent),$("#examForgotPasswordLink").click((function(){return $("#signInSection, #createAccountModalLink").hide(),$(".ForgotPasswordSection").show(),$("#WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm").focus(),$("#signInModal").is(":visible")&&-1!=forgotWidth&&$("#signInModal").dialog({width:forgotWidth}).dialog("option","position","center"),!1})),$(".exam-close-reset-password").on("click",(function(e){e.preventDefault(),$(".ForgotPasswordSection").hide(),$("#signInSection").show()})),$("#modalPasswordResetSubmitButton").click((function(){if($(".ResetPasswordForm").valid()){var resetForm=document.resetPasswordForm,params={};params.challengeAnswer=resetForm.challengeAnswer.value,params.state=resetForm.state.value,params.URL=resetForm.URL.value,params.errorViewName=resetForm.errorViewName.value,params.logonId=resetForm.storeId.value+"|"+resetForm.logonId.value,params.email1=resetForm.logonId.value,params.emailType="forgotpassword",params.senderEmail=resetForm.logonId.value,params.senderName=resetForm.logonId.value,params.email1=resetForm.logonId.value,params.receiveEmail="true",params.recipientEmail=resetForm.logonId.value,params.receiveEmail="true",params.fromName=resetForm.logonId.value,params.pdp_18yrs="true",invokeResetPasswordService(params,!1)}return!1})),$(".examSignInModal .cancel").not(".exam-close-reset-password").click((function(e){e.preventDefault(),signInModal.dialog("close")})),$("#favoriteSignInModal .cancel").not(".exam-close-reset-password").click((function(e){e.preventDefault(),favSignInModal.dialog("close")})),$(".ResetPasswordForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{logonId:{required:!0,email:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid}}})}catch(e){-1==window.location.href.indexOf("ScheduleExamView")?console.error("Logged: "+e):console.log("OEE - No need to setup account modal.")}},setupRegistrationValidation:function(){var modalLogonParameters=$.extend(!0,{},window.logonParameters),examRegisterParameters=$.extend(!0,{},window.registerParameters),favRegisterParameters=$.extend(!0,{},window.registerParameters);examRegisterParameters.rules={logonId:{required:!0,email:!0},logonIdVerify:{required:!0,email:!0,equalTo:"#modalRegistrationForm input[name=logonId]"},logonPassword:{required:!0},logonPasswordVerify:{required:!0,equalTo:"#modalRegistrationForm input[name=logonPassword]"},optin_18yrs:{required:!0}},examRegisterParameters.messages={logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailEmpty,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonIdVerify:{required:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,email:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,equalTo:MessageHelper.messages.ERROR_EMAIL_MISMATCH},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},favRegisterParameters.rules={logonId:{required:!0,email:!0},logonIdVerify:{required:!0,email:!0,equalTo:"#favModalRegistrationForm input[name=logonId]"},logonPassword:{required:!0},logonPasswordVerify:{required:!0,equalTo:"#favModalRegistrationForm input[name=logonPassword]"},optin_18yrs:{required:!0}},favRegisterParameters.messages={logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailEmpty,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonIdVerify:{required:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,email:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,equalTo:MessageHelper.messages.ERROR_EMAIL_MISMATCH},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},modalLogonParameters.rules={logonId:{required:!0,email:!0},logonPassword:{required:!0}},modalLogonParameters.messages={logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER}},modalLogonParameters.submitHandler=AccountModalsJS.logonFormSubmit,examRegisterParameters.submitHandler=window.registerFormSubmit,favRegisterParameters.submitHandler=window.registerFormSubmit;try{$("#modalLoginForm").validate(modalLogonParameters),$("#modalRegistrationForm").validate(examRegisterParameters),$("#favoriteSignInModal").find("#modalLoginForm").validate(modalLogonParameters),$("#favModalRegistrationForm").validate(favRegisterParameters),$("#modalRegistrationForm").find('input[type="checkbox"]').on("keyup",(function(e){13==e.keyCode&&registerFormSubmit($(this).closest("form"))}))}catch(e){-1==window.location.href.indexOf("ScheduleExamView")?console.error("Logged: "+e):console.log("OEE - No need to validate account registration modal.")}},showLoginModal:function(){var signInModal=$("#signInModal");$("#registerSection, #signInLink, .ForgotPasswordSection").hide(),$(".createAccountModalLink, #examSignInSection, #signInSection").show(),signInModal.dialog("open"),$(".signInEmail").focus(),$("#ui-dialog-title-examSignInModal").remove()}};