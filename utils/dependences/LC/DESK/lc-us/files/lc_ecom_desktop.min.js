"function"!=typeof Object.assign&&(Object.assign=function(target){"use strict";if(null==target)throw new TypeError("Cannot convert undefined or null to object");target=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(null!=source)for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target});var selectedDefaultValue=!0;function showFileDetails(itemId){var $modal=$("#rx_modal_image"),req=new XMLHttpRequest;req.open("GET","/wcs/resources/store/"+constants.ajaxParams.storeId+"/provideprescription/download/item/"+itemId,!0),req.responseType="blob",req.onload=function(event){if(req.response.size>0){var blob=req.response;$modal.find(".rx-image").attr("src",window.URL.createObjectURL(blob));var filename=req.getResponseHeader("Content-Disposition").split("filename=")[1];(imgTag=$modal.find(".rx-image")).parent().find("p").remove(),null!=filename&&""!==filename&&imgTag.attr("alt",filename).show(),$modal.toggleClass("hidden"),$("html").toggleClass("hidden-overflow")}else{var imgTag;if(null!=(filename=req.getResponseHeader("Content-Disposition").split("filename=")[1])&&""!==filename)(imgTag=$modal.find(".rx-image").hide()).parent().find("p").remove(),imgTag.parent().append("<p>"+filename+"</p>"),$modal.toggleClass("hidden"),$("html").toggleClass("hidden-overflow")}},req.send()}!function($){void 0===window.LC2&&(window.LC2={});var LC2=window.LC2;LC2.filterOnlyDigitsInput=function(inputRef){var start=inputRef.selectionStart,end=inputRef.selectionEnd;inputRef.value=inputRef.value.replace(/[^\d]/g,""),inputRef.setSelectionRange(start,end)},LC2.accordionMenus=function($ul){var $accordions=$ul||$(".accordion-menu");"function"!=typeof $accordions.each&&($accordions=$($accordions)),$accordions.each((function(){var $this=$(this);if("yes"===$this.data("accordioned"))return!0;$this.data("accordioned","yes");var $links=$this.children("li").children("a");$links.length&&$links.each((function(){var $this=$(this),$listItem=$this.parent(),$sibling=$this.siblings().first();$sibling.length&&$this.on("click",(function(e){e.preventDefault(),$listItem.toggleClass("expanded"),$this.toggleClass("expanded"),$links.not($this).next().stop().slideUp("fast").parent().removeClass("expanded"),$links.not($this).removeClass("expanded"),$sibling.removeClass("hide"),$sibling.stop().slideToggle("fast")}))}))}))},LC2.submitStepData=function(functionPath,formData){var pathElems=functionPath.split("."),pathElemsWithoutFunct=pathElems.slice(0,pathElems.length-1),functionToCall=pathElems[pathElems.length-1],currentScope=window;pathElemsWithoutFunct.forEach((function(singlePath){currentScope=currentScope[singlePath]})),currentScope[functionToCall].call(null,formData)},LC2.initSlideshowListeners=function(){var viewsButtonsDOM=$(".item-image-options > .views-buttons > a"),viewsButtonsCircular=[];viewsButtonsDOM.each((function(){viewsButtonsCircular.push($(this)[0].id)})),$(".product").find(".left-arrow, .right-arrow").on("click",(function(e){var nextIndex,viewsButtonsActive=viewsButtonsDOM.filter(".active")[0].id,currentActiveIndex=viewsButtonsCircular.indexOf(viewsButtonsActive);switch(e.currentTarget.className){case"left-arrow":nextIndex=(--currentActiveIndex+viewsButtonsCircular.length)%viewsButtonsCircular.length;break;case"right-arrow":nextIndex=(++currentActiveIndex+viewsButtonsCircular.length)%viewsButtonsCircular.length}var nextViewsButtonActiveId=viewsButtonsCircular[nextIndex];viewsButtonsDOM.filter((function(index,value){return value.id===nextViewsButtonActiveId})).trigger("click")}))},LC2.stickyTopMobileCheckout=function(){$(window).on("scroll",(function(){window.scrollY>1?$(".progress-sticky-brief").hasClass("hide")&&($(".progress-sticky-complete").addClass("hide"),$(".progress-sticky-brief").removeClass("hide")):($(".progress-sticky-complete").removeClass("hide"),$(".progress-sticky-brief").addClass("hide"))}))},LC2.dynamicDialogCreation=function(id,dialogHtml,openCb,closeCb,dialogWidth){var $body=$("body");$body.find("#"+id).length||$body.append(dialogHtml),dialogWidth=dialogWidth||90*window.screen.availWidth/100,isNaN(Number(dialogWidth))||(dialogWidth+="px"),$("#"+id).dialog({modal:!0,resizeable:!1,width:dialogWidth,open:function(){$(".ui-widget-overlay").addClass("black-overlay"),$("html").addClass("hidden-overflow"),$("body").addClass("hidden-overflow"),openCb&&openCb()},close:function(){$("html").removeClass("hidden-overflow"),$("body").removeClass("hidden-overflow"),closeCb&&closeCb()}})},LC2.initPdpUtils=function(){LC2.pdpUtils={isLensJsonValid:function(jsonToCheck){var isValid=!0;return jsonToCheck&&Object.keys(jsonToCheck).length&&jsonToCheck.lens_categories&&jsonToCheck.lens_categories.length?jsonToCheck.lens_categories.forEach((function(category){category.lenses.forEach((function(lens){lens.lens_color_categories.forEach((function(lens_color_category){lens_color_category.skus&&lens_color_category.skus.length||(isValid=!1)}))}))})):isValid=!1,isValid},openPupillaryDistance:function(id,dialogWidth){var dialogHtml='<div id="'+id+'"><h2>Pupillary Distance</h2><img src="/wcsstore/LensCraftersStorefrontAssetStore/images/pupillary-distance.jpg" /></div>';LC2.dynamicDialogCreation(id,dialogHtml,null,null,dialogWidth)},openJsonInvalidModal:function(id,dialogWidth){var dialogHtml='<div id="'+id+'"><div id="checkout-back-warning" class="back-warning black-overlay"><div><h3>Error</h3><p>Drats! It looks like the glasses you picked can\'t be customized yet. We\'re working to fix that. For now, grab them as is by adding to your cart.</p></div></div></div>';LC2.dynamicDialogCreation(id,dialogHtml,dialogWidth)},checkoutStepBackConfirm:function(id,dialogWidth,callingObjRef){var dialogHtml=function(id){return'<div id="'+id+'" class="modal-steps-checkout redesign2017"><div id="checkout-back-warning" class="back-warning black-overlay"><div><h3>Are you sure you want to go back?</h3><p>If you go back now, you will lose your selections</p></div><div class="warning-buttons redesign2017"><a class="st-button st-button-outline no-response" href="#" tabindex="0"><span aria-hidden="true"></span>CANCEL</a><a href="#" class="st-button yes-response" tabindex="0"><span aria-hidden="true"></span>Yes</a></div></div></div>'}(id);LC2.dynamicDialogCreation(id,dialogHtml,(function(){$("body").on("click","#"+id+" .yes-response",(function(e){e.preventDefault(),window.location.replace(callingObjRef.href)})),$("body").on("click","#"+id+" .no-response",(function(e){e.preventDefault(),$("#"+id).dialog("close")}))}),null,"500")},openExitingFromLensSelection:function(id,dialogWidth){var dialogHtml=function(id){var output='<div id="'+id+'"><div id="checkout-back-warning" class="back-warning black-overlay"><div><h3>Are you sure you want to go back?</h3><p>If you go back now, you will lose your selections</p></div><div class="warning-buttons redesign2017"><a class="st-button st-button-outline no-response" href="#" tabindex="0"><span aria-hidden="true"></span>CANCEL</a><a href="#" class="st-button yes-response" tabindex="0"><span aria-hidden="true"></span>Yes</a></div></div></div>';return"modal-no-lens-choosed"==id&&(output='<div id="'+id+'"><div id="checkout-back-warning" class="back-warning black-overlay"><div><h3>Are you sure you want to go back?</h3><p>If you go back now, you will lose your lens selection.</p></div><div class="warning-buttons redesign2017"><a class="st-button st-button-outline no-response" href="#" tabindex="0"><span aria-hidden="true"></span>CANCEL</a><a href="#" class="st-button yes-response" tabindex="0"><span aria-hidden="true"></span>Yes</a></div></div></div>'),output}(id);LC2.dynamicDialogCreation(id,dialogHtml,(function(){$("body").on("click","#"+id+" .yes-response",(function(e){e.preventDefault(),$("#"+id).dialog("close"),$("#lens-selection-area").data("bypassBeforeClose",!0),closeLensSelectionModal()})),$("body").on("click","#"+id+" .no-response",(function(e){e.preventDefault(),$("#"+id).dialog("close")}))}),null,"500")},checkStepToBeHidden:function(lensTypeSelected,lensProductSelected){var counter=0;return $(".step-template-html").each((function(){$(this).data("stepmounted")&&counter++})),3===counter&&lensTypeSelected&&lensProductSelected&&showModalStep(2),3===counter&&lensTypeSelected&&!lensProductSelected&&showModalStep(1),2===counter&&lensTypeSelected&&showModalStep(1),1===counter&&showModalStep(0),counter},printLensInfoIntoMenu:function(info){if(info.name&&(info.listPrice||0==info.listPrice)){if((RiaHelper.isInsuranceOn()||info.framePromoPrice)&&info.originalPrice?$(".lens-section .price").html("$"+parseFloat(info.originalPrice).toFixed(2)):$(".lens-section .price").html("$"+parseFloat(info.listPrice).toFixed(2)),info.name==$("#planoName").val()||"Sin receta"==info.name)$(".lens-section").addClass("hide"),$("li.lens-subsection").removeClass("selected");else for(var p in $(".lens-section").removeClass("hide"),$("li.lens-subsection").addClass("selected"),$("li.lens-subsection .lens-material-container p").text(info.material),utag_data.Products){utag_data.Products[p].LensTechnology=info.material}$(".lens-hidden-data > .lensCatentryId").val(info.lens_id),$(".lens-hidden-data > .lensPrice").val(info.listPrice),$(".lens-hidden-data > .framePromoPrice").val(info.framePromoPrice),$(".lens-hidden-data > .lensSaving").val(info.offerPrice),$(".lens-hidden-data > .lensUPC").val(info.UPC)}},printColor:function(info){for(var p in $(".lens-subsection .lens-color-container .existing-lens-color").text(info.color),info.lens_sku_code==$("#planoCodeSku").val()?$(".lens-subsection .existing-lens-selection-text").addClass("hide"):$(".lens-subsection .existing-lens-selection-text").removeClass("hide"),$(".lens-hidden-data > .lensColor").val(info.color),utag_data.Products){utag_data.Products[p].LensColor=info.color}$(".lens-hidden-data > .lens_sku_id").val(info.lens_sku_id)},getPropFromLensId:function(pdpLensInfo,prop,id_lens,id_sku){var color;return pdpLensInfo.lens_categories.forEach((function(category){category.lenses.forEach((function(lens){lens.lens_id==id_lens&&(id_sku?lens.lens_color_categories.forEach((function(color_category){color_category.skus.forEach((function(sku){if(sku.lens_sku_id==id_sku)return color=sku[prop]}))})):color=lens.lens_color_categories[0].skus[0][prop])}))})),color},getPropFromLensProduct:function(pdpLensInfo,prop,id_lens){var color;return pdpLensInfo.lens_categories.forEach((function(category){category.lenses.forEach((function(lens){lens.lens_id==id_lens&&(color=lens[prop])}))})),color},getPdpInfoSubset:function(pdpLensInfo,radioCategory,selectedLensId){var subset;return pdpLensInfo.lens_categories.forEach((function(category){category.name===radioCategory.trim()&&category.lenses.forEach((function(lens){lens.lens_id.toString()===selectedLensId&&(subset=lens)}))})),subset},formatJson:function(source1,source2,mobile){return objToClone={selectedItem:source1,addons:source2.addons,mobile:!!mobile},Object.assign?Object.assign({},objToClone):$.extend(!0,{},objToClone);var objToClone},mountStepOnRadioClick:function(pdpLensInfo,templateSelector,appendSelector,selectedRadio,closeAction){var onlystep1=!1;selectedRadio&&(onlystep1=selectedRadio.isOnlyStep1Radio()),onlystep1?setTimeout(closeAction,100):LC2.pdpUtils.mountStep(pdpLensInfo,templateSelector,appendSelector)},addInfoToObj:function(pdpLensInfo){pdpLensInfo.lens_categories=pdpLensInfo.lens_categories.map((function(category){return category.lenses.forEach((function(lens){var skuCount=0;lens.lens_color_categories.forEach((function(lens_color_category){skuCount+=lens_color_category.skus.length})),lens.lens_color_categories.forEach((function(lens_color_category){lens_color_category.skus[0].onlyOneSkus=1===skuCount})),lens.onlyStep1=!pdpLensInfo.addons.length&&1===skuCount&&!lens.ehnancements})),category}))},hideErrorMessages:function(){$("#lens-selection-area .required").hide()},mountStep:function(pdpLensInfo,templateSelector,appendSelector){var modalSource,html;LC2.pdpUtils.hideErrorMessages(),modalSource=$(templateSelector).html(),html=Handlebars.compile(modalSource)(pdpLensInfo),html=$("<span />",{html:html}).html().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&gt;/g,">"),$(appendSelector+" > .step-template-html").data("stepmounted",!0).html(html)},getSelectedProductInfo:function($inputRadio){var info={};return info.name=$inputRadio.data("name"),info.listPrice=$inputRadio.data("listprice"),info.offerPrice=$inputRadio.data("offerprice"),info.framePromoPrice=$inputRadio.data("framepromoprice"),info.originalPrice=$inputRadio.data("price"),info.lens_id=$inputRadio.attr("data-lensid"),info.UPC=$inputRadio.data("lens-upc"),info.material=$inputRadio.data("lens-material"),info},getQueryStringParams:function(sParam){for(var sURLVariables=window.location.search.substring(1).split("&"),i=0;i<sURLVariables.length;i++){var sParameterName=sURLVariables[i].split("=");if(sParameterName[0]==sParam)return sParameterName[1]}},autoOpenLensSelection:function($openButton){var lensPopup=LC2.pdpUtils.getQueryStringParams("lensPopup");(lensPopup=parseInt(lensPopup,10))&&$openButton&&$openButton.trigger("click")},initModalTabs:function(){var $productIdTabs=$("#lens-selection-modal-tabs > div.tab-panes > div");$.each($productIdTabs,(function(index,value){if(""==$(value).find("div").html().trim()){var id=$(value).attr("id");$("a[href=#"+id+"]").parent().remove(),$(value).remove()}}));$productIdTabs=$("#lens-selection-modal-tabs > div.tab-panes > div");$("#lens-selection-modal-tabs > ul").tabs($productIdTabs,{current:"active",initialIndex:0,history:!0})},initLensSelection:function(){if(LC2.pdpUtils.isLensJsonValid(LC2.currentLenses)){LC2.pdpUtils.mountStep(LC2.currentLenses,"#lens-selection-area-template-pre-selection","#lens-selection-area-1");var planoCodeConfig=$("#planoCode").val(),lensSelectedId=$.query.get("selectedLens"),lensSelected=!1,moreCategories=!(1===LC2.currentLenses.lens_categories.length&&1===LC2.currentLenses.lens_categories[0].lenses.length);if($("#lens-selection-area").hasClass("cart-lens-options")&&!LC2.noPrescriptionSelected||lensSelected||void 0!==LC2.currentLenses.selectedLensType)lensSelected&&LC2.currentLenses.lens_categories[0].lenses[0].lens_code==planoCodeConfig&&($(".lens-subsection .bold.existing-lens-name").text("Rx Not Available"),$(".lens-subsection .existing-lens-name").show());else{var planoFound=!1,lensSelectedFound=!1,autoSelectedLens={};try{jQuery.each(LC2.currentLenses.lens_categories,(function(i,lenscat){lensSelectedFound||jQuery.each(lenscat.lenses,(function(j,lens){if(lens.lens_id==lensSelectedId||lens.lens_code==planoCodeConfig){if((autoSelectedLens=lens).material=lenscat.name,lens.lens_id==lensSelectedId)return lensSelectedFound=!0,!1;lens.lens_code==planoCodeConfig&&(planoFound=!0)}}))})),lensSelectedFound||planoFound?setTimeout((function(){LC2.pdpUtils.printLensInfoIntoMenu({name:autoSelectedLens.name,listPrice:autoSelectedLens.current_price,lens_id:autoSelectedLens.lens_id,offerPrice:autoSelectedLens.saving,originalPrice:autoSelectedLens.list_price,framePromoPrice:autoSelectedLens.framePromoPrice,material:autoSelectedLens.material,UPC:autoSelectedLens.lens_color_categories[0].skus[0].lens_sku_code}),lensSelected=!0,$(".add-to-cart").addClass("st-button-orange").removeClass("lens-not-selected"),LC2.pdpUtils.printColor({color:autoSelectedLens.lens_color_categories[0].skus[0].color,lens_sku_id:autoSelectedLens.lens_color_categories[0].skus[0].lens_sku_id,lens_sku_code:autoSelectedLens.lens_color_categories[0].skus[0].lens_sku_code}),$("#lens-selection-area").hasClass("cart-lens-options")||trackApplyLensToFrame(LC2.currentLenses,autoSelectedLens.lens_id),lensSelectedFound?(LC2.pdpUtils.initLensSelectionSteps("prescription-lens",autoSelectedLens),$(".rx-lens-choice[data-lensid="+autoSelectedLens.lens_id+"]").attr("checked","checked"),$(".rx-lens-choice[data-lensid="+autoSelectedLens.lens_id+"]").parents(".select-lens-type").addClass("active"),lensSelected=!0):planoFound&&(LC2.currentLenses.lens_categories.length>1||LC2.currentLenses.lens_categories[0].lenses.length>1?($(".lens-subsection .bold.existing-lens-name").css("display","none"),$(".lens-subsection .existing-lens-selection-text").addClass("hide")):$(".lens-subsection").addClass("hide")),saveLensSelectionData(!1,LC2.currentLenses),LC2.pdpUtils.autoOpenLensSelection($(".pdp-item-options .edit-lens-selection")),RiaHelper.isInsuranceOn()&&moreCategories&&!planoFound&&!lensSelectedFound&&saveLensSelectionData(!1,pdpLensInfo)})):LC2.pdpUtils.initLensSelectionSteps("prescription-lens",!1)}catch(e){console.error("error: "+e.stack)}}}else $("a[rel=#select-a-lens-type]").removeClass("hide").on("click",(function(e){e.stopPropagation(),LC2.pdpUtils.openJsonInvalidModal("modal-json-error")}))},initLensSelectionSteps:function(selectedLensType,selectedLens){LC2.currentLenses.selectedLensType=selectedLensType,LC2.currentLenses.selectedLensProduct=selectedLens;var pdpLensInfo=LC2.currentLenses;if(LC2.pdpUtils.isLensJsonValid(pdpLensInfo))if(LC2.pdpUtils.addInfoToObj(pdpLensInfo),!(1===pdpLensInfo.lens_categories.length&&1===pdpLensInfo.lens_categories[0].lenses.length))$("a[rel=#select-a-lens-type]").removeClass("hide"),pdpLensInfo.onlyStep1=!0,LC2.pdpUtils.mountStep(pdpLensInfo,"#lens-selection-area-template","#lens-selection-area-2"),LC2.pdpUtils.initModalTabs();else{var lens=pdpLensInfo.lens_categories[0].lenses[0];setTimeout((function(){if(LC2.pdpUtils.printLensInfoIntoMenu({name:lens.name,listPrice:lens.current_price,lens_id:lens.lens_id,offerPrice:lens.saving,UPC:lens.lens_color_categories[0].skus[0].lens_sku_code,material:pdpLensInfo.lens_categories[0].name}),lens.onlyStep1)lensSelected=!0,$(".add-to-cart").addClass("st-button-orange").removeClass("lens-not-selected"),LC2.pdpUtils.printColor({color:pdpLensInfo.lens_categories[0].lenses[0].lens_color_categories[0].skus[0].color,lens_sku_id:pdpLensInfo.lens_categories[0].lenses[0].lens_color_categories[0].skus[0].lens_sku_id,lens_sku_code:pdpLensInfo.lens_categories[0].lenses[0].lens_color_categories[0].skus[0].lens_sku_code}),$("#lens-selection-area-3").hasClass("cart-lens-options")||trackApplyLensToFrame(pdpLensInfo,lens.lens_id),saveLensSelectionData(!0,pdpLensInfo,(function(){$(".edit-lens").addClass("hide")}));else{$("a[rel=#select-a-lens-type]").removeClass("hide");var formattedJson=LC2.pdpUtils.formatJson(lens,pdpLensInfo);formattedJson.onlySecondStep=!0,formattedJson.selectedLensType=selectedLensType,LC2.pdpUtils.mountStep(formattedJson,"#lens-selection-area-template-2","#lens-selection-area-3"),LC2.pdpUtils.initModalTabs();var availableSkus=0;$.each(formattedJson.selectedItem.lens_color_categories,(function(index,color_category){availableSkus+=color_category.skus.length})),1===availableSkus&&(LC2.pdpUtils.printColor({color:lens.lens_color_categories[0].skus[0].color,lens_sku_id:lens.lens_color_categories[0].skus[0].lens_sku_id,lens_sku_code:lens.lens_color_categories[0].skus[0].lens_sku_code,UPC:lens.lens_color_categories[0].skus[0].lens_sku_code}),$("#lens-selection-area-3").hasClass("cart-lens-options")||trackApplyLensToFrame(pdpLensInfo,lens.lens_id),setTimeout((function(){saveLensSelectionData(!1,pdpLensInfo,(function(){$("#lens-selection-area-1").addClass("hide")}))})))}}))}else $("a[rel=#select-a-lens-type]").removeClass("hide").on("click",(function(e){e.stopPropagation(),LC2.pdpUtils.openJsonInvalidModal("modal-json-error")}))}}},$(document).ready((function(){LC2.accordionMenus(),LC2.initSlideshowListeners(),$(".lc2 select").not(".dynamic-selectbox").selectBox({mobile:!0}),$("#checkoutContent.mobile").get(0)&&LC2.stickyTopMobileCheckout(),$(".perk-accordion").length>0&&""==$(".perk-accordion").html().trim()&&$(".perk-section").addClass("hide")}))}(jQuery),$.fn.toggleClasses=function(class1,class2){this.hasClass(class1)?(this.removeClass(class1),this.addClass(class2)):(this.removeClass(class2),this.addClass(class1))},$.fn.showOnlyCheckedRadio=function(class1){this.each((function(){var $this=$(this),associatedElemId=$this.attr("rel"),$associatedElem=$("#"+associatedElemId);$this.is(":checked")?$associatedElem.removeClass(class1):$associatedElem.addClass(class1)}))},$.fn.getAssociatedRadios=function(){var radioGroupName=$(this).attr("name");return $("input[type=radio][name="+radioGroupName+"]")},$.fn.onSelectedChange=function(){$(this).getAssociatedRadios().showOnlyCheckedRadio("closed")},$.fn.isGroupType=function(part_name){var elementName=$(this).attr("name");return elementName&&elementName.indexOf(part_name)>-1},$.fn.getAssociatedGroupHiddenField=function(name_part){var out=!1,groupName=$(this).attr("name"),stopPos=groupName.indexOf("_");if(stopPos){var initalNamePortion=groupName.substr(0,stopPos);out=$("input[name="+(initalNamePortion+name_part)+"]")}return out},$.fn.getAssociatedGroupFields=function(part_name){var $this=$(this),out=!1;if($this.isGroupType(part_name)){var elementName=$this.attr("name"),phoneFieldName=elementName.substr(0,elementName.length-1);out=$("[name^="+phoneFieldName+"]")}return out},$.fn.areAllGroupFieldsValid=function(part_name){var $group=$(this).getAssociatedGroupFields(part_name),is_valid=!0;return $group&&$group.each((function(){$(this).hasClass("required")&&(is_valid=!1)})),is_valid},function($,LC2){var pdpLensInfo;function initializePdpListeners(){var $lensSelectionArea=$("#lens-selection-area"),$addToCartButton=$(".add-to-cart"),$addToWishListButton=$(".order-subtotal .addToWishList"),$editSelectionLink=$(".edit-wrapper a.styled-link");if(0==$editSelectionLink.length&&function(successHandler){var $lensSelectionArea=$("#lens-selection-area"),$addToCartButton=($(".select-edit-lens, .edit-lens-link, .edit-link"),$(".remove-lens-link"),$(".add-to-cart")),$selectLensStepExit=$("#lens-selection-area .lens-modal-exit"),sourceUrl=$lensSelectionArea.data("sourceurl"),productIdRadio="input[type=radio][name=productId]",lensTypeRadio="input[type=radio][name=lens-type]";0==$(".pdp-container.pdp-frame").length&&(void 0===window.defLenses&&(window.defLenses=$.ajax({url:sourceUrl,dataType:"json"})),window.defLenses.done((function(json){LC2.currentLenses=json,pdpLensInfo=json,$(".loadingLenses").addClass("hide"),$("body").on("click","#non-rx-lens-button",(function(e){saveLensSelectionData(!1,LC2.currentLenses,(function(){closeLensSelectionModal()}))})),$("body").on("click","#finish-lens-modal-button",(function(e){e.preventDefault(),null!=$('input[name="lens"]:checked')[0]?($(".not-insurable").addClass("hide"),saveLensSelectionData(!1,LC2.currentLenses,(function(){closeLensSelectionModal()}))):$("#lens-error").show()})),$("body").on("click","#finish-package-lens-modal-button",(function(e){e.preventDefault(),null!=$('input[name="lens"]:checked')[0]?(saveLensPackageSelectionData(!1,LC2.currentLenses),closeLensSelectionModal()):$("#lens-error").show()})),$("#lens-selection-area").hasClass("cart-lens-options")||fillProductDL(json),LC2.pdpUtils.initLensSelection(),successHandler&&successHandler()}))),$lensSelectionArea.on("click",productIdRadio,(function(e){selectedDefaultValue&&(selectedDefaultValue=!1),0!=e.pageX&&$(".tab-panes").children().children("div").children(".select-lens-type").children(".lens-price-container").children("label").removeClass("focusmove");var $this=$(this);$(productIdRadio).parent().parent().removeClass("active"),$this.filter(":checked").length>0?$this.filter(":checked").parent().parent().addClass("active"):$this.parent().parent().addClass("active");var productInfo=LC2.pdpUtils.getSelectedProductInfo($this);LC2.pdpUtils.printLensInfoIntoMenu(productInfo);var RIAEnhCount=0;if($this.isOnlyStep1Radio())$("#confirm-lens-step1").html("Apply"),$(".step3-nav").css("display","none"),$(".step3-nav").prev().css("display","none");else{$("#confirm-lens-step1").html("Continue"),$(".step3-nav").css("display","block"),$(".step3-nav").prev().css("display","block");var selectedLensId=$this.val(),radioContainerId=$this.closest(".tab-pane").attr("id"),radioCategory=$("#lens-selection-modal-tabs a[href=#"+radioContainerId+"]").text(),pdpLensInfoSubset=LC2.pdpUtils.getPdpInfoSubset(pdpLensInfo,radioCategory,selectedLensId);if(LC2.pdpUtils.formatJson(pdpLensInfoSubset,pdpLensInfo).selectedLensType=$(lensTypeRadio).filter(":checked").val(),RiaHelper.isInsuranceOn()){var selectedLensEnh=pdpLensInfoSubset.ehnancements,selectedLensAddons=pdpLensInfoSubset.addons,selectedLensSkus=pdpLensInfoSubset.skus;void 0!==selectedLensEnh&&selectedLensEnh.length>0&&($.each(selectedLensEnh,(function(index,elem){"false"==elem.isStepUpPackage&&RIAEnhCount++})),0!=RIAEnhCount||void 0!==selectedLensAddons&&0!=selectedLensAddons.length||!(void 0===selectedLensSkus||selectedLensSkus.length<=1)||$this.data("onlystep1",!0))}else $("#lc-lens-enh-row").show();var $colorsTabsControllers=$("#lens-color-selection-modal-tabs ul"),$colorsTabs=$("#lens-color-selection-modal-tabs > form > div.tab-panes > div");$colorsTabsControllers.tabs($colorsTabs,{current:"active",history:!0}),RiaHelper.isInsuranceOn()?(RIAEnhCount>0?$("input[data-ispackage=true]").closest(".lc-lens-enh-item").hide():$("#lc-lens-enh-row").hide(),$(".lc-lens-enh-price").hide()):$(".lc-lens-enh-price").show(),$(".accordion-menu a").on("click",(function(){$(this).parent().siblings("ul").slideToggle(),$(this).toggleClass("expanded")})),$(".lc-lens-enh-item label").on("click",(function(e){RiaHelper.isInsuranceOn()&&($(".calculate-price-enh").removeClass("hide"),$(".ria-modal-calculated-price").addClass("hide"));var div=$(".lc-lens-enh");$(this).parent().parent().toggleClass("added");var input=$(this).parent().find("input"),exclude=$(input).attr("data-excl").toString().split(",");$(this).parent().parent().hasClass("added")?$(exclude).each((function(index,element){var ele=$(div).find('input[data-pn="'+element+'"]');$(ele).prop("disabled",!0),$(ele).parent().parent().parent().addClass("not-compatible"),$(ele).parent().removeClass("added")})):$(exclude).each((function(index,element){var ele=$(div).find('input[data-pn="'+element+'"]');$(ele).prop("disabled",!1),$(ele).parent().parent().parent().removeClass("not-compatible")}))}));var enhancements=$.query.get("selectedEnh");enhancements.length>0&&(_dl.site_events={select_lens_enhancement:"true"},$.each(enhancements,(function(index,value){$('input[data-sku-pn="'+value+'"]').closest(".lc-lens-enh-item label").click()}))),$(".calculate-price-enh").on("click",(function(){getRIAPricesForEnhancements(!1)})),_dl.site_events={select_lens_tint:"true"},callTrackAnalytics(_dl)}})),$lensSelectionArea.on("click","#confirm-lens-step-0",(function(e){e.preventDefault();var errorMessage=$("#confirm-lens-error-0");if($(lensTypeRadio).filter(":checked").length){var selectedLensType=$(lensTypeRadio).filter(":checked").val();"no-prescription"==selectedLensType?(resetLensSelectionData(),$("#lens-selection-area").data("bypassBeforeClose",!0),closeLensSelectionModal(),$("#lens-selection-area").data("bypassBeforeClose",!1)):(LC2.pdpUtils.initLensSelectionSteps(selectedLensType,$(productIdRadio).filter(":checked").val()),$(".lens-selection-modal-page").not("#lens-selection-modal-page0").hide(),showModalStep(1,(function(){if(_dl.site_events={select_lens_material:"true"},callTrackAnalytics(_dl),RiaHelper.isInsuranceOn()){var tabId=$('a[id^="t1-"].active').attr("id").substring(3);getRIAPricesForTab(tabId),$('a[id*="t1-"]').on("click",(function(){var tabId=$(this).attr("id").substring(3);getRIAPricesForTab(tabId)}))}else $(".current-saving").show();$("#choose_lens_material_header").focus()}))),errorMessage.hide()}else errorMessage.show()})),$lensSelectionArea.on("click","#confirm-lens-step1",(function(e){if(e.preventDefault(),pdpLensInfo=LC2.currentLenses,selectedDefaultValue){var selectedMaterial=$("#lens-selection-modal-tabs a.active").attr("class");selectedMaterial=selectedMaterial.substring(0,selectedMaterial.indexOf("active")-1);for(var i=0;i<pdpLensInfo.lens_categories.length;i++)if(pdpLensInfo.lens_categories[i].name==selectedMaterial){$(".select-lens-type.active input")[0].click();break}selectedDefaultValue=!0}var lensId=$(".tab-panes input[type='radio']:checked").val();fillLensInfo($(".tab-panes input[type='radio']:checked"),$(".lens-options-row input[type='radio']:checked")),_dl.site_events={select_lens_tint:"true"},callTrackAnalytics(_dl);var errorMessage=$("#confirm-lens-error"),selectedRadio=$(productIdRadio).filter(":checked"),productInfo=LC2.pdpUtils.getSelectedProductInfo(selectedRadio);if(LC2.pdpUtils.printLensInfoIntoMenu(productInfo),selectedRadio.isOnlyStep1Radio()){$addToCartButton.addClass("st-button-orange").removeClass("lens-not-selected"),$("#lens-selection-area").hasClass("cart-lens-options")||trackApplyLensToFrame(pdpLensInfo,lensId);var color=LC2.pdpUtils.getPropFromLensId(pdpLensInfo,"color",lensId),lens_sku_id=LC2.pdpUtils.getPropFromLensId(pdpLensInfo,"lens_sku_id",lensId),lens_sku_code=LC2.pdpUtils.getPropFromLensId(pdpLensInfo,"lens_sku_code",lensId);LC2.pdpUtils.printColor({color:color,lens_sku_id:lens_sku_id,lens_sku_code:lens_sku_code}),saveLensSelectionData(!1,pdpLensInfo,(function(){closeLensSelectionModal()}))}else{var selectedLensId=$(".tab-panes input[type='radio']:checked").val(),radioContainerId=$(".tab-panes input[type='radio']:checked").closest(".tab-pane").attr("id"),radioCategory=$("#lens-selection-modal-tabs a[href=#"+radioContainerId+"]").text(),pdpLensInfoSubset=LC2.pdpUtils.getPdpInfoSubset(pdpLensInfo,radioCategory,selectedLensId);formattedJson=LC2.pdpUtils.formatJson(pdpLensInfoSubset,pdpLensInfo),formattedJson.selectedLensType=$(lensTypeRadio).filter(":checked").val();var RIAEnhCount=0;if(RiaHelper.isInsuranceOn()){var selectedLensEnh=pdpLensInfoSubset.ehnancements,selectedLensAddons=pdpLensInfoSubset.addons,selectedLensSkus=pdpLensInfoSubset.skus;void 0!==selectedLensEnh&&selectedLensEnh.length>0&&($.each(selectedLensEnh,(function(index,elem){"false"==elem.isStepUpPackage&&RIAEnhCount++})),0!=RIAEnhCount||void 0!==selectedLensAddons&&0!=selectedLensAddons.length||!(void 0===selectedLensSkus||selectedLensSkus.length<=1)||$this.data("onlystep1",!0))}else $("#lc-lens-enh-row").show();showModalPage2(),LC2.pdpUtils.mountStepOnRadioClick(formattedJson,"#lens-selection-area-template-2","#lens-selection-area-3",$(".tab-panes input[type='radio']:checked"));var $colorsTabsControllers=$("#lens-color-selection-modal-tabs ul"),$colorsTabs=$("#lens-color-selection-modal-tabs > form > div.tab-panes > div");$colorsTabsControllers.tabs($colorsTabs,{current:"active",history:!0}),RiaHelper.isInsuranceOn()?(RIAEnhCount>0?$("input[data-ispackage=true]").closest(".lc-lens-enh-item").hide():$("#lc-lens-enh-row").hide(),$(".lc-lens-enh-price").hide()):$(".lc-lens-enh-price").show(),$(".accordion-menu a").on("click",(function(){$(this).parent().siblings("ul").slideToggle(),$(this).toggleClass("expanded")})),$(".lc-lens-enh-item label").on("click",(function(e){RiaHelper.isInsuranceOn()&&($(".calculate-price-enh").removeClass("hide"),$(".ria-modal-calculated-price").addClass("hide"));var div=$(".lc-lens-enh");$(this).parent().parent().toggleClass("added");var input=$(this).parent().find("input"),exclude=$(input).attr("data-excl").toString().split(",");$(this).parent().parent().hasClass("added")?$(exclude).each((function(index,element){var ele=$(div).find('input[data-pn="'+element+'"]');$(ele).prop("disabled",!0),$(ele).parent().parent().parent().addClass("not-compatible"),$(ele).parent().removeClass("added")})):$(exclude).each((function(index,element){var ele=$(div).find('input[data-pn="'+element+'"]');$(ele).prop("disabled",!1),$(ele).parent().parent().parent().removeClass("not-compatible")}))}));var enhancements=$.query.get("selectedEnh");enhancements.length>0&&(_dl.site_events={select_lens_enhancement:"true"},$.each(enhancements,(function(index,value){$('input[data-sku-pn="'+value+'"]').closest(".lc-lens-enh-item label").click()}))),$(".calculate-price-enh").on("click",(function(){getRIAPricesForEnhancements(!1)})),_dl.site_events={select_lens_tint:"true"},callTrackAnalytics(_dl)}errorMessage.hide()})),$selectLensStepExit.on("click",(function(){$lensSelectionArea.dialog("close")}))}(),$addToWishListButton.on("click",(function(){$(this).addClass("added-to-tray")})),$lensSelectionArea.on("click","#lens-selection-area  #finish-lens-modal-button",(function(){lensHaveBeenSelected=!0;var selectedLensId=$(".lens-hidden-data > .lensCatentryId").val(),selectedSkuId=$(".lens-color-actual").find("input[type=radio][name=lens]:checked").attr("data-skuid"),lens_sku_id=LC2.pdpUtils.getPropFromLensId(pdpLensInfo,"lens_sku_id",selectedLensId,selectedSkuId),color=LC2.pdpUtils.getPropFromLensId(pdpLensInfo,"color",selectedLensId,selectedSkuId),lens_sku_code=LC2.pdpUtils.getPropFromLensId(pdpLensInfo,"lens_sku_code",selectedLensId,selectedSkuId);$("#lens-selection-area").hasClass("cart-lens-options")||trackApplyLensToFrame(pdpLensInfo,selectedLensId,selectedSkuId),LC2.pdpUtils.printColor({color:color,lens_sku_id:lens_sku_id,lens_sku_code:lens_sku_code}),$addToCartButton.addClass("st-button-orange").removeClass("lens-not-selected");var $errorMessage=$addToCartButton.next("span.select-lens-error-message");$errorMessage&&$errorMessage.addClass("hide")})),$lensSelectionArea.on("click","input[type=radio][name=lens]",(function(){var $this=$(this);LC2.pdpUtils.hideErrorMessages(),$this.closest(".lens-holder.check-row").addClass("active"),$this.getAssociatedRadios().filter(":not(:checked)").closest(".lens-holder.check-row").removeClass("active")})),$lensSelectionArea.on("click","#go-back-lens-modal-button-step0",(function(e){e.preventDefault(),LC2.pdpUtils.openExitingFromLensSelection("modal-no-lens-choosed")})),$lensSelectionArea.on("click","#go-back-lens-modal-button-step1",(function(e){showModalStep(0,(function(){$("#lens_type_header").focus()}))})),$lensSelectionArea.on("click","#go-back-lens-modal-button-2",(function(e){showModalStep(1,(function(){if(RiaHelper.isInsuranceOn()){var tabId=$('a[id^="t1-"].active').attr("id").substring(3);getRIAPricesForTab(tabId),$('a[id*="t1-"]').on("click",(function(){var tabId=$(this).attr("id").substring(3);getRIAPricesForTab(tabId)}))}$("#choose_lens_material_header").focus()}))})),$lensSelectionArea.on("click",".lens-name-link",(function(e){e.preventDefault(),$(this).closest(".step-template-html").find(".lens-modal-prev").eq(0).trigger("click")})),$addToCartButton.on("click",(function(e){e.preventDefault(),lensSelected?ajaxAddGlassesToCart():$addToCartButton.parent().find(".select-lens-error-message").length?($addToCartButton.text("Added To Bag"),window.location=this.href):$addToCartButton.parent().append('<span class="select-lens-error-message">Please pick a lens before adding to cart<span>')})),$(".info-dialog-pdp").each((function(index){var id=$(this).attr("id"),titlePerk=(index=$(this).data("index"),$("#"+id+" .perk-espot > h1").text());$("#perk-accordion-title_"+index).text(titlePerk);var expiresPerk=$("#"+id+" .perk-espot .perks-expired-and-code p:first-child").text();$("#perk-accordion-expires_"+index).text(expiresPerk.substr(6))})),$(".perk-box").click((function(){$(this).find(".perk-check").toggleClass("perk-check-active"),$(this).toggleClass("perk-box-active")})),$(".perk-triangle").click((function(){$(".perk-accordion").toggle(300),$(this).toggleClass("perk-triangle-rotated")})),$("[id*=more-info-dialog_]").dialog({autoOpen:!1,modal:!0,open:function(){$(".ui-widget-overlay").addClass("black-overlay"),$(".ui-dialog").addClass("st-dialog ui-corner-all perks-info-modal")}}),$("[class*=circle_]").click((function(){var counter=$(this).attr("class").substring(7);return $("[id*=more-info-dialog_"+counter+"]").dialog("open"),!1})),$(".perk-box").on("click",(function(){var baseUrl=[location.protocol,"//",location.host,location.pathname].join(""),param=$.query.REMOVE("selectedPerkCode").REMOVE("selectedPerk");if($(this).hasClass("perk-box-active"))param=$.query.SET("selectedPerk",$(this).data("perkname")).SET("selectedPerkCode",$(this).children(".perk-check").data("perkcode"));var lens=$(".lens-hidden-data > .lensCatentryId").val();if(lens){$.query.REMOVE("selectedLens");param=$.query.SET("selectedLens",lens)}window.location.href=baseUrl+param.toString()})),""!=$.query.get("selectedPerk")){var perkName=$.query.get("selectedPerk"),$box=$(".perk-box[data-perkname="+perkName+"]");$box.addClass("perk-box-active"),$box.children(".perk-check").addClass("perk-check-active"),$(".perk-triangle").click()}}LC2.initPdpUtils(),$.fn.isOnlyStep1Radio=function(){return!!$(this).data("onlystep1")},$(document).ready((function(){($("#lens-selection-area").length>0||$("#contactLensesForm").length>0)&&initializePdpListeners(),$(".size-container.current").parent().parent().removeClass("hide"),$(".sibling-container").click((function(){var color=$(this).data("color");$(".sibling-container").removeClass("current"),$(this).addClass("current"),$(".pdp-product-siblings-section.size").addClass("hide"),$("#pdp-product-siblings-section-"+color).removeClass("hide")})),$(".callout-content").each((function(index,elem){$(elem).children().length>0&&$(elem).closest(".info-icon").removeClass("hidden")})),$(".perk-section .perk-box").length>0&&$(".perk-section").removeClass("hide"),$(".callout-content").each((function(index,elem){$(elem).children().length>0&&$(elem).closest(".info-icon").removeClass("hidden")})),$(".item_container .item span.badge-pre-release:visible").closest(".item").css("border","1px solid #c23a9a").on("mouseenter",(function(){$(this).css("box-shadow","2px 3px 4px 0 rgba(194, 58, 154, 0.5)")})).on("mouseleave",(function(){$(this).css("box-shadow","none")}))}))}(jQuery,window.LC2),$(document).on("keydown","a.shoppingCartForward",(function(e){13===e.which&&$(this)[0].click()})),$(document).on("keydown","a#editShipping.edit",(function(e){13===e.which&&$(this)[0].click()})),$(document).on("keypress",".pdp-container .product .right-arrow,.pdp-container .product .left-arrow",(function(e){13===e.which&&$(this).trigger("click")})),$(document).on("keypress","label[for^=eighteen_older_footer]",(function(e){if(13===e.which){var my_selector="#"+this.getAttribute("for");$(my_selector).trigger("click")}})),$(document).on("keypress","label[for^=personal_info],label[for^=plan_info],label[for^=ssn]",(function(e){if(13===e.which){var my_selector="#"+this.getAttribute("for");$(my_selector).trigger("click")}})),$(document).on("keypress","label[for^=no-prescription-type],label[for^=single-vision-lens-type]",(function(e){if(13===e.which){var my_selector="#"+this.getAttribute("for");$(my_selector).trigger("click")}})),$(document).on("keypress",".edit-lens-link, .remove-lens-link",(function(e){13===e.which&&$(this).trigger("click")})),$(document).on("keypress",".show-more-facet",(function(e){13===e.which&&($(this).trigger("click"),$(this).hasClass("show-brand less")&&$(this).prev().find("label:first").focus())})),$(document).on("keypress","label[for^=SBN_facet_]",(function(e){if(13===e.which){var my_selector="#"+this.getAttribute("for");$(my_selector).trigger("click")}})),$(document).on("keydown","#shippingBillingPageNext",(function(e){13===e.which&&($(this).trigger("click"),$(".checkout-step-3 .select_container.small-input.date.error div + span.required").attr("aria-label","Please select a valid date"))})),$(document).on("keydown","#processToPayment",(function(e){13===e.which&&($(this).trigger("click"),$("div.checkout-step-2 div.date-parent span.required").attr("aria-label","Please enter your birth date"),$("#WC_shippingAddressCreateEditFormDiv_1_address1_div_11 span.required").attr("aria-label","The street address field cannot be empty"),$("form.lc2 .input-container.error > span.required").attr("tabindex","0"),$("div.checkout-step-2 div.date-parent span.required").attr("tabindex","0"))})),$(document).on("keydown","#insuranceModal",(function(e){27===e.which&&$("#insuranceModal").focusin()&&$("#insurance-switch").focus()})),$("#rxPupilDistance").change((function(){$("form.lc2 .rx-fields .select_container .selectBox-label").attr("aria-label","Pupillary distance selector "+$("a.selectBox.drop_down_checkout.selectBox-dropdown.selectBox-active").text())})),$(document).on("keypress",".select-lens-type input[type=radio] + label",(function(e){if(13===e.which){var for_id="#"+$(this).attr("for");$(for_id).trigger("click")}})),$(document).on("keypress",".lens-color-actual > div .label_radio",(function(e){if(13===e.which){var for_id="#"+$(this).attr("for");$(for_id).trigger("click"),$(for_id).trigger("click")}})),$(document).on("keypress","label[for^=doctor-phone],label[for^=doctor-name]",(function(e){if(13===e.which){var my_selector="#"+this.getAttribute("for");$(my_selector).trigger("click")}})),$(document).on("keypress",".appointmentTimes div label",(function(e){13===e.which&&$(this).parent().children()[0].click()})),$(document).on("keypress","label[for^=ageCheck]",(function(e){if(13===e.which){var my_selector="#"+this.getAttribute("for");$(my_selector).trigger("click")}}));