var modalWidth,forgotWidth,error_list=new Array,signinWidth=-1,currentPage="",products_in_comparison=new Array;modelPWReset=!0,dojo={},dojo.addOnLoad=function(f){$(document).ready(f)},dojo.require=function(){},window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.console.debug||(window.console.debug=function(){}),window.console.error||(window.console.error=function(){}),window.console.info||(window.console.info=function(){}),window.console.warn||(window.console.warn=function(){}),$.extend({getUrlVars:function(){var hash,vars=[];if(!window.location.href.includes("?"))return vars;for(var hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++)if(vars[(hash=hashes[i].split("="))[0]]){var value=vars[hash[0]].split("#")[0];value+="&"+decodeURIComponent(hash[1]),vars[hash[0]]=value}else vars.push(hash[0]),vars[hash[0]]=decodeURIComponent(hash[1]);return vars},getUrlVar:function(name){return $.getUrlVars()[name]}}),$.support.cors=!0;var zipRegex,isOpen=!1;function checkPswDouble(name,contentElement){var val=document.getElementById(name).value,elEightChar=document.getElementById("eight-char-"+contentElement),elUpperChar=document.getElementById("upper-char-"+contentElement),elLowerChar=document.getElementById("lower-char-"+contentElement),elNumberChar=document.getElementById("number-char-"+contentElement),elSpecialChar=document.getElementById("special-char-"+contentElement);""!==val?(val.length>=8?(console.log("lungo 8"),elEightChar.classList.add("correct"),elEightChar.classList.remove("error")):(elEightChar.classList.add("error"),elEightChar.classList.remove("correct")),hasUpperCase(val)?(console.log("Upper"),elUpperChar.classList.add("correct"),elUpperChar.classList.remove("error")):(elUpperChar.classList.add("error"),elUpperChar.classList.remove("correct")),hasLowerCase(val)?(console.log("Lower"),elLowerChar.classList.add("correct"),elLowerChar.classList.remove("error")):(elLowerChar.classList.add("error"),elLowerChar.classList.remove("correct")),hasNumber(val)?(console.log("Number"),elNumberChar.classList.add("correct"),elNumberChar.classList.remove("error")):(elNumberChar.classList.add("error"),elNumberChar.classList.remove("correct")),hasSpecialChar(val)?(console.log("Special"),elSpecialChar.classList.add("correct"),elSpecialChar.classList.remove("error")):(elSpecialChar.classList.add("error"),elSpecialChar.classList.remove("correct"))):clearErrorDouble(contentElement)}function clearErrorDouble(contentElement){var elEightChar=document.getElementById("eight-char-"+contentElement),elUpperChar=document.getElementById("upper-char-"+contentElement),elLowerChar=document.getElementById("lower-char-"+contentElement),elNumberChar=document.getElementById("number-char-"+contentElement),elSpecialChar=document.getElementById("special-char-"+contentElement);elEightChar.classList.remove("error"),elEightChar.classList.remove("correct"),elUpperChar.classList.remove("error"),elUpperChar.classList.remove("correct"),elLowerChar.classList.remove("error"),elLowerChar.classList.remove("correct"),elNumberChar.classList.remove("error"),elNumberChar.classList.remove("correct"),elSpecialChar.classList.remove("error"),elSpecialChar.classList.remove("correct")}function checkPsw(name){var val=document.getElementById(name).value,elEightChar=document.getElementById("eight-char"),elUpperChar=document.getElementById("upper-char"),elLowerChar=document.getElementById("lower-char"),elNumberChar=document.getElementById("number-char"),elSpecialChar=document.getElementById("special-char");""!==val?(val.length>=8?(console.log("lungo 8"),elEightChar.classList.add("correct"),elEightChar.classList.remove("error")):(elEightChar.classList.add("error"),elEightChar.classList.remove("correct")),hasUpperCase(val)?(console.log("Upper"),elUpperChar.classList.add("correct"),elUpperChar.classList.remove("error")):(elUpperChar.classList.add("error"),elUpperChar.classList.remove("correct")),hasLowerCase(val)?(console.log("Lower"),elLowerChar.classList.add("correct"),elLowerChar.classList.remove("error")):(elLowerChar.classList.add("error"),elLowerChar.classList.remove("correct")),hasNumber(val)?(console.log("Number"),elNumberChar.classList.add("correct"),elNumberChar.classList.remove("error")):(elNumberChar.classList.add("error"),elNumberChar.classList.remove("correct")),hasSpecialChar(val)?(console.log("Special"),elSpecialChar.classList.add("correct"),elSpecialChar.classList.remove("error")):(elSpecialChar.classList.add("error"),elSpecialChar.classList.remove("correct"))):clearError()}function clearError(){var elEightChar=document.getElementById("eight-char"),elUpperChar=document.getElementById("upper-char"),elLowerChar=document.getElementById("lower-char"),elNumberChar=document.getElementById("number-char"),elSpecialChar=document.getElementById("special-char");elEightChar.classList.remove("error"),elEightChar.classList.remove("correct"),elUpperChar.classList.remove("error"),elUpperChar.classList.remove("correct"),elLowerChar.classList.remove("error"),elLowerChar.classList.remove("correct"),elNumberChar.classList.remove("error"),elNumberChar.classList.remove("correct"),elSpecialChar.classList.remove("error"),elSpecialChar.classList.remove("correct")}function hasUpperCase(myString){return/[A-Z]/.test(myString)}function hasLowerCase(myString){return/[a-z]/.test(myString)}function hasNumber(myString){return/\d/.test(myString)}function hasSpecialChar(myString){return/[ `!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/.test(myString)}function serializeSessionStorage(){var storageKeys=[];if(sessionStorage.length>0){for(var i=0;i<sessionStorage.length;i++){var key=sessionStorage.key(i),value=sessionStorage.getItem(key);$.cookie(key,value,{path:"/"}),storageKeys.push(key)}$.cookie("sessionStorage",storageKeys.join(":"),{path:"/"})}}function deserializeSessionStorage(){var keys=$.cookie("sessionStorage");if($.cookie("sessionStorage",null,{path:"/"}),keys&&keys.length){keys=keys.split(":");for(var i=0;i<keys.length;i++){var cookieValue=$.cookie(keys[i]);$.cookie(keys[i],null,{path:"/"}),sessionStorage[keys[i]]=cookieValue}}}function eyeExamRemoveEyeExamAnalytics(){var country="us",userAuthenticated="not authenticated",userRegistration="not registered";"CA"==constants.ajaxParams.countryName&&(country="ca"),constants.ajaxParams.loggedIn&&(userAuthenticated="authenticated",userRegistration="registered"),data={site_events:{remove_eye_exam:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration},callTrackAnalytics(data)}function eyeExamEditEyeExamAnalytics(){var country="us",userAuthenticated="not authenticated",userRegistration="not registered";"CA"==constants.ajaxParams.countryName&&(country="ca"),constants.ajaxParams.loggedIn&&(userAuthenticated="authenticated",userRegistration="registered"),data={site_events:{edit_eye_exam:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration},callTrackAnalytics(data)}function getUserInsuranceEligibilityStatus(){var userInsuranceEligibilityStatus="not synced";return constants.ajaxParams.insuranceCheckEligibility&&(userInsuranceEligibilityStatus="synced"),userInsuranceEligibilityStatus}function utagLinkSafe(){try{utag.link.apply(utag,arguments)}catch(err){console.error(err)}}function utagViewSafe(){try{utag.view.apply(utag,arguments)}catch(err){console.error(err)}}function filterAjaxResponse(response){return response&&"string"==typeof response&&response.length?$.parseJSON(response.replace(/^\s*\/\*/,"").replace(/\*\/\s*$/,"")):response}function filterAjaxResponseCart(response){return response&&"string"==typeof response&&response.length?$.parseJSON(response.replace(/^\s*\/\*/,"").replace(/\*\/\s*$/,"")):response}function savePlacement(){currentTopPosition=$(window).scrollTop()}function getPlacement(){return currentTopPosition}function stringTemplate(text,vars,prefix){if(prefix=prefix||"%",null!=vars&&null!=text)for(var variable in vars)for(var value=vars[variable];-1!=text.indexOf(prefix+variable);)text=text.replace(prefix+variable,value);return text}function removeEmptyUtagEntries(utagObj){$.each(utagObj,(function(key,val){null!=val&&(""!=val&&null!=val||delete utagObj[key],"string"==typeof val?val=(val=(val=val.replace(/\\/g,"\\\\")).replace(/'/g,"\\'")).replace(/"/g,'\\"'):utagObj.length<=0&&delete utagObj[key],utagObj[key]=val)}))}function scrollToElement(el,scrollTime){if(null!=el&&null!=$(el).offset()){var t=2e3;null!=scrollTime&&(t=scrollTime);var page=$("html, body").clearQueue();0==t?page.scrollTop($(el).offset().top-20):page.animate({scrollTop:$(el).offset().top-20},t,"easeOutQuint")}}function seeEvents(el){var $el=$(el),applicableEvents={};return $el.parents().andSelf().map((function(){var events=$(this).data("events");if(events){for(var eventType in events)for(var eventList=events[eventType],i=0;i<eventList.length;i++){var event=eventList[i];(null==event.selector||""==event.selector||$el.is(event.selector))&&(applicableEvents[eventType]||(applicableEvents[eventType]=[]),!0,applicableEvents[eventType].push(event))}}})),applicableEvents}function removeExamCookies(){$.cookie("exam1","",{expires:-1,path:"/"}),$.cookie("exam2","",{expires:-1,path:"/"}),$.cookie("exam3","",{expires:-1,path:"/"}),$.cookie("eapptsUserId","",{expires:-1,path:"/"})}function setupPhoneFields(phone1Field,phone2Field,phone3Field){var numbersOnly=function(e){var key=e.which||e.keyCode;return!e.shiftKey&&!e.altKey&&!e.ctrlKey&&key>=48&&key<=57||key>=96&&key<=105||8==key||9==key||13==key||35==key||36==key||37==key||39==key||46==key||45==key||229==key};$(phone1Field).bind("keyup",(function(e){3==this.value.length&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105)&&-1==navigator.userAgent.indexOf("Mobile")&&$(phone2Field).focus().select()})).bind("keydown",numbersOnly).bind("input",(function(){var $this=$(this);($this.val()||"").match(/^\d{0,3}$/)?$this.data("current-value",$this.val()):$this.val($this.data("current-value")||"")})),$(phone2Field).bind("keyup",(function(e){3==this.value.length&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105)&&-1==navigator.userAgent.indexOf("Mobile")&&$(phone3Field).focus().select()})).bind("keydown",numbersOnly).bind("input",(function(){var $this=$(this);($this.val()||"").match(/^\d{0,3}$/)?$this.data("current-value",$this.val()):$this.val($this.data("current-value")||"")})),$(phone2Field).add(phone3Field).bind("keydown",numbersOnly).focus((function(){$(this).select()})),$(phone3Field).bind("input",(function(){var $this=$(this);($this.val()||"").match(/^\d{0,4}$/)?$this.data("current-value",$this.val()):$this.val($this.data("current-value")||"")}))}function setupExamPhoneFields(phone1Field){$(phone1Field).bind("keydown",(function(e){var key=e.which||e.keyCode;return!e.shiftKey&&!e.altKey&&!e.ctrlKey&&key>=48&&key<=57||key>=96&&key<=105||8==key||9==key||13==key||35==key||36==key||37==key||39==key||46==key||45==key||229==key})).bind("input",(function(){var $this=$(this);($this.val()||"").match(/^\d{0,10}$/)?$this.data("current-value",$this.val()):$this.val($this.data("current-value")||"")}))}function addUIoverlay(){var w=$(document).width(),h=$(document).height()+381;0==$(".ui-widget-overlay").length&&$("#footer_wrapper").after('<div class="ui-widget-overlay" style="width:'+w+"px;height:"+h+'px;"></div>')}function removeUIoverlay(){$(".ui-widget-overlay").remove()}function hideAllDialogs(){$(".dialog").hide()}function clearRegisterModelPWDfields(){$("#logonId_perkModel").val(""),$("#logonIdVerify_perks").val(""),$("#logonPassword_perkModel").val(""),$("#logonPasswordVerify_perkModal").val(""),$("#perksheaderEmailAddress").val(""),$("#perks-logonPassword").val(""),$("#optin_18yrs_checkBox_perk").attr("checked",!1),$("#perk-register-modal").css("display","none"),$("#perk-logon-modal").css("display","block")}function RegisterModelPWDfields(){}function logonFormSubmit(logonForm){var f=$(logonForm);if(utag_data.form_name="logon",utag_data.form_field=error_list,f.valid()){var data=f.serializeArray(),newData=[],originalURL=null;myperksURL=null;for(var i=0;i<data.length;i++){var d=data[i];"URL"==d.name&&(originalURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})),"myPerksRedirectURL"==d.name?(myperksURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})):newData.push(d)}$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.passwordExpired&&"1"==data.passwordExpired)constants.ajaxParams.loggedIn=!0,$(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block");else if(fromSubmitReview)window.location=ReviewSuccessURL;else if(data.success){if(utagData={site_events:{authentication_complete:!0},authentication_status:"authenticated",registration_status:"registered"},callTrackAnalytics(utagData),utag_data.Page_Type="Delivery")try{var obj={id:"WCS-D-CheckoutDelivery-Login",Click_FocusElement:this}}catch(err){obj={id:"WCS-D-CheckoutDelivery-Login-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-CheckoutDelivery-Login",tealium_data2track.push(obj)}else try{obj={id:"WCS-D-MyLoginRegister-Login",Click_FocusElement:this}}catch(err){obj={id:"WCS-D-MyLoginRegister-Login-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-MyLoginRegister-Login",tealium_data2track.push(obj)}var nextUrl=originalURL,myPerksRedirectUrl=myperksURL;nextUrl.length&&"#"==nextUrl.charAt(nextUrl.length-1)&&(nextUrl=nextUrl.substring(0,nextUrl.length-1)),null!=myPerksRedirectUrl&&myPerksRedirectUrl.length&&"#"==myPerksRedirectUrl.charAt(myPerksRedirectUrl.length-1)&&(myPerksRedirectUrl=myPerksRedirectUrl.substring(0,myPerksRedirectUrl.length-1)),"true"==data.redirectToMyPerks?(utagLinkSafe({link_name:"login"}),setTimeout((function(){window.location=myPerksRedirectUrl}),200)):(utagLinkSafe({link_name:"login"}),setTimeout((function(){window.location=nextUrl}),200))}else{var errMsg=data.errorMessage;"EXIST_IN_US"==errMsg?($(".LogOnFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".LogOnFailureResponseMessageDiv").append("<a target='_blank' href='"+MessageHelper.messages.RediectHomePageURL+"'>"+MessageHelper.messages.LenscrafterUS+"</a>?")):"EXIST_IN_CA"==errMsg?($(".LogOnFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".LogOnFailureResponseMessageDiv").append("<a target='_blank' href='"+MessageHelper.messages.RediectHomePageURL+"'>"+MessageHelper.messages.LenscrafterCA+"</a>?")):(obj={id:"Error",Error_Source:"User",Error_Code:"Form Filling Error",Error_Details:errMsg,Error_Message:errMsg},tealium_data2track.push(obj),$(".LogOnFailureResponseMessageDiv").html(errMsg))}},error:function(jqXHR,textStatus,errorThrown){$(".LogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}return!1}function logonFormTimeoutSubmit(logonForm){var f=$(logonForm);if(utag_data.form_name="logon",utag_data.form_field=error_list,f.valid()){var data=f.serializeArray(),newData=[];myperksURL=null;for(var i=0;i<data.length;i++){var d=data[i];"URL"==d.name&&(d.value,newData.push({name:"URL",value:"LogonAjaxView"})),"myPerksRedirectURL"==d.name?(myperksURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})):newData.push(d)}$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.passwordExpired&&"1"==data.passwordExpired)$(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block"),obj={id:"Error",Error_Source:"User",Error_Code:"Login",Error_Message:"Your password has expired"},tealium_data2track.push(obj);else if(fromSubmitReview)window.location=ReviewSuccessURL;else if(data.success){var nextUrl=$("#headerMyAccountURL").val();utagLinkSafe({link_name:"login"}),window.location=nextUrl}else obj={id:"Error",Error_Source:"User",Error_Code:"Form Filling Error - Login",Error_Details:data.errorMessage,Error_Message:data.errorMessage},tealium_data2track.push(obj),$(".LogOnFailureResponseMessageTimeoutDiv").html(data.errorMessage).show()},error:function(jqXHR,textStatus,errorThrown){$(".LogOnFailureResponseMessageTimeoutDiv").html("Login request failed - please try again later.").show()}})}return!1}function examLogonFormSubmit(logonForm){var logonFromPopup=document.getElementById("ScheduleExamLoginForm").getElementsByClassName("signInEmail").value,f=$(logonForm);if(utag_data.form_name="exam logon",utag_data.form_field=error_list,f.valid()){for(var data=f.serializeArray(),newData=[],originalURL=null,i=0;i<data.length;i++){var d=data[i];"URL"==d.name?(originalURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})):newData.push(d)}$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.passwordExpired&&"1"==data.passwordExpired)$("#examSignInSection").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block"),obj={id:"Error",Error_Source:"User",Error_Code:"Login",Error_Message:"Your password has expired"},tealium_data2track.push(obj);else if(data.success){utagData={site_events:{authentication_complete:!0},authentication_status:"authenticated",registration_status:"registered"},callTrackAnalytics(utagData);try{if(document.getElementById("userRegModelFormExam"))$(".examSignInModal").dialog("close"),document.getElementById("userRegModelFormExam").closest("div").style.display="none","true"!=data.syncValueForSignedIn?(document.getElementById("consentFormStepfour").style.display="block",document.getElementById("logonId").value=logonFromPopup):document.getElementById("manageExams").style.display="block",$(".step3_details2").css("display","none");else{var nextUrl=originalURL;nextUrl.length&&"#"==nextUrl.charAt(nextUrl.length-1)&&(nextUrl=nextUrl.substring(0,x.length-1)),window.location=nextUrl}}catch(err){obj={id:"Error",Error_Source:"Server",Error_Code:"Login",Error_Message:"Sign up Request Failed"},tealium_data2track.push(obj)}}else{var errMsg=data.errorMessage;"EXIST_IN_US"==errMsg?($(".examLogOnFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".examLogOnFailureResponseMessageDiv").append("<a target='_blank' href='"+MessageHelper.messages.RediectHomePageURL+"'>"+MessageHelper.messages.LenscrafterUS+"</a>?")):"EXIST_IN_CA"==errMsg?($(".examLogOnFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".examLogOnFailureResponseMessageDiv").append("<a target='_blank' href='"+MessageHelper.messages.RediectHomePageURL+"'>"+MessageHelper.messages.LenscrafterCA+"</a>?")):$(".examLogOnFailureResponseMessageDiv").html(errMsg),obj={id:"Error",Error_Source:"User",Error_Code:"Form Filling Error - Login",Error_Details:errMsg,Error_Message:errMsg},tealium_data2track.push(obj)}},error:function(jqXHR,textStatus,errorThrown){$(".examLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.")}})}return!1}function perksRegistrationFormSubmit(form){var f=$(form),receieveEmailCheck=!0,optin_18yrsCheck=!0;RegisterModelPWDfields(),utag_data.form_name="registration",utag_data.form_field=error_list;var optinEmail=!1;if(f.valid()){for(var data=f.serializeArray(),newData=[],i=0;i<data.length;i++){var d=data[i];"receiveEmail"==d.name&&"on"==d.value&&(d.value=!0,optinEmail=!0,receieveEmailCheck=!1,newData.push({name:"optinStatus",value:"1"})),"optin_18yrs"==d.name&&"on"==d.value&&(d.value=!0,optin_18yrsCheck=!1),d.name,"URL"==d.name?(d.value,newData.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):newData.push(d)}receieveEmailCheck&&(newData.push({name:"receiveEmail",value:!1}),newData.push({name:"optinStatus",value:"0"})),optin_18yrsCheck&&newData.push({name:"optin_18yrs",value:!1});$("#logonId_perkModel").val();$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationAddAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.success){var perkName=$("#perkLogonModalPerkName").val(),dataSidVar="";null!=$("#perkLogonDataSid").val()&&(dataSidVar=$("#perkLogonDataSid").val());var dataCidVar="";null!=$("#perkLogonDataCid").val()&&(dataCidVar=$("#perkLogonDataCid").val()),utagData={site_events:{registration_complete:!0,authentication_complete:!0,email_opt_in:optinEmail},authentication_status:"authenticated",registration_status:"registered",offer_code:[perkName.toLowerCase()],sid:dataSidVar,cid:dataCidVar},callTrackAnalytics(utagData),constants.ajaxParams.loggedIn=!0,void 0!==data.displayFLModal&&"true"==data.displayFLModal?displayPerkAttributeModal():displayThankYouModal();var url="RefreshHeaderView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&refreshHeader=true";$.ajax({url:getAbsoluteURL(!0)+url,dataType:"html",success:function(response){$("#header_links1").html(response)},error:function(jqXHR,textStatus,errorThrown){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}else $(".PerksRegFailureResponseMessageDiv").html(data.errorMessage)},error:function(jqXHR,textStatus,errorThrown){$(".PerksRegFailureResponseMessageDiv").html("Registration request failed - please try again later.")}})}return!1}function setupTooltips(){setTimeout((function(){$(".tooltip-link").each((function(){var $this=$(this),$tool=$this.prev(".tooltip"),top=$tool.height()-15,left=$tool.width()/2-20;$tool.css("left","-9999px").show(),$tool.css("top","-"+top+"px").css("left","-"+left+"px").hide(),$this.hover((function(){$tool.show()}),(function(){$tool.hide()}))}))}),100)}function registerFormSubmit(registerForm){$(".userRegModelForm").find("input[name=account]").val($(".logonId_regModel").val());var f=$(registerForm),receieveEmailCheck=!0,optinEmail=!1,optin_18yrsCheck=!0;if(utag_data.form_name="registration",utag_data.form_field=error_list,f.valid()){for(var data=f.serializeArray(),newData=[],originalURL=null,i=0;i<data.length;i++){var d=data[i];if("receiveEmail"==d.name&&"on"==d.value&&(d.value=!0,receieveEmailCheck=!1,optinEmail=!0,newData.push({name:"optinStatus",value:"1"})),"optin_18yrs"==d.name&&"on"==d.value&&(d.value=!0,optin_18yrsCheck=!1),d.name,f.hasClass("confirmationPage")&&("age"==d.name&&"on"==d.value&&(d.value=!0,d.name="optin_18yrs",optin_18yrsCheck=!1),"logonId"==d.name)){var logonIdVerifyV=d.value;newData.push({name:"logonIdVerify",value:logonIdVerifyV})}"URL"==d.name?(originalURL=d.value,newData.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):newData.push(d)}receieveEmailCheck&&(newData.push({name:"receiveEmail",value:!1}),newData.push({name:"optinStatus",value:"0"})),optin_18yrsCheck&&newData.push({name:"optin_18yrs",value:!1}),$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationAddAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.success){if(utagData={site_events:{registration_complete:!0,authentication_complete:!0,email_opt_in:optinEmail},authentication_status:"authenticated",registration_status:"registered"},callTrackAnalytics(utagData),utagViewSafe({sc_event:"event76"}),utagLinkSafe({link_name:"regComplete",customer_id:data.userId}),console.log("RegComplete Event Triggered Desktop - "+JSON.stringify(data)),f.hasClass("confirmationPage"))try{var obj={id:"WCS-D-CheckoutThankYou-NewAccount-Create",Click_FocusElement:this}}catch(err){obj={id:"WCS-D-CheckoutThankYou-NewAccount-Create-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-CheckoutThankYou-NewAccount-Create",tealium_data2track.push(obj)}$(".PurchaseSyncCheckLogin").is(":checked")?setTimeout((function(){window.location=$(".URL_AccountPersonalization_Dsk").val()}),300):setTimeout((function(){window.location=originalURL}),300),receieveEmailCheck||utagLinkSafe({link_name:"emailSubscribe"})}else $(".RegFailureResponseMessageDiv").html(data.errorMessage)},error:function(jqXHR,textStatus,errorThrown){$(".RegFailureResponseMessageDiv").html("Registration request failed - please try again later.")}})}return!1}function logonFormSubmitPerks(logonForm){var f=$(logonForm);if(utag_data.form_name="logon",utag_data.form_field=error_list,f.valid()){var data=f.serializeArray();newData=[],originalURL=null,myperksURL=null;for(var i=0;i<data.length;i++){var d=data[i];"URL"==d.name&&(originalURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})),"myPerksRedirectURL"==d.name?(myperksURL=d.value,newData.push({name:"URL",value:"LogonAjaxView"})):newData.push(d)}$("#perksheaderEmailAddress").val();$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.passwordExpired&&"1"==data.passwordExpired)$(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block"),obj={id:"Error",Error_Source:"User",Error_Code:"Login",Error_Message:"Your password has expired"},tealium_data2track.push(obj);else if(data.success){var perkName=$("#perkLogonModalPerkName").val(),dataSidVar="";null!=$("#perkLogonDataSid").val()&&(dataSidVar=$("#perkLogonDataSid").val());var dataCidVar="";null!=$("#perkLogonDataCid").val()&&(dataCidVar=$("#perkLogonDataCid").val()),utagData={site_events:{authentication_complete:!0},authentication_status:"authenticated",registration_status:"registered",offer_code:[perkName.toLowerCase()],sid:dataSidVar,cid:dataCidVar},callTrackAnalytics(utagData),constants.ajaxParams.loggedIn=!0,void 0!==data.displayFLModal&&data.displayFLModal&&"true"==data.displayFLModal?displayPerkAttributeModal():displayThankYouModal();var url="RefreshHeaderView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&refreshHeader=true";$.ajax({url:getAbsoluteURL(!0)+url,dataType:"html",success:function(response){$("#header_links1").html(response)},error:function(jqXHR,textStatus,errorThrown){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}});url="WishListCountView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:getAbsoluteURL(!0)+url,dataType:"html",success:function(response){var wishListFrameCount=parseInt($(response).find("#wishListFrameCount").val()),wishListLensCount=parseInt($(response).find("#wishListLensCount").val()),titleText=$(response).find("#wishListFrameTitle").val(),totalCount=wishListFrameCount+wishListLensCount;totalCount>0&&($("#wishListCountSection").find("#favorite_count").html(totalCount).removeClass("hide"),$("#wishListCountSection").find("a").attr("title",titleText))},error:function(jqXHR,textStatus,errorThrown){}})}else obj={id:"Error",Error_Source:"User",Error_Code:"Form Filling Error - Login",Error_Details:data.errorMessage,Error_Message:data.errorMessage},tealium_data2track.push(obj),$(".PerksLogOnFailureResponseMessageDiv").html(data.errorMessage).show()},error:function(jqXHR,textStatus,errorThrown){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}return!1}function displayThankYouModal(){var url="AjaxThankYouModalView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:getAbsoluteURL()+url,dataType:"html",success:function(response){$("#perksThankYouModal").dialog("destroy").remove(),$("#perksThankYouModalFiller").html(response),$("#perksThankYouModal").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615,open:function(){},close:function(){refreshNotifications()}}),resetRightNavWidget(),$(".header-account-signin").remove(),$("#perkLogonFormContent").dialog("close"),$(".perkContactModelDiv").dialog("close"),$("#perksThankYouModal").dialog("open")},error:function(jqXHR,textStatus,errorThrown){$(".LogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}function displayPerkAttributeModal(){var url="PerksAttributeModalView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&refreshHeader=true";$.ajax({url:getAbsoluteURL()+url,dataType:"html",success:function(response){resetRightNavWidget(),$(".header-account-signin").remove(),$(".perkContactModelDiv").dialog("destroy").remove(),$("#perkAttributesModalFiller").html(response),$(".perkContactModelDiv").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:615,open:function(){}}),$("#perkFLForm").submit((function(e){e.preventDefault();var data=$("#perkFLForm").serializeArray();newData=[],originalURL=null,myperksURL=null;for(var i=0;i<data.length;i++){var d=data[i];"URL"==d.name?(originalURL=d.value,newData.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):newData.push(d)}"true"===$("#isSubmitAJAX").val()&&$("#perkFLForm").valid()&&(e.preventDefault(),$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationUpdateAttributesAjax",data:newData,type:"POST",dataType:"json",success:function(data){var serviceResponse=data;"string"==typeof serviceResponse&&(serviceResponse=filterAjaxResponseCart(data)),serviceResponse.success?displayThankYouModal():$(".FirstNameLastNameResponseMessageDiv").html(serviceResponse.errorMessage)},error:function(jqXHR,textStatus,errorThrown){$(".FirstNameLastNameResponseMessageDiv").html("FirstName or LastName is incorrect - please try again later.").show()}}))})),$("#perkFLForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{firstName:{required:!0},lastName:{required:!0}},messages:{firstName:{required:MessageHelper.messages.ERROR_contactInfoModel_FirstNameEmpty},lastName:{required:MessageHelper.messages.ERROR_contactInfoModel_LastNameEmpty}}}),$("#flFormMyPerkName").val(perkName),$("#isSubmitAJAX").val("true"),$("#perkLogonFormContent").dialog("close"),$(".perkContactModelDiv").dialog("open")},error:function(jqXHR,textStatus,errorThrown){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}function registerFormSubmitPerks(registerForm){$(".userRegModelForm").find("input[name=account]").val($(".logonId_regModel").val());var f=$(registerForm),receieveEmailCheck=!0,optin_18yrsCheck=!0,optinEmail=!1;if(utag_data.form_name="registration",utag_data.form_field=error_list,f.valid()){for(var data=f.serializeArray(),newData=[],i=0;i<data.length;i++){var d=data[i];"receiveEmail"==d.name&&"on"==d.value&&(d.value=!0,receieveEmailCheck=!1,optinEmail=!0,newData.push({name:"optinStatus",value:"1"})),"optin_18yrs"==d.name&&"on"==d.value&&(d.value=!0,optin_18yrsCheck=!1),d.name,"URL"==d.name?(d.value,newData.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):newData.push(d)}receieveEmailCheck&&(newData.push({name:"receiveEmail",value:!1}),newData.push({name:"optinStatus",value:"0"})),optin_18yrsCheck&&newData.push({name:"optin_18yrs",value:!1}),$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationAddAjax",data:newData,type:"POST",dataType:"json",success:function(data){if(data.success){utagData={site_events:{registration_complete:!0,authentication_complete:!0,email_opt_in:optinEmail},authentication_status:"authenticated",registration_status:"registered"},callTrackAnalytics(utagData),constants.ajaxParams.loggedIn=!0;utagViewSafe({sc_event:"event76"}),utagLinkSafe({link_name:"regComplete",customer_id:data.userId}),console.log("RegComplete Event Triggered Desktop - "+JSON.stringify(data)),receieveEmailCheck||utagLinkSafe({link_name:"emailSubscribe"})}else $(".PerksRegFailureResponseMessageDiv").html(data.errorMessage)},error:function(jqXHR,textStatus,errorThrown){$(".PerksRegFailureResponseMessageDiv").html("Registration request failed - please try again later.")}})}return!1}function serializeParameters(form){var serialized=form.serializeArray(),params=[];for(index in serialized){var obj=serialized[index];params[obj.name]=obj.value}return params}function setupLabel(){$(".label_check input").length&&($(".label_check").each((function(){$(this).removeClass("on")})),$(".label_check input:checked").each((function(){$(this).parent("label").addClass("on")})))}$((function(){$(".phoneNumberOnly").on("keyup",(function(e){var $this=$(this);$this.val().match(/[^0-9-]/g)&&$this.val($this.val().replace(/[^0-9-]/g,"")),$this.val().match(/[0-9]{10}/)&&$this.val($this.val().match(new RegExp("[0-9]{4,6}$|[0-9]{3}","g")).join("-").substr(0,12))}))})),/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&sessionStorage&&(deserializeSessionStorage(),$(window).bind("unload",(function(){serializeSessionStorage()}))),function($){$.fn.ariaHide=function(){return this.hide().attr("aria-hidden","true"),this},$.fn.ariaShow=function(){return this.show().attr("aria-hidden","false"),this},$.validator.setDefaults({errorPlacement:function(error,element){$(error).attr("aria-live","rude").insertAfter(element)},invalidHandler:function(form,validator){validator.numberOfInvalids()&&validator.errorList[0].element.focus()}}),$.validator.addMethod("phoneValidation",(function(value,element){if(0==value.length){var required=$(this).closest(".row").children(":radio").is(":checked");return $(element).closest(".row").find("input:text").each((function(){required=required||$(this).val().length>0})),!required}return value.length==element.maxLength}),"Please enter a valid number"),$.validator.addMethod("postalFormatCheck",(function(value,element){var regexObj={canada:/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i,usa:/^\d{5}(-\d{4})?$/};return"CA"==$("#storeCountryName").val()?regexObj.canada.test(value):regexObj.usa.test(value)})),$.validator.addMethod("CCExp",(function(value,element,params){var minMonth=(new Date).getMonth()+1,minYear=(new Date).getFullYear(),month=parseInt($(params.month).val(),10),year=parseInt($(params.year).val(),10);return year>minYear||year===minYear&&month>=minMonth})),$.validator.addMethod("contactQuantity",(function(value,element,params){return parseInt($(params.left).val(),10)+parseInt($(params.right).val(),10)>0})),$.validator.addMethod("lettersonly",(function(value,element){return this.optional(element)||/^[a-z]+$/i.test(value)}),"Letters only please"),$.validator.addMethod("specialCharacters",(function(value){var userInput=value,valid=!1;return-1==userInput.indexOf("!")&&-1==userInput.indexOf("#")&&(valid=!0),valid}),"* invalid"),$.validator.addMethod("atLeastOneLetterAndOneDigit",(function(value,element){return/^(?=.*[0-9])(?=.*[a-zA-Z])(.*)$/.test(value)})),$.validator.addMethod("atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial",(function(value,element){return/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[ `!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~])(.*)$/.test(value)})),$.validator.addMethod("zipCode",(function(value,element){var valid=!1,checkRegex=!0,form=$(element).closest("form").attr("id");if($(".drop_down_country")&&"IE"==$("#"+form+" .drop_down_country").val()&&(checkRegex=!1,valid=!0,$("#zipCode").removeClass("required").next(".required").remove(),$("#zipCode1").removeClass("required").next(".required").remove(),""==$("#zipCode").val()?$("#zipCode").attr("name","zip"):$("#zipCode").attr("name","zipCode"),""==$("#zipCode1").val()?$("#zipCode1").attr("name","zip"):$("#zipCode1").attr("name","zipCode")),checkRegex){var userInput=value;if(null==zipRegex){regexp=new RegExp(/^\d{5}(-\d{4})?$/),regexp.test(userInput)&&(valid=!0)}else regexp=new RegExp(zipRegex),valid=!!regexp.test(userInput)}return valid}),"* invalid"),$.validator.addMethod("date",(function(value,element){var form=$(element).parents("form"),day=form.find(".validate-day").val(),month=form.find(".validate-month").val(),year=form.find(".validate-year").val();return!(0!=year||0!=day||0!=month)||isValidDate(year,month,day)}),"* invalid"),$.validator.addMethod("age",(function(value,element){var form=$(element).parents("form"),day=form.find(".validate-day").val(),month=form.find(".validate-month").val(),year=form.find(".validate-year").val();return!(0!=year||0!=day||0!=month)||MyAccountDisplayExtJS.validateAge(new Date(year,month-1,day))}),"* invalid"),$.validator.addMethod("phoneNumber",(function(value){var val=value;return regexp=new RegExp(phoneNumberRegex),!(!regexp.test(val)&&0!=$.trim(value).length)}),"* Invalid"),"US"==$("#storeCountryName").val()?$.validator.messages.postalFormatCheck="Please enter a valid ZIP code":$.validator.messages.postalFormatCheck="Please enter a valid postal code",$.validator.addMethod("dotPos_formatCheck",(function(value){return value.length-(value.lastIndexOf(".")+1)>=2}),MessageHelper.messages.ERROR_EmailEmpty)}(jQuery);var firstLoad=!1;function pagerFactory(idx,slide){return"<li"+(idx>4?' style="display:none"':"")+'><a href="#">'+(idx+1)+"</a></li>"}function performGeocode(location,callbackName){if(location&&location.length&&callbackName&&callbackName.length)try{(new google.maps.Geocoder).geocode({address:location},callbackName)}catch(e){console.warn("global.js - performGeocode(): google.maps.Geocoder is undefined")}}function enableAllSections(){$(".brands-list li a").removeClass("link-disabled-sort").addClass("link-enabled-sort")}function disableSection(){var link=$(".brands-list li a");$(link).removeClass("link-enabled-sort").addClass("link-disabled-sort")}function isCorrectDate(month,day,year){try{var date=month+"/"+day+"/"+year;$.datepicker.parseDate("mm/dd/yy",date),valid=!0}catch(exc){utag_data.form_field="invalid date",valid=!1}return valid}function validateAge(dobForm,month,day,year){var overEightteen=!1,yearDifference=year-dobForm.birth_year.value;return(yearDifference>18||18==yearDifference&&(dobForm.birth_month.value<month||dobForm.birth_month.value==month&&dobForm.birth_date.value<=day))&&(overEightteen=!0),validateAge||error_list.push("not 18"),overEightteen}function dashbordStepOneFormSubmitValidation(){$("form#dashboard-step1").validate({onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{firstName:{required:!0}},messages:{firstName:{required:"Please enter a first name"}}})}function dashbordStepTwoFormSubmitValidation(){$("form#dashboard-step2").validate({onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{lastName:{required:!0}},messages:{lastName:{required:"Please enter a last name"}}})}function dashbordStepThreeFormSubmitValidation(){$("form#dashboard-step3").validate({onfocusout:!1,ignore:"",onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{phone1_1:{required:!0,minlength:3},phone1_2:{required:!0,minlength:3},phone1_3:{required:!0,minlength:4}},messages:{phone1_1:{required:"Please enter a mobile phone number",minlength:"Please enter a valid phone number"},phone1_2:{required:"Please enter a mobile phone number",minlength:"Please enter a valid phone number"},phone1_3:{required:"Please enter a mobile phone number",minlength:"Please enter a valid phone number"}},errorPlacement:function(error,element){for(var noErrorElements=[],found=!1,i=0;i<noErrorElements.length;i++)found=found||noErrorElements[i]==element.attr("name");found||(-1!=$(element).attr("name").indexOf("phone")?element.parent().append(error).addClass("validationError"):$(error).addClass("validationError").insertAfter(element)),error_list.push(error.text())},showErrors:function(errorMap,errorList){if(this.defaultShowErrors(),$(".dashboard-phone span.required:visible").filter((function(i){return 0!=i})).hide(),errorList&&errorList.length){var lowestOffset=Number.MAX_VALUE;$("form#dashboard-step3").find(".validationError:visible, span.required:visible").parent("div:first").each((function(){var $this=$(this),top=$this.offset().top;top<lowestOffset&&(lowestOffset=top,$this)}))}},highlight:function(element,errorClass){$(element).addClass("required")},unhighlight:function(element,errorClass){$(element).removeClass("required")}}),$("form#dashboard-step3").each((function(){var $this=$(this);setupPhoneFields($this.find("input[name=phone1_1]"),$this.find("input[name=phone1_2]"),$this.find("input[name=phone1_3]"))})),$("input[name=phone1_1]").keyup((function(){$(this).val(this.value.substring(0,3))})),$("input[name=phone1_2]").keyup((function(){$(this).val(this.value.substring(0,3))})),$("input[name=phone1_3]").keyup((function(){$(this).val(this.value.substring(0,4))})),$("#dashboard-step3 #phone-check").change((function(){$("#dashboard-step3 #receiveMobile").val($(this).prop("checked"))}))}function dashbordStepFourFormSubmitValidation(){$("form#dashboard-step4").validate({ignore:"",onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",errorLabelContainer:$("#dashboard-step4 .dashboard-DateOfBirth"),rules:{dobMonth_1:{required:!0},dobDay_1:{required:!0},dobYear_1:{required:!0,check_date_of_birth_future:!0,check_date_of_birth:!0}},messages:{dobMonth_1:{required:"Please enter a valid birthday"},dobDay_1:{required:"Please enter a valid birthday"},dobYear_1:{required:"Please enter a valid birthday",check_date_of_birth_future:"You must be at least 18 years old to view eye exam information.",check_date_of_birth:"You must be at least 18 years old to view eye exam information."}},showErrors:function(errorMap,errorList){this.defaultShowErrors(),$(".select-date-of-birth span.required:visible").filter((function(i){return 0!=i})).hide()},highlight:function(element,errorClass){$(element).parents(".select-date-of-birth").addClass("required")},submitHandler:function(form){$(element).parents(".select-date-of-birth").removeClass("required"),form.submit()}})}function dashbordStepFiveFormSubmitValidation(){$("form#dashboard-step5").validate({onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{receiptNumber:{required:!0,maxlength:9}},messages:{receiptNumber:{required:MessageHelper.messages["Please enter a receipt number"]}}})}function showLogonModal(){if(hideSaveFavorites(),$(".header-register-modal").css("display","none").attr("aria-hidden","true"),$(".header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".header-update-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".background-update-reset").css("display","none"),$(".header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$(".header-sign-in-modal").css("display","block").attr("aria-hidden","false"),$(".headerEmailAddress").focus(),$(".notification-count").removeClass("active"),$(".sign-in-link").addClass("open"),window.scrollTo(0,0),$(".headerEmailAddress").focus(),clearResetPwdErrorMessages(),clearResetForgotPWDErrors(),clearRegErrorMessages(),void 0!==$.getUrlVar("resetPassword")&&"true"==$.getUrlVar("resetPassword")){$(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").css("display","block").attr("aria-hidden","false"),$(".header-reset-password-modal").css("display","none").attr("aria-hidden","true");var email="";return void 0!==$.getUrlVar("emailId")&&(email=$.getUrlVar("emailId"),document.getElementsByClassName("WC_PasswordUpdateForm_FormInput_EmailAddress").value=email),!0}return!1}function clearLoginErrorMessages(){$(".LogOnFailureResponseMessageDiv").empty(),$(".header-sign-in-modal span.required ").not(".LogOnFailureResponseMessageDiv").remove()}function clearLoginPerkErrorMessages(){$(".PerksLogOnFailureResponseMessageDiv").empty(),$("#perk-logon-modal span.required ").not(".PerksLogOnFailureResponseMessageDiv").remove()}function clearRegErrorMessages(){$(".RegFailureResponseMessageDiv").empty(),$(".header-register-modal span.required ").not(".RegFailureResponseMessageDiv").remove()}function clearRegPerkErrorMessages(){$(".PerksRegFailureResponseMessageDiv").empty(),$("#perk-register-modal span.required ").not(".PerksRegFailureResponseMessageDiv").remove()}function clearLoginFields(){$(".headerEmailAddress").val(""),$(".header-logonPassword").val("")}function clearRegInputFields(){$(".logonId_regModel").val(""),$(".logonIdVerify").val(""),$(".logonPassword_regModel").val(""),$(".logonPasswordVerify_regModal").val("")}function clearResetPwdErrorMessages(){document.getElementsByClassName("WC_PasswordResetForm_FormInput_logonId_In_ResetPasswordForm_1")[0].value="",$(".ResetPasswordFailureResponseMessageDiv").empty(),$(".header-reset-password-modal span.required").not(".ResetPasswordFailureResponseMessageDiv").remove()}function clearResetForgotPWDErrors(){$(".WC_PasswordUpdateForm_FormInput_logonPasswordOld_In_Logon_1").val(""),$(".logonPassword_updateModel").val(""),$(".WC_PasswordUpdateForm_FormInput_logonPasswordVerify_In_Logon_1").val(""),$(".PasswordUpdateFailureResponseMessageDiv").empty(),$(".header-set-a-new-password-modal span.required").not(".ResetPasswordFailureResponseMessageDiv").remove(),$(".logonPassword_updateModel,.WC_PasswordUpdateForm_FormInput_logonPasswordVerify_In_Logon_1,.WC_PasswordUpdateForm_FormInput_logonPasswordOld_In_Logon_1,.WC_PasswordUpdateForm_FormInput_EmailAddress").addClass("resetHighlight")}$.browser.msie&&"8.0"==$.browser.version?$("html").addClass("dj_ie dj_ie8 overflow-hidden"):$.browser.msie&&"9.0"==$.browser.version?$("html").addClass("dj_ie dj_ie9"):$.browser.msie&&"10.0"==$.browser.version?$("html").addClass("dj_ie dj_ie10"):$.browser.webkit&&$("html").addClass("dj_chrome"),$(document).ready((function(){geoLocationSchedule(),refreshNotifications(),catalogScroll(),recoLinkClick(),initTopNavigationLinkHandlers(),switchImageViews(),checkStepFourSync(),stepFourManageExam(),storeStep3session(),dashbordStepOneFormSubmitValidation(),dashbordStepTwoFormSubmitValidation(),dashbordStepThreeFormSubmitValidation(),dashbordStepFourFormSubmitValidation(),dashbordStepFiveFormSubmitValidation(),$("#bazaar_voice_review_summary_wrapper").show(),$.validator.addMethod("check_date_of_birth",(function(value,element){var day=$("#dobDay_1").val(),month=$("#dobMonth_1").val(),year=$("#dobYear_1").val(),mydate=new Date;mydate.setFullYear(year,month-1,day-1);var currdate=new Date;return currdate.setFullYear(currdate.getFullYear()-18),currdate>mydate}),"You must be 18 years old to view eye exam information"),$.validator.addMethod("check_date_of_birth_future",(function(value,element){var day=$("#dobDay_1").val(),month=$("#dobMonth_1").val(),year=$("#dobYear_1").val(),mydate=new Date;return mydate.setFullYear(year,month-1,day-1),new Date>mydate}),"The provided birthday is invalid"),$("form#accountPersonalizationForm #phone1Type_1").on("change",(function(e){e.preventDefault(),checkMobile(".phoneNumeber")?$(".smsAgreement").is(":visible")||$(".smsAgreement").show():($('input[name="offersCheckbox"]').attr("checked",!1),$(".smsAgreement").hide(),$(".phoneNumeber span.required:visible").hide())})),$("#perk-register-modal").css("display","none"),$("#perk-logon-modal").css("display","block");var PerkOfferName=$.cookie("lcOfferName")||"",cookieToDelete=$("#lcCookieToDelete").val()||"";function profileSubscribeFormSubmit(profileForm,isSubscribed,checkboxVal){if($(profileForm).valid()){var subscriptionForm=document.EmailSusbscriptionForm;"true"==isSubscribed&&"email"==checkboxVal&&subscriptionForm.recieveEmail_CheckBox.checked&&($(".checkBoxareaEmail").hide(),$(".checkBoxSubscribedareaEmail").show()),"false"==isSubscribed&&"email"==checkboxVal&&($(".checkBoxSubscribedareaEmail").hide(),$(".checkBoxareaEmail").show(),subscriptionForm.recieveEmail_CheckBox.checked=!1),"true"==isSubscribed&&"phone"==checkboxVal&&subscriptionForm.receiveMobile_CheckBox.checked&&($(".checkBoxareaPhone").hide(),$(".checkBoxSubscribedareaPhone").show()),"false"==isSubscribed&&"phone"==checkboxVal&&($(".checkBoxSubscribedareaPhone").hide(),$(".checkBoxareaPhone").show(),subscriptionForm.receiveMobile_CheckBox.checked=!1)}return!1}if(""!==PerkOfferName&&($(".perks-wrapper").first().addClass("recentlyAdded"),$(".recentlyAdded").prepend("<p class='selectedPerk'><span></span>Just Added</p>"),"true"===cookieToDelete&&""!=cookieToDelete&&(document.cookie="lcOfferName=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;")),$(".c-tabs").basicTabs(),$("#sync_PurchaseEye").is(":checked")?$("#CreateAccountURL").val($("#personalizationURL").val()):$("#CreateAccountURL").val($("#CreateAccountURL").val()),$("#subscribeContainer").on("change",".subscribeUserData",(function(){var isSubscribed=$(this).attr("data-subscribe"),subscribeType=$(this).attr("data-subtype");return profileSubscribeFormSubmit($(this).parents("form"),isSubscribed,subscribeType),!1})),$(document).on("change","input[name='prescrNeed']",(function(number){var indexProduct=parseInt($(this).attr("data-index"))-1,orderItemId=$(this).attr("data-orderitemid"),isDoctor=$(this).is(":checked"),params={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,orderItemId:orderItemId,prescriptionNeed:isDoctor};return $.ajax({type:"POST",url:getAbsoluteURL()+"AjaxOrderChangeServicePrescriptionUpdateLC",traditional:!0,data:params,success:function(data,textStatus,jqXHR){if(isDoctor&&null!=_dl.products_in_cart&&_dl.products_in_cart.length>indexProduct){var _dlCopy=$.extend(!0,{},_dl);_dlCopy.site_events={prescription_needed_click:"true"},_dlCopy.product_updated=[_dl.products_in_cart[indexProduct]],callTrackAnalytics(_dlCopy)}var params=[];params.storeId=constants.ajaxParams.storeId,params.catalogId=constants.ajaxParams.catalogId,params.langId=constants.ajaxParams.langId,params.URL="",params.updatePrices="1",params.orderId=constants.ajaxParams.orderId,params.calculationUsageId="-1",wc.service.invoke("AjaxOrderCalculate",params)}}),!1})),$("#subscribeContainer").on("click",".subscribeUserLink",(function(){var isSubscribed=$(this).attr("data-subscribe"),subscribeType=$(this).attr("data-subtype"),dataType=$(this).data("subtype");if(profileSubscribeFormSubmit($(this).parents("form"),isSubscribed,subscribeType),"email"==dataType){var email=$(this).siblings(".pref-email").text().toLowerCase(),trimmedLowerMail="";email&&(trimmedLowerMail=email.trim().toLowerCase());try{var obj={id:"WCS-D-Unsubscribe",User_Email_MD5:MD5(email),User_Email_SHA256:sha256(trimmedLowerMail)}}catch(err){obj={id:"WCS-D-Unsubscribe-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-Unsubscribe",obj.User_Email_MD5=MD5(email),obj.User_Email_SHA256=sha256(trimmedLowerMail),tealium_data2track.push(obj)}}return!1})),$("#sync_PurchaseEye").on("change",(function(){return $(this).is(":checked")?$("#CreateAccountURL").val($("#personalizationURL").val()):$("#CreateAccountURL").val($("#CreateAccountURL").val()),!1})),$("#subscribeContainer").on("click",".subscribeUserLink",(function(){var isSubscribed=$(this).attr("data-subscribe"),subscribeType=$(this).attr("data-subtype");return profileSubscribeFormSubmit($(this).parents("form"),isSubscribed,subscribeType),!1})),$("a",".facet-options .main").on("touchstart",(function(){var $href=$(this).attr("href");return""!=$href&&null!=$href&&(document.location.href=$href),!1})),navigator.userAgent.indexOf("Mobile")>-1&&($("html").addClass("ios"),setTimeout((function(){$(".button").not(".go, .hp_hero_container .button").attr("style","")}),1e3)),$("#SimpleSearchForm_SearchTerm").addClass("blur"),window.member)var addedAllRec=window.member.isAddedAllRecomm;if(window.user)var usrType=window.user.userType;if("G"==usrType){"Yes"==$.cookie("isAddedtoAccount")&&$("#right-nav-header").append('<div id="fyl_added" class="fyl_added"></div>')}else"R"==usrType&&("Y"==addedAllRec?$("#fyl_added").show():$("#fyl_added").hide());if((navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))&&($("a.blue.button, .blue.button").css({background:"#6eabce",paddingTop:"3px",paddingBottom:"3px",paddingLeft:"5px",paddingRight:"5px","border-radius":"4px 4px 4px 4px"}),$("a.blue.button.schedule-exam-store").css({background:"#6eabce"}),$(".submit-blue, .submit").css({color:"#6eabce"})),$(".column.below .last").blur((function(){$(".oo_feedback_float").length>0&&$(".oo_feedback_float").focus()})),$(document).keydown((function(e){if(32==e.keyCode&&$("a").is(":focus")){var $this=$("a:focus");$this.data("events")&&$this.data("events").click?$this.click():document.location.href=$this.attr("href"),e.preventDefault()}})),hideAllDialogs(),enableNavFocus(),$(".dialog").attr("aria-hidden","true"),$(".ui-dialog").attr("aria-hidden","true"),$(".footer_email_signup").addClass("blur"),$(".footer_email_signup").focus((function(){$(this).removeClass("blur"),"Enter your email address"==$(this).val()&&$(this).val("")})),$(".footer_email_signup").blur((function(){$(this).addClass("blur"),""==$(this).val()&&$(this).val("Enter your email address")})),$(".top-level li a").on("touchstart",(function(e){if(~navigator.userAgent.indexOf("iPad"))return window.location=$(this).prop("href"),!1})),$("#header_links").on("mouseenter",".top-level",(function(){if($(".subnav").hide(),$(".subnav-arrow").hide(),$(this).children("a").css("color","#326fa8"),$(this).children(".subnav").stop(!0,!0).fadeIn(300).css("display","flex"),$(this).children(".subnav-arrow").stop(!0,!0).fadeIn(300),!$(this).hasClass("exam")&&!$(this).hasClass("eyeglasses")&&!$(this).hasClass("savings")){var offsetLeft=$(this).offset().left,offsetLeftEyeglasses=$(".top-level.eyeglasses").offset().left;$(this).children(".subnav").css("transform","translateX(-"+(parseInt(offsetLeft)-parseInt(offsetLeftEyeglasses)+17)+"px)")}})).on("mouseleave",".top-level",(function(){$(this).children("a").css("color","#5a5a5a"),$(".subnav").hide(),$(".subnav-arrow").hide()})),$(document).on("click","button.tablinks",(function(e){e.preventDefault(),$(".tabcontent").each((function(){$(this).hide()})),$(".tablinks").each((function(){$(this).removeClass("active")}));var tab=$(this).data("click");$(this).addClass("active"),$("#"+tab).css("display","flex")})),$("a.search-start").on("click touchmove",(function(e){$("#SimpleSearchForm_SearchTerm").focus()})),$(".top-level").is(":visible")||$(".header-shield-content").is(":visible")||$(".subnav-search").not(":hidden")){var containerSearch=$(".header-search"),searchNav=$(".subnav-search"),inputSearch=$("#SimpleSearchForm_SearchTerm");$(document).bind("touchstart",(function(e){var containerTop=$(".top-level"),containerShield=$("#header_shield");containerTop.is(e.target)||0!==containerTop.has(e.target).length||(containerTop.children(".subnav").hide(),containerTop.children(".subnav-arrow").hide()),containerTop.is(e.target)&&0===!containerTop.has(e.target).length&&(containerTop.children(".subnav").show(),containerTop.children(".subnav-arrow").show()),containerShield.is(e.target)||0!==containerShield.has(e.target).length||containerShield.children("div").hide(),containerShield.is(e.target)&&0===!containerShield.has(e.target).length&&containerShield.children("div").show()})),$(document).bind("click",(function(e){containerSearch.is(e.target)||inputSearch.is(e.target)||searchNav.is(e.target)||$(".subnav-search").hide()}))}function profileFormSubmit(profileForm){var pf=$(profileForm);if(pf.valid()){var formID=pf.attr("id");if("dashboard-step3"==formID){var phone1=pf.find("input[name=phone1_1]").val()+pf.find("input[name=phone1_2]").val()+pf.find("input[name=phone1_3]").val();pf.find("input[name=phone1]").val(phone1)}if("dashboard-step4"==formID){var month_val=$("#dobMonth_1").val(),day_val=$("#dobDay_1").val();month_val<10&&(month_val="0"+month_val),day_val<10&&(day_val="0"+day_val);var DOB_format=$("#dobYear_1").val()+"-"+month_val+"-"+day_val;pf.find("input[name=dateOfBirth]").val(DOB_format)}if("dashboard-step5"==formID){var receiptNumber=pf.find("input[name=receiptNumber]").val();pf.find("input[id=receiptNumberVal]").val(receiptNumber)}$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:pf.serializeArray(),dataType:"html",crossDomain:!0,success:function(data){(data=filterAjaxResponseCart(data)).success?function(formID){var url="myDashboardProfileView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&userId="+constants.ajaxParams.userId+"&updateId="+formID;$.ajax({url:getAbsoluteURL(!0)+url,dataType:"html",success:function(response){$("#profile-data").html(response)}})}(formID):"dashboard-step3"==formID&&"_WEB_SERVICE_GENERIC"==data.errorMessageKey?$("#dashboard-step3 .dashboard-phone").addClass("validationError").append('<span class="required backendError">'+MessageHelper.messages.ERROR_VALID_PHONENUMBER+"</span>"):$(".PasswordUpdateFailureResponseMessageDiv").html(data.errorMessage)},error:function(jqXHR,textStatus,errorThrown){$(".PasswordUpdateFailureResponseMessageDiv").html("Update failed - please try again later.")}})}return!1}if($(".headerLogout").on("click",(function(){removeExamCookies(),$.cookie("WC_PERSISTENT","",{expires:-1,path:"/"})})),$("input").not(":submit, :button, :hidden, .no-replace").each((function(){var $this=$(this),defaultValue=$this.val();$this.addClass("blur"),$this.hasClass("no-focus-clear")||($this.focus((function(){$this.val()==defaultValue&&$this.val("").removeClass("blur")})),$this.blur((function(){""==$this.val()&&$this.val(defaultValue).addClass("blur")})))})),$("li.sort-brands a").each((function(){null==navigator.userAgent.match(/iPad/i)?$(this).on("click",(function(event){$("li.sort-brands a").removeClass("sorted-by"),$(this).addClass("sorted-by"),event.preventDefault();var $id=$(this).attr("id");"sort-all"==$id?enableAllSections():(disableSection(),$(".brands-list").find("a."+$id).removeClass("link-disabled-sort").addClass("link-enabled-sort"))})):$(this).on("touchend",(function(event){$("li.sort-brands a").removeClass("sorted-by"),$(this).addClass("sorted-by"),event.preventDefault();var $id=$(this).attr("id");"sort-all"==$id?enableAllSections():(disableSection(),$(".brands-list").find("a."+$id).removeClass("link-disabled-sort").addClass("link-enabled-sort"))}))})),$(".brands-list li a.link-disabled-for-facet-result").each((function(){$(this).click((function(event){event.preventDefault()}))})),$.validator&&(jQuery.validator.addMethod("zip",(function(value,element){var trimmedValue=$.trim(value);return trimmedValue.match(constants.regex.zip.usa)||trimmedValue.match(constants.regex.zip.canada)}),MessageHelper.messages.ERROR_ZipCodeEmpty),jQuery.validator.addMethod("caZip",(function(value,element){return"10852"==constants.ajaxParams.storeId||(!!$.trim(value).match(constants.regex.zip.usa)||(utag_data.form_field="ZIP Code",!1))}),MessageHelper.messages.STORE_FINDER_ZIP_COUNTRY_MISMATCH),jQuery.validator.addMethod("pattern",(function(e,t,n){return!(!this.optional(t)&&"[0-9]*"!=n)||("string"==typeof n&&(n=new RegExp("^(?:"+n+")$")),n.test(e))}),"Invalid format.")),$("body").on("click touchstart",".ui-widget-overlay",(function(){$("#ContactUsChatOverLay:visible").parents(".ui-dialog:visible").length>0||$(".showWaitModalContainer").parents(".ui-dialog:visible").length>0||$(".ui-dialog-content").dialog("close")})),$(".close-dialog").click((function(){return $(".ui-dialog-content").dialog("close"),!1})),$(document.body).on("click",".dashboard-skip",(function(){$(this).parents("form");!function(skipId){var url="myDashboardProfileView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&userId="+constants.ajaxParams.userId+"&skipId="+skipId;$.ajax({url:getAbsoluteURL(!0)+url,dataType:"html",success:function(response){$("#profile-data").html(response)}})}($(this).parents("form").attr("id"))})),$(document.body).on("click",".dashboard-update",(function(){return profileFormSubmit($(this).parents("form")),!1})),$(document).ready((function(){$("form#dashboard-step3, form#accountPersonalizationForm").each((function(){var $this=$(this);setupPhoneFields($this.find("input[name=phone1_1]"),$this.find("input[name=phone1_2]"),$this.find("input[name=phone1_3]"))})),$("input[name=phone1_1]").keyup((function(){$(this).val(this.value.substring(0,3))})),$("input[name=phone1_2]").keyup((function(){$(this).val(this.value.substring(0,3))})),$("input[name=phone1_3]").keyup((function(){$(this).val(this.value.substring(0,4))})),$(document.body).on("click","#header_shield_link",(function(){var _dlCopy=$.extend(!0,{},_dl);_dlCopy.site_events={insurance_shield_click:"true"},callTrackAnalytics(_dlCopy),$("#InsuranceStepsDiv [tabindex='-1']").attr("tabindex","0")}))})),$("#addEyeExamDetails").click((function(e){e.preventDefault();var f=$(this).parents("form"),$form=$("#addEyeExamSubmitForm"),phone1="("+$form.find("input[name=phone1_1]").val()+")"+$form.find("input[name=phone1_2]").val()+"-"+$form.find("input[name=phone1_3]").val();$form.find("input[name=phone1]").val(phone1);var month_val=$form.find("#dobMonth_1").val(),day_val=$form.find("#dobDay_1").val();month_val<10&&(month_val="0"+month_val),day_val<10&&(day_val="0"+day_val);var DOB_format=month_val+"/"+day_val+"/"+$form.find("#dobYear_1").val();$form.find("input[name=dob]").val(DOB_format);var pf,showWaitModal,eyeExamDelayTimeMs;f.serializeArray();f.valid()&&((pf=$($form)).serializeArray(),showWaitModal=$(".showWaitModalForAddExam").val()||"",eyeExamDelayTimeMs=$("#eyeExamDelayTimeMs").val()||"",$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:pf.serializeArray(),dataType:"json",crossDomain:!0,success:function(data){console.log(eyeExamDelayTimeMs),"true"===showWaitModal&&""!==showWaitModal&&0==$("#reSyncUser").length?($(".showWaitModalContainer").dialog("open"),setTimeout((function(){$.ajax({url:getAbsoluteURL(!0)+"LCAjaxEyeExamHistorySyncCmd",data:pf.serializeArray(),dataType:"json",crossDomain:!0,success:function(data){window.location.href=$("#EyeExamHistoryURL").val()}})}),eyeExamDelayTimeMs)):$.ajax({url:getAbsoluteURL(!0)+"LCAjaxEyeExamHistorySyncCmd",data:pf.serializeArray(),dataType:"json",crossDomain:!0,success:function(data){window.location.href=$("#EyeExamHistoryURL").val()}})},error:function(jqXHR,textStatus,errorThrown){console.log("error is -"+errorThrown)}}))})),$(".unSyncContinue").on("click",(function(){var formData=$("#UnsyncppointmentForm").serializeArray();$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:formData,dataType:"json",crossDomain:!0,success:function(data){data.success&&(window.location.href=$("#addEyeExamURL").val())}})})),$("#ViewmoreEyeExams").on("click",(function(e){var hideDivCount=$(".appointmentHeader .hideEyeExam").length;pastExamCount<=hideDivCount&&$(".viewMoreExams").css("display","none");$(".pastExams .Row").length;if($(".pastExams .Row.hideEyeExam").length)$(".pastExams .Row.hideEyeExam:lt(4)").removeClass("hideEyeExam").addClass("showEyeExam");var showDivCount=$(".appointmentHeader .showEyeExam").length;pastExamCount<=showDivCount&&$(".viewMoreExams").css("display","none")})),$(".unsyncEyeExmas").on("click",(function(e){$(".unsyncContainer").dialog("open")})),$(".cancelExam[data-appointment-id]").on("click",(function(e){var country="us",userAuthenticated="not authenticated",userRegistration="not registered",isFuture=$(this).attr("is-future")||"";"CA"==constants.ajaxParams.countryName&&(country="ca"),constants.ajaxParams.loggedIn&&(userAuthenticated="authenticated",userRegistration="registered"),data="true"!=isFuture?{site_events:{cancel_eye_exam:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration}:{site_events:{cancel_future_exam:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration};try{var obj={id:"WCS-D-Exam-Funnel-Cancellation"}}catch(err){obj={id:"WCS-D-Exam-Funnel-Cancellation-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-Exam-Funnel-Cancellation",tealium_data2track.push(obj)}callTrackAnalytics(data),$("#cancelAppointmentHistroyForm").find(".cancelAppointmentId").val($(this).attr("data-appointment-id")),$(".canceleyeExamContainer").dialog("open"),$("#header_cancel_eyeexam").focus()})),$(".closeEyeExamModel").on("click",(function(e){$(".canceleyeExamContainer").is(":visible")?$(".canceleyeExamContainer").dialog("close"):$(".unsyncContainer").is(":visible")&&$(".unsyncContainer").dialog("close")})),$.validator.addMethod("validPhoneCheck",(function(value,element){var phoneVal=!0;if($("input[name=phone1_1]").length>0){var phoneLength;(phoneLength=$("input[name=phone1_1]").val().length+$("input[name=phone1_2]").val().length+$("input[name=phone1_3]").val().length)>0&&phoneLength<10&&(phoneVal=!1)}return phoneVal}),MessageHelper.messages.PHONE_FIELDS_ERROR),$.validator.addMethod("validDOB",(function(value,element){var month=$("#dobMonth_1").val(),day=$("#dobDay_1").val(),year=$("#dobYear_1").val();if(""!=year&&""!=month&&""!=day&&new Date(year,month,day)>new Date)return!1;return!0}),MessageHelper.messages.BDAY_FIELDS_INVALID),$.validator.addMethod("validLeapYear",(function(value,element){var month=$("#dobMonth_1").val(),day=$("#dobDay_1").val(),year=$("#dobYear_1").val(),date=new Date(year,month-1,day);return""==year||""==month||""==day||date.getFullYear()==year&&date.getMonth()+1==month&&date.getDate()==day}),MessageHelper.messages.BDAY_FIELDS_INVALID),$("form#addEyeExamSubmitForm").each((function(){var $thisEyeExam=$(this);setupPhoneFields($thisEyeExam.find("input[name=phone1_1]"),$thisEyeExam.find("input[name=phone1_2]"),$thisEyeExam.find("input[name=phone1_3]"))})),$("input[name=phone1_1]").keyup((function(){$(this).val(this.value.substring(0,3))})),$("input[name=phone1_2]").keyup((function(){$(this).val(this.value.substring(0,3))})),$("input[name=phone1_3]").keyup((function(){$(this).val(this.value.substring(0,4))})),$("input[name=phone1_1], input[name=phone1_2], input[name=phone1_3]").bind("focusout",(function(){return!1})),$("#addEyeExamSubmitForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{firstName:{required:!0},lastName:{required:!0},dobMonth:{validDOB:!0,validLeapYear:!0,required:!0},dobDay:{validDOB:!0,validLeapYear:!0,required:!0},dobYear:{validDOB:!0,validLeapYear:!0,required:!0},phone1_1:{validPhoneCheck:!0,required:!0,minlength:3},phone1_2:{validPhoneCheck:!0,required:!0,minlength:3},phone1_3:{validPhoneCheck:!0,required:!0,minlength:4},consentCheckbox:{required:!0}},messages:{firstName:MessageHelper.messages.ERROR_FIELD_REQ,lastName:MessageHelper.messages.ERROR_FIELD_REQ,dobMonth:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dobDay:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dobYear:{required:MessageHelper.messages.BDAY_FIELDS_REQ},phone1_1:{required:MessageHelper.messages.ERROR_FIELD_REQ},phone1_2:{required:MessageHelper.messages.ERROR_FIELD_REQ},phone1_3:{required:MessageHelper.messages.ERROR_FIELD_REQ},consentCheckbox:MessageHelper.messages.ERROR_CONSENT_CHECKBOX},errorPlacement:function(error,element){for(var noErrorElements=[],found=!1,i=0;i<noErrorElements.length;i++)found=found||noErrorElements[i]==element.attr("name");found||("consentCheckbox"==$(element).attr("name")?$(error).css({float:"none",display:"block"}).insertAfter($(element).next()):-1!=$(element).attr("name").indexOf("dob")||-1!=$(element).attr("name").indexOf("phone")?element.parent().append(error).addClass("validationError"):$(error).addClass("validationError").insertAfter(element)),error_list.push(error.text());var spans=$(".addMyExams .fe-row span.required");for(i=0;i<spans.length;i++)spans[i].setAttribute("aria-label",spans[i].innerText)},showErrors:function(errorMap,errorList){if(this.defaultShowErrors(),$(".phoneDetails span.required:visible").each((function(i,obj){$(this).text()==MessageHelper.messages.PHONE_FIELDS_ERROR&&$(".phoneDetails span.required:visible").text(MessageHelper.messages.PHONE_FIELDS_ERROR)})),$(".dobMonthData span.required:visible").filter((function(i){return 0!=i})).hide(),$(".phoneDetails span.required:visible").filter((function(i){return 0!=i})).hide(),errorList&&errorList.length){Number.MAX_VALUE;null}$(".phoneDetails span.required:visible").length>0&&$(".phoneDetails").addClass("validationError"),$("span.required").attr("tabindex",0)},highlight:function(element,errorClass){$(element).addClass("required"),$(element).parent().addClass("validationError")},unhighlight:function(element,errorClass){$(element).removeClass("required"),$(element).parent().removeClass("validationError")}}),$("body").hasClass("home-page")){$().cycle&&($(".slideshow").cycle({fx:"fade",pager:"#home-controls",speed:"800",pause:!0,timeout:0,pagerAnchorBuilder:function(idx,slide){return'<li><a aria-label="Homepage Promotion Slide '+(1+idx)+'" href="#">'+(1+idx)+"</a></li>"}}),$("#home-controls a").click((function(){$(".slideshow").cycle("pause")}))),$(".banner-image .ad_product").each((function(i){var $this=$(this);$marginLeft=$this.width()/2,$this.css("marginLeft","-"+$marginLeft+"px")}));var imgHeight=$(".banner-image .ad_product:first img").height(),imgWidth=$(".banner-image .ad_product:first img").width();$(".banner-image").css("width",imgWidth+"px").css("height",imgHeight+"px")}$(".plan-visit-holder").each((function(i){var $this=$(this);$marginLeft=$this.width()/2,$this.css("marginLeft","-"+$marginLeft+"px")})),Modernizr.input.placeholder||($("[placeholder]").focus((function(){var $this=$(this);$this.val()==$this.attr("placeholder")&&$this.val("").addClass("active").removeClass("inactve")})).blur((function(){var $this=$(this);null!=$this.val()&&""!=$this.val()||$this.val($this.attr("placeholder")).addClass("inactive").removeClass("active")})).blur(),$("[placeholder]").parents("form").submit((function(){$(this).find("[placeholder]").each((function(){var $this=$(this);$this.val()==$this.attr("placeholder")&&$this.val("")}))}))),$(".pin-it-button").click((function(event){event.preventDefault(),window.open($(this).attr("href"),"popUpWindow","height=700,width=800,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes"),utag.link({link_name:"SocialShare",social_site:"Pinterest"})})),$("#dateOfBirthForm").submit((function(e){var dob=$.trim($("#myDOB").text());if(""!=dob)return this.dateOfBirth.value=dob,!0;var date=new Date,year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();return 0==this.birth_year.value||isCorrectDate(this.birth_month.value,this.birth_date.value,this.birth_year.value)?validateAge(this,month,day,year)?0!=this.birth_year.value||0!=this.birth_month.value||0!=this.birth_date.value?(this.dateOfBirth.value=this.birth_year.value+"-"+this.birth_month.value+"-"+this.birth_date.value,!0):void(this.dateOfBirth.value=""):(utag_data.form_field="under 18",$("#moreInformatonErrorDiv").text("You need to be 18 years old to sign up for Lenscrafters.com").show(),$("#moreInformatonErrorDiv").attr("aria-label",$("#moreInformatonErrorDiv").text()),!1):(utag_data.form_field="invalid date",$("#moreInformatonErrorDiv").text("Please Enter a valid date.").show(),$("#moreInformatonErrorDiv").attr("aria-label",$("#moreInformatonErrorDiv").text()),!1)})),$("body").on("click",".label_check",(function(){setupLabel()})),$('#form-fsa input[type="radio"]').change((function(e){"checked"==$("#fsaYes").attr("checked")?$("#fsaExpField").css("display","block"):"checked"==$("#fsaNo").attr("checked")&&($("#fsaExpField").css("display","none"),$("#fsa_datepicker").val(""))})),setupLabel(),null!=window.EmailSignupForm&&(EmailSignupForm.setupValidation(),EmailSignupForm.setupClickEvents()),$("#countrySelector").click((function(e){var children=$(this).children("li");if(children.eq(0).hasClass("selected"))return children.eq(0).hide().removeClass("selected"),children.eq(1).show().addClass("selected"),!1;children.eq(1).hide().removeClass("selected"),children.eq(0).show().addClass("selected")})),$("#countrySelector > li li").click((function(e){e.preventDefault();var $this=$(this);if($this.hasClass("current"));else{var nextUrl=$this.find("a").attr("href");document.location=nextUrl}})),$("a.submit-form").click((function(){return $("#getDirectionsForm").is(":visible")&&$("#getDirectionsForm").validate(),$(this).parents("form").submit(),utagLinkSafe({link_id:"drivingDirections"}),!1})),$("body").on("click",".close-favorites-modal",(function(e){e.preventDefault(),$("#AddedWishlistDialogDiv").attr("aria-hidden","true").slideUp()})),-1!=navigator.userAgent.indexOf("Mobile")&&($("#logonPassword2, #logonPasswordVerify2").unbind("blur").attr("placeholder","Enter password"),$("#logonPasswordVerify2").attr("placeholder","Re-enter password")),null!=window.FooterStoreSearch&&FooterStoreSearch.setup(),$("#EyeExamsModalDiv").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:640,open:function(){$("#EyeExamsModalDiv").prev(".ui-dialog-titlebar").find(".ui-dialog-titlebar-close").addClass("eyeexams").find(".ui-icon-closethick").text("Return to myAccount"),$("#EyeExamsModalDiv").parent().addClass("with-bg")}}),$("#perkLogonFormContent").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615,open:function(){},close:function(){clearRegisterModelPWDfields(),clearLoginPerkErrorMessages(),clearRegPerkErrorMessages()},create:function(){var dialogTitle=$(this).dialog("option","title"),dialog=$(this).dialog("widget");dialog.attr("role","complementary"),void 0!==dialogTitle&&""!=dialogTitle||dialog.attr("aria-label","Perk Logon Form Content").removeAttr("aria-labelledby")}}),$("#footerDoctorNotice").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:440,create:function(){var dialogTitle=$(this).dialog("option","title"),dialog=$(this).dialog("widget");dialog.attr("role","complementary"),void 0!==dialogTitle&&""!=dialogTitle||dialog.attr("aria-label","Footer Doctor Notice").removeAttr("aria-labelledby")}}),$("#playVideoModal").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999}),$(".unsyncContainer").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615}),$(".canceleyeExamContainer").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615}),$(".showWaitModalContainer").dialog({dialogClass:"noModal-close",autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:490,minHeight:175,closeOnEscape:!1}),$(".openWhatToExpectModal").click((function(e){e.preventDefault(),$("#playVideoModal").dialog("open")})),$(".openDoctorNotice").click((function(e){e.preventDefault(),$("#footerDoctorNotice").dialog("open")}));var cancelAppointmentModal=$("#CancelAppointmentModalDiv").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:340,open:function(){$("#CancelAppointmentModalDiv .cancel").bind("click",(function(){$("#CancelAppointmentModalDiv").dialog("close")}))},close:function(){$("#CancelAppointmentModalDiv .cancel").unbind("click")}});$("#EyeExamsModalDiv").on("click","a.cancelAppointment[data-appointment-id]",(function(){return $(".cancelAppointmentId").val($(this).attr("data-appointment-id")),cancelAppointmentModal.dialog("open"),!1})),$("#WC_shippingAddressCreateEditFormDiv_1_address1_div_11 input").on("change",(function(){return AddressHelper.avalaraFail=!1,!1})),$("#WC_shippingAddressCreateEditFormDiv_1_address1_div_11 select").on("change",(function(){return AddressHelper.avalaraFail=!1,!1})),$("#EyeExamsModalDiv .show-past-exam").on("click",(function(){var index=$(this).index("#EyeExamsModalDiv .show-past-exam");$("#EyeExamsModalDiv .show-past-exam").eq(index).toggle(),$("#EyeExamsModalDiv .hide-past-exam").eq(index).toggle(),$("#EyeExamsModalDiv .past .each-exam").eq(index).toggle()})),$("#EyeExamsModalDiv .hide-past-exam").on("click",(function(){var index=$(this).index("#EyeExamsModalDiv .hide-past-exam");$("#EyeExamsModalDiv .show-past-exam").eq(index).toggle(),$("#EyeExamsModalDiv .hide-past-exam").eq(index).toggle(),$("#EyeExamsModalDiv .past .each-exam").eq(index).toggle()})),$("#CancelAppointmentModalDiv .yes-cancel").on("click",(function(){utagLinkSafe({link_id:"apptRemove"})}));var currentButton=0;$("#StoreLocatorPdpModelDiv").dialog({autoOpen:!1,title:"FIND IN STORES",draggable:!1,resizable:!1,position:["center"],modal:!0,zIndex:9999,minWidth:990,open:function(){var brand="",style="",price="",imgSrc="",sku="";if($("#quick-view-modal").is(":visible"))brand=$("#quick-view-modal #productBrand").text(),style=$("#quick-view-modal #productName").text(),price=$("#quick-view-modal #productPrice").text(),imgSrc=$("#quick-view-modal #productFullImage").attr("src"),$("#quick-view-modal").dialog("close");else if($("#compare_details").is(":visible")){brand=(currentRow=$(".each-compare-product").eq(currentButton)).find(".the-brand").text(),style=currentRow.find(".brandStyle span").text(),price=currentRow.find(".the-price:first span").text(),imgSrc=currentRow.find(".comparehover img").attr("src"),sku=currentRow.find("#partNumber").text(),$("#StoreLocator_ProductId").val(sku)}else if($("#wishlist-holder").is(":visible")){brand=(currentRow=$(".item").eq(currentButton)).find(".the-brand").text(),style=currentRow.find(".style-name").text(),price=currentRow.find(".the-price:first span").text(),imgSrc=currentRow.find(".productMainImage").attr("src"),utagLinkSafe({link_name:"findinstore",product_id:sku=currentRow.find(".find-in-store").data("partnumber")}),$("#StoreLocator_ProductId").val(sku)}else if($("#certona-reco").length>0){var currentRow;brand=(currentRow=$(".each-reco-product").eq(currentButton)).find(".brand").text(),style=currentRow.find(".style-name").text(),price=currentRow.find(".the-price:first span").text(),imgSrc=currentRow.find(".product_image img").attr("src"),utagLinkSafe({link_name:"findinstore",product_id:sku=currentRow.find(".find-in-store").data("partnumber")}),$("#StoreLocator_ProductId").val(sku)}if(""!=brand&&""!=style&&""!=price&&""!=imgSrc){$("#StoreLocatorPdpModelDiv #storeBrand").text(brand),$("#StoreLocatorPdpModelDiv h2 span").text(style),$("#StoreLocatorPdpModelDiv .the-price").text(price);var regex=/wid=(\d*)/;imgSrc.match(regex)&&(imgSrc=imgSrc.replace(regex,"wid=254")),$("#StoreLocatorPdpModelDiv #storeImage").attr("src",imgSrc)}$(".pdpSubText").length>0&&($(".pdpSubText").css("display","none"),$(".pdpNoStoreText").css("display","none"),$(".storeLocatorResults").html(""),$("#map").css("display","none"),$("#number-of-store-results").html(""),$("#num-results").css("display","none"),$(".disclaimer").css("display","none"))},create:function(){var dialogTitle=$(this).dialog("option","title"),dialog=$(this).dialog("widget");dialog.attr("role","complementary"),void 0!==dialogTitle&&""!=dialogTitle||dialog.attr("aria-label","Product store locator modal").removeAttr("aria-labelledby")}}),$("#ContactUsChatOverLay").dialog({autoOpen:!1,title:"",draggable:!1,resizable:!1,position:["center"],modal:!0,zIndex:9999,minWidth:520,close:function(){if($("#ContactUsChatOverLay span.required").hide(),$("#chatOverlay").css("display","none"),$("#rightNowChatContainer").length){try{$("#rightNowChatContainer")[0].contentWindow.closeAndDisconnect()}catch(err){}try{$("#rightNowChatContainer")[0].contentWindow.closeAndDisconnect()}catch(err){}}},create:function(){var dialogTitle=$(this).dialog("option","title"),dialog=$(this).dialog("widget");dialog.attr("role","complementary"),void 0!==dialogTitle&&""!=dialogTitle||dialog.attr("aria-label","Contact Us Chat OverLay").removeAttr("aria-labelledby")}}),$(".email-friend").click((function(){var url=$(this).attr("generic_email_view_url");return $.ajax({url:getAbsoluteURL()+url,success:function(data){$("#EmailFriendFormDiv").html(data),$("#EmailFriendFormDiv").dialog({draggable:!1,resizable:!1,modal:!0,zIndex:9999,minWidth:520,open:function(){$("#EmailFriendFormDiv .cancel").bind("click",(function(e){e.preventDefault(),$(".ui-dialog-content").dialog("close")})),$("input[name=directions]").length>0&&$("input[name=directions]").val($("#allDirections").text()),$("input[name=totalDistance]").length>0&&$("input[name=totalDistance]").val($("#totalDist").text()),$("input[name=mapImage]").length>0&&$("input[name=mapImage]").val($("#imageUrl").text()),$("input[name=totalTime]").length>0&&$("input[name=totalTime]").val($("#timeTaken").text())},close:function(){$("#EmailFriendFormDiv .cancel").unbind("click")}})}}),utagLinkSafe({link_name:"emailPDP"}),!1})),$(".sign-in-link").click((function(){return showLogonModal(),!1})),$(".perk-sign-in-link").click((function(){return hideSaveFavorites(),$("#perk-register-modal").css("display","none").attr("aria-hidden","true"),$(".header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$(".header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$("#perk-logon-modal").css("display","block").attr("aria-hidden","false"),$("#perksheaderEmailAddress").focus(),$(".perk-account-link").removeClass("active"),$(".perk-sign-in-link").addClass("active"),$(".headerEmailAddress").focus(),clearResetPwdErrorMessages(),clearRegPerkErrorMessages(),!1})),$(".perk-account-link").click((function(e){if(!constants.ajaxParams.loggedIn)return hideSaveFavorites(),$("#perk-logon-modal").css("display","none"),$("#perk-register-modal").css("display","block").attr("aria-hidden","false"),$("#perk-register-modal .logonId_regModel").focus(),$(".perk-account-link").addClass("active"),$(".perk-sign-in-link").removeClass("active"),$("#logonId_perkModel").focus(),clearLoginPerkErrorMessages(),!1})),$("#create-an-account-plan-visit").click((function(){return $(".header-sign-in-modal").css("display","none"),$(".header-register-modal").css("display","block"),$(".sign-in-link").removeClass("open"),$("#create-an-account-plan-visit").addClass("open"),$(".logonId_regModel").focus(),clearLoginErrorMessages(),!1})),$(".close-sign-in").click((function(){return $(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearLoginErrorMessages(),clearLoginFields(),clearRegInputFields(),!1})),$("#create-an-account-in-eye-examspage").click((function(){return $(".header-register-modal").css("display","block").attr("aria-hidden","false"),!1})),$(".close-register").click((function(){return $(".header-register-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearRegErrorMessages(),$(".userRegModelForm").validate().resetForm(),$(":input",".userRegModelForm").not(":hidden").val("").removeClass("required"),$(".userRegModelForm")[0].reset(),utagLinkSafe({link_name:"contactAdd",customer_id:"${userId}"}),!1})),$("#logonPassword_perkModel").keydown((function(e){($("#logonPasswordVerify_perkModal").hasClass("valid")||$("#logonPasswordVerify_perkModal").hasClass("required"))&&$("#logonPasswordVerify_perkModal").show(),e.which})),$("#perkLogonFormContent .forgotPasswordLink").on("click touchstart",(function(){$("#perkLogonFormContent").dialog("close"),clearRegPerkErrorMessages(),clearLoginPerkErrorMessages()})),$(".cancelPerkModel").on("click",(function(e){$("#perk-logon-modal").is(":visible")||$("#perk-register-modal").is(":visible")?$("#perkLogonFormContent").dialog("close"):$(".perkContactModelDiv").is(":visible")&&$(".perkContactModelDiv").dialog("close");var isCancel=$(this).attr("data-attrcancel");"undefined"!=perkName&&$.cookie("lcOfferName")==perkName&&"true"==isCancel&&(document.cookie="lcOfferName=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"),clearRegPerkErrorMessages(),clearLoginPerkErrorMessages(),refreshNotifications()})),$(document).on("click",".cancelPerkModel",(function(e){$("#perksThankYouModal").is(":visible")?$("#perksThankYouModal").dialog("close"):$(".perkContactModelDiv").is(":visible")&&$(".perkContactModelDiv").dialog("close");var isCancel=$(this).attr("data-attrcancel");"undefined"!=perkName&&$.cookie("lcOfferName")==perkName&&"true"==isCancel&&(document.cookie="lcOfferName=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"),refreshNotifications()})),$(".close-set-new-password").click((function(){return $(".header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),!1})),$(".LogOnModalSubmitButton").click((function(){logonFormSubmit($(this).parents("form"));var emailIdToAutoPopulate=document.getElementsByClassName("headerEmailAddress")[0].value;return emailIdToAutoPopulate&&(document.getElementsByClassName("WC_PasswordUpdateForm_FormInput_EmailAddress").value=emailIdToAutoPopulate,document.getElementsByClassName("autoPopulatedEmailHiddenDesktop").value=emailIdToAutoPopulate),!1})),$("body, #quick-view-modal").on(tabEvent,".find-in-store",(function(){if($("#compare_details").is(":visible")){var currentSection=$(this).parents(".each-compare-product");currentButton=$(".each-compare-product").index(currentSection)}else $("#wishlist-holder").is(":visible")?(currentButton=$(this).closest(".item").index(),$(".storeLocatorResults").html(""),$("#num-results").hide(),$(".disclaimer").hide(),$("#map").hide()):$("#certona-reco").length>0&&(currentButton=$(this).closest(".each-reco-product").index()-1);return $("#StoreLocatorPdpModelDiv").dialog("open"),!1})),$("#LogonForm").submit((function(){return logonFormSubmit($(this)),!1})),$("#LogonSessionTimeoutForm").submit((function(){return logonFormTimeoutSubmit($(this)),!1})),$("#userRegModelFormConfirm .regSubmit").click((function(){registerFormSubmit($(this).parents("form"))})),$("#EmailPreferencesForm").submit((function(e){var emailPreferencesForm=document.EmailPreferencesForm,isEmailChecked="",isMobileChecked="";$(".checkBoxareaEmail").is(":visible")&&(isEmailChecked=$(".checkBoxareaEmail:visible .isEmailChecked").val()),$(".checkBoxSubscribedareaEmail").is(":visible")&&(isEmailChecked=$(".checkBoxSubscribedareaEmail:visible .isEmailChecked").val()),$(".checkBoxareaPhone").is(":visible")&&(isMobileChecked=$(".checkBoxareaPhone:visible .isMobileChecked").val()),$(".checkBoxSubscribedareaPhone").is(":visible")&&(isMobileChecked=$(".checkBoxSubscribedareaPhone:visible .isMobileChecked").val()),null!=isEmailChecked&&"true"==isEmailChecked&&(data={site_events:{email_opt_in:!0}},callTrackAnalytics(data),$("#recieveEmail_id").val("true")),null!=isMobileChecked&&"true"==isMobileChecked&&$("#receiveMobile_id").val("true"),emailPreferencesForm.womenStyle.checked&&$("#womenStyle_id").val("true"),emailPreferencesForm.menStyle.checked&&$("#menStyle_id").val("true"),emailPreferencesForm.childrenStyle.checked&&$("#childrenStyle_id").val("true"),emailPreferencesForm.classicStyle.checked&&$("#classicStyle_id").val("true"),emailPreferencesForm.trendyStyle.checked&&$("#trendyStyle_id").val("true"),emailPreferencesForm.sportStyle.checked&&$("#sportStyle_id").val("true"),emailPreferencesForm.exclusiveStyle.checked&&$("#exclusiveStyle_id").val("true"),emailPreferencesForm.contacts.checked&&$("#contacts_id").val("true"),emailPreferencesForm.wellness.checked&&$("#wellness_id").val("true"),emailPreferencesForm.tech.checked&&$("#tech_id").val("true"),emailPreferencesForm.sportLenses.checked&&$("#sportLenses_id").val("true"),emailPreferencesForm.multiLenses.checked&&$("#multiLenses_id").val("true"),emailPreferencesForm.oneSight.checked&&$("#oneSight_id").val("true"),emailPreferencesForm.jewelry.checked&&$("#jewelry_id").val("true"),emailPreferencesForm.durable.checked&&$("#durable_id").val("true"),emailPreferencesForm.look.checked&&$("#look_id").val("true"),emailPreferencesForm.yearlyExam.checked&&$("#yearlyExam_id").val("true"),emailPreferencesForm.participateActivities.checked&&$("#participateActivities_id").val("true"),emailPreferencesForm.sameStyle.checked&&$("#sameStyle_id").val("true"),emailPreferencesForm.shopAlone.checked&&$("#shopAlone_id").val("true"),emailPreferencesForm.expression.checked&&$("#expression_id").val("true"),emailPreferencesForm.needHelp.checked&&$("#needHelp_id").val("true"),emailPreferencesForm.largeFace.checked&&$("#largeFace_id").val("true"),emailPreferencesForm.smallFace.checked&&$("#smallFace_id").val("true"),emailPreferencesForm.narrowNose.checked&&$("#narrowNose_id").val("true"),emailPreferencesForm.wideNose.checked&&$("#wideNose_id").val("true"),emailPreferencesForm.justMe.checked&&$("#justMe_id").val("true"),emailPreferencesForm.partner.checked&&$("#partner_id").val("true"),emailPreferencesForm.under12.checked&&$("#under12_id").val("true"),emailPreferencesForm.twelveto18.checked&&$("#twelveto18_id").val("true");var form=this;e.preventDefault(),setTimeout((function(){form.submit()}),400)})),$("#favoriteSignInModal #examForgotPasswordLink").on("click touchstart",(function(){return $("#favoriteSignInModal #signInSection").css("display","none").attr("aria-hidden","true"),$("#favoriteSignInModal .ForgotPasswordSection").css("display","block"),!1})),$("#favoriteSignInModal  #modalPasswordResetSubmitButton").click((function(){if(null!=$("#favoriteSignInModal #WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm")&&"Enter your email address"!=$("#favoriteSignInModal #WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm").val()){var currentID=document.getElementsByClassName("currentID");null!=currentID&&(currentID.value=$("#favoriteSignInModal #WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm").val())}return $("#favoriteSignInModal .ForgotPasswordSection .ResetPasswordForm").valid()&&(modelPWReset=!0,resetPassword()),!1})),perkName="",$(".addPerks").click((function(){if(perkName=$(this).attr("data-perkname"),dataSidName=$(this).attr("data-sid"),dataCidName=$(this).attr("data-cid"),constants.ajaxParams.loggedIn){var params={};params.myPerkName=perkName,params.storeId=constants.ajaxParams.storeId,params.catalogId=constants.ajaxParams.catalogId,params.langId=constants.ajaxParams.langId,$.ajax({url:getAbsoluteURL()+"AjaxAddPerkCmd",data:params,dataType:"html",crossDomain:!0,success:function(data){var serviceResponse=data;"string"==typeof serviceResponse&&(serviceResponse=filterAjaxResponseCart(data)),void 0===serviceResponse.errorMessage||""==serviceResponse.errorMessage?void 0!==serviceResponse.displayFLModal&&"true"==serviceResponse.displayFLModal?displayPerkAttributeModal():displayThankYouModal():void 0!==serviceResponse.errorMessage&&""!=serviceResponse.errorMessage?"_ERR_DIDNT_LOGON"==serviceResponse.errorMessageKey&&(window.location=$("#headerMyAccountURL").val()):$(".LogOnFailureResponseMessageDiv").html(data.errorMessage).show()},error:function(jqXHR,textStatus,errorThrown){$(".LogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}else $("#perkLogonModalPerkName").val(perkName),$("#perkRegModalPerkName").val(perkName),$("#perkLogonModalPerkName").val(perkName),$("#perkLogonDataSid").val(dataSidName),$("#perkLogonDataCid").val(dataCidName),$("#perkLogonFormContent").dialog("open"),$("#perk-register-modal").css("display","none"),$(".header-sign-in-modal").css("display","none"),$("#perk-logon-modal .perk-sign-in-link").addClass("active"),$("#perk-logon-modal .perk-account-link").removeClass("active"),$("#perk-logon-modal").css("display","block"),$("#perksheaderEmailAddress").focus();return!1})),$("#add-now, #verifyrx").click((function(e){e.preventDefault(),$("#verifyRxInfoModal").dialog("open")})),$(".return-to-your-account").click((function(){return $("#EyeExamsModalDiv").dialog("close"),!1})),$("#perkLogonForm").submit((function(){return logonFormSubmitPerks($(this)),!1})),$("#perksUserRegModelForm").submit((function(){return perksRegistrationFormSubmit($(this)),!1})),$("#regSubmitPerks").click((function(){registerFormSubmitPerks($(this).parents("form"))})),$(".plan-visit-holder-signed-in .section").each((function(){var $this=$(this);$this.hasClass("completed")&&$this.hover((function(){$this.children(".completed-holder").attr("aria-hidden","true").hide(),$this.children(".start-over-holder").attr("aria-hidden","false").show()}),(function(){$this.children(".completed-holder").attr("aria-hidden","false").show(),$this.children(".start-over-holder").attr("aria-hidden","true").hide()}))})),$(".planYourVisitCloseLink").click((function(){return closeYourLook(),!1})),$("#hello").on("click","#top-account-label",(function(e){e.stopPropagation(),$("#header-notification-modal").toggle()})),$("#hello").on("click",".notification-click",(function(e){data={site_events:{notifications_seen:!0}},callTrackAnalytics(data);var timeDiff=(new Date).valueOf()-startTime,sessiontimeOut=$(".sessionDuration").val()||"";if(!(timeDiff>=sessiontimeOut&&""!=sessiontimeOut))return $(".notification-count").hasClass("active")?$(".notification-count").removeClass("active"):$(".notification-count").addClass("active"),!1;window.location.href=$("#headerMyAccountURL").val()})),window.logonParameters={onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{logonId:{required:!0,email:!0},logonPassword:{required:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailEmpty,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonPassword:{required:MessageHelper.messages.ERR_PSW_FIELD_EMPTY}},errorPlacement:function(error,element){"optin_18yrs"==$(element).attr("name")?$(error).insertAfter($(element).next()):$(error).insertAfter(element),error_list.push(error.text())}},$(document).keydown((function(e){$(".header-register-modal").is(":visible")&&9==e.keyCode&&$(".header-register-modal .sign-in-link").is(":focus")&&showLogonModal(),$(".header-sign-in-modal").is(":visible")&&13==e.keyCode&&$(".LogOnModalSubmitButton").click(),$(".ui-dialog-titlebar-close").is(":focus")&&32==e.keyCode&&($(".ui-dialog-content").dialog("close"),e.preventDefault()),$(".compareCheckBox").is(":focus")&&32==e.keyCode&&$(".compareCheckBox").is(":focus").click()})),$(".LogonDialogModalForm").validate(window.logonParameters),$("#LogonForm").validate(window.logonParameters),$("#LogonSessionTimeoutForm").validate(window.logonParameters),$("#perkLogonForm").validate(window.logonParameters),$.validator.addMethod("equalToIgnoreCase",(function(value,element,param){return value.toLowerCase()==$(param).val().toLowerCase()}));new Array;$("#userRegModelFormConfirm").validate({onfocusout:!1,onkeyup:function(form,event){13==event.keyCode&&registerFormSubmit(this.currentForm)},onclick:!1,errorClass:"required",errorElement:"span",rules:{logonId:{required:!0},logonPassword:{required:!0,minlength:8,atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial:!0},logonPasswordVerify:{required:!0,equalTo:"#new-password-create"},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER,minlength:MessageHelper.messages.PASSWORD_UPDATE_INVALID_ERROR,atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial:MessageHelper.messages.PASSWORD_UPDATE_INVALID_ERROR},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}}}),window.registerParameters={onfocusout:!1,onkeyup:function(form,event){13==event.keyCode&&registerFormSubmit(this.currentForm)},onclick:!1,errorClass:"required",errorElement:"span",rules:{logonId:{required:!0,email:!0},logonIdVerify:{required:!0,logonIdVerifyRequired:!0,email:!0,equalToIgnoreCase:".logonId_regModel"},logonPassword:{required:!0,minlength:6,atLeastOneLetterAndOneDigit:!0},logonPasswordVerify:{required:!0,equalTo:".logonPassword_regModel",atLeastOneLetterAndOneDigit:!0},optin_18yrs:{required:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonIdVerify:{required:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,logonIdVerifyRequired:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,equalToIgnoreCase:MessageHelper.messages.ERROR_EMAIL_MISMATCH},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},showErrors:function(errorMap,errorList){this.defaultShowErrors();var hideSpan=!0;$(".header-register-modal div.fe span.required:visible").each((function(i,obj){$(this).text()==MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR&&($(".passwordRequirements").hide(),hideSpan=!1)})),hideSpan&&$(".passwordRequirements").show()},errorPlacement:function(error,element){"optin_18yrs"==$(element).attr("name")?$(error).insertAfter($(element).next()):$(error).insertAfter(element),error_list.push(error.text())}},window.registerPerkParameters={onfocusout:!1,onkeyup:function(form,event){13==event.keyCode&&registerFormSubmit(this.currentForm)},onclick:!1,errorClass:"required",errorElement:"span",rules:{logonId:{required:!0,email:!0},logonIdVerify:{required:!0,logonIdVerifyRequired:!0,email:!0,equalToIgnoreCase:"#logonId_perkModel"},logonPassword:{required:!0,minlength:6,atLeastOneLetterAndOneDigit:!0},logonPasswordVerify:{required:!0,equalTo:"#logonPassword_perkModel",atLeastOneLetterAndOneDigit:!0},optin_18yrs:{required:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonIdVerify:{required:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,logonIdVerifyRequired:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,equalToIgnoreCase:MessageHelper.messages.ERROR_EMAIL_MISMATCH},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},errorPlacement:function(error,element){"optin_18yrs"==$(element).attr("name")?$(error).insertAfter($(element).next()):$(error).insertAfter(element),error_list.push(error.text())}},$(".userRegModelForm").validate(window.registerParameters),$("#perksUserRegModelForm").validate(window.registerPerkParameters),$(".userRegModelForm").find('input[type="checkbox"]').on("keyup",(function(e){13==e.keyCode&&registerFormSubmit($(this).closest("form"))})),window.startTime=(new Date).valueOf(),$("#PasswordUpdateSubmitForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{logonId:{required:!0,email:!0},logonPasswordOld:{required:!0},logonPassword:{required:!0,minlength:8,atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial:!0},logonPasswordVerify:{required:!0,equalTo:".logonPassword_updateModel",atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailEmpty,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonPasswordOld:{required:MessageHelper.messages.OLD_PASSWORD_EMPTY_ERROR},logonPassword:{required:MessageHelper.messages.OLD_PASSWORD_EMPTY_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_INVALID_ERROR,atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial:MessageHelper.messages.PASSWORD_UPDATE_INVALID_ERROR},logonPasswordVerify:{required:MessageHelper.messages.PASSWORD_UPDATE_CONFIRM_ERROR,atLeastOneLetterUpperAndLowerAndOneDigitAndSpecial:MessageHelper.messages.PASSWORD_UPDATE_INVALID_ERROR,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH}},showErrors:function(errorMap,errorList){this.defaultShowErrors();var hideSpan=!0;$(".header-set-a-new-password-modal div.fe span.required:visible").each((function(i,obj){$(this).text()==MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR&&($(".passwordRequirements").hide(),hideSpan=!1)})),hideSpan&&$(".passwordRequirements").show();for(var spans=$("span.required"),i=0;i<spans.length;i++)spans[i].setAttribute("aria-label",spans[i].innerText),spans[i].setAttribute("tabindex",0)},submitHandler:function(form){var timeDiff=(new Date).valueOf()-startTime,sessiontimeOut=$(".sessionDuration").val()||"";if(timeDiff>=sessiontimeOut&&""!=sessiontimeOut)window.location.reload();else{var data=$(form).serializeArray(),newData=[],originalURL=null;$("#successPassword").hide();for(var i=0;i<data.length;i++){var d=data[i];"URL"==d.name?(originalURL=d.value,newData.push({name:"URL",value:"ResetPasswordAjaxView"})):newData.push(d)}$.ajax({url:getAbsoluteURL(!0)+"ResetPassword",data:newData,type:"POST",dataType:"json",success:function(data){if(data.success)if($(".PasswordUpdateFailureResponseMessageDiv").hide(),null==$("#successPassword").html()){var nextUrl=originalURL;null!=nextUrl&&nextUrl.length&&"#"==nextUrl.charAt(nextUrl.length-1)&&(nextUrl=nextUrl.substring(0,x.length-1)),window.location=nextUrl}else $("#successPassword").show();else $(".PasswordUpdateFailureResponseMessageDiv").html(data.errorMessage).show()},error:function(jqXHR,textStatus,errorThrown){$(".PasswordUpdateFailureResponseMessageDiv").html("Reset password update failed - please try again later.")}})}}}),$(".removeFctCookie").click((function(e){document.cookie="facets=; path=/"})),$(".cookFacet").click((function(e){if(!$(this).hasClass("link-disabled")){var data=$(this).data("item");data=data.replace(/ /g,"+"),$.cookie("latestAddedFacet",data,{path:"/"});var cookInfo=read_cookie("facets");document.cookie=null!=cookInfo?"facets="+cookInfo+"|"+data+"; path=/":"facets=|"+data+"; path=/"}})),$(".noThanks").click((function(e){$.cookie("hideRegistrationModal","true")})),$(".email-friend").on("click",(function(e){if(void 0===exitUrl)var exitUrl="";data={site_events:["social_share"],exit_url:exitUrl},callTrackAnalytics(data)})),$(".facebook-button").on("click",(function(e){data={site_events:["social_share"],exit_url:$(this).attr("href")},callTrackAnalytics(data)})),$("#eye-exam-edit-click").on("click",(function(e){e.preventDefault();var nextURL=$(this).attr("href"),country="us",userAuthenticated="not authenticated",userRegistration="not registered";"CA"==constants.ajaxParams.countryName&&(country="ca"),constants.ajaxParams.loggedIn&&(userAuthenticated="authenticated",userRegistration="registered"),data={site_events:{edit_patient_info:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration},callTrackAnalytics(data),setTimeout((function(){window.location=nextURL}),200)})),$(document.body).on("click",".AddAnotherExamLink",(function(e){e.preventDefault();var country="us",userAuthenticated="not authenticated",userRegistration="not registered";"CA"==constants.ajaxParams.countryName&&(country="ca"),constants.ajaxParams.loggedIn&&(userAuthenticated="authenticated",userRegistration="registered"),data={site_events:{add_exam_another_patient:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration},callTrackAnalytics(data),location.href=$(this).attr("href")})),$("#eyeExamChangeLocation").on("click",(function(){var country="us",userAuthenticated="not authenticated",userRegistration="not registered";"CA"==constants.ajaxParams.countryName&&(country="ca"),constants.ajaxParams.loggedIn&&(userAuthenticated="authenticated",userRegistration="registered"),data={site_events:{change_exam_location:!0},site_layout_type:"desktop",country:country,authentication_status:userAuthenticated,registration_status:userRegistration},callTrackAnalytics(data)})),$("#step2Chat").on("click",(function(){data={site_events:{live_chat_click:!0}},callTrackAnalytics(data)})),$(document.body).on("click",".eyeExamEditExam",(function(e){e.preventDefault(),eyeExamEditEyeExamAnalytics(),location.href=$(this).attr("href")})),$(".twitter-button").on("click",(function(e){data={site_events:["social_share"],exit_url:$(this).attr("href")},callTrackAnalytics(data)})),$(".pinterest-button").on("click",(function(e){var exitUrl=$(this).attr("href");""!=exitUrl&&"#"!=exitUrl||(exitUrl=$(this).attr("data-href")),data={site_events:["social_share"],exit_url:exitUrl},callTrackAnalytics(data)})),$(".youtube-button").on("click",(function(e){data={site_events:["social_share"],exit_url:$(this).attr("href")},callTrackAnalytics(data)})),$(".brand_sort").on("click",(function(e){data={site_events:["brand_sort"],brand_sort_type:$(this).attr("data-sort-type")},callTrackAnalytics(data)})),updateCompareBox()})),$(document).click((function(e){var signinModelClick=!1,regModelClick=!1,resetModelClick=!1,signInObj=$(".header-sign-in-modal"),regObj=$(".header-register-modal"),resetModelObj=$(".header-reset-password-modal"),resetModelDoneObj=$(".header-reset-password-done-modal"),setModelObj=$(".header-set-a-new-password-modal"),updateModelObj=$(".header-update-reset-password-modal"),eventObj=e.target,notificatioModelClick=!1,notificationObj=$("#header-notification-modal");(signInObj==e.target&&($(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open")),regObj==e.target)&&($(".header-register-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),$(".userRegModelForm").validate().resetForm(),$(":input",".userRegModelForm").not(":hidden").val("").removeClass("required"));resetModelObj==e.target&&($(".header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open")),resetModelDoneObj==e.target&&($(".header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open")),setModelObj==e.target&&($(".header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open")),updateModelObj==e.target&&($(".header-update-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".background-update-reset").css("display","none")),$(eventObj).parents().each((function(index,element){element==signInObj[0]&&(signinModelClick=!0)})),$(eventObj).parents().each((function(index,element){element==regObj[0]&&(regModelClick=!0)})),$(eventObj).parents().each((function(index,element){element==resetModelObj[0]&&(resetModelClick=!0)})),$(eventObj).parents().each((function(index,element){element==resetModelDoneObj[0]&&(resetModelClick=!0)})),$(eventObj).parents().each((function(index,element){element==setModelObj[0]&&(resetModelClick=!0)})),$(eventObj).parents().each((function(index,element){element==updateModelObj[0]&&(resetModelClick=!0)})),signinModelClick||regModelClick||resetModelClick||($(".header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearLoginErrorMessages(),$(".header-register-modal").css("display","none").attr("aria-hidden","true"),$(".header-update-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".background-update-reset").css("display","none"),$(".header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearRegErrorMessages(),clearRegInputFields(),clearLoginFields(),$(".header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$(".header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$("#myaccount-rectangle > .backdrop").addClass("hide"),$("#myaccount-rectangle").addClass("hide")),$(eventObj).parents().each((function(index,element){element==notificationObj[0]&&(notificatioModelClick=!0)})),notificatioModelClick||($("#header-notification-modal").css("display","none"),$(".notification-count").removeClass("active"))})),jQuery.validator.addMethod("antipattern",(function(value,element,param){return $("span[for=locationEntry],#ErrorDivStoreSearch").hide(),this.optional(element)||!param.test(value)}),"Invalid format."),jQuery.validator.addMethod("logonIdVerifyRequired",(function(value,element,param){return"Enter e-mail address"!=value}),"Please enter a password"),$.validator.addMethod("postalFormatCheck",(function(value,element){var regexObj_canada=/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i,regexObj_usa=/^\d{5}(-\d{4})?$/;return""!=$("#storeCountryName").val()&&"US"==$("#storeCountryName").val()?new RegExp(regexObj_usa).test(value):(null,new RegExp(regexObj_canada).test(value))})),$.validator.addMethod("atLeastOneLetter",(function(value,element){return/^(?=.*[A-Za-z])[A-Za-z\d$@$!%*?&()^#-_~]{6,}$/.test(value)})),""!=$("#storeCountryName").val()&&"US"==$("#storeCountryName").val()?$.validator.messages.postalFormatCheck="Please enter a valid zip code":$.validator.messages.postalFormatCheck="Please enter a valid postal code";var ReviewSuccessURL,fromSubmitReview=!1;function popupSignInRegModal(successURL,submitReviewURL){return fromSubmitReview=!0,ReviewSuccessURL=successURL,showLogonModal(),!1}function read_cookie(key){var result;return(result=new RegExp("(?:^|; )"+key+"=([^;]*)").exec(document.cookie))?result[1]:null}function enableNavFocus(){var current=null;$("li.top-level > a:first-child").focus((function(){null!=current&&current.nextAll().hide(),(current=$(this)).nextAll().show();var parent=current.parent();if(!parent.hasClass("exam")&&!parent.hasClass("eyeglasses")&&!parent.hasClass("savings")){var offsetLeft=current.offset().left,offsetLeftEyeglasses=$(".top-level.eyeglasses").offset().left;current.nextAll(".subnav").css("transform","translateX(-"+(parseInt(offsetLeft)-parseInt(offsetLeftEyeglasses)+17)+"px)")}}))}function popUpFavoritesStoreLocModal(catEntryId){$("#StoreLocatorPdpModelDiv"+catEntryId).dialog("open")}function hideSaveFavorites(){$(".save-favorites-modal-text").hide(),$.cookie("saveFavoritesHidePrompt","1",{path:"/"})}function closeYourLook(){isOpen=!1,$("#PlanYourVisitDiv").attr("aria-hidden","true").slideUp("400"),$("li.plan-visit").removeClass("on"),removeUIoverlay(),$(".ui-widget-overlay").removeClass("lower-zindex"),$("#header_wrapper").removeClass("height-for-plan-visit-dropdown")}var sliderModification=void $("document").ready((function(){$("#zone1 .slideshow .ad_product .info").last().css({"margin-top":"40px"}),$("#zone1 .slideshow .ad_product .info h1").last().css({color:"#1f1f1f"}),$("#zone1 .slideshow .ad_product:eq(2) .info h1").css({color:"#1f1f1f"}),$("#zone1 .slideshow .ad_product .info br").last().remove(),$("#zone1 .slideshow .ad_product:eq(2) .info p, #zone1 .slideshow .ad_product:eq(3) .info p").css({color:"#1f1f1f","font-family":"verdana"}),$(".banner-landing-image .ad_product div br").remove(),$(".banner-landing-image.lens-landing .info p").css({"font-size":"13px !important","line-height":"19px !important"})}));function highlightLeftNav(itemToHighlight){var leftNav=$("#leftNav"),leftNavItem=leftNav.find("ul li"),highlightItem=leftNav.find("."+itemToHighlight);leftNavItem.removeClass("selected"),highlightItem.addClass("selected"),(highlightItem.hasClass("acct-profile-link")||highlightItem.hasClass("acct-landing"))&&(highlightItem.addClass("leftNavProfileSelected").removeClass("selected"),highlightItem.find(".heading a").addClass("selected"));var acctProfileFocus=highlightItem.parent().parent();$(acctProfileFocus).addClass("leftNavProfileSelected")}function initTopNavigationLinkHandlers(){$("#link_product_style").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style"})})),$("#link_men").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Men"}),console.log("top nav event fired")})),$("#link_women").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Women"})})),$("#link_kids").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Kids"})})),$("#link_eyeglasses").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Eyeglases"})})),$("#link_sunglasses").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Sunglasses"})})),$("#link_lenses").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Lenses"})})),$("#link_contactlenses").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Contact Lenses"})})),$("#link_accessories").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Accessories"})})),$("#link_prescription_sport").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Prescription Sport"})})),$("#link_prescription_safety").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Prescription Safety"})})),$("#link_brands").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Brands"})})),$("#link_trends").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Trends"})})),$("#link_collections").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Collections"})})),$("#link_eyecare_service").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service"})})),$("#link_schedule_an_eyeexam_top").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Schedule an Eye Exam"})})),$("#link_storelocations").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Store Locations"})})),$("#link_accufit").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Accufit"})})),$("#link_mylook").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | My look"})})),$("#link_lenssimulator").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Lenssimulator"})})),$("#link_visionguide").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Visionguide"})})),$("#link_doctors_office").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Doctor's office"})})),$("#link_onsite_lab").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | On-site Lab"})})),$("#eyecare_service_link_visit_customer_service").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Visit Customer Service"})})),$("#eyecare_service_link_purchasecare").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Purchase Care"})})),$("#eyecare_service_link_faqs").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | FAQs"})})),$("#eyecare_service_link_contact_us").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Contact Us"})})),$("#link_seeing_eyeexams").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Seeing Eye Exams"})})),$("#eyecare_service_link_schedule_an_eyeexam_bottom").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Schedule an Eye Exam"})})),$("#link_savings").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings"})})),$("#link_offers_and_discounts").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Offers and Discounts"})})),$("#link_insurance").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Insurance"})})),$("#link_lenscrafters_creditcards").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Lenscrafters credit card"})})),$("#savings_link_visit_customer_service").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Visit Customer Service"})})),$("#savings_link_purchasecare").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Purchase Care"})})),$("#savings_link_faqs").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | FAQs"})})),$("#savings_link_contact_us").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Contact Us"})})),$("#savings_link_schedule_an_eyeexam_bottom").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Schedule an Eye Exam"})})),$("#link_ourvision").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision"})})),$("#link_about_lenscrafters").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | About Lenscrafters"})})),$("#link_ourstores").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Our Stores"})})),$("#link_onesight").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Onesight"})})),$("#link_ourblog").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Our Blog"})})),$("#ourvision_link_visit_customer_service").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Visit Customer Service"})})),$("#ourvision_link_purchasecare").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Purchase Care"})})),$("#ourvision_link_faqs").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | FAQs"})})),$("#ourvision_link_contact_us").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Contact Us"})})),$("#ourvision_link_schedule_an_eyeexam_bottom").click((function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Schedule an Eye Exam"})})),console.log("initialized")}function catalogScroll(){var isSearchPage=$("body").hasClass("catalog-search-page");($("body").hasClass("catalog-page")||isSearchPage)&&$(window).scroll((function(){var $top=$(this).scrollTop(),$bannerExists=$("#global-banner").length>0,$tabsExist=$(".search-tabs").length>0,defaultHeightSearch=$bannerExists?235:185,$bannerHeight=$bannerExists?$("#global-banner").outerHeight():0,$searchBannerHeight=$(".search-espots img").length>0?155:0,finalHeightSearch=$bannerExists?defaultHeightSearch+$searchBannerHeight:defaultHeightSearch-$bannerHeight+$searchBannerHeight;finalHeightSearch=$tabsExist?finalHeightSearch:finalHeightSearch-95;$facetHolderPosition=isSearchPage?148:118,$facetHolderPosition=118,$linePosition=isSearchPage?186:156,$linePosition=$tabsExist?$linePosition:156,$searchTabs=99,setFixed=function(){$(".facet-holder, .products_holder, #header-line, .search-tabs").addClass("fixed"),$(".facet-holder").css("top",$facetHolderPosition+"px"),$(".info.search-tab").find("a").hasClass("on")?$("#header-line").css("top","148px"):$("#header-line").css("top",$linePosition+"px"),$(".search-tabs").css("top",$searchTabs+"px")},$top>=($bannerExists?118:118-$bannerHeight)&&!isSearchPage||$top>=finalHeightSearch&&isSearchPage?setFixed():($(".facet-holder, .products_holder, #header-line, .search-tabs").removeClass("fixed"),$(".facet-holder, #header-line").css("top","0px"),$(".search-tabs").css("top","-6px"))}))}function recoModalOpen(){$("#recoModal").dialog({width:490,modal:!0,autoOpen:!0,open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove()}})}function switchImageViews(){$("#loadButton").click((function(){window.lazyLoaded||($(".lazyLoadClass").lazyload(),window.lazyLoaded={})})),$("#front-view").click((function(){return $("#view-switcher").find(".active").removeClass("active"),$(this).addClass("active"),$(".catEntry_Image_PLP").each((function(){$(this).closest(".image-holder").removeClass("front-view quarter-view").addClass("front-view");var other=$(this).siblings(".catEntry_Image_PLP_Alt"),src=$(this).attr("src"),otherSrc=other.attr("src");src!=otherSrc&&(src=(src=src.replace("_fr","_qt")).replace("_qt","_fr"),$(this).attr("src",src),otherSrc=(otherSrc=otherSrc.replace("_qt","_fr")).replace("_fr","_qt"),other.attr("src",otherSrc))})),data={site_events:["change_view_option"],view_option_name:"front"},callTrackAnalytics(data),!1})),$("#quarter-view").click((function(){return $("#view-switcher").find(".active").removeClass("active"),$(this).addClass("active"),$(".catEntry_Image_PLP").each((function(){$(this).closest(".image-holder").removeClass("front-view quarter-view").addClass("quarter-view");var other=$(this).siblings(".catEntry_Image_PLP_Alt"),src=$(this).attr("src"),otherSrc=other.attr("src");src!=otherSrc&&(src=(src=src.replace("_qt","_fr")).replace("_fr","_qt"),$(this).attr("src",src),otherSrc=(otherSrc=otherSrc.replace("_fr","_qt")).replace("_qt","_fr"),other.attr("src",otherSrc))})),data={site_events:["change_view_option"],view_option_name:"3/4 view"},callTrackAnalytics(data),!1}))}function recoLinkClick(){$(".reco-link").live("click",(function(){recoModalOpen()}))}function toggleThumbnailImage(activeImg,inactiveImg,currentItem){$this=$(currentItem),".catEntry_Image_PLP_Alt"==inactiveImg&&void 0!==$this.find(inactiveImg).attr("data-original")&&$this.find(inactiveImg).attr("src",$this.find(inactiveImg).attr("data-original")),$this.find(activeImg).hide(),$this.find(inactiveImg).show()}function refreshNotifications(){var thisUrl=getAbsoluteURL()+"AjaxAccountNotificationsView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:thisUrl,dataType:"html",success:function(response){if(0==$(response).find(".sessionTimeoutPage").length&&response.indexOf("totalNoOfAlerts")>0){document.getElementById("ajaxRefreshNotifications").innerHTML=response;var counter=document.getElementById("totalNoOfAlerts").value;counter>0&&("undefined"==(document.getElementById("notification-click"),!1)&&(document.getElementById("notification-click").style.display="inline-block"),"undefined"==(document.getElementById("notificationsDisplayDiv"),!1)&&(document.getElementById("notificationsDisplayDiv").textContent=counter),$("#header-myaccount-notify").removeClass("has-notification").addClass("has-notification"),$("#notificationsDisplayDiv").hover((function(){$(this).attr("title","notification("+$("#notificationsDisplayDiv").text()+")")})))}}})}function geoLocationSchedule(){if(constants.isExamsNearMeEnabled&&(null!=document.getElementById("rightNavPromoDefault")||null!=document.getElementById("topNavPromoSuccess"))){var myLat=$.cookie("lc_latitude"),myLog=$.cookie("lc_longitude");null!=myLat&&""!=myLat&&null!=myLog&&""!=myLog&&ifGeoLocationAllowed(myLat,myLog)}}function ifGeoLocationAllowed(myLat,myLog){var thisUrl=getAbsoluteURL()+"AjaxGetGeoLocationScheduleView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&latitude="+myLat+"&longitude="+myLog;$.ajax({url:thisUrl,dataType:"json",success:function(response){"success"==response.status&&checkEpointmentAndPopulateWidget(response)}})}function checkEpointmentAndPopulateWidget(geoResponse){var thisUrl=getAbsoluteURL()+"AjaxGetAppointmentListForWidgetCmd?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&storeNumber="+geoResponse.storeNumber;$.ajax({url:thisUrl,dataType:"json",success:function(eppResponse){if("success"==eppResponse.status){try{document.getElementById("widgetExamCenter").innerHTML=geoResponse.storeName+"<br>"+geoResponse.storeAddressLine,document.getElementById("widgetFirstAvailableDate").innerHTML=eppResponse.firstAvailableDate,document.getElementById("widgetSecondAvailableDate").innerHTML=eppResponse.secondAvailableDate,document.getElementById("widgetThirdAvailableWeekendDate").innerHTML=eppResponse.thirdAvailableWeekendDate,document.getElementById("widgetFirstAvailableTime").innerHTML=eppResponse.firstAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("widgetSecondAvailableTime").innerHTML=eppResponse.secondAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("widgetThirdAvailableWeekendTime").innerHTML=eppResponse.thirdAvailableWeekendTime.replace(":",'<span class="colon">:</span>'),document.getElementById("widgetUrl").href=geoResponse.url,document.getElementById("rightNavPromoDefault").style.display="none",document.getElementById("rightNavPromoSuccess").style.display="block"}catch(err){}try{document.getElementById("navExamCenter").innerHTML=geoResponse.storeName+", "+geoResponse.storeAddressLine,document.getElementById("navMiles").innerHTML=geoResponse.miles+" Mi",document.getElementById("navFirstAvailableDate").innerHTML=eppResponse.firstAvailableDate,document.getElementById("navSecondAvailableDate").innerHTML=eppResponse.secondAvailableDate,document.getElementById("navThirdAvailableWeekendDate").innerHTML=eppResponse.thirdAvailableWeekendDate,document.getElementById("navFirstAvailableTime").innerHTML=eppResponse.firstAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("navSecondAvailableTime").innerHTML=eppResponse.secondAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("navThirdAvailableWeekendTime").innerHTML=eppResponse.thirdAvailableWeekendTime.replace(":",'<span class="colon">:</span>'),document.getElementById("navUrl").href=geoResponse.url,document.getElementsByClassName("top-level eyecare")[0].getElementsByClassName("subnav")[0].getElementsByClassName("column image-spots")[0].getElementsByClassName("image-holder")[0].firstElementChild.innerHTML=document.getElementById("topNavPromoSuccess").innerHTML}catch(err){}}}})}function resetRightNavWidget(){$("#rightNavPromoSuccess")&&$("#rightNavPromoDefault")&&($("#rightNavPromoSuccess").hide(),$("#rightNavPromoDefault").show())}function checkMobile(phoneWrapClass){if($(phoneWrapClass+" :visible").find("select :selected").text().indexOf("Mobile")>-1)return!0}function showMultiplePDModal(){showStandardModal("#MultiplePDModal","multiple-modal")}function showPDModal(){showStandardModal(".PDModal","pd-modal")}function removeNullEntries(currentObject){var newObj=[];return $.each(currentObject,(function(key,val){void 0===val||null==val||"null"==val||newObj.push(val)})),newObj}function showStandardModal(modalSelector,modalClass){var $modal=$(modalSelector);if($modal.length<1)return!1;$modal.dialog({modal:!0,resizeable:!1,width:"520px",dialogClass:modalClass+" standard-modal"})}function executeBackButtonStep3(){try{for(var lockArray=document.getElementById("activeLockIds").value.split(","),examToGoBack="",i=2;i>=0;i--)if(null!=lockArray[i]&&""!=lockArray[i].trim()){examToGoBack=i+1;break}return document.getElementById("BackbuttonLink").href=""!=examToGoBack?document.getElementById("ScheduleExamReview_EditExam_Link"+examToGoBack).href.replace("&mobile=true",""):document.getElementsByClassName("AddAnotherExamLink").href,!0}catch(e){return!1}}function addSyncValueToDbForEyeExam(consentFormStepfour){var pf=$(consentFormStepfour);$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:pf.serializeArray(),dataType:"json",crossDomain:!0,success:function(data){document.getElementById("consentFormStepfour").style.display="none",document.getElementById("syncExamAgree").style.display="block"}})}function checkStepFourSync(){$("#consentFormsubmit").on("click",(function(){$("#consentFormStepfour").valid()&&addSyncValueToDbForEyeExam($("#consentFormStepfour"))})),$("#consentFormStepfour").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{consentCheckbox:{required:!0}},messages:{consentCheckbox:MessageHelper.messages.ERROR_CONSENT_CHECKBOX_APPOINTMENT},errorPlacement:function(error,element){for(var noErrorElements=[],found=!1,i=0;i<noErrorElements.length;i++)found=found||noErrorElements[i]==element.attr("name");found||"consentCheckbox"==$(element).attr("name")&&($(error).css({float:"none",display:"block"}).insertAfter($(element).next()),element.siblings("label").append(error).addClass("validationError")),error_list.push(error.text())}})}function stepFourManageExam(){$("#regExam").on("click",(function(){$("#userRegModelFormExam").valid()})),$("#userRegModelFormExam").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",rules:{optin_18yrs:{required:!0},dob1_1:{eyeExamValidDOB:!0,eyeExamValidLeapYear:!0,required:!0},dob1_2:{eyeExamValidDOB:!0,eyeExamValidLeapYear:!0,required:!0},dob1_3:{eyeExamValidDOB:!0,eyeExamValidLeapYear:!0,required:!0}},messages:{optin_18yrs:MessageHelper.messages.ERROR_18_CERTIFY,dob1_1:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dob1_2:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dob1_3:{required:MessageHelper.messages.BDAY_FIELDS_REQ}},errorPlacement:function(error,element){for(var noErrorElements=[],found=!1,i=0;i<noErrorElements.length;i++)found=found||noErrorElements[i]==element.attr("name");found||("optin_18yrs"==$(element).attr("name")?($(error).css({float:"none",display:"block"}).insertAfter($(element).next()),element.siblings("label").append(error).addClass("validationError")):-1!=$(element).attr("name").indexOf("dob")?element.parent().append(error).addClass("validationError"):$(error).addClass("validationError").insertAfter(element)),error_list.push(error.text()),$(error).attr("tabindex","0"),$(error).attr("aria-label",error.text())},showErrors:function(errorMap,errorList){this.defaultShowErrors(),$(".dobfield span.required:visible").filter((function(i){return 0!=i})).hide()},highlight:function(element,errorClass){$(element).addClass("required"),$(element).parent().addClass("validationError")},unhighlight:function(element,errorClass){$(element).removeClass("required"),$(element).parent().removeClass("validationError")}})}function storeStep3session(){try{"undefined"!=typeof Storage&&-1!=window.location.href.indexOf("AjaxStoreLocatorDisplayView")&&sessionStorage.setItem("Step3_Visited",!1),"undefined"!=typeof Storage&&-1!=window.location.href.indexOf("ReviewExamView")&&sessionStorage.setItem("Step3_Visited",!0),"true"==sessionStorage.getItem("Step3_Visited")&&-1!=window.location.href.indexOf("ScheduleExamView")?$(".fe .schedule-actions-buttons .backbuttonhide").remove():("false"==sessionStorage.getItem("Step3_Visited")&&window.location.href.indexOf("ScheduleExamView"),$(".fe .schedule-actions-buttons .cancelbuttonhide").remove(),$(".fe .schedule-actions-buttons .backbuttonhide").show())}catch(err){}}function invokeLazyLoad(){void 0!==$.fn.lazyload&&$("img.lazy").lazyload({effect:"fadeIn",threshold:100,skip_invisible:!0}).on("load",(function(){var $this=$(this);$this.closest(".lazy-container").find(".loader").remove(),$(this).hasClass("catEntry_Image_PLP_Alt")&&!$(this).hasClass("not-hide")&&$(this).hide(),$this.closest(".image-holder").hasClass("quarter-view")&&($this.hasClass("catEntry_Image_PLP")?($this.attr("src",$this.attr("src").replace("_qt","_fr")),$this.attr("src",$this.attr("src").replace("_fr","_qt"))):$this.hasClass("catEntry_Image_PLP_Alt")&&($this.attr("src",$this.attr("src").replace("_fr","_qt")),$this.attr("src",$this.attr("src").replace("_qt","_fr"))),$(this).off("load"))})).each((function(){this.complete&&$(this).trigger("load")}))}function toggleThumbnailImageOnHover(){$(".catEntry_Image_PLP").closest(".item").hover((function(){toggleThumbnailImage($(this).find(".catEntry_Image_PLP"),$(this).find(".catEntry_Image_PLP_Alt"),$(this))}),(function(){toggleThumbnailImage($(this).find(".catEntry_Image_PLP_Alt"),$(this).find(".catEntry_Image_PLP"),$(this))}))}function invokeLazyLoadOldImage(){$(".products_holder img.lazy").lazyload({skip_invisible:!1}).on("load",(function(){$(this).closest(".lazy-container").find(".loader").remove(),$(".products_holder .catEntry_Image_PLP_Alt").hasClass("not-hide")||$(".products_holder .catEntry_Image_PLP_Alt").hide()})).each((function(){this.complete&&$(this).trigger("load")}))}function invokeLazyLoadAfterNewImageAppend(){$(".products_holder img.lazy.yetToload").lazyload({skip_invisible:!1}).load((function(){var $this=$(this);$this.closest(".lazy-container").find(".loader").remove(),$this.hasClass("catEntry_Image_PLP_Alt")&&$this.hide(),$this.hasClass("yetToload")&&$this.removeClass("yetToload")}))}function updateCompareBox(){var compareItems=$.cookie("CompareItems_"+constants.ajaxParams.storeId);if(null!=compareItems){compareItems=compareItems.split(";");for(var i=0;i<compareItems.length;i++)try{$("#compare_"+compareItems[i]).prop("checked","true"),$("#compare_"+compareItems[i]).parent("label").addClass("on"),$("#compare_"+compareItems[i]).closest(".item").addClass("selected")}catch(exception){console.error(exception)}}}$("document").ready((function(){if(null!=document.getElementById("clickAppointment")&&document.getElementById("clickAppointment").value){var timeDiff=(new Date).valueOf()-(new Date).valueOf(),sessiontimeOut=$(".sessionDuration").val()||"";timeDiff>=sessiontimeOut&&""!=sessiontimeOut?window.location.reload():$("#EyeExamsModalDiv").dialog("open")}var showWaitModal=$(".showWaitModal").val()||"",eyeExamDelayTimeMs=$("#eyeExamDelayTimeMs").val()||"";"true"===showWaitModal&&""!==showWaitModal&&($(".showWaitModalContainer").dialog("open"),setTimeout((function(){$(".showWaitModalContainer").dialog("close")}),eyeExamDelayTimeMs),window.location.href=$("#EyeExamHistoryURLVal").val())})),window.addEventListener?window.addEventListener("message",(function(e){try{var data=$.parseJSON(e.data);$("#rightNowContainer, #rightNowWrapper").height(data.height)}catch(e){}})):window.attachEvent("onmessage",(function(e){try{var data=$.parseJSON(e.data);if(!_.isEmpty(data)&&_.isNumber(data.height)){var bufferHeight=data.height+100;$("#rightNowContainer, #rightNowWrapper").height(bufferHeight)}}catch(e){}})),function($){$(document).ready((function(){setTimeout((function(){$(".orangeFill").each((function(){var $this=$(this);$this.val()&&$this.val()!=$this.attr("placeholder")?$this.addClass("ok"):$this.removeClass("ok")}))}),1e3),setTimeout((function(){$(".contact-section-number.orangeFill").each((function(){var $this=$(this);""===$this.find("input[name=phone1_1]").val()||""===$this.find("input[name=phone1_2]").val()||""===$this.find("input[name=phone1_3]").val()?$this.removeClass("ok"):$this.addClass("ok")}))}),1e3)})),$(document).on("change focusout focus","input.orangeFill, select.orangeFill",(function(e){var $this=$(this);"focusin"==e.type?($this.removeClass("orangeFill"),$this.addClass("ok")):($this.val($.trim($this.val())),""===$this.val()?$this.removeClass("ok"):$this.addClass("ok"))})),$(document).on("change focusout focus",".contact-section-number.orangeFill",(function(e){var $this=$(this);"focusin"==e.type?$this.addClass("ok"):""===$this.find("input[name=phone1_1]").val()||""===$this.find("input[name=phone1_2]").val()||""===$this.find("input[name=phone1_3]").val()?$this.removeClass("ok"):$this.addClass("ok")})),$(document).on("change focusout focus",".dob_field1.orangeFill",(function(e){var $this=$(this);"focusin"==e.type||""!==$this.find("input[name=dob1_1]").val()||""!==$this.find("input[name=dob1_2]").val()||""!==$this.find("input[name=dob1_3]").val()?$this.addClass("ok"):""!==$this.find("input[name=dob1_1]").val()&&""!==$this.find("input[name=dob1_2]").val()&&""!==$this.find("input[name=dob1_3]").val()||$this.removeClass("ok")}))}(jQuery),jQuery.fn.extend({trap:function(){if(!this.jquery)return!1;var $allFields=this.find("a:visible, input:visible").not(':[tabindex="-1"]'),$firstField=$allFields.first(),$lastField=$allFields.last();$firstField.on("keydown",(function(e){9===(e.keyCode||e.which)&&e.shiftKey&&(e.preventDefault(),$lastField.focus())})),$lastField.on("keydown",(function(e){9!==(e.keyCode||e.which)||e.shiftKey||(e.preventDefault(),$firstField.focus())}))}}),jQuery,$.fn.extend({initCarousel:function(){var $carousel=$(this);$carousel.owlCarousel({navigation:!$carousel.attr("data-navigation")||"true"===$carousel.attr("data-navigation"),slideSpeed:300,paginationSpeed:400,singleItem:!0,autoPlay:!$carousel.attr("data-autoplay")||"true"===$carousel.attr("data-autoplay"),addClassActive:!0,afterInit:function(){},afterMove:function(){},startDragging:function(){this.stop()}})}}),function($){$.fn.basicTabs=function(options){var settings=$.extend({active_class:"is-active",open_class:"is-open",list_class:"c-tabs",starting_tab:1},options);$("."+settings.list_class).each((function(){$(this).children("li:nth-child("+settings.starting_tab+")").children("a").addClass(settings.active_class).next().addClass(settings.open_class).show()})),$("."+settings.list_class).on("click","li > a.c-tabs__link",(function(event){if($(this).hasClass(settings.active_class))event.preventDefault();else{event.preventDefault();var tabs=$(this).closest("."+settings.list_class);tabs.find("."+settings.open_class).removeClass(settings.open_class).hide(),$(this).next().toggleClass(settings.open_class).toggle(),tabs.find("."+settings.active_class).removeClass(settings.active_class),$(this).addClass(settings.active_class)}}))}}(jQuery),function($){$.fn.loading=function(done){return this.pastPosition=this.pastPosition?this.pastPosition:this.css("position"),!0===done?(this.css("position",this.pastPosition?this.pastPosition:"static"),this.find(".loading_overlay").detach().remove()):this.find(".loading_overlay").length||("static"!=this.pastPosition&&"initial"!=this.pastPosition&&"inherit"!=this.pastPosition||this.css("position","relative"),$("<div>").addClass("loading_overlay").appendTo(this)),this},$.fn.loadingStart=function(){return this.loading(!1)},$.fn.loadingDone=function(){return this.loading(!0)},$.fn.redraw=function(){return $(this).each((function(){this.offsetHeight})),this}}(jQuery),$(document).ready((function(){$(document).on("click",".pd-select-one .selectBox-menuShowing",(function(){if($(".drop_down_checkout-selectBox-dropdown-menu").is(":visible")){var _dlCopy=$.extend(!0,{},_dl);_dlCopy.site_events={select_pupillary_distance:"true"};var indexEl=$("#currentItemIndex").val();indexEl>=0&&null!=_dl.products_in_cart&&_dl.products_in_cart.length>indexEl&&(_dlCopy.product=[_dl.products_in_cart[indexEl]]),callTrackAnalytics(_dlCopy)}})),$(".multiple-pd-link").on("click",(function(){return showMultiplePDModal(),!1})),$("#myAccount #right.right-container .small-container.favorites .the-price a").click((function(e){e.preventDefault()})),$(document).on("click","#create-account",(function(){var _dlCopy=$.extend(!0,{},_dl);_dlCopy.site_events={create_an_account_click:"true"},callTrackAnalytics(_dlCopy)})),$(document).on("click","#DoctorInfoURL",(function(){var _dlCopy=$.extend(!0,{},_dl);_dlCopy.site_events={submit_thank_you_page:"true"},callTrackAnalytics(_dlCopy)})),$("#goShoppingAgain").on("click",(function(){var _dlCopy=$.extend(!0,{},_dl);_dlCopy.site_events={submit_prescription_page:"true"},callTrackAnalytics(_dlCopy)})),$("input[name=phone1_1]").keyup((function(){$(this).val(this.value.substring(0,3)),3==this.value.length&&$(this).parents("form").find("input[name=phone1_2]").focus()})),$("input[name=phone1_2]").keyup((function(){$(this).val(this.value.substring(0,3)),3==this.value.length&&$(this).parents("form").find("input[name=phone1_3]").focus()})),$("input[name=phone1_3]").keyup((function(){$(this).val(this.value.substring(0,4))})),$("input[name=dob1_1]").keyup((function(){$("input[name=dob1_1]").val(this.value.substring(0,2)),2==this.value.length&&$("input[name=dob1_2]").focus()})),$("input[name=dob1_2]").keyup((function(){$("input[name=dob1_2]").val(this.value.substring(0,2)),2==this.value.length&&$("input[name=dob1_3]").focus()})),$("input[name=dob1_3]").keyup((function(){$("input[name=dob1_3]").val(this.value.substring(0,4))})),$.validator.addMethod("validAlphaNumberPurchaseSync",(function(value,element){return!!value.match(/^([a-zA-Z0-9]+)$/)}),"Please enter a valid receipt number"),$("#accountPersonalizationForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",onfocusout:!1,rules:{firstName:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")}}},lastName:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},dobMonth:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobYear]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},dobDay:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobYear]").val()||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},dobYear:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}},check_date_of_birth_future:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}},check_date_of_birth:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},phone1_1:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"], form#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm input[name=phone1_2]").val()||""!==$("form#accountPersonalizationForm input[name=phone1_3]").val()}},minlength:3,number:!0},phone1_2:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"], form#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm input[name=phone1_1]").val()||""!==$("form#accountPersonalizationForm input[name=phone1_3]").val()}},minlength:3,number:!0},phone1_3:{required:{depends:function(element){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"], form#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm input[name=phone1_1]").val()||""!==$("form#accountPersonalizationForm input[name=phone1_2]").val()}},minlength:4,number:!0},receiptNumber:{required:{depends:function(element){return $('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}},validAlphaNumberPurchaseSync:{depends:function(element){return $('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}}},messages:{firstName:{required:"Please enter a first name"},lastName:{required:"Please enter a last name"},dobMonth:{required:"Please enter your birthday"},dobDay:{required:"Please enter your birthday"},dobYear:{required:"Please enter your birthday"},phone1_1:{required:"Please enter a phone number",minlength:"Please enter a valid phone number",number:"Please enter a valid phone number"},phone1_2:{required:"Please enter a phone number",minlength:"Please enter a valid phone number",number:"Please enter a valid phone number"},phone1_3:{required:"Please enter a phone number",minlength:"Please enter a valid phone number",number:"Please enter a valid phone number"},receiptNumber:{required:"Please provide a receipt number"}},showErrors:function(errorMap,errorList){if(this.defaultShowErrors(),$(".dateOfBirth span.required:visible").filter((function(i){return 0!=i})).hide(),$(".phoneNumeber span.required:visible").filter((function(i){return 0!=i})).hide(),$('.contact-section-number span.required:contains("Please enter a valid phone number")').length>0&&($('.contact-section-number span.required:visible:contains("Please enter a phone number")').hide(),$('.contact-section-number span.required:contains("Please enter a valid phone number")').first().show()),errorList&&errorList.length){Number.MAX_VALUE;null}$(".contact-section-number span.required:visible").length>0&&($(".contact-section-number").addClass("validationError"),$('#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")?($("#accountPersonalizationForm .smsAgreement").find("span.required").show(),$('#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||$('.contact-section-number span.required:contains("Please enter a phone number")').length>0&&$('.contact-section-number span.required:contains("Please enter a phone number")').hide().parents(".contact-section-number").removeClass("validationError")):$("#accountPersonalizationForm .smsAgreement").find("span.required").hide()),$(".dateOfBirth span.required:visible").length>0?$(".dateOfBirth select").addClass("required"):$(".dateOfBirth select").removeClass("required"),$("#accountPersonalizationForm span.required:visible").length>0&&($('#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")?$("#accountPersonalizationForm .doctorDisplay").find("span.required").show():$("#accountPersonalizationForm .doctorDisplay").find("span.required").hide()),$("#accountPersonalizationForm span.required:visible").length>0&&$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")?$("<span class='required purchaseSync'>To sync purchase history, please complete the highlighted fields above</span>").appendTo(".purchaseHistoryInfo").show():$(".purchaseHistoryInfo .purchaseSync").hide()},submitHandler:function(form){$("form#accountPersonalizationForm").each((function(){var $thisEyeExam=$(this),ConcatPhoneNo=$thisEyeExam.find("input[name=phone1_1]").val()+$thisEyeExam.find("input[name=phone1_2]").val()+$thisEyeExam.find("input[name=phone1_3]").val();$thisEyeExam.find("input[name=phone1]").val(ConcatPhoneNo);var year=$thisEyeExam.find("select[name=dobYear]").val(),month=$thisEyeExam.find("select[name=dobMonth]").val(),day=$thisEyeExam.find("select[name=dobDay]").val();month<10&&(month="0"+month),day<10&&(day="0"+day);var mydate=null;null==year&&""==year||null==month&&""==month||null==day&&""==day||(mydate=year+"-"+month+"-"+day),$thisEyeExam.find("input[name=dateOfBirth]").val(mydate)})),form.submit()},highlight:function(element,errorClass){$(element).addClass("required"),$(element).parent().addClass("validationError")},unhighlight:function(element,errorClass){$(element).removeClass("required"),$(element).parent().removeClass("validationError")}})})),$.validator.addMethod("eyeExamValidDOB",(function(value,element){var month=$("#dob1_1").val(),day=$("#dob1_2").val(),year=$("#dob1_3").val();if(""!=year&&""!=month&&""!=day&&new Date(year,month,day)>new Date)return!1;return!0}),MessageHelper.messages.BDAY_FIELDS_INVALID),$.validator.addMethod("eyeExamValidLeapYear",(function(value,element){var month=$("#dob1_1").val(),day=$("#dob1_2").val(),year=$("#dob1_3").val(),date=new Date(year,month-1,day);return""==year||""==month||""==day||date.getFullYear()==year&&date.getMonth()+1==month&&date.getDate()==day}),MessageHelper.messages.BDAY_FIELDS_INVALID);var scrollProductsObject={};function updateBV(){try{$BV.ui("rr","inline_ratings",{productIds:scrollProductsObject,containerPrefix:"BVRRInlineRating"})}catch(e){console.error("$BV is not defined")}}var loadMoreProduct=!0;function loadMoreFrameResultsDesktop(){loadMoreProduct=!1;var lazyLoadURL=$("input.lazyload_scroll").last().val();""!==lazyLoadURL&&null!=lazyLoadURL&&"false"!==lazyLoadURL&&($(".products_holder").append('<div class="loader"></div>'),$.ajax({url:lazyLoadURL,dataType:"html",success:function(data){$(".products_holder").append(data),loadMoreProduct=!0,setupLabel(),toggleThumbnailImageOnHover(),invokeLazyLoadAfterNewImageAppend(),$(".products_holder").find(".loader").remove()},error:function(jqXHR,textStatus,errorThrown){conole.log("Exception while fetching scroll results"),loadMoreProduct=!0,$(".products_holder").find(".loader").remove()}}))}var tabEvent="click",isTouch="ontouchstart"in window||navigator.msMaxTouchPoints>0;function templateSettings(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{%([\s\S]+?)%\}/g,escape:/\{%-([\s\S]+?)%\}/g}}function loadMoreSearchProducts(){scrollProductsObject={},loadMoreProduct=!1,templateSettings(),window.pageSize||(window.pageSize=24),window.totalCount||(window.totalCount=100),window.totalContentCount||(window.totalContentCount=100),window.AjaxCategoriesDisplayView||(window.AjaxCategoriesDisplayView=""),window.SearchDisplayView||(window.SearchDisplayContentView=""),"https:"==document.location.protocol?window.SearchDisplayView=window.SearchDisplayView.replace(/^http:\/\//i,"https://"):window.SearchDisplayView=window.SearchDisplayView.replace(/^https:\/\//i,"http://"),$(".products_holder").append('<div class="loader"></div>'),$.ajax({url:window.SearchDisplayView,type:"post",data:{beginIndex:window.beginIndex},success:function(result){var widget=$("#moreProductsToDisplay");$(".products_holder").find(".loader").remove(),widget.getProducts({data:result}),window.beginIndex=window.beginIndex+window.scrollPageSize,setupLabel(),toggleThumbnailImageOnHover(),invokeLazyLoadAfterNewImageAppend(),updateCompareBox(),window.beginIndex<window.pageSize&&(loadMoreProduct=!0),result=$.parseJSON(result),$.each(result,(function(i,item){var partNumber=item.upc,urlObject={};urlObject.url=item.url,scrollProductsObject[partNumber]=urlObject})),updateBV(),categoryDisplayJS.updateFavoriteLinks("TopCategoriesDisplay")}})}function loadMoreProducts(){scrollProductsObject={},loadMoreProduct=!1,templateSettings(),window.pageSize||(window.pageSize=20),window.totalCount||(window.totalCount=100),window.totalContentCount||(window.totalContentCount=100),window.AjaxCategoriesDisplayView||(window.AjaxCategoriesDisplayView=""),window.currentItemCount||(window.currentItemCount=12),"https:"==document.location.protocol?window.AjaxCategoriesDisplayView=window.AjaxCategoriesDisplayView.replace(/^http:\/\//i,"https://"):window.AjaxCategoriesDisplayView=window.AjaxCategoriesDisplayView.replace(/^https:\/\//i,"http://"),$(".products_holder").append('<div class="loader"></div>'),$.ajax({url:window.AjaxCategoriesDisplayView,type:"post",data:{beginIndex:window.beginIndex,currentItemCount:window.currentItemCount},success:function(result){var widget=$("#moreProductsToDisplay");$(".products_holder").find(".loader").remove(),widget.getProducts({data:result}),window.beginIndex=window.beginIndex+window.scrollPageSize,window.currentItemCount=window.currentItemCount+window.scrollPageSize,result.indexOf("ESPOT")>1&&(window.beginIndex=window.beginIndex-1),setupLabel(),toggleThumbnailImageOnHover(),invokeLazyLoadAfterNewImageAppend(),updateCompareBox(),window.beginIndex<window.pageSize&&(loadMoreProduct=!0),result=$.parseJSON(result),$.each(result,(function(i,item){var partNumber=item.upc,urlObject={};urlObject.url=item.url,scrollProductsObject[partNumber]=urlObject})),updateBV(),categoryDisplayJS.updateFavoriteLinks("TopCategoriesDisplay")}})}function initCarouselDashboard(){$(this).owlCarousel({margin:10,navigation:!0,slideSpeed:300,items:3,responsive:!0,navigationText:[],autoPlay:!1,addClassActive:!0,afterInit:function(){},afterMove:function(){},startDragging:function(){this.stop()}})}function updateTotalInput(e){e=e||window.event;var inputValue=$("input[name='payment_card_1']").val();if(8!=e.keyCode&&inputValue.length<22){var blocks=$("input[name='payment_card_1']").val().replace(new RegExp(CheckoutPayments.cardSeparator,"g"),"").match(/.{1,4}/g);$("input[name='payment_card_1']").val("");var newValue=$("input[name='payment_card_1']").val();if(null!=blocks){$.each(blocks,(function(index,value){index++,4==value.length&&index<4&&(value+=CheckoutPayments.cardSeparator),newValue+=value}))}$("input[name='payment_card_1']").val(newValue),$("input[name='account1']").val($("input[name='payment_card_1']").val().replace(new RegExp(CheckoutPayments.cardSeparator,"g"),"")),$("input[name='account1']").change()}if(document.getElementById("AMEX").classList.contains("active")&15==inputValue.length){var first4=inputValue.slice(0,4),next6=inputValue.slice(4,10),last5=inputValue.slice(10,15);newValue=first4+" "+next6+" "+last5,$("input[name='payment_card_1']").val(newValue)}}function removeDisabledAttr(){$("#shippingBillingPageNext").removeAttr("disabled")}function updateDateInput(){$(".expdateFinal").val($("select[name='payment_expire_1']").val()+"/"+$("select[name='payment_expire_2']").val().slice(2,4)).change(),removeDisabledAttr()}function incrementShopCartCounter(num){try{void 0===num&&(num=1);var $tahQuantityHeader=$("#tah-quantity-header");$tahQuantityHeader.html(parseInt($tahQuantityHeader.html())+num),$tahQuantityHeader.removeClass("hide")}catch(e){}}function repaint(){$("body").addClass("nothing").removeClass("nothing")}function mouseoverPass(obj){document.getElementById("cc_cvc_1").type="text"}function mouseoutPass(obj){document.getElementById("cc_cvc_1").type="password"}function findGetParameter(parameterName){var result=null,tmp=[];return location.search.substr(1).forEach((function(item){(tmp=item.split("="))[0]===parameterName&&(result=decodeURIComponent(tmp[1]))})),result}function showPassword(id){var x=document.getElementById(id),icon=document.getElementById(id+"-icon");"password"===x.type?(x.type="text",icon.querySelector("use").setAttribute("href","#eye-icon-hide")):(x.type="password",icon.querySelector("use").setAttribute("href","#eye-icon-show"))}isTouch&&(tabEvent="touchstart"),$.fn.extend({initCarouselDashboard:initCarouselDashboard}),$(document).ready((function(){$("#myaccount2_rr").one("DOMSubtreeModified",(function(){setTimeout((function(){$("#myaccount2_rr .carousel-items-container").initCarouselDashboard()}),300)}))})),$(document).ready((function(){$("input[name='doctor-add']").on("change",(function(){$("#doctor-phone").is(":checked")&&($("#doctorPhoneContainer").show(),$("#doctorNameContainer_2").hide()),$("#doctor-name").is(":checked")&&($("#doctorPhoneContainer").hide(),$("#doctorNameContainer_2").show())}));var allTitles=$(".accordion-title"),allPanels=$(".accordion-content").hide();$(".accordion-title").on("click",(function(){return $this=$(this),$target=$this.next(),$target.hasClass("active")?($target.removeClass("active").slideUp(),$this.removeClass("open")):(allPanels.removeClass("active").slideUp(),allTitles.removeClass("open"),$target.addClass("active").slideDown(),$this.addClass("open")),!1})),$("#content_wrapper_box").on("click",".updownCLButton",(function(){$(this).parent().find(".contact-lens-prescription-table").slideToggle(200),$(this).parent().find(".contact-lens-rx-prescription-tables").slideToggle(200),$(this).siblings(".contactLensEdit").toggle(),$(this).toggleClass("open")})),$("#content_wrapper_box").on("click",".contact-lens-modal-prescription",(function(e){e.preventDefault();var prescription=$(this),sourceurl=($(this),$(this).data("url"));$.ajax({url:sourceurl,dataType:"json",success:function(data){$.extend(data,$(prescription).data()),$.extend(data,$("#current-prescription-"+data.orderitemid).serializeObject()),void 0!==data.OLD_R_PRD_POWER&&(data.RIGHT_EYE=!0),void 0!==data.OLD_L_PRD_POWER&&(data.LEFT_EYE=!0);var theTemplateScript=$(".contact-lenses-modal-template").html(),theCompiledHtml=Handlebars.compile(theTemplateScript)(data);$(".contact-lens-selection-area-2").html(theCompiledHtml),$(".contact-lens-selection-area").dialog({modal:!0,resizeable:!1,width:lensSelectDialogWidth,open:function(){var $dialog=$(this).closest(".ui-dialog");$(".contact-lens-selection-area").data("bypassBeforeClose",!1),$dialog.css({top:"15%"}),savePlacement(),$(window).scrollTop(0),$(".ui-widget-overlay").addClass("black-overlay")},close:function(){$(window).scrollTop(getPlacement()),$(this).data("closeTriggered",!1)},dialogClass:"contact-lens-selection-modal"})}})})),$(".cart-wrapper").on("change",".submit-on-change",(function(){var quantity=$(this).val(),quantityOther=$(this).parents(".contact-lens-boxes-table").siblings(".contact-lens-boxes-table").find("select").val(),partNumber=$(this).parents(".cart-item-container").find("input[name='rightLensItemId']").val(),fullQuantity=parseFloat(quantity)+parseFloat(quantityOther);if("undefined"==(utag_data.Products,!1)){utag_data.Products[partNumber].Units=fullQuantity+"";var fullTotalPrice=fullQuantity*parseFloat(utag_data.Products[partNumber].PriceFull),discounts=parseFloat($(this).parents(".cart-item-container").find("input[name='contactDiscount']").val()).toFixed(2);discounts<0&&(discounts*=-1);var discountUnit=discounts/fullQuantity;utag_data.Products[partNumber].Price=(parseFloat(utag_data.Products[partNumber].PriceFull)-discountUnit).toFixed(2)+"";var contactOldSubtotal=parseFloat($(this).parents(".cart-item-container").find(".frameSubtotal").data("contactsubtotal")).toFixed(2),diffSubtotal=parseFloat(fullTotalPrice-contactOldSubtotal).toFixed(2);utag_data.Order_ProductsAmount=parseFloat(utag_data.Order_ProductsAmount)+diffSubtotal}var orderItemId=$(this).data("orderitemid");CheckoutHelperJS.updateContactLensQuantity(orderItemId,null,quantity)})),$("body").on("click",".confirm-contact-lens",(function(){$(".cart-edit-contacts-error-rx").addClass("hide"),contactLensOptions.initContactLensValidator(),LC2.selectedContactLens=$("#contactLensesForm").serializeObject(),$("#contactLensesForm").submit()})),$(document).on("click","#cart-edit-prescription-close",(function(event){event.preventDefault(),$(".ui-dialog-titlebar-close").click()})),$("body").on("click",".updownLensButton",(function(){$(this).next().toggle(),$(this).parent().next().find(".lensDescr").slideToggle(200),$(this).parent().next().next().toggle(),$(this).toggleClass("open")}))})),$(document).ready((function(){$("body").on("click","#s7_spinview_fullScreenButton",(function(){$(".s7spinviewer .s7spinview").toggleClass("pointer-null")}))})),$(document).ready((function(){$(".catEntry_Image_PLP").on("load",(function(e){$(".catEntry_Image_PLP.swicht-qt").each((function(){var src=$(this).attr("src");$(this).after("<p>cambiato!</p>"),$(this).attr("src",$(this).siblings("catEntry_Image_PLP_Alt").attr("src")),$(this).siblings("catEntry_Image_PLP_Alt").attr("src",src),$(this).removeClass("swicht-qt")}))}))})),$(document).ready((function(){$(document).on("click","[class^='SBN_facet_']",(function(){try{var obj={id:"WCS-D-Search-FilterUpdated"}}catch(err){obj={id:"WCS-D-Search-FilterUpdated-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-Search-FilterUpdated",tealium_data2track.push(obj)}})),$(document).on("click","#suggestedKeywordResults [role='listitem']",(function(){try{var obj={Search_Type:"Suggested"}}catch(err){obj={id:"WCS-D-Search_Type-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.Search_Type="Suggested",tealium_data2track.push(obj)}}))})),jQuery.validator.setDefaults({invalidHandler:function(form,validator){try{var obj={id:"Error",Click_FocusElement:this}}catch(err){obj={id:"WCS-D-Form-FillingError-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="Error",tealium_data2track.push(obj)}}}),$(document).ready((function(){$(document).on("click","#rn_FormSubmit_28_Button",(function(){try{var obj={id:"WCS-D-CustomerSupport-MessageForm-ContactUs",Click_FocusElement:this}}catch(err){obj={id:"WCS-D-CustomerSupport-MessageForm-ContactUs-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-CustomerSupport-MessageForm-ContactUs",tealium_data2track.push(obj)}})),$(document).on("click","#ChatLogonOverlaySubmit",(function(){try{var obj={id:"WCS-D-CustomerSupport-ChatForm-ContactUs",Click_FocusElement:this}}catch(err){obj={id:"WCS-D-CustomerSupport-ChatForm-ContactUs-Error",Error_Source:"Server",Error_Code:"utag_data syntax - "+err.message};tealium_data2track.push(obj)}finally{obj.id="WCS-D-CustomerSupport-ChatForm-ContactUs",tealium_data2track.push(obj)}chatNowClicked=!0,utagLinkSafe({link_name:"clickChat"}),$(".chat_error").hide();var focusInput=null;return chatInputHasError("chat_first_name")&&(focusInput=$("#chat_first_name")),chatInputHasError("chat_last_name")&&null==focusInput&&(focusInput=$("#chat_last_name")),chatInputHasError("chat_email")&&null==focusInput&&(focusInput=$("#chat_email")),null!=focusInput?($(focusInput).focus(),!1):($("#chatLoginOverlay").css("display","none"),$("#chatOverlay").css("display","block"),$("#rightNowChatContainer").attr("src",getChatLandingURL()),!1)}))})),$(window).on("load",(function(){$(".selectBox-dropdown-menu").attr("role","complementary"),$(".selectBox-dropdown-menu:nth-of-type(1)").attr("aria-label","Select Box Dropdown Month"),$(".selectBox-dropdown-menu:nth-of-type(2)").attr("aria-label","Select Box Dropdown Day"),$(".selectBox-dropdown-menu:nth-of-type(3)").attr("aria-label","Select Box Dropdown Year"),$("#BVSEO_meta").attr("role","complementary").attr("aria-label","BVSEO Meta"),$("iframe[title='Twitter settings iframe']").removeAttr("scrolling").removeAttr("frameborder").removeAttr("allowtransparency")})),$(document).on("keydown","#lens-selection-modal-tabs",(function(e){var currentActive=$(".select-lens-type.active");39==e.keyCode||40==e.keyCode?(currentActive.next().children(".lens-price-container").children("label").length>0?(currentActive.next().children(".lens-price-container").children("label").addClass("focusmove"),currentActive.removeClass("active"),39==e.keyCode&&currentActive.next().addClass("active")):(currentActive.prev().prev().children(".lens-price-container").children("label").addClass("focusmove"),currentActive.removeClass("active"),39==e.keyCode&&currentActive.prev().prev().addClass("active")),currentActive.children(".lens-price-container").children("label").removeClass("focusmove")):37!=e.keyCode&&38!=e.keyCode||(currentActive.prev().children(".lens-price-container").children("label").length>0?(currentActive.prev().children(".lens-price-container").children("label").addClass("focusmove"),currentActive.removeClass("active"),37==e.keyCode&&currentActive.prev().addClass("active")):(currentActive.next().next().children(".lens-price-container").children("label").addClass("focusmove"),currentActive.removeClass("active"),37==e.keyCode&&currentActive.next().next().addClass("active")),currentActive.children(".lens-price-container").children("label").removeClass("focusmove"))})),$(document).on("click","#lens-selection-modal-tabs ul",(function(e){if($("#lens-selection-modal-tabs").children("ul").children().length>1){var tabtorefer=$("#lens-selection-modal-tabs").children("ul").children("div").children("a").filter(".active")[0].href.substring($("#lens-selection-modal-tabs").children("ul").children("div").children("a").filter(".active")[0].href.indexOf("#tab"));$(".tab-panes").children().filter(tabtorefer).children("div").children().first().addClass("active"),$(".tab-panes").children().not(tabtorefer).children("div").children().removeClass("active"),$(".tab-panes").children().not(tabtorefer).children("div").children(".select-lens-type").children(".lens-price-container").children("label").removeClass("focusmove"),selectedDefaultValue=!0}})),$(document).on("click",".button.HPBtn, .hp-zone1 .img-container a",(function(e){try{tealium_data2track.push({id:"Click",Click_FocusElement:this,Tracking_Type:"hiddenaction"})}catch(err){console.log(err.message)}}));var sha256=function sha256(ascii){if((str=ascii)&&!/^\s*$/.test(str)){var str;ascii=ascii.toLowerCase().trim();for(var i,j,mathPow=Math.pow,maxWord=mathPow(2,32),result="",words=[],asciiBitLength=8*ascii.length,hash=sha256.h=sha256.h||[],k=sha256.k=sha256.k||[],primeCounter=k.length,isComposite={},candidate=2;primeCounter<64;candidate++)if(!isComposite[candidate]){for(i=0;i<313;i+=candidate)isComposite[i]=candidate;hash[primeCounter]=mathPow(candidate,.5)*maxWord|0,k[primeCounter++]=mathPow(candidate,1/3)*maxWord|0}for(ascii+="";ascii.length%64-56;)ascii+="\0";for(i=0;i<ascii.length;i++){if((j=ascii.charCodeAt(i))>>8)return;words[i>>2]|=j<<(3-i)%4*8}for(words[words.length]=asciiBitLength/maxWord|0,words[words.length]=asciiBitLength,j=0;j<words.length;){var w=words.slice(j,j+=16),oldHash=hash;for(hash=hash.slice(0,8),i=0;i<64;i++){var w15=w[i-15],w2=w[i-2],a=hash[0],e=hash[4],temp1=hash[7]+(rightRotate(e,6)^rightRotate(e,11)^rightRotate(e,25))+(e&hash[5]^~e&hash[6])+k[i]+(w[i]=i<16?w[i]:w[i-16]+(rightRotate(w15,7)^rightRotate(w15,18)^w15>>>3)+w[i-7]+(rightRotate(w2,17)^rightRotate(w2,19)^w2>>>10)|0);(hash=[temp1+((rightRotate(a,2)^rightRotate(a,13)^rightRotate(a,22))+(a&hash[1]^a&hash[2]^hash[1]&hash[2]))|0].concat(hash))[4]=hash[4]+temp1|0}for(i=0;i<8;i++)hash[i]=hash[i]+oldHash[i]|0}for(i=0;i<8;i++)for(j=3;j+1;j--){var b=hash[i]>>8*j&255;result+=(b<16?0:"")+b.toString(16)}return result}function rightRotate(value,amount){return value>>>amount|value<<32-amount}},MD5=function(string){if((str=string)&&!/^\s*$/.test(str)){var str;string=string.toLowerCase().trim();var k,AA,BB,CC,DD,a,b,c,d,x=Array();for(string=function(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext}(string),x=function(string){for(var lWordCount,lMessageLength=string.length,lNumberOfWords_temp1=lMessageLength+8,lNumberOfWords=16*((lNumberOfWords_temp1-lNumberOfWords_temp1%64)/64+1),lWordArray=Array(lNumberOfWords-1),lBytePosition=0,lByteCount=0;lByteCount<lMessageLength;)lBytePosition=lByteCount%4*8,lWordArray[lWordCount=(lByteCount-lByteCount%4)/4]=lWordArray[lWordCount]|string.charCodeAt(lByteCount)<<lBytePosition,lByteCount++;return lBytePosition=lByteCount%4*8,lWordArray[lWordCount=(lByteCount-lByteCount%4)/4]=lWordArray[lWordCount]|128<<lBytePosition,lWordArray[lNumberOfWords-2]=lMessageLength<<3,lWordArray[lNumberOfWords-1]=lMessageLength>>>29,lWordArray}(string),a=1732584193,b=4023233417,c=2562383102,d=271733878,k=0;k<x.length;k+=16)AA=a,BB=b,CC=c,DD=d,a=FF(a,b,c,d,x[k+0],7,3614090360),d=FF(d,a,b,c,x[k+1],12,3905402710),c=FF(c,d,a,b,x[k+2],17,606105819),b=FF(b,c,d,a,x[k+3],22,3250441966),a=FF(a,b,c,d,x[k+4],7,4118548399),d=FF(d,a,b,c,x[k+5],12,1200080426),c=FF(c,d,a,b,x[k+6],17,2821735955),b=FF(b,c,d,a,x[k+7],22,4249261313),a=FF(a,b,c,d,x[k+8],7,1770035416),d=FF(d,a,b,c,x[k+9],12,2336552879),c=FF(c,d,a,b,x[k+10],17,4294925233),b=FF(b,c,d,a,x[k+11],22,2304563134),a=FF(a,b,c,d,x[k+12],7,1804603682),d=FF(d,a,b,c,x[k+13],12,4254626195),c=FF(c,d,a,b,x[k+14],17,2792965006),a=GG(a,b=FF(b,c,d,a,x[k+15],22,1236535329),c,d,x[k+1],5,4129170786),d=GG(d,a,b,c,x[k+6],9,3225465664),c=GG(c,d,a,b,x[k+11],14,643717713),b=GG(b,c,d,a,x[k+0],20,3921069994),a=GG(a,b,c,d,x[k+5],5,3593408605),d=GG(d,a,b,c,x[k+10],9,38016083),c=GG(c,d,a,b,x[k+15],14,3634488961),b=GG(b,c,d,a,x[k+4],20,3889429448),a=GG(a,b,c,d,x[k+9],5,568446438),d=GG(d,a,b,c,x[k+14],9,3275163606),c=GG(c,d,a,b,x[k+3],14,4107603335),b=GG(b,c,d,a,x[k+8],20,1163531501),a=GG(a,b,c,d,x[k+13],5,2850285829),d=GG(d,a,b,c,x[k+2],9,4243563512),c=GG(c,d,a,b,x[k+7],14,1735328473),a=HH(a,b=GG(b,c,d,a,x[k+12],20,2368359562),c,d,x[k+5],4,4294588738),d=HH(d,a,b,c,x[k+8],11,2272392833),c=HH(c,d,a,b,x[k+11],16,1839030562),b=HH(b,c,d,a,x[k+14],23,4259657740),a=HH(a,b,c,d,x[k+1],4,2763975236),d=HH(d,a,b,c,x[k+4],11,1272893353),c=HH(c,d,a,b,x[k+7],16,4139469664),b=HH(b,c,d,a,x[k+10],23,3200236656),a=HH(a,b,c,d,x[k+13],4,681279174),d=HH(d,a,b,c,x[k+0],11,3936430074),c=HH(c,d,a,b,x[k+3],16,3572445317),b=HH(b,c,d,a,x[k+6],23,76029189),a=HH(a,b,c,d,x[k+9],4,3654602809),d=HH(d,a,b,c,x[k+12],11,3873151461),c=HH(c,d,a,b,x[k+15],16,530742520),a=II(a,b=HH(b,c,d,a,x[k+2],23,3299628645),c,d,x[k+0],6,4096336452),d=II(d,a,b,c,x[k+7],10,1126891415),c=II(c,d,a,b,x[k+14],15,2878612391),b=II(b,c,d,a,x[k+5],21,4237533241),a=II(a,b,c,d,x[k+12],6,1700485571),d=II(d,a,b,c,x[k+3],10,2399980690),c=II(c,d,a,b,x[k+10],15,4293915773),b=II(b,c,d,a,x[k+1],21,2240044497),a=II(a,b,c,d,x[k+8],6,1873313359),d=II(d,a,b,c,x[k+15],10,4264355552),c=II(c,d,a,b,x[k+6],15,2734768916),b=II(b,c,d,a,x[k+13],21,1309151649),a=II(a,b,c,d,x[k+4],6,4149444226),d=II(d,a,b,c,x[k+11],10,3174756917),c=II(c,d,a,b,x[k+2],15,718787259),b=II(b,c,d,a,x[k+9],21,3951481745),a=AddUnsigned(a,AA),b=AddUnsigned(b,BB),c=AddUnsigned(c,CC),d=AddUnsigned(d,DD);return(WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d)).toLowerCase()}function RotateLeft(lValue,iShiftBits){return lValue<<iShiftBits|lValue>>>32-iShiftBits}function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;return lX8=2147483648&lX,lY8=2147483648&lY,lResult=(1073741823&lX)+(1073741823&lY),(lX4=1073741824&lX)&(lY4=1073741824&lY)?2147483648^lResult^lX8^lY8:lX4|lY4?1073741824&lResult?3221225472^lResult^lX8^lY8:1073741824^lResult^lX8^lY8:lResult^lX8^lY8}function FF(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(function(x,y,z){return x&y|~x&z}(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function GG(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(function(x,y,z){return x&z|y&~z}(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function HH(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(function(x,y,z){return x^y^z}(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function II(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(function(x,y,z){return y^(x|~z)}(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function WordToHex(lValue){var lCount,WordToHexValue="",WordToHexValue_temp="";for(lCount=0;lCount<=3;lCount++)WordToHexValue+=(WordToHexValue_temp="0"+(lValue>>>8*lCount&255).toString(16)).substr(WordToHexValue_temp.length-2,2);return WordToHexValue}};$(document).on("keydown","div.filter-title",(function(e){13==e.keyCode&&$(this).trigger("click")})),$(document).on("focus",".products_holder .item_container .item",(function(e){$(".products_holder .item_container .item.hover").removeClass("hover"),$(this).addClass("hover")})),$(document).on("hover",".products_holder .item_container .item",(function(e){$(".products_holder .item_container .item.hover").removeClass("hover")})),$(document).on("focus",".control-checkbox .control_indicator",(function(){$("label.focus").removeClass("focus"),$(this).parent().addClass("focus")})),$(document).on("keydown","form#storeSearchForm button.store-search-submit, form#storeSearchFormHeader button.store-search-submit",(function(e){13==e.keyCode&&$(this).trigger("click")}));