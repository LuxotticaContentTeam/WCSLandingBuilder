window.GlassesFunctions=function(){this.transparencyNeeded=!1,this.nextGenEnabled=!0,GlassesFunctions.prototype.setTransparencyNeeded=function(e){this.transparencyNeeded=e},GlassesFunctions.prototype.getTransparencyNeeded=function(){return this.transparencyNeeded},GlassesFunctions.prototype.setNextGenEnabled=function(e){this.nextGenEnabled=e},GlassesFunctions.prototype.getNextGenEnabled=function(){return this.nextGenEnabled},GlassesFunctions.prototype.preLazyLoading=function(e){}},window.glassesFunctions||(window.glassesFunctions=new GlassesFunctions);var modalWidth,forgotWidth,error_list=new Array,signinWidth=-1,currentPage="",products_in_comparison=new Array;modelPWReset=!0,dojo={},dojo.addOnLoad=function(e){$(document).ready(e)},dojo.require=function(){},window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.console.debug||(window.console.debug=function(){}),window.console.error||(window.console.error=function(){}),window.console.info||(window.console.info=function(){}),window.console.warn||(window.console.warn=function(){}),$.extend({getUrlVars:function(){for(var e,a=[],t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<t.length;n++)if(a[(e=t[n].split("="))[0]]){var o=a[e[0]].split("#")[0];o+="&"+decodeURIComponent(e[1]),a[e[0]]=o}else a.push(e[0]),a[e[0]]=decodeURIComponent(e[1]);return a},getUrlVar:function(e){return $.getUrlVars()[e]}}),$.support.cors=!0;var zipRegex,isOpen=!1;function serializeSessionStorage(){var e=[];if(sessionStorage.length>0){for(var a=0;a<sessionStorage.length;a++){var t=sessionStorage.key(a),n=sessionStorage.getItem(t);$.cookie(t,n,{path:"/"}),e.push(t)}$.cookie("sessionStorage",e.join(":"),{path:"/"})}}function deserializeSessionStorage(){var e=$.cookie("sessionStorage");if($.cookie("sessionStorage",null,{path:"/"}),e&&e.length){e=e.split(":");for(var a=0;a<e.length;a++){var t=$.cookie(e[a]);$.cookie(e[a],null,{path:"/"}),sessionStorage[e[a]]=t}}}function eyeExamRemoveEyeExamAnalytics(){var e="us",a="not authenticated",t="not registered";"CA"==constants.ajaxParams.countryName&&(e="ca"),constants.ajaxParams.loggedIn&&(a="authenticated",t="registered"),data={site_events:{remove_eye_exam:!0},site_layout_type:"desktop",country:e,authentication_status:a,registration_status:t},callTrackAnalytics(data)}function eyeExamEditEyeExamAnalytics(){var e="us",a="not authenticated",t="not registered";"CA"==constants.ajaxParams.countryName&&(e="ca"),constants.ajaxParams.loggedIn&&(a="authenticated",t="registered"),data={site_events:{edit_eye_exam:!0},site_layout_type:"desktop",country:e,authentication_status:a,registration_status:t},callTrackAnalytics(data)}function getUserInsuranceEligibilityStatus(){var e="not synced";return constants.ajaxParams.insuranceCheckEligibility&&(e="synced"),e}function utagLinkSafe(){try{utag.link.apply(utag,arguments)}catch(e){console.error(e)}}function utagViewSafe(){try{utag.view.apply(utag,arguments)}catch(e){console.error(e)}}function filterAjaxResponse(e){return e&&"string"==typeof e&&e.length?$.parseJSON(e.replace(/^\s*\/\*/,"").replace(/\*\/\s*$/,"")):e}function invokeResetPasswordService(e,a){return $.ajax({url:getAbsoluteURL()+"AjaxResetPassword",data:e,dataType:"html",type:"post",success:function(e){console.log("reset password response",e);try{console.log("invokeResetPasswordService");var t=e;"string"==typeof t&&(t=filterAjaxResponse(e));var n="#examResetPasswordFailureResponseMessageDiv",o=!0;modelPWReset&&(n="#favoriteSignInModal #ForgotPasswordSection #examResetPasswordFailureResponseMessageDiv");var r=MessageHelper.messages.RediectHomePageURL;if(null==t||(null==t.errorMessage||t.errorMessage.success)&&0!=t.success){if(null!=t&&null!=t.PASSWORDEXPIRED)return $("#header-reset-password-modal").css("display","none"),$("#header-set-a-new-password-modal").css("display","block"),$(".sign-in-link").addClass("open"),removeUIoverlay(),addUIoverlay(),!1;var s="";null!=document.getElementById("currentID")&&(s=document.getElementById("currentID").value),$("#ResetPasswordSuccessFullResponseMessageDiv").length>0&&($("#ResetPasswordFailureResponseMessageDiv").html(""),$("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),a?($("#header-reset-password-done-modal").css("display","block").attr("aria-hidden","false"),$("#sentTempPasswordText").html($("#sentTempPasswordText").html().replace("{0}",s))):($(".ResetPasswordSuccessMsg").show(),$(".ResetPasswordSuccessMsg").html($(".ResetPasswordSuccessMsg").html().replace("{0}",s))),$("#passwordResetSubmitButton").hide()),$("#examResetPasswordSuccessFullResponseMessageDiv").length>0&&$("#examResetPasswordSuccessFullResponseMessageDiv").html(MessageHelper.messages.PASSWORD_RESET_SUCCESS)}else{var i=$("#ResetPasswordErrorMsg").html();$("#ResetPasswordFailureResponseMessageDiv").length>0&&("EXIST_IN_US"==t.errorMessage?($("#ResetPasswordFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$("#ResetPasswordFailureResponseMessageDiv").append("<a target='_blank' href='"+r+"'>"+MessageHelper.messages.LenscrafterUS+"</a>?"),$("#ResetPasswordFailureResponseMessageDiv").css("display","block").attr("aria-hidden","false")):"EXIST_IN_CA"==t.errorMessage?($("#ResetPasswordFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$("#ResetPasswordFailureResponseMessageDiv").append("<a target='_blank' href='"+r+"'>"+MessageHelper.messages.LenscrafterCA+"</a>?").show(),$("#ResetPasswordFailureResponseMessageDiv").css("display","block").attr("aria-hidden","false")):($("#ResetPasswordFailureResponseMessageDiv").html(t.errorMessage),$("#ResetPasswordFailureResponseMessageDiv").css("display","block").attr("aria-hidden","false"))),$(n).length>0&&$(n).html(i),o=!1}modelPWReset&&(modelPWReset=!1),o&&($("#favoriteSignInModal").parent().hide(),$(".ui-widget-overlay").hide())}catch(e){console.error(e)}},error:function(e){if(e)try{var a=filterAjaxResponse(e.responseText),t="#ResetPasswordFailureResponseMessageDiv",n=MessageHelper.messages.RediectHomePageURL;if(modelPWReset&&(t="#favoriteSignInModal #ForgotPasswordSection #examResetPasswordFailureResponseMessageDiv",modelPWReset=!1),a){var o=a.errorMessage;"EXIST_IN_US"==o?($(".ResetPasswordFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".ResetPasswordFailureResponseMessageDiv").append("<a target='_blank' href='"+n+"'>www.lenscrafters.com</a>?").show()):"EXIST_IN_CA"==o?($(".ResetPasswordFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".ResetPasswordFailureResponseMessageDiv").append("<a target='_blank' href='"+n+"'>www.lenscrafters.ca</a>?").show()):a.errorMessage?$(t).length>0&&$(t).html(a.errorMessage):a.errorMessageKey&&$(t).length>0&&$(t).html(a.errorMessageKey)}}catch(e){console.error(e)}}})}function savePlacement(){currentTopPosition=$(window).scrollTop()}function getPlacement(){return currentTopPosition}function stringTemplate(e,a,t){if(t=t||"%",void 0!=a&&null!=e)for(var n in a)for(var o=a[n];-1!=e.indexOf(t+n);)e=e.replace(t+n,o);return e}function removeEmptyUtagEntries(e){$.each(e,function(a,t){void 0!=t&&(""!=t&&null!=t||delete e[a],"string"==typeof t?(t=(t=(t=t.replace(/\\/g,"\\\\")).replace(/'/g,"\\'")).replace(/"/g,'\\"'),document.title=document.title.split(String.fromCharCode(8217)).join("")):e.length<=0&&delete e[a],e[a]=t)})}function scrollToElement(e,a){if(null!=e&&null!=$(e).offset()){var t=2e3;null!=a&&(t=a);var n=$("html, body").clearQueue();0==t?n.scrollTop($(e).offset().top-20):n.animate({scrollTop:$(e).offset().top-20},t,"easeOutQuint")}}function seeEvents(e){var a=$(e),t={};return a.parents().andSelf().map(function(){var e=$(this).data("events");if(e){for(var n in e)for(var o=e[n],r=0;r<o.length;r++){var s=o[r];(null==s.selector||""==s.selector||a.is(s.selector))&&(t[n]||(t[n]=[]),!0,t[n].push(s))}}}),t}function removeExamCookies(){$.cookie("exam1","",{expires:-1,path:"/"}),$.cookie("exam2","",{expires:-1,path:"/"}),$.cookie("exam3","",{expires:-1,path:"/"}),$.cookie("eapptsUserId","",{expires:-1,path:"/"})}function setupPhoneFields(e,a,t){var n=function(e){var a=e.which||e.keyCode;return!e.shiftKey&&!e.altKey&&!e.ctrlKey&&a>=48&&a<=57||a>=96&&a<=105||8==a||9==a||13==a||35==a||36==a||37==a||39==a||46==a||45==a||229==a};$(e).bind("keyup",function(e){3==this.value.length&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105)&&-1==navigator.userAgent.indexOf("Mobile")&&$(a).focus().select()}).bind("keydown",n).bind("input",function(){var e=$(this);(e.val()||"").match(/^\d{0,3}$/)?e.data("current-value",e.val()):e.val(e.data("current-value")||"")}),$(a).bind("keyup",function(e){3==this.value.length&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105)&&-1==navigator.userAgent.indexOf("Mobile")&&$(t).focus().select()}).bind("keydown",n).bind("input",function(){var e=$(this);(e.val()||"").match(/^\d{0,3}$/)?e.data("current-value",e.val()):e.val(e.data("current-value")||"")}),$(a).add(t).bind("keydown",n).focus(function(){$(this).select()}),$(t).bind("input",function(){var e=$(this);(e.val()||"").match(/^\d{0,4}$/)?e.data("current-value",e.val()):e.val(e.data("current-value")||"")})}function addUIoverlay(){var e=$(document).width(),a=$(document).height()+381;0==$(".ui-widget-overlay").length&&$("#footer_wrapper").after('<div class="ui-widget-overlay" style="width:'+e+"px;height:"+a+'px;"></div>')}function removeUIoverlay(){$(".ui-widget-overlay").remove()}function hideAllDialogs(){$(".dialog").hide()}function clearRegisterModelPWDfields(){$("#logonId_perkModel").val(""),$("#logonIdVerify_perks").val(""),$("#logonPassword_perkModel").val(""),$("#logonPasswordVerify_perkModal").val(""),$("#perksheaderEmailAddress").val(""),$("#perks-logonPassword").val(""),$("#optin_18yrs_checkBox_perk").attr("checked",!1),$("#perk-register-modal").css("display","none"),$("#perk-logon-modal").css("display","block")}function RegisterModelPWDfields(){}function logonFormSubmit(e){var a=$(e);if(a.valid()){var t=a.serializeArray(),n=[];myperksURL=null;for(var o=0;o<t.length;o++){var r=t[o];"URL"==r.name&&(r.value,n.push({name:"URL",value:"LogonAjaxView"})),"myPerksRedirectURL"==r.name?(myperksURL=r.value,n.push({name:"URL",value:"LogonAjaxView"})):n.push(r)}$("#LogonForm .logonSubmit").html('<i class="fa fa-spinner fa-spin"></i>Sign in');var s=window.userDetails;$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:n,dataType:"jsonp",crossDomain:!0,timeout:15e3,success:function(e){if(console.log("login form response",e),e.passwordExpired&&"1"==e.passwordExpired){constants.ajaxParams.loggedIn=!0,$(".LogOnFailureResponseMessageDiv").html("Password expired. Please update it.").show(),$(".login-forgot-password-container").removeClass("no-service-messages");var a={id:"Error",Error_Source:"Server",Error_Code:"Login",Error_Details:"Unable to find the profile",Error_Message:"Password expired. Please update it."};tealium_data2track.push(a)}else if(fromSubmitReview)console.log("Submit review");else if(e.success)if(window.location.pathname.endsWith("/ReLogonFormView")||window.location.pathname.endsWith("/AjaxLogonForm"))window.location=$("#registrationLandingNextURL").val();else{try{a={id:"Login",User_Email_MD5:s.getEmail_MD5(),User_Segments:s.getSegments(),User_Id:s.getUserId(),User_CrmId:s.getCrmId()};tealium_data2track.push(a)}catch(e){console.error(e)}var t=window.location.href,n="myAccount=true",o="";-1!=t.indexOf("?")?(n="&"+n,"undefined"!=typeof checkoutStep&&"address"==checkoutStep&&(o="&cart=true")):(n="?"+n,"undefined"!=typeof checkoutStep&&"address"==checkoutStep&&(o="?cart=true")),window.location=""!==o?t.split("#")[0]+o:t.split("#")[0]+n}else{var r=e.errorMessage;$(".LogOnFailureResponseMessageDiv").html(r).show(),$(".login-forgot-password-container").removeClass("no-service-messages");a={id:"Error",Error_Source:"User",Error_Code:"Login",Error_Message:"Wrong Email, Wrong Password"};tealium_data2track.push(a)}$("#LogonForm .logonSubmit").html("Sign in")},error:function(e,a,t){var n="Login request failed - please try again later.";$(".LogOnFailureResponseMessageDiv").html(n).show(),$(".login-forgot-password-container").removeClass("no-service-messages"),$("#LogonForm .logonSubmit").html("Sign in");var o={id:"Error",Error_Source:"Server",Error_Code:"Login",Error_Details:"Login Request Failed",Error_Message:n};tealium_data2track.push(o)}})}return!1}function logonFormTimeoutSubmit(e){var a=$(e);if(a.valid()){var t=a.serializeArray(),n=[];myperksURL=null;for(var o=0;o<t.length;o++){var r=t[o];"URL"==r.name&&(r.value,n.push({name:"URL",value:"LogonAjaxView"})),"myPerksRedirectURL"==r.name?(myperksURL=r.value,n.push({name:"URL",value:"LogonAjaxView"})):n.push(r)}$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:n,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.passwordExpired&&"1"==e.passwordExpired)$("#header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$("#header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block");else if(fromSubmitReview)window.location=ReviewSuccessURL;else if(e.success){var a=$("#headerMyAccountURL").val();utagLinkSafe({link_name:"login"}),window.location=a}else $(".LogOnFailureResponseMessageTimeoutDiv").html(e.errorMessage).show()},error:function(e,a,t){$(".LogOnFailureResponseMessageTimeoutDiv").html("Login request failed - please try again later.").show()}})}return!1}function examLogonFormSubmit(e){var a=document.getElementById("ScheduleExamLoginForm").elements.signInEmail.value,t=$(e);if(t.valid()){for(var n=t.serializeArray(),o=[],r=null,s=0;s<n.length;s++){var i=n[s];"URL"==i.name?(r=i.value,o.push({name:"URL",value:"LogonAjaxView"})):o.push(i)}$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:o,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.passwordExpired&&"1"==e.passwordExpired)$("#examSignInSection").css("display","none").attr("aria-hidden","true"),$("#header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block");else if(e.success)try{if(document.getElementById("userRegModelFormExam"))$("#examSignInModal").dialog("close"),document.getElementById("userRegModelFormExam").closest("div").style.display="none","true"!=e.syncValueForSignedIn?(document.getElementById("consentFormStepfour").style.display="block",document.getElementById("logonId").value=a):document.getElementById("manageExams").style.display="block";else{var t=r;t.length&&"#"==t.charAt(t.length-1)&&(t=t.substring(0,x.length-1)),window.location=t}}catch(e){}else{var n=e.errorMessage;"EXIST_IN_US"==n?($(".examLogOnFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".examLogOnFailureResponseMessageDiv").append("<a target='_blank' href='"+MessageHelper.messages.RediectHomePageURL+"'>"+MessageHelper.messages.LenscrafterUS+"</a>?")):"EXIST_IN_CA"==n?($(".examLogOnFailureResponseMessageDiv").html(MessageHelper.messages.ERR_MSG_DID_YOU_MEAN),$(".examLogOnFailureResponseMessageDiv").append("<a target='_blank' href='"+MessageHelper.messages.RediectHomePageURL+"'>"+MessageHelper.messages.LenscrafterCA+"</a>?")):$(".examLogOnFailureResponseMessageDiv").html(n)}},error:function(e,a,t){$(".examLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.")}})}return!1}function perksRegistrationFormSubmit(e){var a=$(e),t=!0,n=!0;RegisterModelPWDfields();if(a.valid()){for(var o=a.serializeArray(),r=[],s=0;s<o.length;s++){var i=o[s];"receiveEmail"==i.name&&"on"==i.value&&(i.value=!0,!0,t=!1,r.push({name:"optinStatus",value:"1"})),"optin_18yrs"==i.name&&"on"==i.value&&(i.value=!0,n=!1),i.name,"URL"==i.name?(i.value,r.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):r.push(i)}t&&(r.push({name:"receiveEmail",value:!1}),r.push({name:"optinStatus",value:"0"})),n&&r.push({name:"optin_18yrs",value:!1});$("#logonId_perkModel").val();$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationAddAjax",data:r,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.success){$("#perkLogonModalPerkName").val();null!=$("#perkLogonDataSid").val()&&$("#perkLogonDataSid").val();null!=$("#perkLogonDataCid").val()&&$("#perkLogonDataCid").val(),constants.ajaxParams.loggedIn=!0,void 0!==e.displayFLModal&&"true"==e.displayFLModal?displayPerkAttributeModal():displayThankYouModal();var a="RefreshHeaderView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&refreshHeader=true";$.ajax({url:getAbsoluteURL(!0)+a,dataType:"html",success:function(e){$("#header_links1").html(e)},error:function(e,a,t){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}else $(".PerksRegFailureResponseMessageDiv").html(e.errorMessage)},error:function(e,a,t){$(".PerksRegFailureResponseMessageDiv").html("Registration request failed - please try again later.")}})}return!1}function setupTooltips(){setTimeout(function(){$(".tooltip-link").each(function(){var e=$(this),a=e.prev(".tooltip"),t=a.height()-15,n=a.width()/2-20;a.css("left","-9999px").show(),a.css("top","-"+t+"px").css("left","-"+n+"px").hide(),e.hover(function(){a.show()},function(){a.hide()})})},100)}function registerFormSubmit(e){$("#userRegModelForm").find("input[name=account]").val($("#logonId_regModel").val());var a=$(e),t=!0,n=!0;if(a.valid()){for(var o=a.serializeArray(),r=[],s=0;s<o.length;s++){var i=o[s];if("receiveEmail"==i.name&&"on"==i.value&&(i.value=!0,t=!1,!0,r.push({name:"optinStatus",value:"1"})),"optin_18yrs"==i.name&&"on"==i.value&&(i.value=!0,n=!1),i.name,a.hasClass("confirmationPage")&&("age"==i.name&&"on"==i.value&&(i.value=!0,i.name="optin_18yrs",n=!1),"logonId"==i.name)){var l=i.value;r.push({name:"logonIdVerify",value:l})}"URL"==i.name?(i.value,r.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):r.push(i)}t&&(r.push({name:"receiveEmail",value:!1}),r.push({name:"optinStatus",value:"0"})),n&&r.push({name:"optin_18yrs",value:!1}),$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationAddAjax",data:r,dataType:"jsonp",crossDomain:!0,timeout:15e3,success:function(e){if(console.log("data",e),e.success)console.log("RegComplete Event Triggered Desktop - "+JSON.stringify(e)),setTimeout(function(){var e="myAccount=true";e=-1!=currentUrl.indexOf("?")?"&"+e:"?"+e,window.location=currentUrl.split("#")[0]+e},300);else{$(".RegFailureResponseMessageDiv").html(e.errorMessage);var a={id:"Account-Create-Tentative",Error_Source:"User",Error_Code:"Account Create - User already exists",Error_Message:e.errorMessage};tealium_data2track.push(a)}},error:function(e,a,t){$(".RegFailureResponseMessageDiv").html("Registration request failed - please try again later.");var n={id:"Error",Error_Source:"Server",Error_Code:"Signup",Error_Details:"Sign up Request Failed - "+t,Error_Message:"Registration request failed - please try again later."};tealium_data2track.push(n)}})}return!1}function logonFormSubmitPerks(e){var a=$(e);if(a.valid()){var t=a.serializeArray();newData=[],originalURL=null,myperksURL=null;for(var n=0;n<t.length;n++){var o=t[n];"URL"==o.name&&(originalURL=o.value,newData.push({name:"URL",value:"LogonAjaxView"})),"myPerksRedirectURL"==o.name?(myperksURL=o.value,newData.push({name:"URL",value:"LogonAjaxView"})):newData.push(o)}$("#perksheaderEmailAddress").val();$.ajax({url:getAbsoluteURL(!0)+"LogonAjax",data:newData,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.passwordExpired&&"1"==e.passwordExpired)$("#header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$("#header-set-a-new-password-modal").attr("aria-hidden","true").css("display","block");else if(e.success){$("#perkLogonModalPerkName").val();null!=$("#perkLogonDataSid").val()&&$("#perkLogonDataSid").val();null!=$("#perkLogonDataCid").val()&&$("#perkLogonDataCid").val(),constants.ajaxParams.loggedIn=!0,void 0!==e.displayFLModal&&e.displayFLModal&&"true"==e.displayFLModal?displayPerkAttributeModal():displayThankYouModal();var a="RefreshHeaderView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&refreshHeader=true";$.ajax({url:getAbsoluteURL(!0)+a,dataType:"html",success:function(e){$("#header_links1").html(e)},error:function(e,a,t){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}});a="WishListCountView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:getAbsoluteURL(!0)+a,dataType:"html",success:function(e){var a=parseInt($(e).find("#wishListFrameCount").val()),t=parseInt($(e).find("#wishListLensCount").val()),n=$(e).find("#wishListFrameTitle").val(),o=a+t;o>0&&($("#wishListCountSection").find("span.favorite-count ").addClass("active").html(o),$("#wishListCountSection").find("a").attr("title",n))},error:function(e,a,t){}})}else $(".PerksLogOnFailureResponseMessageDiv").html(e.errorMessage).show()},error:function(e,a,t){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}return!1}function displayThankYouModal(){var e="AjaxThankYouModalView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:getAbsoluteURL()+e,dataType:"html",success:function(e){$("#perksThankYouModal").dialog("destroy").remove(),$("#perksThankYouModalFiller").html(e),$("#perksThankYouModal").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615,open:function(){},close:function(){refreshNotifications()}}),getUserName(),resetRightNavWidget(),$(".header-account-signin").remove(),$("#perkLogonFormContent").dialog("close"),$("#perkContactModelDiv").dialog("close"),$("#perksThankYouModal").dialog("open")},error:function(e,a,t){$(".LogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}function displayPerkAttributeModal(){var e="PerksAttributeModalView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&refreshHeader=true";$.ajax({url:getAbsoluteURL()+e,dataType:"html",success:function(e){getUserName(),resetRightNavWidget(),$(".header-account-signin").remove(),$("#perkContactModelDiv").dialog("destroy").remove(),$("#perkAttributesModalFiller").html(e),$("#perkContactModelDiv").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:615,open:function(){}}),$("#perkFLForm").submit(function(e){e.preventDefault();var a=$("#perkFLForm").serializeArray();newData=[],originalURL=null,myperksURL=null;for(var t=0;t<a.length;t++){var n=a[t];"URL"==n.name?(originalURL=n.value,newData.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):newData.push(n)}"true"===$("#isSubmitAJAX").val()&&$("#perkFLForm").valid()&&(e.preventDefault(),$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationUpdateAttributesAjax",data:newData,dataType:"jsonp",crossDomain:!0,success:function(e){var a=e;"string"==typeof a&&(a=filterAjaxResponse(e)),a.success?displayThankYouModal():$(".FirstNameLastNameResponseMessageDiv").html(a.errorMessage)},error:function(e,a,t){$(".FirstNameLastNameResponseMessageDiv").html("FirstName or LastName is incorrect - please try again later.").show()}}))}),$("#perkFLForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",rules:{firstName:{required:!0},lastName:{required:!0}},messages:{firstName:{required:MessageHelper.messages.ERROR_contactInfoModel_FirstNameEmpty},lastName:{required:MessageHelper.messages.ERROR_contactInfoModel_LastNameEmpty}}}),$("#flFormMyPerkName").val(perkName),$("#isSubmitAJAX").val("true"),$("#perkLogonFormContent").dialog("close"),$("#perkContactModelDiv").dialog("open")},error:function(e,a,t){$(".PerksLogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}function registerFormSubmitPerks(e){$("#userRegModelForm").find("input[name=account]").val($("#logonId_regModel").val());var a=$(e),t=!0,n=!0;if(a.valid()){for(var o=a.serializeArray(),r=[],s=0;s<o.length;s++){var i=o[s];"receiveEmail"==i.name&&"on"==i.value&&(i.value=!0,t=!1,!0,r.push({name:"optinStatus",value:"1"})),"optin_18yrs"==i.name&&"on"==i.value&&(i.value=!0,n=!1),i.name,"URL"==i.name?(i.value,r.push({name:"URL",value:getAbsoluteURL(!0)+"UserRegistrationAddAjaxView"})):r.push(i)}t&&(r.push({name:"receiveEmail",value:!1}),r.push({name:"optinStatus",value:"0"})),n&&r.push({name:"optin_18yrs",value:!1}),$.ajax({url:getAbsoluteURL(!0)+"UserRegistrationAddAjax",data:r,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.success){constants.ajaxParams.loggedIn=!0;console.log("RegComplete Event Triggered Desktop - "+JSON.stringify(e))}else $(".PerksRegFailureResponseMessageDiv").html(e.errorMessage)},error:function(e,a,t){$(".PerksRegFailureResponseMessageDiv").html("Registration request failed - please try again later.")}})}return!1}function serializeParameters(e){var a=e.serializeArray(),t=[];for(index in a){var n=a[index];t[n.name]=n.value}return t}function setupLabel(){$(".label_check input").length&&($(".label_check").each(function(){$(this).removeClass("on")}),$(".label_check input:checked").each(function(){$(this).parent("label").addClass("on")}))}$(function(){$(".phoneNumberOnly").on("keyup",function(e){var a=$(this);a.val().match(/[^0-9-]/g)&&a.val(a.val().replace(/[^0-9-]/g,"")),a.val().match(/[0-9]{10}/)&&a.val(a.val().match(new RegExp("[0-9]{4,6}$|[0-9]{3}","g")).join("-").substr(0,12))})}),/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&sessionStorage&&(deserializeSessionStorage(),$(window).bind("unload",function(){serializeSessionStorage()})),function(e){e.fn.ariaHide=function(){return this.hide().attr("aria-hidden","true"),this},e.fn.ariaShow=function(){return this.show().attr("aria-hidden","false"),this},e.validator.setDefaults({errorPlacement:function(a,t){e(a).attr("aria-live","rude").insertAfter(t)},invalidHandler:function(e,a){a.numberOfInvalids()&&a.errorList[0].element.focus()}}),e.validator.addMethod("phoneValidation",function(a,t){if(0==a.length){var n=e(this).closest(".row").children(":radio").is(":checked");return e(t).closest(".row").find("input:text").each(function(){n=n||e(this).val().length>0}),!n}return a.length==t.maxLength},"Please enter a valid number"),e.validator.addMethod("postalFormatCheck",function(a,t){var n={canada:/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i,usa:/^\d{5}(-\d{4})?$/};return"CA"==e("#storeCountryName").val()?n.canada.test(a):n.usa.test(a)}),e.validator.addMethod("CCExp",function(a,t,n){var o=(new Date).getMonth()+1,r=(new Date).getFullYear(),s=parseInt(e(n.month).val(),10),i=parseInt(e(n.year).val(),10);return i>r||i===r&&s>=o}),e.validator.addMethod("contactQuantity",function(a,t,n){return parseInt(e(n.left).val(),10)+parseInt(e(n.right).val(),10)>0}),e.validator.addMethod("lettersonly",function(e,a){return this.optional(a)||/^[a-z]+$/i.test(e)},"Letters only please"),e.validator.addMethod("specialCharacters",function(e){var a=e,t=!1;return-1==a.indexOf("!")&&-1==a.indexOf("#")&&(t=!0),t},"* invalid"),e.validator.addMethod("atLeastOneLetterAndOneDigit",function(e,a){return/^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$/.test(e)}),e.validator.addMethod("zipCode",function(a,t){var n=!1,o=!0,r=e(t).closest("form").attr("id");if(e(".drop_down_country")&&"IE"==e("#"+r+" .drop_down_country").val()&&(o=!1,n=!0,e("#zipCode").removeClass("required").next(".required").remove(),e("#zipCode1").removeClass("required").next(".required").remove(),""==e("#zipCode").val()?e("#zipCode").attr("name","zip"):e("#zipCode").attr("name","zipCode"),""==e("#zipCode1").val()?e("#zipCode1").attr("name","zip"):e("#zipCode1").attr("name","zipCode")),o){var s=a;if(void 0==zipRegex){regexp=new RegExp(/^\d{5}(-\d{4})?$/),regexp.test(s)&&(n=!0)}else regexp=new RegExp(zipRegex),n=!!regexp.test(s)}return n},"* invalid"),e.validator.addMethod("date",function(a,t){var n=e(t).parents("form"),o=n.find(".validate-day").val(),r=n.find(".validate-month").val(),s=n.find(".validate-year").val();return!(0!=s||0!=o||0!=r)||isValidDate(s,r,o)},"* invalid"),e.validator.addMethod("age",function(a,t){var n=e(t).parents("form"),o=n.find(".validate-day").val(),r=n.find(".validate-month").val(),s=n.find(".validate-year").val();return!(0!=s||0!=o||0!=r)||MyAccountDisplayExtJS.validateAge(new Date(s,r-1,o))},"* invalid"),e.validator.addMethod("phoneNumber",function(a){var t=a;return regexp=new RegExp(phoneNumberRegex),!(!regexp.test(t)&&0!=e.trim(a).length)},"* Invalid"),"US"==e("#storeCountryName").val()?e.validator.messages.postalFormatCheck="Please enter a valid ZIP code":e.validator.messages.postalFormatCheck="Please enter a valid postal code",e.validator.addMethod("dotPos_formatCheck",function(e){return e.length-(e.lastIndexOf(".")+1)>=2},MessageHelper.messages.ERROR_EmailEmpty)}(jQuery);var firstLoad=!1;function pagerFactory(e,a){return"<li"+(e>4?' style="display:none"':"")+'><a href="#">'+(e+1)+"</a></li>"}function performGeocode(e,a){e&&e.length&&a&&a.length&&(new google.maps.Geocoder).geocode({address:e},a)}function enableAllSections(){$(".brands-list li a").removeClass("link-disabled-sort").addClass("link-enabled-sort")}function disableSection(){var e=$(".brands-list li a");$(e).removeClass("link-enabled-sort").addClass("link-disabled-sort")}function isCorrectDate(e,a,t){try{var n=e+"/"+a+"/"+t;$.datepicker.parseDate("mm/dd/yy",n),valid=!0}catch(e){valid=!1}return valid}function validateAge(e,a,t,n){var o=!1,r=n-e.birth_year.value;return r>18?o=!0:18==r&&(e.birth_month.value<a?o=!0:e.birth_month.value==a&&e.birth_date.value<=t&&(o=!0)),validateAge||error_list.push("not 18"),o}function dashbordStepOneFormSubmitValidation(){$("form#dashboard-step1").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{firstName:{required:!0}},messages:{firstName:{required:"Please enter a first name"}}})}function dashbordStepTwoFormSubmitValidation(){$("form#dashboard-step2").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{lastName:{required:!0}},messages:{lastName:{required:"Please enter a last name"}}})}function dashbordStepThreeFormSubmitValidation(){$("form#dashboard-step3").validate({onfocusout:!1,ignore:"",onkeyup:!1,onclick:!1,errorClass:"required",rules:{phone1_1:{required:!0,minlength:3},phone1_2:{required:!0,minlength:3},phone1_3:{required:!0,minlength:4}},messages:{phone1_1:{required:"Please enter a mobile phone number",minlength:"Please enter a valid phone number"},phone1_2:{required:"Please enter a mobile phone number",minlength:"Please enter a valid phone number"},phone1_3:{required:"Please enter a mobile phone number",minlength:"Please enter a valid phone number"}},errorPlacement:function(e,a){for(var t=[],n=!1,o=0;o<t.length;o++)n=n||t[o]==a.attr("name");n||(-1!=$(a).attr("name").indexOf("phone")?a.parent().append(e).addClass("validationError"):$(e).addClass("validationError").insertAfter(a)),error_list.push(e.text())},showErrors:function(e,a){if(this.defaultShowErrors(),$(".dashboard-phone span.required:visible").filter(function(e){return 0!=e}).hide(),a&&a.length){var t=Number.MAX_VALUE;$("form#dashboard-step3").find(".validationError:visible, span.required:visible").parent("div:first").each(function(){var e=$(this),a=e.offset().top;a<t&&(t=a,e)})}},highlight:function(e,a){$(e).addClass("required")},unhighlight:function(e,a){$(e).removeClass("required")}}),$("form#dashboard-step3").each(function(){var e=$(this);setupPhoneFields(e.find("input[name=phone1_1]"),e.find("input[name=phone1_2]"),e.find("input[name=phone1_3]"))}),$("input[name=phone1_1]").keyup(function(){$(this).val(this.value.substring(0,3))}),$("input[name=phone1_2]").keyup(function(){$(this).val(this.value.substring(0,3))}),$("input[name=phone1_3]").keyup(function(){$(this).val(this.value.substring(0,4))}),$("#dashboard-step3 #phone-check").change(function(){$("#dashboard-step3 #receiveMobile").val($(this).prop("checked"))})}function dashbordStepFourFormSubmitValidation(){$("form#dashboard-step4").validate({ignore:"",onkeyup:!1,onclick:!1,errorClass:"required",errorLabelContainer:$("#dashboard-step4 .dashboard-DateOfBirth"),rules:{dobMonth_1:{required:!0},dobDay_1:{required:!0},dobYear_1:{required:!0,check_date_of_birth_future:!0,check_date_of_birth:!0}},messages:{dobMonth_1:{required:"Please enter a valid birthday"},dobDay_1:{required:"Please enter a valid birthday"},dobYear_1:{required:"Please enter a valid birthday",check_date_of_birth_future:"You must be at least 18 years old to view eye exam information.",check_date_of_birth:"You must be at least 18 years old to view eye exam information."}},showErrors:function(e,a){this.defaultShowErrors(),$(".select-date-of-birth span.required:visible").filter(function(e){return 0!=e}).hide()},highlight:function(e,a){$(e).parents(".select-date-of-birth").addClass("required")},submitHandler:function(e){$(element).parents(".select-date-of-birth").removeClass("required"),e.submit()}})}function dashbordStepFiveFormSubmitValidation(){$("form#dashboard-step5").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{receiptNumber:{required:!0,maxlength:9}},messages:{receiptNumber:{required:MessageHelper.messages["Please enter a receipt number"]}}})}$.browser.msie&&"8.0"==$.browser.version?$("html").addClass("dj_ie dj_ie8 overflow-hidden"):$.browser.msie&&"9.0"==$.browser.version?$("html").addClass("dj_ie dj_ie9"):$.browser.msie&&"10.0"==$.browser.version?$("html").addClass("dj_ie dj_ie10"):$.browser.webkit&&$("html").addClass("dj_chrome");var RiaHelper={getCookie:function(e){for(var a="",t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var o=t[n];" "==o.charAt(0);)o=o.substring(1);0==o.indexOf(e)&&(a=o.substring(e.length+1,o.length))}return a},getInsuranceCookie:function(){var e=RiaHelper.getCookie("ria_1");return""!==e?e:RiaHelper.getCookie("ria_0")},loadJsonInsurance:function(){var e=RiaHelper.getInsuranceCookie();return e?JSON.parse(e):null},getTentativeUserCookie:function(){return RiaHelper.getCookie("tentative_user")},setInsuranceCookie:function(e){var a=new Date,t=a.getTime()+18e5;if(a.setTime(t),e.riaInsuranceInformation){var n=JSON.parse(e.riaInsuranceInformation);n.planName&&(n.planName=n.planName.replace(",",""),e.riaInsuranceInformation=JSON.stringify(n))}var o=JSON.stringify(e);""!=RiaHelper.getCookie("ria_0")?document.cookie="ria_0="+o+"; path=/; expires="+a.toUTCString()+";":document.cookie="ria_1="+o+"; path=/; expires="+a.toUTCString()+";"},toggleInsurance:function(e){var a=new Date,t=a.getTime()+18e5;if(a.setTime(t),e){var n=RiaHelper.getCookie("ria_0");document.cookie="ria_0=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",$(".pdp-container").length>0&&($(".lc-lens-enh-item.added").removeClass("added"),$(".existing-lens-addons").empty())}else{n=RiaHelper.getCookie("ria_1");document.cookie="ria_1=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}document.cookie="ria_"+(e?"1":"0")+"="+n+"; path=/; expires="+a.toUTCString()+";"},isInsuranceOn:function(){return""!==RiaHelper.getCookie("ria_1")},saveJsonInsurance:function(e){RiaHelper.setInsuranceCookie(e)},setTentativeCookie:function(e){var a=new Date,t=a.getTime()+3e5;a.setTime(t),document.cookie=e?"tentative_user="+e+"; path=/; expires="+a.toUTCString()+";":"tentative_user=0; path=/; expires="+a.toUTCString()+";"},removeInsuranceCookie:function(){document.cookie="ria_0=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie="ria_1=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie="tentative_user=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},checkAllBenefits:function(){var e,a=!1;if(""!==RiaHelper.getInsuranceCookie())for(e=JSON.parse(RiaHelper.getInsuranceCookie()).data,i=0;i<Object.keys(e).length&&!a;i++)1==e[Object.keys(e)[i]][0].available&&(a=!0);return a},checkSingleBenefit:function(e){var a;if(""!==RiaHelper.getInsuranceCookie())for(a=JSON.parse(RiaHelper.getInsuranceCookie()).data,i=0;i<Object.keys(a).length;i++)if(Object.keys(a)[i]==e)return a[Object.keys(a)[i]][0].available;return!1}};function showLogonModal(){if(hideSaveFavorites(),$("#header-register-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$("#header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$("#header-sign-in-modal").css("display","block").attr("aria-hidden","false"),$("#headerEmailAddress").focus(),$(".notification-count").removeClass("active"),$(".sign-in-link").addClass("open"),window.scrollTo(0,0),$("#headerEmailAddress").focus(),clearResetPwdErrorMessages(),clearResetForgotPWDErrors(),clearRegErrorMessages(),void 0!==$.getUrlVar("resetPassword")&&"true"==$.getUrlVar("resetPassword")){$("#header-set-a-new-password-modal").css("display","block").attr("aria-hidden","false");var e="";void 0!==$.getUrlVar("emailId")&&(e=$.getUrlVar("emailId"),document.getElementById("WC_PasswordUpdateForm_FormInput_EmailAddress").value=e)}}function clearLoginErrorMessages(){$(".LogOnFailureResponseMessageDiv").empty(),$("#header-sign-in-modal span.required ").not(".LogOnFailureResponseMessageDiv").remove()}function clearLoginPerkErrorMessages(){$(".PerksLogOnFailureResponseMessageDiv").empty(),$("#perk-logon-modal span.required ").not(".PerksLogOnFailureResponseMessageDiv").remove()}function clearRegErrorMessages(){$(".RegFailureResponseMessageDiv").empty(),$("#header-register-modal span.required ").not(".RegFailureResponseMessageDiv").remove()}function clearRegPerkErrorMessages(){$(".PerksRegFailureResponseMessageDiv").empty(),$("#perk-register-modal span.required ").not(".PerksRegFailureResponseMessageDiv").remove()}function clearLoginFields(){$("#headerEmailAddress").val(""),$("#header-logonPassword").val("")}function clearRegInputFields(){$("#logonId_regModel").val(""),$("#logonIdVerify").val(""),$("#logonPassword_regModel").val(""),$("#logonPasswordVerify_regModal").val(""),$("#optin_18yrs_checkBox").attr("checked",!1)}function clearResetPwdErrorMessages(){$("#ResetPasswordFailureResponseMessageDiv").empty(),$("#header-reset-password-modal span.required").not("#ResetPasswordFailureResponseMessageDiv").remove()}function clearResetForgotPWDErrors(){$("#WC_PasswordUpdateForm_FormInput_logonPasswordOld_In_Logon_1").val(""),$("#logonPassword_updateModel").val(""),$("#WC_PasswordUpdateForm_FormInput_logonPasswordVerify_In_Logon_1").val(""),$("#PasswordUpdateFailureResponseMessageDiv").empty(),$("#header-set-a-new-password-modal span.required").not("#ResetPasswordFailureResponseMessageDiv").remove(),$("#logonPassword_updateModel,#WC_PasswordUpdateForm_FormInput_logonPasswordVerify_In_Logon_1,#WC_PasswordUpdateForm_FormInput_logonPasswordOld_In_Logon_1,#WC_PasswordUpdateForm_FormInput_EmailAddress").addClass("resetHighlight")}$(document).ready(function(){geoLocationSchedule(),getUserName(),refreshNotifications(),catalogScroll(),recoLinkClick(),initTopNavigationLinkHandlers(),switchImageViews(),checkStepFourSync(),stepFourManageExam(),storeStep3session(),dashbordStepOneFormSubmitValidation(),dashbordStepTwoFormSubmitValidation(),dashbordStepThreeFormSubmitValidation(),dashbordStepFourFormSubmitValidation(),dashbordStepFiveFormSubmitValidation(),window.glassesFunctions.setTransparencyNeeded(!1),registerLazyLoadByClass("div.img.dots-loader",50),toggleThumbnailImageOnHover(),invokeLazyLoadOldImage(),$("#bazaar_voice_review_summary_wrapper").show(),$.validator.addMethod("check_date_of_birth",function(e,a){var t=$("#dobDay_1").val(),n=$("#dobMonth_1").val(),o=$("#dobYear_1").val(),r=new Date;r.setFullYear(o,n-1,t-1);var s=new Date;return s.setFullYear(s.getFullYear()-18),s>r},"You must be 18 years old to view eye exam information"),$.validator.addMethod("check_date_of_birth_future",function(e,a){var t=$("#dobDay_1").val(),n=$("#dobMonth_1").val(),o=$("#dobYear_1").val(),r=new Date;return r.setFullYear(o,n-1,t-1),new Date>r},"The provided birthday is invalid"),$("form#accountPersonalizationForm #phone1Type_1").on("change",function(e){e.preventDefault(),checkMobile(".phoneNumeber")?$(".smsAgreement").is(":visible")||$(".smsAgreement").show():($('input[name="offersCheckbox"]').attr("checked",!1),$(".smsAgreement").hide(),$(".phoneNumeber span.required:visible").hide())}),$("#perk-register-modal").css("display","none"),$("#perk-logon-modal").css("display","block");var e=$.cookie("lcOfferName")||"",a=$("#lcCookieToDelete").val()||"";function t(e,a,t){if($(e).valid()){var n=document.EmailSusbscriptionForm;"true"==a&&"email"==t&&n.recieveEmail_CheckBox.checked&&($(".checkBoxareaEmail").hide(),$(".checkBoxSubscribedareaEmail").show()),"false"==a&&"email"==t&&($(".checkBoxSubscribedareaEmail").hide(),$(".checkBoxareaEmail").show(),n.recieveEmail_CheckBox.checked=!1),"true"==a&&"phone"==t&&n.receiveMobile_CheckBox.checked&&($(".checkBoxareaPhone").hide(),$(".checkBoxSubscribedareaPhone").show()),"false"==a&&"phone"==t&&($(".checkBoxSubscribedareaPhone").hide(),$(".checkBoxareaPhone").show(),n.receiveMobile_CheckBox.checked=!1)}return!1}if(""!==e&&($(".perks-wrapper").first().addClass("recentlyAdded"),$(".recentlyAdded").prepend("<p class='selectedPerk'><span></span>Just Added</p>"),"true"===a&&""!=a&&(document.cookie="lcOfferName=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;")),$(".c-tabs").basicTabs(),$("#sync_PurchaseEye").is(":checked")?$("#CreateAccountURL").val($("#personalizationURL").val()):$("#CreateAccountURL").val($("#CreateAccountURL").val()),$("#subscribeContainer").on("change",".subscribeUserData",function(){var e=$(this).attr("data-subscribe"),a=$(this).attr("data-subtype");return t($(this).parents("form"),e,a),!1}),$(document).on("change","input[name='prescrNeed']",function(e){parseInt($(this).attr("data-index"));var a=$(this).attr("data-orderitemid"),t=$(this).is(":checked"),n={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,orderItemId:a,prescriptionNeed:t};return $.ajax({type:"POST",url:getAbsoluteURL()+"AjaxOrderChangeServicePrescriptionUpdateGL",traditional:!0,data:n,success:function(e,a,t){var n=[];n.storeId=constants.ajaxParams.storeId,n.catalogId=constants.ajaxParams.catalogId,n.langId=constants.ajaxParams.langId,n.URL="",n.updatePrices="1",n.orderId=constants.ajaxParams.orderId,n.calculationUsageId="-1",wc.service.invoke("AjaxOrderCalculate",n)}}),!1}),$("#subscribeContainer").on("click",".subscribeUserLink",function(){var e=$(this).attr("data-subscribe"),a=$(this).attr("data-subtype");return t($(this).parents("form"),e,a),!1}),$("#sync_PurchaseEye").on("change",function(){return $(this).is(":checked")?$("#CreateAccountURL").val($("#personalizationURL").val()):$("#CreateAccountURL").val($("#CreateAccountURL").val()),!1}),$("#subscribeContainer").on("click",".subscribeUserLink",function(){var e=$(this).attr("data-subscribe"),a=$(this).attr("data-subtype");return t($(this).parents("form"),e,a),!1}),$("a",".facet-options .main").on("touchstart",function(){var e=$(this).attr("href");return""!=e&&null!=e&&(document.location.href=e),!1}),navigator.userAgent.indexOf("Mobile")>-1&&($("html").addClass("ios"),setTimeout(function(){$(".button").not(".go, .hp_hero_container .button").attr("style","")},1e3)),window.member)var n=window.member.isAddedAllRecomm;if(window.user)var o=window.user.userType;if("G"==o){"Yes"==$.cookie("isAddedtoAccount")&&$("#right-nav-header").append('<div id="fyl_added" class="fyl_added"></div>')}else"R"==o&&("Y"==n?$("#fyl_added").show():$("#fyl_added").hide());if((navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))&&($("a.blue.button, .blue.button").css({background:"#6eabce",paddingTop:"3px",paddingBottom:"3px",paddingLeft:"5px",paddingRight:"5px","border-radius":"4px 4px 4px 4px"}),$("a.blue.button.schedule-exam-store").css({background:"#6eabce"}),$(".submit-blue, .submit").css({color:"#6eabce"}),$('input[type="radio"]').parent().removeClass("label_radio")),$(".column.below .last").blur(function(){$(".oo_feedback_float").length>0&&$(".oo_feedback_float").focus()}),$(document).keydown(function(e){if(32==e.keyCode&&$("a").is(":focus")){var a=$("a:focus");a.data("events")&&a.data("events").click?a.click():document.location.href=a.attr("href"),e.preventDefault()}}),hideAllDialogs(),enableNavFocus(),$(".dialog").attr("aria-hidden","true"),$(".ui-dialog").attr("aria-hidden","true"),$(".footer_email_signup,.email-signup").addClass("blur"),$(".footer_email_signup,.email-signup").focus(function(){$(this).removeClass("blur"),"Enter your email address"==$(this).val()&&$(this).val("")}),$(".footer_email_signup,.email-signup").blur(function(){$(this).addClass("blur"),""==$(this).val()&&$(this).val("Enter your email address")}),$(".top-level li a").on("touchstart",function(e){if(~navigator.userAgent.indexOf("iPad"))return window.location=$(this).prop("href"),!1}),$("#header_links").on("mouseenter",".top-level",function(){if($(this).children("a").css("color","#326fa8"),$(this).children(".subnav").fadeIn(300),$(this).children(".subnav-arrow").fadeIn(300),!$(this).hasClass("exam")&&!$(this).hasClass("savings")){var e=$(this).offset().left;$(this).children(".subnav").css("transform","translateX(-"+e+"px)")}}),$("#header_links").on("mouseleave",".top-level",function(){$(this).children("a").css("color","#5a5a5a"),$(this).children(".subnav").hide(),$(this).children(".subnav-arrow").hide()}),$("#header").on("mouseenter",".header-shield",function(){$(".header-shield-content").fadeIn(300)}),$("#header").on("mouseleave",".header-shield",function(){$(".header-shield-content").toggle()}),$(".header-search-container").on("click",function(e){e.stopPropagation(),$("#tagCloudStatic").show(),$(".header-search-icon").toggleClass("blue"),$(".subnav-search").toggle(function(){$("#SimpleSearchForm_SearchTerm").focus()}),$("html").addClass("noScroll-menu");try{var a={id:"VirtualPage-View",Page_Type:"Search",Page_Section1:"Common",Page_Section2:"InternalSearch",Cart_Id:"${orderId}",Order_Currency:"USD",Search_Keyword:"",Search_Type:"",Search_ResultItemsQnt:"",Events_SearchRun:""};tealium_data2track.push(a)}catch(e){a={id:"InternalSearch-Tentative",Error_Source:"Search",Error_Code:"InternalSearch"};tealium_data2track.push(a)}}),$(".top-level").is(":visible")||$(".header-shield-content").is(":visible")||$(".subnav-search").not(":hidden")){$(".header-search"),$(".subnav-search"),$("#SimpleSearchForm_SearchTerm");$(document).bind("touchstart",function(e){var a=$(".top-level"),t=$(".header-shield");a.is(e.target)||0!==a.has(e.target).length||(a.children(".subnav").hide(),a.children(".subnav-arrow").hide()),a.is(e.target)&&0===!a.has(e.target).length&&(a.children(".subnav").show(),a.children(".subnav-arrow").show()),t.is(e.target)||0!==t.has(e.target).length||t.children("div").hide(),t.is(e.target)&&0===!t.has(e.target).length&&t.children("div").show()})}function r(e){var a=$(e);if(a.valid()){var t=a.attr("id");if("dashboard-step3"==t){var n=a.find("input[name=phone1_1]").val()+a.find("input[name=phone1_2]").val()+a.find("input[name=phone1_3]").val();a.find("input[name=phone1]").val(n)}if("dashboard-step4"==t){var o=$("#dobMonth_1").val(),r=$("#dobDay_1").val(),s=$("#dobYear_1").val();o<10&&(o="0"+o),r<10&&(r="0"+r);var i=s+"-"+o+"-"+r;a.find("input[name=dateOfBirth]").val(i)}if("dashboard-step5"==t){var l=a.find("input[name=receiptNumber]").val();a.find("input[id=receiptNumberVal]").val(l)}$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:a.serializeArray(),dataType:"html",crossDomain:!0,success:function(e){(e=filterAjaxResponse(e)).success?function(e){var a="myDashboardProfileView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&userId="+constants.ajaxParams.userId+"&updateId="+e;$.ajax({url:getAbsoluteURL(!0)+a,dataType:"html",success:function(e){$("#profile-data").html(e)}})}(t):"dashboard-step3"==t&&"_WEB_SERVICE_GENERIC"==e.errorMessageKey?$("#dashboard-step3 .dashboard-phone").addClass("validationError").append('<span class="required backendError">'+MessageHelper.messages.ERROR_VALID_PHONENUMBER+"</span>"):$("#PasswordUpdateFailureResponseMessageDiv").html(e.errorMessage)},error:function(e,a,t){$("#PasswordUpdateFailureResponseMessageDiv").html("Update failed - please try again later.")}})}return!1}if($("#headerLogout").on("click",function(){removeExamCookies(),$.cookie("WC_PERSISTENT","",{expires:-1,path:"/"})}),$("input").not(":submit, :button, :hidden, .no-replace").each(function(){var e=$(this),a=e.val();e.addClass("blur"),e.hasClass("no-focus-clear")||(e.focus(function(){e.val()==a&&e.val("").removeClass("blur")}),e.blur(function(){""==e.val()&&e.val(a).addClass("blur")}))}),$("li.sort-brands a").each(function(){null==navigator.userAgent.match(/iPad/i)?$(this).on("click",function(e){$("li.sort-brands a").removeClass("sorted-by"),$(this).addClass("sorted-by"),e.preventDefault();var a=$(this).attr("id");"sort-all"==a?enableAllSections():(disableSection(),$(".brands-list").find("a."+a).removeClass("link-disabled-sort").addClass("link-enabled-sort"))}):$(this).on("touchend",function(e){$("li.sort-brands a").removeClass("sorted-by"),$(this).addClass("sorted-by"),e.preventDefault();var a=$(this).attr("id");"sort-all"==a?enableAllSections():(disableSection(),$(".brands-list").find("a."+a).removeClass("link-disabled-sort").addClass("link-enabled-sort"))})}),$(".brands-list li a.link-disabled-for-facet-result").each(function(){$(this).click(function(e){e.preventDefault()})}),$.validator&&(jQuery.validator.addMethod("zip",function(e,a){var t=$.trim(e);return t.match(constants.regex.zip.usa)||t.match(constants.regex.zip.canada)},MessageHelper.messages.ERROR_ZipCodeEmpty),jQuery.validator.addMethod("caZip",function(e,a){return"10852"==constants.ajaxParams.storeId||!!$.trim(e).match(constants.regex.zip.usa)},MessageHelper.messages.STORE_FINDER_ZIP_COUNTRY_MISMATCH),jQuery.validator.addMethod("pattern",function(e,a,t){return!(!this.optional(a)&&"[0-9]*"!=t)||("string"==typeof t&&(t=new RegExp("^(?:"+t+")$")),t.test(e))},"Invalid format.")),$("body").on("click touchstart",".ui-widget-overlay",function(){$("#ContactUsChatOverLay:visible").parents(".ui-dialog:visible").length>0||$(".showWaitModalContainer").parents(".ui-dialog:visible").length>0||$(".ui-dialog-content").dialog("close")}),$(".close-dialog").click(function(){return $(".ui-dialog-content").dialog("close"),!1}),$(document.body).on("click",".dashboard-skip",function(){$(this).parents("form");!function(e){var a="myDashboardProfileView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&userId="+constants.ajaxParams.userId+"&skipId="+e;$.ajax({url:getAbsoluteURL(!0)+a,dataType:"html",success:function(e){$("#profile-data").html(e)}})}($(this).parents("form").attr("id"))}),$(document.body).on("click",".dashboard-update",function(){return r($(this).parents("form")),!1}),$(document).ready(function(){$("form#dashboard-step3, form#accountPersonalizationForm").each(function(){var e=$(this);setupPhoneFields(e.find("input[name=phone1_1]"),e.find("input[name=phone1_2]"),e.find("input[name=phone1_3]"))}),$("input[name=phone1_1]").keyup(function(){$(this).val(this.value.substring(0,3))}),$("input[name=phone1_2]").keyup(function(){$(this).val(this.value.substring(0,3))}),$("input[name=phone1_3]").keyup(function(){$(this).val(this.value.substring(0,4))})}),$("#addEyeExamDetails").click(function(e){e.preventDefault();var a=$(this).parents("form"),t=$("#addEyeExamSubmitForm"),n="("+t.find("input[name=phone1_1]").val()+")"+t.find("input[name=phone1_2]").val()+"-"+t.find("input[name=phone1_3]").val();t.find("input[name=phone1]").val(n);var o=t.find("#dobMonth_1").val(),r=t.find("#dobDay_1").val(),s=t.find("#dobYear_1").val();o<10&&(o="0"+o),r<10&&(r="0"+r);var i=o+"/"+r+"/"+s;t.find("input[name=dob]").val(i);var l,d,c;a.serializeArray();a.valid()&&(l=$(t),d=$(".showWaitModalForAddExam").val()||"",c=$("#eyeExamDelayTimeMs").val()||"",$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:l.serializeArray(),dataType:"json",crossDomain:!0,success:function(e){console.log(c),"true"===d&&""!==d&&0==$("#reSyncUser").length?($(".showWaitModalContainer").dialog("open"),setTimeout(function(){$.ajax({url:getAbsoluteURL(!0)+"AjaxEyeExamHistorySyncCmd",data:l.serializeArray(),dataType:"json",crossDomain:!0,success:function(e){window.location.href=$("#EyeExamHistoryURL").val()}})},c)):$.ajax({url:getAbsoluteURL(!0)+"AjaxEyeExamHistorySyncCmd",data:l.serializeArray(),dataType:"json",crossDomain:!0,success:function(e){window.location.href=$("#EyeExamHistoryURL").val()}})},error:function(e,a,t){console.log("error is -"+t)}}))}),$(".unSyncContinue").on("click",function(){var e=$("#UnsyncppointmentForm").serializeArray();$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:e,dataType:"json",crossDomain:!0,success:function(e){e.success&&(window.location.href=$("#addEyeExamURL").val())}})}),$("#ViewmoreEyeExams").on("click",function(e){var a=$(".appointmentHeader .hideEyeExam").length;pastExamCount<=a&&$(".viewMoreExams").css("display","none");$(".pastExams .Row").length;if($(".pastExams .Row.hideEyeExam").length)$(".pastExams .Row.hideEyeExam:lt(4)").removeClass("hideEyeExam").addClass("showEyeExam");var t=$(".appointmentHeader .showEyeExam").length;pastExamCount<=t&&$(".viewMoreExams").css("display","none")}),$(".unsyncEyeExmas").on("click",function(e){$(".unsyncContainer").dialog("open")}),$(".cancelExam[data-appointment-id]").on("click",function(e){var a="us",t="not authenticated",n="not registered",o=$(this).attr("is-future")||"";"CA"==constants.ajaxParams.countryName&&(a="ca"),constants.ajaxParams.loggedIn&&(t="authenticated",n="registered"),"true"!=o?data={site_events:{cancel_eye_exam:!0},site_layout_type:"desktop",country:a,authentication_status:t,registration_status:n}:($("#cancelAppointmentHistroyForm").find(".cancelAppointmentId").val($(this).attr("data-appointment-id")),$(".canceleyeExamContainer").dialog("open"))}),$(".closeEyeExamModel").on("click",function(e){$(".canceleyeExamContainer").is(":visible")?$(".canceleyeExamContainer").dialog("close"):$(".unsyncContainer").is(":visible")&&$(".unsyncContainer").dialog("close")}),$.validator.addMethod("validPhoneCheck",function(e,a){var t=!0;if($("input[name=phone1_1]").length>0){var n;(n=$("input[name=phone1_1]").val().length+$("input[name=phone1_2]").val().length+$("input[name=phone1_3]").val().length)>0&&n<10&&(t=!1)}return t},MessageHelper.messages.PHONE_FIELDS_ERROR),$.validator.addMethod("validDOB",function(e,a){var t=$("#dobMonth_1").val(),n=$("#dobDay_1").val(),o=$("#dobYear_1").val();if(""!=o&&""!=t&&""!=n&&new Date(o,t,n)>new Date)return!1;return!0},MessageHelper.messages.BDAY_FIELDS_INVALID),$.validator.addMethod("validLeapYear",function(e,a){var t=$("#dobMonth_1").val(),n=$("#dobDay_1").val(),o=$("#dobYear_1").val(),r=new Date(o,t-1,n);return""==o||""==t||""==n||r.getFullYear()==o&&r.getMonth()+1==t&&r.getDate()==n},MessageHelper.messages.BDAY_FIELDS_INVALID),$("form#addEyeExamSubmitForm").each(function(){var e=$(this);setupPhoneFields(e.find("input[name=phone1_1]"),e.find("input[name=phone1_2]"),e.find("input[name=phone1_3]"))}),$("input[name=phone1_1]").keyup(function(){$(this).val(this.value.substring(0,3))}),$("input[name=phone1_2]").keyup(function(){$(this).val(this.value.substring(0,3))}),$("input[name=phone1_3]").keyup(function(){$(this).val(this.value.substring(0,4))}),$("input[name=phone1_1], input[name=phone1_2], input[name=phone1_3]").bind("focusout",function(){return!1}),$("#addEyeExamSubmitForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{firstName:{required:!0},lastName:{required:!0},dobMonth:{validDOB:!0,validLeapYear:!0,required:!0},dobDay:{validDOB:!0,validLeapYear:!0,required:!0},dobYear:{validDOB:!0,validLeapYear:!0,required:!0},phone1_1:{validPhoneCheck:!0,required:!0,minlength:3},phone1_2:{validPhoneCheck:!0,required:!0,minlength:3},phone1_3:{validPhoneCheck:!0,required:!0,minlength:4},consentCheckbox:{required:!0}},messages:{firstName:MessageHelper.messages.ERROR_FIELD_REQ,lastName:MessageHelper.messages.ERROR_FIELD_REQ,dobMonth:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dobDay:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dobYear:{required:MessageHelper.messages.BDAY_FIELDS_REQ},phone1_1:{required:MessageHelper.messages.ERROR_FIELD_REQ},phone1_2:{required:MessageHelper.messages.ERROR_FIELD_REQ},phone1_3:{required:MessageHelper.messages.ERROR_FIELD_REQ},consentCheckbox:MessageHelper.messages.ERROR_CONSENT_CHECKBOX},errorPlacement:function(e,a){for(var t=[],n=!1,o=0;o<t.length;o++)n=n||t[o]==a.attr("name");n||("consentCheckbox"==$(a).attr("name")?$(e).css({float:"none",display:"block"}).insertAfter($(a).next()):-1!=$(a).attr("name").indexOf("dob")||-1!=$(a).attr("name").indexOf("phone")?a.parent().append(e).addClass("validationError"):$(e).addClass("validationError").insertAfter(a)),error_list.push(e.text())},showErrors:function(e,a){if(this.defaultShowErrors(),$(".phoneDetails span.required:visible").each(function(e,a){$(this).text()==MessageHelper.messages.PHONE_FIELDS_ERROR&&$(".phoneDetails span.required:visible").text(MessageHelper.messages.PHONE_FIELDS_ERROR)}),$(".dobMonthData span.required:visible").filter(function(e){return 0!=e}).hide(),$(".phoneDetails span.required:visible").filter(function(e){return 0!=e}).hide(),a&&a.length){Number.MAX_VALUE;null}$(".phoneDetails span.required:visible").length>0&&$(".phoneDetails").addClass("validationError")},highlight:function(e,a){$(e).addClass("required"),$(e).parent().addClass("validationError")},unhighlight:function(e,a){$(e).removeClass("required"),$(e).parent().removeClass("validationError")}}),$("body").hasClass("home-page")){$().cycle&&($(".slideshow").cycle({fx:"fade",pager:"#home-controls",speed:"800",pause:!0,timeout:0,pagerAnchorBuilder:function(e,a){return'<li><a aria-label="Homepage Promotion Slide '+(1+e)+'" href="#">'+(1+e)+"</a></li>"}}),$("#home-controls a").click(function(){$(".slideshow").cycle("pause")})),$(".banner-image .ad_product").each(function(e){var a=$(this);$marginLeft=a.width()/2,a.css("marginLeft","-"+$marginLeft+"px")});var s=$(".banner-image .ad_product:first img").height(),i=$(".banner-image .ad_product:first img").width();$(".banner-image").css("width",i+"px").css("height",s+"px")}$(".plan-visit-holder").each(function(e){var a=$(this);$marginLeft=a.width()/2,a.css("marginLeft","-"+$marginLeft+"px")}),Modernizr.input.placeholder||($("[placeholder]").focus(function(){var e=$(this);e.val()==e.attr("placeholder")&&e.val("").addClass("active").removeClass("inactve")}).blur(function(){var e=$(this);null!=e.val()&&""!=e.val()||e.val(e.attr("placeholder")).addClass("inactive").removeClass("active")}).blur(),$("[placeholder]").parents("form").submit(function(){$(this).find("[placeholder]").each(function(){var e=$(this);e.val()==e.attr("placeholder")&&e.val("")})})),$(".pin-it-button").click(function(e){e.preventDefault(),window.open($(this).attr("href"),"popUpWindow","height=700,width=800,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes"),utag.link({link_name:"SocialShare",social_site:"Pinterest"})}),$("#dateOfBirthForm").submit(function(e){var a=$.trim($("#myDOB").text());if(""!=a)return this.dateOfBirth.value=a,!0;var t=new Date,n=t.getFullYear(),o=t.getMonth()+1,r=t.getDate();return 0==this.birth_year.value||isCorrectDate(this.birth_month.value,this.birth_date.value,this.birth_year.value)?validateAge(this,o,r,n)?0!=this.birth_year.value||0!=this.birth_month.value||0!=this.birth_date.value?(this.dateOfBirth.value=this.birth_year.value+"-"+this.birth_month.value+"-"+this.birth_date.value,!0):void(this.dateOfBirth.value=""):($("#moreInformatonErrorDiv").text("You need to be 18 years old to sign up for Lenscrafters.com").show(),!1):($("#moreInformatonErrorDiv").text("Please Enter a valid date.").show(),!1)}),$("body").on("click",".label_check",function(){setupLabel()}),$('#form-fsa input[type="radio"]').change(function(e){"checked"==$("#fsaYes").attr("checked")?$("#fsaExpField").css("display","block"):"checked"==$("#fsaNo").attr("checked")&&($("#fsaExpField").css("display","none"),$("#fsa_datepicker").val(""))}),setupLabel(),void 0!=window.EmailSignupForm&&(EmailSignupForm.setupValidation(),EmailSignupForm.setupClickEvents()),$("#countrySelector").click(function(e){var a=$(this).children("li");if(a.eq(0).hasClass("selected"))return a.eq(0).hide().removeClass("selected"),a.eq(1).show().addClass("selected"),!1;a.eq(1).hide().removeClass("selected"),a.eq(0).show().addClass("selected")}),$("#countrySelector > li li").click(function(e){e.preventDefault();var a=$(this);if(a.hasClass("current"));else{var t=a.find("a").attr("href");document.location=t}}),$("a.submit-form").click(function(){return $("#getDirectionsForm").is(":visible")&&$("#getDirectionsForm").validate(),$(this).parents("form").submit(),utagLinkSafe({link_id:"drivingDirections"}),!1}),$("body").on("click",".close-favorites-modal",function(e){e.preventDefault(),$("#AddedWishlistDialogDiv").attr("aria-hidden","true").slideUp()}),-1!=navigator.userAgent.indexOf("Mobile")&&($("#logonPassword2, #logonPasswordVerify2").unbind("blur").attr("placeholder","Enter password"),$("#logonPasswordVerify2").attr("placeholder","Re-enter password")),void 0!=window.FooterStoreSearch&&FooterStoreSearch.setup(),$("#EyeExamsModalDiv").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:640,open:function(){$("#EyeExamsModalDiv").prev(".ui-dialog-titlebar").find(".ui-dialog-titlebar-close").addClass("eyeexams").find(".ui-icon-closethick").text("Return to myAccount"),$("#EyeExamsModalDiv").parent().addClass("with-bg")}}),$("#perkLogonFormContent").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615,open:function(){},close:function(){clearRegisterModelPWDfields(),clearLoginPerkErrorMessages(),clearRegPerkErrorMessages()}}),$("#playVideoModal").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999}),$(".unsyncContainer").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615}),$(".canceleyeExamContainer").dialog({autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:615}),$(".showWaitModalContainer").dialog({dialogClass:"noModal-close",autoOpen:!1,draggable:!1,resizable:!1,zIndex:9999,modal:!0,width:490,minHeight:175,closeOnEscape:!1}),$(".openWhatToExpectModal").click(function(e){e.preventDefault(),$("#playVideoModal").dialog("open")});var l=$("#CancelAppointmentModalDiv").dialog({autoOpen:!1,draggable:!1,resizable:!1,modal:!0,zIndex:9999,width:340,open:function(){$("#CancelAppointmentModalDiv .cancel").bind("click",function(){$("#CancelAppointmentModalDiv").dialog("close")})},close:function(){$("#CancelAppointmentModalDiv .cancel").unbind("click")}});$("#EyeExamsModalDiv").on("click","a.cancelAppointment[data-appointment-id]",function(){return $("#cancelAppointmentId").val($(this).attr("data-appointment-id")),l.dialog("open"),!1}),$("#WC_shippingAddressCreateEditFormDiv_1_address1_div_11 input").on("change",function(){return AddressHelper.avalaraFail=!1,!1}),$("#WC_shippingAddressCreateEditFormDiv_1_address1_div_11 select").on("change",function(){return AddressHelper.avalaraFail=!1,!1}),$("#EyeExamsModalDiv .show-past-exam").on("click",function(){var e=$(this).index("#EyeExamsModalDiv .show-past-exam");$("#EyeExamsModalDiv .show-past-exam").eq(e).toggle(),$("#EyeExamsModalDiv .hide-past-exam").eq(e).toggle(),$("#EyeExamsModalDiv .past .each-exam").eq(e).toggle()}),$("#EyeExamsModalDiv .hide-past-exam").on("click",function(){var e=$(this).index("#EyeExamsModalDiv .hide-past-exam");$("#EyeExamsModalDiv .show-past-exam").eq(e).toggle(),$("#EyeExamsModalDiv .hide-past-exam").eq(e).toggle(),$("#EyeExamsModalDiv .past .each-exam").eq(e).toggle()}),$("#CancelAppointmentModalDiv .yes-cancel").on("click",function(){utagLinkSafe({link_id:"apptRemove"})});var d=0;function c(){console.log("resetpassword function");var e=document.ResetPasswordForm;""==e.logonId.value&&(e=$("#favoriteSignInModal #ForgotPasswordSection #resetPasswordForm")[0]);var a={};a.challengeAnswer=e.challengeAnswer.value,a.state=e.state.value,a.URL=e.URL.value,a.errorViewName=e.errorViewName.value,a.logonId=e.logonId.value,a.email1=e.logonId.value,a.emailType="forgotpassword",a.senderEmail=e.logonId.value,a.senderName=e.logonId.value,a.email1=e.logonId.value,a.receiveEmail="true",a.recipientEmail=e.logonId.value,a.receiveEmail="true",a.fromName=e.logonId.value,a.pdp_18yrs="true",a.storeId=e.storeId.value,invokeResetPasswordService(a,!1)}$("#StoreLocatorPdpModelDiv").dialog({autoOpen:!1,title:"FIND IN STORES",draggable:!1,resizable:!1,position:["center"],modal:!0,zIndex:9999,minWidth:990,open:function(){var e="",a="",t="",n="",o="";if($("#quick-view-modal").is(":visible"))e=$("#quick-view-modal #productBrand").text(),a=$("#quick-view-modal #productName").text(),t=$("#quick-view-modal #productPrice").text(),n=$("#quick-view-modal #productFullImage").attr("src");else if($("#compare_details").is(":visible")){e=(r=$(".each-compare-product").eq(d)).find(".the-brand").text(),a=r.find(".brandStyle span").text(),t=r.find(".the-price:first span").text(),n=r.find(".comparehover img").attr("src"),o=r.find("#partNumber").text(),$("#StoreLocator_ProductId").val(o)}else if($("#wishlist-holder").is(":visible")){e=(r=$(".item").eq(d)).find(".the-brand").text(),a=r.find(".style-name").text(),t=r.find(".the-price:first span").text(),n=r.find(".productMainImage").attr("src"),utagLinkSafe({link_name:"findinstore",product_id:o=r.find(".find-in-store").data("partnumber")}),$("#StoreLocator_ProductId").val(o)}else if($("#certona-reco").length>0){var r;e=(r=$(".each-reco-product").eq(d)).find(".brand").text(),a=r.find(".style-name").text(),t=r.find(".the-price:first span").text(),n=r.find(".product_image img").attr("src"),utagLinkSafe({link_name:"findinstore",product_id:o=r.find(".find-in-store").data("partnumber")}),$("#StoreLocator_ProductId").val(o)}if(""!=e&&""!=a&&""!=t&&""!=n){$("#StoreLocatorPdpModelDiv #storeBrand").text(e),$("#StoreLocatorPdpModelDiv h2 span").text(a),$("#StoreLocatorPdpModelDiv .the-price").text(t);var s=/wid=(\d*)/;n.match(s)&&(n=n.replace(s,"wid=254")),$("#StoreLocatorPdpModelDiv #storeImage").attr("src",n)}$(".pdpSubText").length>0&&($(".pdpSubText").css("display","none"),$(".pdpNoStoreText").css("display","none"),$(".storeLocatorResults").html(""),$("#map").css("display","none"),$("#number-of-store-results").html(""),$("#num-results").css("display","none"),$(".disclaimer").css("display","none"))}}),$("#ContactUsChatOverLay").dialog({autoOpen:!1,title:"",draggable:!1,resizable:!1,position:["center"],modal:!0,zIndex:9999,minWidth:520,close:function(){if($("#ContactUsChatOverLay span.required").hide(),$("#chatOverlay").css("display","none"),$("#rightNowChatContainer").length){try{$("#rightNowChatContainer")[0].contentWindow.closeAndDisconnect()}catch(e){}try{$("#rightNowChatContainer")[0].contentWindow.closeAndDisconnect()}catch(e){}}}}),$(".setNewPassword").click(function(){$("#header-set-a-new-password-modal").css("display","block").attr("aria-hidden","false"),document.getElementById("WC_PasswordUpdateForm_FormInput_EmailAddress").value=document.getElementById("currentID").value}),$(".email-friend").click(function(){var e=$(this).attr("generic_email_view_url");return $.ajax({url:getAbsoluteURL()+e,success:function(e){$("#EmailFriendFormDiv").html(e),$("#EmailFriendFormDiv").dialog({draggable:!1,resizable:!1,modal:!0,zIndex:9999,minWidth:520,open:function(){$("#EmailFriendFormDiv .cancel").bind("click",function(e){e.preventDefault(),$(".ui-dialog-content").dialog("close")}),$("input[name=directions]").length>0&&$("input[name=directions]").val($("#allDirections").text()),$("input[name=totalDistance]").length>0&&$("input[name=totalDistance]").val($("#totalDist").text()),$("input[name=mapImage]").length>0&&$("input[name=mapImage]").val($("#imageUrl").text()),$("input[name=totalTime]").length>0&&$("input[name=totalTime]").val($("#timeTaken").text())},close:function(){$("#EmailFriendFormDiv .cancel").unbind("click")}})}}),utagLinkSafe({link_name:"emailPDP"}),!1}),$(".sign-in-link").click(function(){return showLogonModal(),!1}),$(".perk-sign-in-link").click(function(){return hideSaveFavorites(),$("#perk-register-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$("#header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$("#perk-logon-modal").css("display","block").attr("aria-hidden","false"),$("#perksheaderEmailAddress").focus(),$(".perk-account-link").removeClass("active"),$(".perk-sign-in-link").addClass("active"),$("#headerEmailAddress").focus(),clearResetPwdErrorMessages(),clearRegPerkErrorMessages(),!1}),$(".perk-account-link").click(function(e){if(!constants.ajaxParams.loggedIn)return hideSaveFavorites(),$("#perk-logon-modal").css("display","none"),$("#perk-register-modal").css("display","block").attr("aria-hidden","false"),$("#perk-register-modal #logonId_regModel").focus(),$(".perk-account-link").addClass("active"),$(".perk-sign-in-link").removeClass("active"),$("#logonId_perkModel").focus(),clearLoginPerkErrorMessages(),!1}),$("#create-an-account-plan-visit").click(function(){return $("#header-sign-in-modal").css("display","none"),$("#header-register-modal").css("display","block"),$(".sign-in-link").removeClass("open"),$("#create-an-account-plan-visit").addClass("open"),$("#logonId_regModel").focus(),clearLoginErrorMessages(),!1}),$(".close-sign-in").click(function(){return $("#header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearLoginErrorMessages(),clearLoginFields(),clearRegInputFields(),!1}),$("#create-an-account-in-eye-examspage").click(function(){return $("#header-register-modal").css("display","block").attr("aria-hidden","false"),!1}),$(".close-register").click(function(){return $("#header-register-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearRegErrorMessages(),$("#userRegModelForm").validate().resetForm(),$(":input","#userRegModelForm").not(":hidden").val("").removeClass("required"),$("#userRegModelForm")[0].reset(),utagLinkSafe({link_name:"contactAdd",customer_id:"${userId}"}),!1}),$("#logonPassword_perkModel").keydown(function(e){($("#logonPasswordVerify_perkModal").hasClass("valid")||$("#logonPasswordVerify_perkModal").hasClass("required"))&&$("#logonPasswordVerify_perkModal").show(),e.which}),$("#forgotPasswordLink, #forgotPassword").on("click touchstart",function(){return clearLoginFields(),clearLoginErrorMessages(),$("#header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-modal").css("display","block").attr("aria-hidden","false"),$(".sign-in-link").addClass("open"),$("#WC_PasswordResetForm_FormInput_logonId_In_ResetPasswordForm_1").focus(),!1}),$("#perkLogonFormContent #forgotPasswordLink").on("click touchstart",function(){$("#perkLogonFormContent").dialog("close"),clearRegPerkErrorMessages(),clearLoginPerkErrorMessages()}),$(".cancelPerkModel").on("click",function(e){$("#perk-logon-modal").is(":visible")||$("#perk-register-modal").is(":visible")?$("#perkLogonFormContent").dialog("close"):$("#perkContactModelDiv").is(":visible")&&$("#perkContactModelDiv").dialog("close");var a=$(this).attr("data-attrcancel");"undefined"!=perkName&&$.cookie("lcOfferName")==perkName&&"true"==a&&(document.cookie="lcOfferName=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"),clearRegPerkErrorMessages(),clearLoginPerkErrorMessages(),refreshNotifications()}),$(document).on("click",".cancelPerkModel",function(e){$("#perksThankYouModal").is(":visible")?$("#perksThankYouModal").dialog("close"):$("#perkContactModelDiv").is(":visible")&&$("#perkContactModelDiv").dialog("close");var a=$(this).attr("data-attrcancel");"undefined"!=perkName&&$.cookie("lcOfferName")==perkName&&"true"==a&&(document.cookie="lcOfferName=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"),refreshNotifications()}),$(".close-reset-password").click(function(){return $("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$("#header-sign-in-modal").css("display","block").attr("aria-hidden","true"),$("#headerEmailAddress").focus(),$(".sign-in-link").removeClass("open"),clearResetPwdErrorMessages(),!1}),$(".close-reset-cancel-password").click(function(){return $("#header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-done-modal ").css("display","none").attr("aria-hidden","true"),$("#header-sign-in-modal").css("display","block").attr("aria-hidden","true"),$("#headerEmailAddress").focus(),$(".sign-in-link").removeClass("open"),clearResetPwdErrorMessages(),clearResetForgotPWDErrors(),!1}),$(".close-reset-password-done").click(function(){return $("#header-reset-password-done-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),!1}),$(".set-new-password").click(function(){return $("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$("#header-set-a-new-password-modal").css("display","block").attr("aria-hidden","false"),!1}),$(".close-set-new-password").click(function(){return $("#header-set-a-new-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),!1}),$(".LogOnModalSubmitButton").click(function(){logonFormSubmit($(this).parents("form"));var e=document.getElementById("headerEmailAddress").value;return e&&(document.getElementById("WC_PasswordUpdateForm_FormInput_EmailAddress").value=e,document.getElementById("autoPopulatedEmailHiddenDesktop").value=e),!1}),$("body, #quick-view-modal").on(tabEvent,".find-in-store",function(){if($("#compare_details").is(":visible")){var e=$(this).parents(".each-compare-product");d=$(".each-compare-product").index(e)}else $("#wishlist-holder").is(":visible")?(d=$(this).closest(".item").index(),$(".storeLocatorResults").html(""),$("#num-results").hide(),$(".disclaimer").hide(),$("#map").hide()):$("#certona-reco").length>0&&(d=$(this).closest(".each-reco-product").index()-1);return $("#StoreLocatorPdpModelDiv").dialog("open"),!1}),$("#LogonForm").submit(function(){return logonFormSubmit($(this)),!1}),$("#LogonSessionTimeoutForm").submit(function(){return logonFormTimeoutSubmit($(this)),!1}),$(".modals-container").on("submit","#ResetPasswordUpdateSubmitForm",function(){return $("#ResetPasswordUpdateSubmitForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{logonId:{required:!0,email:!0},logonPasswordOld:{required:!0},logonPassword:{required:!0,minlength:6,atLeastOneLetterAndOneDigit:!0},logonPasswordVerify:{required:!0,minlength:6,equalTo:"#logonPassword_updateModel",atLeastOneLetterAndOneDigit:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonPasswordOld:{required:MessageHelper.messages.OLD_PASSWORD_EMPTY_ERROR},logonPassword:{required:MessageHelper.messages.OLD_PASSWORD_EMPTY_ERROR,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},logonPasswordVerify:{required:MessageHelper.messages.PASSWORD_UPDATE_CONFIRM_ERROR,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH}},errorPlacement:function(e,a){var t=$(a).next(),n=$(a).parent().next();t.show(),n.addClass("error-red"),$(e).insertAfter(n)},unhighlight:function(e,a){var t=$(e).next(),n=$(e).parent().next();t.hide(),n.removeClass("error-red")}}),function(e){var a=$(e),t=(new Date).valueOf()-startTime,n=$("#sessionDuration").val()||"";if(t>=n&&""!=n)window.location.reload();else if(a.valid()){$("#successPassword").hide();var o=$("#WC_PasswordUpdateForm_FormInput_EmailAddress").val(),r=$("#WC_PasswordUpdateForm_FormInput_logonPasswordOld_In_Logon_1").val(),s="LogonAjaxView",i=$("#autoPopulatedEmailHiddenDesktop").val();if(constants.ajaxParams.loggedIn)if(o!=i)$("#WC_PasswordUpdateForm_FormInput_EmailAddress").addClass("required").removeClass("valid resetHighlight"),$("#PasswordUpdateFailureResponseMessageDiv").html("Your email address is incorrect, please try again.").show();else{var l=$("#ResetPasswordUpdateSubmitForm").serializeArray(),d=[];myperksURL=null;for(var c=0;c<l.length;c++){var u=l[c];"URL"==u.name?(u.value,d.push({name:"URL",value:"ResetPasswordAjaxView"})):d.push(u)}$.ajax({url:getAbsoluteURL(!0)+"ResetPassword",data:d,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.success){var a=$("#headerMyAccountURL").val()+"?myAccount=true";utagLinkSafe({link_name:"login"}),window.location=a}else $("#PasswordUpdateFailureResponseMessageDiv").html(e.errorMessage)},error:function(e,a,t){$("#PasswordUpdateFailureResponseMessageDiv").html("Reset password update failed - please try again later.")}})}else{var s="LogonAjax?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&logonId="+o+"&logonPassword="+r+"&errorViewName=LogonAjaxView&reLogonURL=LogonAjaxView&rememberMe=true&URL="+s+"&temp_signinPassword=&differentErrorMessgaeRequired=true";$.ajax({url:getAbsoluteURL(!0)+s,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.success){var a=$("#ResetPasswordUpdateSubmitForm").serializeArray(),t=[];myperksURL=null;for(var n=0;n<a.length;n++){var o=a[n];"URL"==o.name?(o.value,t.push({name:"URL",value:"ResetPasswordAjaxView"})):t.push(o)}$.ajax({url:getAbsoluteURL(!0)+"ResetPassword",data:t,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.success){var a=$("#headerMyAccountURL").val()+"?myAccount=true";utagLinkSafe({link_name:"login"}),window.location=a}else $("#PasswordUpdateFailureResponseMessageDiv").html(e.errorMessage)},error:function(e,a,t){$("#PasswordUpdateFailureResponseMessageDiv").html("Reset password update failed - please try again later.")}})}else{"20101"==e.errorCode?$("#WC_PasswordUpdateForm_FormInput_EmailAddress").addClass("required").removeClass("valid resetHighlight"):"20301"==e.errorCode&&$("#WC_PasswordUpdateForm_FormInput_logonPasswordOld_In_Logon_1").addClass("required").removeClass("valid resetHighlight"),$("#PasswordUpdateFailureResponseMessageDiv").html(e.errorMessage).show();tealium_data2track.push({id:"Error",Error_Source:"User",Error_Code:"Login",Error_Message:"Wrong Email, Wrong Password"})}},error:function(e,a,t){$("#PasswordUpdateFailureResponseMessageDiv").html("Reset password update failed - please try again later.").show();tealium_data2track.push({id:"Error",Error_Source:"Server",Error_Code:"Login",Error_Details:"Login Request Failed",Error_Message:"Reset password update failed - please try again later."})}})}}}($(this)),!1}),$(".modals-container").on("click","#regSubmit",function(){registerFormSubmit($(this).parents("form"))}),$("#EmailPreferencesForm").submit(function(e){var a=document.EmailPreferencesForm,t="",n="";$(".checkBoxareaEmail").is(":visible")&&(t=$(".checkBoxareaEmail:visible .isEmailChecked").val()),$(".checkBoxSubscribedareaEmail").is(":visible")&&(t=$(".checkBoxSubscribedareaEmail:visible .isEmailChecked").val()),$(".checkBoxareaPhone").is(":visible")&&(n=$(".checkBoxareaPhone:visible .isMobileChecked").val()),$(".checkBoxSubscribedareaPhone").is(":visible")&&(n=$(".checkBoxSubscribedareaPhone:visible .isMobileChecked").val()),null!=t&&"true"==t&&$("#recieveEmail_id").val("true"),null!=n&&"true"==n&&$("#receiveMobile_id").val("true"),a.womenStyle.checked&&$("#womenStyle_id").val("true"),a.menStyle.checked&&$("#menStyle_id").val("true"),a.childrenStyle.checked&&$("#childrenStyle_id").val("true"),a.classicStyle.checked&&$("#classicStyle_id").val("true"),a.trendyStyle.checked&&$("#trendyStyle_id").val("true"),a.sportStyle.checked&&$("#sportStyle_id").val("true"),a.exclusiveStyle.checked&&$("#exclusiveStyle_id").val("true"),a.contacts.checked&&$("#contacts_id").val("true"),a.wellness.checked&&$("#wellness_id").val("true"),a.tech.checked&&$("#tech_id").val("true"),a.sportLenses.checked&&$("#sportLenses_id").val("true"),a.multiLenses.checked&&$("#multiLenses_id").val("true"),a.oneSight.checked&&$("#oneSight_id").val("true"),a.jewelry.checked&&$("#jewelry_id").val("true"),a.durable.checked&&$("#durable_id").val("true"),a.look.checked&&$("#look_id").val("true"),a.yearlyExam.checked&&$("#yearlyExam_id").val("true"),a.participateActivities.checked&&$("#participateActivities_id").val("true"),a.sameStyle.checked&&$("#sameStyle_id").val("true"),a.shopAlone.checked&&$("#shopAlone_id").val("true"),a.expression.checked&&$("#expression_id").val("true"),a.needHelp.checked&&$("#needHelp_id").val("true"),a.largeFace.checked&&$("#largeFace_id").val("true"),a.smallFace.checked&&$("#smallFace_id").val("true"),a.narrowNose.checked&&$("#narrowNose_id").val("true"),a.wideNose.checked&&$("#wideNose_id").val("true"),a.justMe.checked&&$("#justMe_id").val("true"),a.partner.checked&&$("#partner_id").val("true"),a.under12.checked&&$("#under12_id").val("true"),a.twelveto18.checked&&$("#twelveto18_id").val("true");var o=this;e.preventDefault(),setTimeout(function(){o.submit()},400)}),$(".modals-container").on("keypress","#ResetPasswordForm",function(e){return 13!=e.keyCode||($("#ResetPasswordForm").valid()&&c(),!1)}),$(".modals-container").on("click","#passwordResetSubmitButton",function(){if(null!=document.getElementById("WC_PasswordResetForm_FormInput_logonId_In_ResetPasswordForm_1")&&"Enter your email address"!=document.getElementById("WC_PasswordResetForm_FormInput_logonId_In_ResetPasswordForm_1").value){var e=document.getElementById("currentID");null!=e&&(e.value=document.getElementById("WC_PasswordResetForm_FormInput_logonId_In_ResetPasswordForm_1").value)}return $("#ResetPasswordForm").valid()&&c(),!1}),$("#favoriteSignInModal #examForgotPasswordLink").on("click touchstart",function(){return $("#favoriteSignInModal #signInSection").css("display","none").attr("aria-hidden","true"),$("#favoriteSignInModal #ForgotPasswordSection").css("display","block"),!1}),$("#favoriteSignInModal  #modalPasswordResetSubmitButton").click(function(){if(null!=$("#favoriteSignInModal #WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm")&&"Enter your email address"!=$("#favoriteSignInModal #WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm").val()){var e=document.getElementById("currentID");null!=e&&(e.value=$("#favoriteSignInModal #WC_PasswordResetForm_FormInput_logonId_In_resetPasswordForm").val())}return $("#favoriteSignInModal #ForgotPasswordSection #resetPasswordForm").valid()&&(modelPWReset=!0,c()),!1}),$("#UpdatePasswordLink").click(function(){return $("#header-set-a-new-password-modal").css("display","block"),!1}),startTime=(new Date).valueOf(),$("#EyeExamsLink, #EyeExamsLinkInBody, .openEyeExamsModal").click(function(){var e=(new Date).valueOf()-startTime,a=$("#sessionDuration").val()||"";if(!(e>=a&&""!=a))return $("#EyeExamsModalDiv").dialog("open"),!1;window.location.reload()}),perkName="",$(".addPerks").click(function(){if(perkName=$(this).attr("data-perkname"),dataSidName=$(this).attr("data-sid"),dataCidName=$(this).attr("data-cid"),constants.ajaxParams.loggedIn){var e={};e.myPerkName=perkName,e.storeId=constants.ajaxParams.storeId,e.catalogId=constants.ajaxParams.catalogId,e.langId=constants.ajaxParams.langId,$.ajax({url:getAbsoluteURL()+"AjaxAddPerkCmd",data:e,dataType:"html",crossDomain:!0,success:function(e){var a=e;"string"==typeof a&&(a=filterAjaxResponse(e)),void 0===a.errorMessage||""==a.errorMessage?void 0!==a.displayFLModal&&"true"==a.displayFLModal?displayPerkAttributeModal():displayThankYouModal():void 0!==a.errorMessage&&""!=a.errorMessage?"_ERR_DIDNT_LOGON"==a.errorMessageKey&&(window.location=$("#headerMyAccountURL").val()):$(".LogOnFailureResponseMessageDiv").html(e.errorMessage).show()},error:function(e,a,t){$(".LogOnFailureResponseMessageDiv").html("Login request failed - please try again later.").show()}})}else $("#perkLogonModalPerkName").val(perkName),$("#perkRegModalPerkName").val(perkName),$("#perkLogonModalPerkName").val(perkName),$("#perkLogonDataSid").val(dataSidName),$("#perkLogonDataCid").val(dataCidName),$("#perkLogonFormContent").dialog("open"),$("#perk-register-modal").css("display","none"),$("#header-sign-in-modal").css("display","none"),$("#perk-logon-modal .perk-sign-in-link").addClass("active"),$("#perk-logon-modal .perk-account-link").removeClass("active"),$("#perk-logon-modal").css("display","block"),$("#perksheaderEmailAddress").focus();return!1}),$("#add-now, #verifyrx").click(function(e){e.preventDefault(),$("#verifyRxInfoModal").dialog("open")}),$(".return-to-your-account").click(function(){return $("#EyeExamsModalDiv").dialog("close"),!1}),$("#perkLogonForm").submit(function(){return logonFormSubmitPerks($(this)),!1}),$("#perksUserRegModelForm").submit(function(){return perksRegistrationFormSubmit($(this)),!1}),$("#regSubmitPerks").click(function(){registerFormSubmitPerks($(this).parents("form"))}),$(".plan-visit-holder-signed-in .section").each(function(){var e=$(this);e.hasClass("completed")&&e.hover(function(){e.children(".completed-holder").attr("aria-hidden","true").hide(),e.children(".start-over-holder").attr("aria-hidden","false").show()},function(){e.children(".completed-holder").attr("aria-hidden","false").show(),e.children(".start-over-holder").attr("aria-hidden","true").hide()})}),$(".planYourVisitCloseLink").click(function(){return closeYourLook(),!1}),$("#hello").on("click","#top-account-label",function(e){event.stopPropagation(),$("#header-notification-modal").toggle()}),$("#hello").on("click",".notification-click",function(e){var a=(new Date).valueOf()-startTime,t=$("#sessionDuration").val()||"";if(!(a>=t&&""!=t))return $(".notification-count").hasClass("active")?$(".notification-count").removeClass("active"):$(".notification-count").addClass("active"),!1;window.location.href=$("#headerMyAccountURL").val()}),window.logonParameters={onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",rules:{logonId:{required:!0,email:!0},logonPassword:{required:!0}},messages:{logonId:{required:"The email field cannot be empty.",email:"The provided email is invalid."},logonPassword:{required:"The password field cannot be empty."}},errorPlacement:function(e,a){var t=$(a).next(),n=$(a).parent().next();t.show(),n.addClass("error-red"),n.after(e)},unhighlight:function(e,a){var t=$(e).next(),n=$(e).parent().next();t.hide(),n.removeClass("error-red")}},$(document).keydown(function(e){$("#header-register-modal").is(":visible")&&9==e.keyCode&&$("#header-register-modal .sign-in-link").is(":focus")&&showLogonModal(),$("#header-sign-in-modal").is(":visible")&&13==e.keyCode&&$(".LogOnModalSubmitButton").click(),$(".ui-dialog-titlebar-close").is(":focus")&&32==e.keyCode&&($(".ui-dialog-content").dialog("close"),e.preventDefault()),$(".compareCheckBox").is(":focus")&&32==e.keyCode&&$(".compareCheckBox").is(":focus").click()}),$("#LogonDialogModalForm").validate(window.logonParameters),$("#LogonForm").validate(window.logonParameters),$("#LogonSessionTimeoutForm").validate(window.logonParameters),$("#perkLogonForm").validate(window.logonParameters),$.validator.addMethod("equalToIgnoreCase",function(e,a,t){return e.toLowerCase()==$(t).val().toLowerCase()});new Array;window.registerParameters={onfocusout:!1,onkeyup:function(e,a){13==a.keyCode&&registerFormSubmit(this.currentForm)},onclick:!1,errorClass:"required",rules:{logonId:{required:!0,email:!0},logonIdVerify:{required:!0,logonIdVerifyRequired:!0,email:!0,equalToIgnoreCase:"#logonId_regModel"},logonPassword:{required:!0,minlength:6,atLeastOneLetterAndOneDigit:!0},logonPasswordVerify:{required:!0,equalTo:"#logonPassword_regModel",atLeastOneLetterAndOneDigit:!0},optin_18yrs:{required:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonIdVerify:{required:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,logonIdVerifyRequired:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,equalToIgnoreCase:MessageHelper.messages.ERROR_EMAIL_MISMATCH},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},showErrors:function(e,a){this.defaultShowErrors();var t=!0;$("#header-register-modal div.fe span.required:visible").each(function(e,a){$(this).text()==MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR&&($(".passwordRequirements").hide(),t=!1)}),t&&$(".passwordRequirements").show()},errorPlacement:function(e,a){"optin_18yrs"==$(a).attr("name")?$(e).insertAfter($(a).next()):$(e).insertAfter(a),error_list.push(e.text())}},window.registerPerkParameters={onfocusout:!1,onkeyup:function(e,a){13==a.keyCode&&registerFormSubmit(this.currentForm)},onclick:!1,errorClass:"required",rules:{logonId:{required:!0,email:!0},logonIdVerify:{required:!0,logonIdVerifyRequired:!0,email:!0,equalToIgnoreCase:"#logonId_perkModel"},logonPassword:{required:!0,minlength:6,atLeastOneLetterAndOneDigit:!0},logonPasswordVerify:{required:!0,equalTo:"#logonPassword_perkModel",atLeastOneLetterAndOneDigit:!0},optin_18yrs:{required:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonIdVerify:{required:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,logonIdVerifyRequired:MessageHelper.messages.ERROR_LOGON_MODEL_EMAIL_CONFIRM,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,equalToIgnoreCase:MessageHelper.messages.ERROR_EMAIL_MISMATCH},logonPassword:{required:MessageHelper.messages.ERROR_PASSWORD_ENTER,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},logonPasswordVerify:{required:MessageHelper.messages.ERROR_PASSWORD_RE_ENTER,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},optin_18yrs:{required:MessageHelper.messages.EYE_EXAM_ERROR_NOT_18_YEARS_OLD}},errorPlacement:function(e,a){"optin_18yrs"==$(a).attr("name")?$(e).insertAfter($(a).next()):$(e).insertAfter(a),error_list.push(e.text())}},$("#userRegModelForm").validate(window.registerParameters),$("#perksUserRegModelForm").validate(window.registerPerkParameters),$("#userRegModelForm").find('input[type="checkbox"]').on("keyup",function(e){13==e.keyCode&&registerFormSubmit($(this).closest("form"))}),$("#ResetPasswordForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",rules:{logonId:{required:!0,email:!0}},messages:{logonId:{required:"The email field cannot be empty.",email:"The provided email is invalid."}},errorPlacement:function(e,a){var t=$(a).next(),n=$(a).parent().next();t.show(),n.addClass("error-red"),$(n).after(e)},unhighlight:function(e,a){var t=$(e).next(),n=$(e).parent().next();t.hide(),n.removeClass("error-red")}}),$("#PasswordUpdateForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{logonPassword:{required:!0,minlength:2,pattern:/\d/},logonPasswordVerify:{required:!0,minlength:2,pattern:/\d/,equalTo:"#logonPassword_updateModel"}},messages:{logonPassword:{required:MessageHelper.messages.PASSWORD_MIN_LENGTH_ERROR,minlength:MessageHelper.messages.PASSWORD_MIN_LENGTH_ERROR,pattern:MessageHelper.messages.PASSWORD_MIN_LENGTH_NUMERIC_ERROR},logonPasswordVerify:{required:MessageHelper.messages.PASSWORD_MIN_LENGTH_ERROR,minlength:MessageHelper.messages.PASSWORD_MIN_LENGTH_ERROR,pattern:MessageHelper.messages.PASSWORD_MIN_LENGTH_NUMERIC_ERROR,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH}}}),$("#PasswordUpdateSubmitForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",rules:{logonId:{required:!0,email:!0},logonPasswordOld:{required:!0},logonPassword:{required:!0,minlength:6,atLeastOneLetterAndOneDigit:!0},logonPasswordVerify:{required:!0,minlength:6,equalTo:"#logonPassword_updateModel",atLeastOneLetterAndOneDigit:!0}},messages:{logonId:{required:MessageHelper.messages.ERROR_Logon_model_EmailInvalid,email:MessageHelper.messages.ERROR_Logon_model_EmailInvalid},logonPasswordOld:{required:MessageHelper.messages.OLD_PASSWORD_EMPTY_ERROR},logonPassword:{required:MessageHelper.messages.OLD_PASSWORD_EMPTY_ERROR,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR},logonPasswordVerify:{required:MessageHelper.messages.PASSWORD_UPDATE_CONFIRM_ERROR,atLeastOneLetterAndOneDigit:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,minlength:MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR,equalTo:MessageHelper.messages.ERROR_PASSWORD_MISMATCH}},showErrors:function(e,a){this.defaultShowErrors();var t=!0;$("#header-set-a-new-password-modal div.fe span.required:visible").each(function(e,a){$(this).text()==MessageHelper.messages.PASSWORD_UPDATE_REQUIREMENTS_ERROR&&($(".passwordRequirements").hide(),t=!1)}),t&&$(".passwordRequirements").show()},submitHandler:function(e){var a=(new Date).valueOf()-startTime,t=$("#sessionDuration").val()||"";if(a>=t&&""!=t)window.location.reload();else{var n=$(e).serializeArray(),o=[],r=null;$("#successPassword").hide();for(var s=0;s<n.length;s++){var i=n[s];"URL"==i.name?(r=i.value,o.push({name:"URL",value:"ResetPasswordAjaxView"})):o.push(i)}$.ajax({url:getAbsoluteURL(!0)+"ResetPassword",data:o,dataType:"jsonp",crossDomain:!0,success:function(e){if(e.success)if(null==$("#successPassword").html()){var a=r;null!=a&&a.length&&"#"==a.charAt(a.length-1)&&(a=a.substring(0,x.length-1)),window.location=a}else $("#successPassword").show();else $("#PasswordUpdateFailureResponseMessageDiv").html(e.errorMessage)},error:function(e,a,t){$("#PasswordUpdateFailureResponseMessageDiv").html("Reset password update failed - please try again later.")}})}}}),$(".removeFctCookie").click(function(e){document.cookie="facets=; path=/"}),$(".cookFacet").click(function(e){if(!$(this).hasClass("link-disabled")){var a=$(this).data("item");a=a.replace(/ /g,"+"),$.cookie("latestAddedFacet",a,{path:"/"});var t=read_cookie("facets");document.cookie=null!=t?"facets="+t+"|"+a+"; path=/":"facets=|"+a+"; path=/"}}),$(".noThanks").click(function(e){$.cookie("hideRegistrationModal","true")}),$("#eye-exam-edit-click").on("click",function(e){e.preventDefault(),setTimeout(function(){window.location=nextURL},200)}),$(document.body).on("click","#AddAnotherExamLink",function(e){e.preventDefault(),location.href=$(this).attr("href")}),$(document.body).on("click",".eyeExamEditExam",function(e){e.preventDefault(),eyeExamEditEyeExamAnalytics(),location.href=$(this).attr("href")}),updateCompareBox()}),$(document).click(function(e){var a=!1,t=!1,n=!1,o=$("#header-sign-in-modal"),r=$("#header-register-modal"),s=$("#header-reset-password-modal"),i=e.target,l=!1,d=$("#header-notification-modal");(o==e.target&&($("#header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open")),r==e.target)&&($("#header-register-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),$("#userRegModelForm").validate().resetForm(),$(":input","#userRegModelForm").not(":hidden").val("").removeClass("required"));s==e.target&&($("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open")),$(i).parents().each(function(e,t){t==o[0]&&(a=!0)}),$(i).parents().each(function(e,a){a==r[0]&&(t=!0)}),$(i).parents().each(function(e,a){a==s[0]&&(n=!0)}),a||t||n||($("#header-sign-in-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearLoginErrorMessages(),$("#header-register-modal").css("display","none").attr("aria-hidden","true"),$("#header-reset-password-modal").css("display","none").attr("aria-hidden","true"),$(".sign-in-link").removeClass("open"),clearRegErrorMessages(),clearRegInputFields(),clearLoginFields()),$(i).parents().each(function(e,a){a==d[0]&&(l=!0)}),l||($("#header-notification-modal").css("display","none"),$(".notification-count").removeClass("active"))}),jQuery.validator.addMethod("antipattern",function(e,a,t){return $("span[for=locationEntry],#ErrorDivStoreSearch").hide(),this.optional(a)||!t.test(e)},"Invalid format."),jQuery.validator.addMethod("logonIdVerifyRequired",function(e,a,t){return"Enter e-mail address"!=e},"Please re-enter your email address"),$.validator.addMethod("postalFormatCheck",function(e,a){var t=/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i,n=/^\d{5}(-\d{4})?$/;return""!=$("#storeCountryName").val()&&"US"==$("#storeCountryName").val()?new RegExp(n).test(e):(null,new RegExp(t).test(e))}),$.validator.addMethod("atLeastOneLetter",function(e,a){return/^(?=.*[A-Za-z])[A-Za-z\d$@$!%*?&()^#-_~]{6,}$/.test(e)}),""!=$("#storeCountryName").val()&&"US"==$("#storeCountryName").val()?$.validator.messages.postalFormatCheck="Please enter a valid zip code":$.validator.messages.postalFormatCheck="Please enter a valid postal code";var ReviewSuccessURL,fromSubmitReview=!1;function popupSignInRegModal(e,a){return fromSubmitReview=!0,ReviewSuccessURL=e,showLogonModal(),!1}function read_cookie(e){var a;return(a=new RegExp("(?:^|; )"+e+"=([^;]*)").exec(document.cookie))?a[1]:null}function enableNavFocus(){var e="";$("li.top-level > a:first-child").focus(function(){""!=e&&e.next().hide(),(e=$(this)).next().show()})}function popUpFavoritesStoreLocModal(e){$("#StoreLocatorPdpModelDiv"+e).dialog("open")}function hideSaveFavorites(){$(".save-favorites-modal-text").hide(),$.cookie("saveFavoritesHidePrompt","1",{path:"/"})}function closeYourLook(){isOpen=!1,$("#PlanYourVisitDiv").attr("aria-hidden","true").slideUp("400"),$("li.plan-visit").removeClass("on"),removeUIoverlay(),$(".ui-widget-overlay").removeClass("lower-zindex"),$("#header_wrapper").removeClass("height-for-plan-visit-dropdown")}var sliderModification=void $("document").ready(function(){$("#zone1 .slideshow .ad_product .info").last().css({"margin-top":"40px"}),$("#zone1 .slideshow .ad_product .info h1").last().css({color:"#1f1f1f"}),$("#zone1 .slideshow .ad_product:eq(2) .info h1").css({color:"#1f1f1f"}),$("#zone1 .slideshow .ad_product .info br").last().remove(),$("#zone1 .slideshow .ad_product:eq(2) .info p, #zone1 .slideshow .ad_product:eq(3) .info p").css({color:"#1f1f1f","font-family":"verdana"}),$(".banner-landing-image .ad_product div br").remove(),$(".banner-landing-image.lens-landing .info p").css({"font-size":"13px !important","line-height":"19px !important"})});function highlightLeftNav(e){var a=$("#leftNav"),t=a.find("ul li"),n=a.find("."+e);t.removeClass("selected"),n.addClass("selected"),n.hasClass("acct-profile-link")?(n.addClass("leftNavProfileSelected").removeClass("selected"),n.find(".heading a").addClass("selected")):n.hasClass("acct-landing")&&(n.addClass("leftNavProfileSelected").removeClass("selected"),n.find(".heading a").addClass("selected"));var o=n.parent().parent();$(o).addClass("leftNavProfileSelected")}function initTopNavigationLinkHandlers(){$("#link_product_style").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style"})}),$("#link_men").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Men"}),console.log("top nav event fired")}),$("#link_women").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Women"})}),$("#link_kids").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Kids"})}),$("#link_eyeglasses").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Eyeglases"})}),$("#link_sunglasses").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Sunglasses"})}),$("#link_lenses").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Lenses"})}),$("#link_contactlenses").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Contact Lenses"})}),$("#link_accessories").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Accessories"})}),$("#link_prescription_sport").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Prescription Sport"})}),$("#link_prescription_safety").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Prescription Safety"})}),$("#link_brands").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Brands"})}),$("#link_trends").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Trends"})}),$("#link_collections").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Products and Style | Collections"})}),$("#link_eyecare_service").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service"})}),$("#link_schedule_an_eyeexam_top").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Schedule an Eye Exam"})}),$("#link_storelocations").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Store Locations"})}),$("#link_accufit").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Accufit"})}),$("#link_mylook").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | My look"})}),$("#link_lenssimulator").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Lenssimulator"})}),$("#link_visionguide").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Visionguide"})}),$("#link_doctors_office").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Doctor's office"})}),$("#link_onsite_lab").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | On-site Lab"})}),$("#eyecare_service_link_visit_customer_service").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Visit Customer Service"})}),$("#eyecare_service_link_purchasecare").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Purchase Care"})}),$("#eyecare_service_link_faqs").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | FAQs"})}),$("#eyecare_service_link_contact_us").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Contact Us"})}),$("#link_seeing_eyeexams").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Seeing Eye Exams"})}),$("#eyecare_service_link_schedule_an_eyeexam_bottom").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Eyecare and Service | Schedule an Eye Exam"})}),$("#link_savings").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings"})}),$("#link_offers_and_discounts").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Offers and Discounts"})}),$("#link_insurance").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Insurance"})}),$("#link_lenscrafters_creditcards").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Lenscrafters credit card"})}),$("#savings_link_visit_customer_service").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Visit Customer Service"})}),$("#savings_link_purchasecare").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Purchase Care"})}),$("#savings_link_faqs").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | FAQs"})}),$("#savings_link_contact_us").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Contact Us"})}),$("#savings_link_schedule_an_eyeexam_bottom").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Savings | Schedule an Eye Exam"})}),$("#link_ourvision").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision"})}),$("#link_about_lenscrafters").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | About Lenscrafters"})}),$("#link_ourstores").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Our Stores"})}),$("#link_onesight").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Onesight"})}),$("#link_ourblog").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Our Blog"})}),$("#ourvision_link_visit_customer_service").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Visit Customer Service"})}),$("#ourvision_link_purchasecare").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Purchase Care"})}),$("#ourvision_link_faqs").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | FAQs"})}),$("#ourvision_link_contact_us").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Contact Us"})}),$("#ourvision_link_schedule_an_eyeexam_bottom").click(function(e){utagLinkSafe({link_name:"topNav",nav_link:"Our Vision | Schedule an Eye Exam"})})}function catalogScroll(){var e=$("body").hasClass("catalog-search-page");($("body").hasClass("catalog-page")||e)&&$(window).scroll(function(){var a=$(this).scrollTop(),t=$("#global-banner").length>0,n=$(".search-tabs").length>0,o=t?235:185,r=t?$("#global-banner").outerHeight():0,s=$(".search-espots img").length>0?155:0,i=t?o+s:o-r+s;i=n?i:i-95;$facetHolderPosition=e?148:118,$facetHolderPosition=118,$linePosition=e?186:156,$linePosition=n?$linePosition:156,$searchTabs=99,setFixed=function(){$(".facet-holder, .products_holder, #header-line, .search-tabs").addClass("fixed"),$(".facet-holder").css("top",$facetHolderPosition+"px"),$(".info.search-tab").find("a").hasClass("on")?$("#header-line").css("top","148px"):$("#header-line").css("top",$linePosition+"px"),$(".search-tabs").css("top",$searchTabs+"px")},a>=(t?118:118-r)&&!e?setFixed():a>=i&&e?setFixed():($(".facet-holder, .products_holder, #header-line, .search-tabs").removeClass("fixed"),$(".facet-holder, #header-line").css("top","0px"),$(".search-tabs").css("top","-6px"))})}function recoModalOpen(){$("#recoModal").dialog({width:490,modal:!0,autoOpen:!0,open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove()}})}function switchImageViews(){$("#loadButton").click(function(){window.lazyLoaded||($(".lazyLoadClass").lazyload(),window.lazyLoaded={})}),$("#front-view").click(function(){return $("#view-switcher").find(".active").removeClass("active"),$(this).addClass("active"),$(".catEntry_Image_PLP").each(function(){var e=$(this).siblings(".catEntry_Image_PLP_Alt"),a=$(this).attr("src"),t=e.attr("src");a!=t&&(a=(a=a.replace("_fr","_qt")).replace("_qt","_fr"),$(this).attr("src",a),t=(t=t.replace("_qt","_fr")).replace("_fr","_qt"),e.attr("src",t))}),!1}),$("#quarter-view").click(function(){return $("#view-switcher").find(".active").removeClass("active"),$(this).addClass("active"),$(".catEntry_Image_PLP").each(function(){var e=$(this).siblings(".catEntry_Image_PLP_Alt"),a=$(this).attr("src"),t=e.attr("src");a!=t&&(a=(a=a.replace("_qt","_fr")).replace("_fr","_qt"),$(this).attr("src",a),t=(t=t.replace("_fr","_qt")).replace("_qt","_fr"),e.attr("src",t))}),!1})}function recoLinkClick(){$(".reco-link").live("click",function(){recoModalOpen()})}function toggleThumbnailImage(e,a,t){$this=$(t),".catEntry_Image_PLP_Alt"==a&&void 0!==$this.find(a).attr("data-original")&&$this.find(a).attr("src",$this.find(a).attr("data-original")),$this.find(e).hide(),$this.find(a).show()}function getUserName(){if(document.getElementById("greet_user")){var e="GreetUserView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:getAbsoluteURL()+e,dataType:"html",success:function(e){$("#greet_user").html(e)}})}}function refreshNotifications(){if(document.getElementById("ajaxRefreshNotifications")){var e=getAbsoluteURL()+"AjaxAccountNotificationsView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId;$.ajax({url:e,dataType:"html",success:function(e){if(0==$(e).find(".sessionTimeoutPage").length&&e.indexOf("totalNoOfAlerts")>0){document.getElementById("ajaxRefreshNotifications").innerHTML=e;var a=document.getElementById("totalNoOfAlerts").value;a>0&&(document.getElementById("notification-click").style.display="inline-block",document.getElementById("notificationsDisplayDiv").textContent=a,$("#header-myaccount-notify").removeClass("has-notification").addClass("has-notification"),$("#notificationsDisplayDiv").hover(function(){$(this).attr("title","notification("+$("#notificationsDisplayDiv").text()+")")}))}}})}}function geoLocationSchedule(){if(constants.isExamsNearMeEnabled&&(null!=document.getElementById("rightNavPromoDefault")||null!=document.getElementById("topNavPromoSuccess"))){var e=$.cookie("lc_latitude"),a=$.cookie("lc_longitude");null!=e&&""!=e&&null!=a&&""!=a&&ifGeoLocationAllowed(e,a)}}function ifGeoLocationAllowed(e,a){var t=getAbsoluteURL()+"AjaxGetGeoLocationScheduleView?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&latitude="+e+"&longitude="+a;$.ajax({url:t,dataType:"json",success:function(e){"success"==e.status&&checkEpointmentAndPopulateWidget(e)}})}function checkEpointmentAndPopulateWidget(e){var a=getAbsoluteURL()+"AjaxGetAppointmentListForWidgetCmd?storeId="+constants.ajaxParams.storeId+"&catalogId="+constants.ajaxParams.catalogId+"&langId="+constants.ajaxParams.langId+"&storeNumber="+e.storeNumber;$.ajax({url:a,dataType:"json",success:function(a){if("success"==a.status){try{document.getElementById("widgetExamCenter").innerHTML=e.storeName+"<br>"+e.storeAddressLine,document.getElementById("widgetFirstAvailableDate").innerHTML=a.firstAvailableDate,document.getElementById("widgetSecondAvailableDate").innerHTML=a.secondAvailableDate,document.getElementById("widgetThirdAvailableWeekendDate").innerHTML=a.thirdAvailableWeekendDate,document.getElementById("widgetFirstAvailableTime").innerHTML=a.firstAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("widgetSecondAvailableTime").innerHTML=a.secondAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("widgetThirdAvailableWeekendTime").innerHTML=a.thirdAvailableWeekendTime.replace(":",'<span class="colon">:</span>'),document.getElementById("widgetUrl").href=e.url,document.getElementById("rightNavPromoDefault").style.display="none",document.getElementById("rightNavPromoSuccess").style.display="block"}catch(e){}try{document.getElementById("navExamCenter").innerHTML=e.storeName+", "+e.storeAddressLine,document.getElementById("navMiles").innerHTML=e.miles+" Mi",document.getElementById("navFirstAvailableDate").innerHTML=a.firstAvailableDate,document.getElementById("navSecondAvailableDate").innerHTML=a.secondAvailableDate,document.getElementById("navThirdAvailableWeekendDate").innerHTML=a.thirdAvailableWeekendDate,document.getElementById("navFirstAvailableTime").innerHTML=a.firstAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("navSecondAvailableTime").innerHTML=a.secondAvailableTime.replace(":",'<span class="colon">:</span>'),document.getElementById("navThirdAvailableWeekendTime").innerHTML=a.thirdAvailableWeekendTime.replace(":",'<span class="colon">:</span>'),document.getElementById("navUrl").href=e.url,document.getElementsByClassName("top-level eyecare")[0].getElementsByClassName("subnav")[0].getElementsByClassName("column image-spots")[0].getElementsByClassName("image-holder")[0].firstElementChild.innerHTML=document.getElementById("topNavPromoSuccess").innerHTML}catch(e){}}}})}function resetRightNavWidget(){$("#rightNavPromoSuccess")&&$("#rightNavPromoDefault")&&($("#rightNavPromoSuccess").hide(),$("#rightNavPromoDefault").show())}function checkMobile(e){if($(e+" :visible").find("select :selected").text().indexOf("Mobile")>-1)return!0}function showMultiplePDModal(){showStandardModal("#MultiplePDModal","multiple-modal")}function showPDModal(){showStandardModal("#PDModal","pd-modal")}function removeNullEntries(e){var a=[];return $.each(e,function(e,t){void 0===t||null==t||"null"==t||a.push(t)}),a}function showStandardModal(e,a){var t=$(e);if(t.length<1)return!1;t.dialog({modal:!0,resizeable:!1,width:"520px",dialogClass:a+" standard-modal"})}function executeBackButtonStep3(){try{for(var e=document.getElementById("activeLockIds").value.split(","),a="",t=2;t>=0;t--)if(null!=e[t]&&""!=e[t].trim()){a=t+1;break}return document.getElementById("BackbuttonLink").href=""!=a?document.getElementById("ScheduleExamReview_EditExam_Link"+a).href:document.getElementById("AddAnotherExamLink").href,!0}catch(e){return!1}}function addSyncValueToDbForEyeExam(e){var a=$(e);$.ajax({url:getAbsoluteURL(!0)+"AjaxUserRegistrationUpdate",data:a.serializeArray(),dataType:"json",crossDomain:!0,success:function(e){document.getElementById("consentFormStepfour").style.display="none",document.getElementById("syncExamAgree").style.display="block"}})}function checkStepFourSync(){$("#consentFormsubmit").on("click",function(){$("#consentFormStepfour").valid()&&addSyncValueToDbForEyeExam($("#consentFormStepfour"))}),$("#consentFormStepfour").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",rules:{consentCheckbox:{required:!0}},messages:{consentCheckbox:MessageHelper.messages.ERROR_CONSENT_CHECKBOX_APPOINTMENT},errorPlacement:function(e,a){for(var t=[],n=!1,o=0;o<t.length;o++)n=n||t[o]==a.attr("name");n||"consentCheckbox"==$(a).attr("name")&&($(e).css({float:"none",display:"block"}).insertAfter($(a).next()),a.siblings("label").append(e).addClass("validationError")),error_list.push(e.text())}})}function stepFourManageExam(){$("#regExam").on("click",function(){$("#userRegModelFormExam").valid()}),$("#userRegModelFormExam").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",rules:{optin_18yrs:{required:!0},dob1_1:{eyeExamValidDOB:!0,eyeExamValidLeapYear:!0,required:!0},dob1_2:{eyeExamValidDOB:!0,eyeExamValidLeapYear:!0,required:!0},dob1_3:{eyeExamValidDOB:!0,eyeExamValidLeapYear:!0,required:!0}},messages:{optin_18yrs:MessageHelper.messages.ERROR_18_CERTIFY,dob1_1:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dob1_2:{required:MessageHelper.messages.BDAY_FIELDS_REQ},dob1_3:{required:MessageHelper.messages.BDAY_FIELDS_REQ}},errorPlacement:function(e,a){for(var t=[],n=!1,o=0;o<t.length;o++)n=n||t[o]==a.attr("name");n||("optin_18yrs"==$(a).attr("name")?($(e).css({float:"none",display:"block"}).insertAfter($(a).next()),a.siblings("label").append(e).addClass("validationError")):-1!=$(a).attr("name").indexOf("dob")?a.parent().append(e).addClass("validationError"):$(e).addClass("validationError").insertAfter(a)),error_list.push(e.text())},showErrors:function(e,a){this.defaultShowErrors(),$(".dobfield span.required:visible").filter(function(e){return 0!=e}).hide()},highlight:function(e,a){$(e).addClass("required"),$(e).parent().addClass("validationError")},unhighlight:function(e,a){$(e).removeClass("required"),$(e).parent().removeClass("validationError")}})}function storeStep3session(){try{"undefined"!=typeof Storage&&-1!=window.location.href.indexOf("AjaxStoreLocatorDisplayView")&&sessionStorage.setItem("Step3_Visited",!1),"undefined"!=typeof Storage&&-1!=window.location.href.indexOf("ReviewExamView")&&sessionStorage.setItem("Step3_Visited",!0),"true"==sessionStorage.getItem("Step3_Visited")&&-1!=window.location.href.indexOf("ScheduleExamView")?$(".fe .schedule-actions-buttons .backbuttonhide").remove():("false"==sessionStorage.getItem("Step3_Visited")&&window.location.href.indexOf("ScheduleExamView"),$(".fe .schedule-actions-buttons .cancelbuttonhide").remove(),$(".fe .schedule-actions-buttons .backbuttonhide").show())}catch(e){}}function invokeLazyLoad(){"IntersectionObserver"in window?$("div.dots-loader").each(function(e,a){lazyImageObserver.observe(a)}):void 0!==$.fn.lazyload&&$("img.lazy").lazyload({effect:"fadeIn",threshold:100,skip_invisible:!0}).on("load",function(){var e=$(this);e.removeClass("lazy"),e.addClass("lazy-loaded")}).each(function(){this.complete&&$(this).isInViewport()&&$(this).trigger("load")})}if($("document").ready(function(){if(null!=document.getElementById("clickAppointment")&&document.getElementById("clickAppointment").value){var e=(new Date).valueOf()-(new Date).valueOf(),a=$("#sessionDuration").val()||"";e>=a&&""!=a?window.location.reload():$("#EyeExamsModalDiv").dialog("open")}var t=$(".showWaitModal").val()||"",n=$("#eyeExamDelayTimeMs").val()||"";"true"===t&&""!==t&&($(".showWaitModalContainer").dialog("open"),setTimeout(function(){$(".showWaitModalContainer").dialog("close")},n),window.location.href=$("#EyeExamHistoryURLVal").val())}),window.addEventListener?window.addEventListener("message",function(e){try{var a=$.parseJSON(e.data);$("#rightNowContainer, #rightNowWrapper").height(a.height)}catch(e){}}):window.attachEvent("onmessage",function(e){try{var a=$.parseJSON(e.data);if(!_.isEmpty(a)&&_.isNumber(a.height)){var t=a.height+100;$("#rightNowContainer, #rightNowWrapper").height(t)}}catch(e){}}),function(e){e(document).ready(function(){setTimeout(function(){e(".orangeFill").each(function(){var a=e(this);a.val()&&a.val()!=a.attr("placeholder")?a.addClass("ok"):a.removeClass("ok")})},1e3),setTimeout(function(){e(".contact-section-number.orangeFill").each(function(){var a=e(this);""===a.find("input[name=phone1_1]").val()||""===a.find("input[name=phone1_2]").val()||""===a.find("input[name=phone1_3]").val()?a.removeClass("ok"):a.addClass("ok")})},1e3)}),e(document).on("change focusout focus","input.orangeFill, select.orangeFill",function(a){var t=e(this);"focusin"==a.type?(t.removeClass("orangeFill"),t.addClass("ok")):(t.val(e.trim(t.val())),""===t.val()?t.removeClass("ok"):t.addClass("ok"))}),e(document).on("change focusout focus",".contact-section-number.orangeFill",function(a){var t=e(this);"focusin"==a.type?t.addClass("ok"):""===t.find("input[name=phone1_1]").val()||""===t.find("input[name=phone1_2]").val()||""===t.find("input[name=phone1_3]").val()?t.removeClass("ok"):t.addClass("ok")}),e(document).on("change focusout focus",".dob_field1.orangeFill",function(a){var t=e(this);"focusin"==a.type?t.addClass("ok"):""!==t.find("input[name=dob1_1]").val()||""!==t.find("input[name=dob1_2]").val()||""!==t.find("input[name=dob1_3]").val()?t.addClass("ok"):""!==t.find("input[name=dob1_1]").val()&&""!==t.find("input[name=dob1_2]").val()&&""!==t.find("input[name=dob1_3]").val()||t.removeClass("ok")})}(jQuery),function(e){jQuery.fn.extend({trap:function(){if(!this.jquery)return!1;var e=this.find("a:visible, input:visible").not(':[tabindex="-1"]'),a=e.first(),t=e.last();a.on("keydown",function(e){9===(e.keyCode||e.which)&&e.shiftKey&&(e.preventDefault(),t.focus())}),t.on("keydown",function(e){9!==(e.keyCode||e.which)||e.shiftKey||(e.preventDefault(),a.focus())})}})}(),function(){$.fn.extend({initCarousel:function(){var e=$(this);e.owlCarousel({navigation:!e.attr("data-navigation")||"true"===e.attr("data-navigation"),slideSpeed:300,paginationSpeed:400,singleItem:!0,autoPlay:!e.attr("data-autoplay")||"true"===e.attr("data-autoplay"),addClassActive:!0,afterInit:function(){},afterMove:function(){},startDragging:function(){this.stop()}})}})}(jQuery),function(e){e.fn.basicTabs=function(a){var t=e.extend({active_class:"is-active",open_class:"is-open",list_class:"c-tabs",starting_tab:1},a);e("."+t.list_class).each(function(){e(this).children("li:nth-child("+t.starting_tab+")").children("a").addClass(t.active_class).next().addClass(t.open_class).show()}),e("."+t.list_class).on("click","li > a.c-tabs__link",function(a){if(e(this).hasClass(t.active_class))a.preventDefault();else{a.preventDefault();var n=e(this).closest("."+t.list_class);n.find("."+t.open_class).removeClass(t.open_class).hide(),e(this).next().toggleClass(t.open_class).toggle(),n.find("."+t.active_class).removeClass(t.active_class),e(this).addClass(t.active_class)}})}}(jQuery),function(e){e.fn.loading=function(a){return this.pastPosition=this.pastPosition?this.pastPosition:this.css("position"),!0===a?(this.css("position",this.pastPosition?this.pastPosition:"static"),this.find(".loading_overlay").detach().remove()):this.find(".loading_overlay").length||("static"!=this.pastPosition&&"initial"!=this.pastPosition&&"inherit"!=this.pastPosition||this.css("position","relative"),e("<div>").addClass("loading_overlay").appendTo(this)),this},e.fn.loadingStart=function(){return this.loading(!1)},e.fn.loadingDone=function(){return this.loading(!0)},e.fn.redraw=function(){return e(this).each(function(){this.offsetHeight}),this}}(jQuery),$(function(){checkOrientationAndForce()}),$(document).ready(function(){$(document).on("click",".pd-select-one .selectBox-menuShowing",function(){if($(".drop_down_checkout-selectBox-dropdown-menu").is(":visible")){var e=$.extend(!0,{},_dl);e.site_events={select_pupillary_distance:"true"};var a=$("#currentItemIndex").val();a>=0&&void 0!=_dl.products_in_cart&&_dl.products_in_cart.length>a&&(e.product=[_dl.products_in_cart[a]])}}),$(".multiple-pd-link").on("click",function(){return showMultiplePDModal(),!1}),$("#myAccount #right.right-container .small-container.favorites .the-price a").click(function(e){e.preventDefault()}),$("input[name=phone1_1]").keyup(function(){$(this).val(this.value.substring(0,3)),3==this.value.length&&$(this).parents("form").find("input[name=phone1_2]").focus()}),$("input[name=phone1_2]").keyup(function(){$(this).val(this.value.substring(0,3)),3==this.value.length&&$(this).parents("form").find("input[name=phone1_3]").focus()}),$("input[name=phone1_3]").keyup(function(){$(this).val(this.value.substring(0,4))}),$("input[name=dob1_1]").keyup(function(){$("input[name=dob1_1]").val(this.value.substring(0,2)),2==this.value.length&&$("input[name=dob1_2]").focus()}),$("input[name=dob1_2]").keyup(function(){$("input[name=dob1_2]").val(this.value.substring(0,2)),2==this.value.length&&$("input[name=dob1_3]").focus()}),$("input[name=dob1_3]").keyup(function(){$("input[name=dob1_3]").val(this.value.substring(0,4))}),$.validator.addMethod("validAlphaNumberPurchaseSync",function(e,a){return!!e.match(/^([a-zA-Z0-9]+)$/)},"Please enter a valid receipt number"),$.validator.addMethod("customDateValidation",function(e){var a,t,n,o=!0,r=new Date(e);if(isNaN(r.getTime())&&(o=!1),a=r.getMonth()+1,t=r.getDate(),n=r.getFullYear(),0==t||0==a||0==n)o=!1;else if(a<new Date(n,a-1,t).getMonth()+1)o=!1;else{var s=new Date,i=new Date(r),l=s.getFullYear()-i.getFullYear(),d=s.getMonth()-i.getMonth();(d<0||0===d&&s.getDate()<i.getDate())&&l--,l<18&&(o=!1)}return o},"Invalid date! Ex: mm/dd/yyyy"),$("#personalInfo").validate({onkeyup:!1,onclick:!1,onfocusout:!1,errorClass:"required",errorPlacement:function(e,a){var t=$(a).next(),n=$(a).parent().next();t.show(),n.addClass("error-red"),n.after(e),$(a).glTypeaheadAddError(e)},rules:{firstNameInsurance:"required",lastNameInsurance:"required",dateBirth:{required:!0,customDateValidation:!1},zip_input:{required:!0,minlength:4,maxlength:5,digits:!0},insuranceProviderSelect:{required:!0,glTypeaheadValidation:!0}},messages:{firstNameInsurance:{required:"The first name field cannot be empty."},lastNameInsurance:{required:"The last name field cannot be empty."},dateBirth:{required:"The date of birth field cannot be empty.",customDateValidation:"The provided date of birth is invalid."},zip_input:{required:"The zip code or SSN field cannot be empty.",minlength:"The provided zip code or SSN is invalid.",maxlength:"The provided zip code or SSN is invalid.",digits:"The provided zip code or SSN is invalid."},insuranceProviderSelect:{required:"The insurance provider is not valid.",glTypeaheadValidation:"The insurance provider is not valid."}},unhighlight:function(e,a){var t=$(e).next(),n=$(e).parent().next();t.hide(),n.removeClass("error-red"),$(e).glTypeaheadRemoveError()},submitHandler:function(e){checkInsurance()}}),$("#accountPersonalizationForm").validate({onkeyup:!1,onclick:!1,errorClass:"required",onfocusout:!1,rules:{firstName:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")}}},lastName:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},dobMonth:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobYear]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},dobDay:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobYear]").val()||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},dobYear:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}},check_date_of_birth_future:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}},check_date_of_birth:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm select[name=dobMonth]").val()||""!==$("form#accountPersonalizationForm select[name=dobDay]").val()||$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}},phone1_1:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"], form#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm input[name=phone1_2]").val()||""!==$("form#accountPersonalizationForm input[name=phone1_3]").val()}},minlength:3,number:!0},phone1_2:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"], form#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm input[name=phone1_1]").val()||""!==$("form#accountPersonalizationForm input[name=phone1_3]").val()}},minlength:3,number:!0},phone1_3:{required:{depends:function(e){return $('form#accountPersonalizationForm .doctorDisplay input[type="checkbox"], form#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")||""!==$("form#accountPersonalizationForm input[name=phone1_1]").val()||""!==$("form#accountPersonalizationForm input[name=phone1_2]").val()}},minlength:4,number:!0},receiptNumber:{required:{depends:function(e){return $('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}},validAlphaNumberPurchaseSync:{depends:function(e){return $('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")}}}},messages:{firstName:{required:"Please enter a first name"},lastName:{required:"Please enter a last name"},dobMonth:{required:"Please enter your birthday"},dobDay:{required:"Please enter your birthday"},dobYear:{required:"Please enter your birthday"},phone1_1:{required:"Please enter a phone number",minlength:"Please enter a valid phone number",number:"Please enter a valid phone number"},phone1_2:{required:"Please enter a phone number",minlength:"Please enter a valid phone number",number:"Please enter a valid phone number"},phone1_3:{required:"Please enter a phone number",minlength:"Please enter a valid phone number",number:"Please enter a valid phone number"},receiptNumber:{required:"Please provide a receipt number"}},showErrors:function(e,a){if(this.defaultShowErrors(),$(".dateOfBirth span.required:visible").filter(function(e){return 0!=e}).hide(),$(".phoneNumeber span.required:visible").filter(function(e){return 0!=e}).hide(),$('.contact-section-number span.required:contains("Please enter a valid phone number")').length>0&&($('.contact-section-number span.required:visible:contains("Please enter a phone number")').hide(),$('.contact-section-number span.required:contains("Please enter a valid phone number")').first().show()),a&&a.length){Number.MAX_VALUE;null}$(".contact-section-number span.required:visible").length>0&&($(".contact-section-number").addClass("validationError"),$('#accountPersonalizationForm .smsAgreement input[type="checkbox"]').is(":checked")?($("#accountPersonalizationForm .smsAgreement").find("span.required").show(),$('#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")||$('.contact-section-number span.required:contains("Please enter a phone number")').length>0&&$('.contact-section-number span.required:contains("Please enter a phone number")').hide().parents(".contact-section-number").removeClass("validationError")):$("#accountPersonalizationForm .smsAgreement").find("span.required").hide()),$(".dateOfBirth span.required:visible").length>0?$(".dateOfBirth select").addClass("required"):$(".dateOfBirth select").removeClass("required"),$("#accountPersonalizationForm span.required:visible").length>0&&($('#accountPersonalizationForm .doctorDisplay input[type="checkbox"]').is(":checked")?$("#accountPersonalizationForm .doctorDisplay").find("span.required").show():$("#accountPersonalizationForm .doctorDisplay").find("span.required").hide()),$("#accountPersonalizationForm span.required:visible").length>0&&$('form#accountPersonalizationForm .purchaseHistoryInfo input[type="checkbox"]').is(":checked")?$("<span class='required purchaseSync'>To sync purchase history, please complete the highlighted fields above</span>").appendTo(".purchaseHistoryInfo").show():$(".purchaseHistoryInfo .purchaseSync").hide()},submitHandler:function(e){$("form#accountPersonalizationForm").each(function(){var e=$(this),a=e.find("input[name=phone1_1]").val()+e.find("input[name=phone1_2]").val()+e.find("input[name=phone1_3]").val();e.find("input[name=phone1]").val(a);var t=e.find("select[name=dobYear]").val(),n=e.find("select[name=dobMonth]").val(),o=e.find("select[name=dobDay]").val();n<10&&(n="0"+n),o<10&&(o="0"+o);var r=null;null==t&&""==t||null==n&&""==n||null==o&&""==o||(r=t+"-"+n+"-"+o),e.find("input[name=dateOfBirth]").val(r)}),e.submit()},highlight:function(e,a){$(e).addClass("required"),$(e).parent().addClass("validationError")},unhighlight:function(e,a){$(e).removeClass("required"),$(e).parent().removeClass("validationError")}})}),$.validator.addMethod("eyeExamValidDOB",function(e,a){var t=$("#dob1_1").val(),n=$("#dob1_2").val(),o=$("#dob1_3").val();if(""!=o&&""!=t&&""!=n&&new Date(o,t,n)>new Date)return!1;return!0},MessageHelper.messages.BDAY_FIELDS_INVALID),$.validator.addMethod("eyeExamValidLeapYear",function(e,a){var t=$("#dob1_1").val(),n=$("#dob1_2").val(),o=$("#dob1_3").val(),r=new Date(o,t-1,n);return""==o||""==t||""==n||r.getFullYear()==o&&r.getMonth()+1==t&&r.getDate()==n},MessageHelper.messages.BDAY_FIELDS_INVALID),"IntersectionObserver"in window){console.log("Using IntersectionObserver as LazyLoader");var lazyImageObserver=new IntersectionObserver(function(e,a){e.forEach(function(e){void 0===e.isVisible&&(e.isVisible=!0),e.isIntersecting&&e.isVisible&&($(e.target).hasClass("dots-loader")?(lazyImageObserver.unobserve(e.target),$(e.target).find("img.lazy, picture.lazy source").each(function(e,a){lazyLoadImg(a)})):(lazyLoadImg(e.target),lazyImageObserver.unobserve(e.target),$(e.target).siblings('img.[class$="lazy"]').each(function(e,a){lazyLoadImg(a),lazyImageObserver.unobserve(a)})))})},{trackVisibility:!0,delay:100})}function cleanImgUrlFmt(e){if(e.indexOf("?")<0)e+="?";else for(var a=e.substring(e.indexOf("?")+1).split("&"),t=0;t<a.length;t++){if(a[t].startsWith("fmt="))if(t==a.length-1)e=e.substring(0,e.lastIndexOf("&fmt="));else e=e.substring(0,e.indexOf(a[t]))+e.substring(e.indexOf(a[t+1]))}return e}function filterAkamaiIMNextGen(e){return e.indexOf("assets")>0&&1==window.glassesFunctions.getNextGenEnabled()?(e=cleanImgUrlFmt(e),1==(!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime))?e+"&fmt=webp":(console.log("no nextgen format"),e)):(console.log("nextgen format not enabled or not akamai IM"),e)}function lazyLoadImg(e){var a=null;if(e.dataset.lazyLoaded?a=e.dataset.lazyLoaded:e.dataset.original?a=e.dataset.original:e.dataset.src&&(a=e.dataset.src),null!=a)try{$(e).is("source")?($(e).siblings("img")[0].onload=function(){$(e).closest(".dots-loader").removeClass("dots-loader")},e.srcset=a):(e.onload=function(){$(e).removeClass("img-unfit"),$(e).removeClass("lazy-hidden"),$(e).closest(".dots-loader").removeClass("dots-loader")},e.classList.contains("no-next-gen"),e.src=a)}catch(t){e.src=a}if(!$(e).is("source")){var t=$(e).attr("class").split(" ");$.each(t,function(a,t){0==t.indexOf("lazy")&&$(e).removeClass(t)})}}function registerLazyLoadByClass(e,a){"IntersectionObserver"in window?$(e).each(function(e,a){lazyImageObserver.observe(a)}):(void 0==a&&(a=50),void 0!==$.fn.lazyload&&(console.log("LAZY-> "+e),$(e).lazyload({effect:"fadeIn",threshold:a,skip_invisible:!1}).each(function(){var a=1==!!document.documentMode,t=1==(!a&&!!window.StyleMedia);(e.indexOf("lazy-")>=0||!a&&!t)&&window.glassesFunctions.preLazyLoading($(this)),$(this).trigger("load"),$(this).hasClass("item-thumbnail")&&$(this).siblings().each(function(){$(this).hasClass(e.substring(e.lastIndexOf("lazy")))&&$(this).lazyload()})})))}function delayedScroll(e){setTimeout(function(){$(window).scroll()},e)}function toggleThumbnailImageOnHover(){}function invokeLazyLoadOldImage(){"IntersectionObserver"in window?$(".products_holder img.lazy").each(function(e,a){lazyImageObserver.observe(a)}):$(".products_holder img.lazy").lazyload({skip_invisible:!1}).on("load",function(){$(this).closest(".lazy-container").find(".loader").remove(),$(".products_holder .catEntry_Image_PLP_Alt").hasClass("not-hide")||$(".products_holder .catEntry_Image_PLP_Alt").hide()}).each(function(){this.complete&&$(this).trigger("load")})}function invokeLazyLoadAfterNewImageAppend(){"IntersectionObserver"in window?$(".products_holder img.lazy.yetToload").each(function(e,a){lazyImageObserver.observe(a)}):$(".products_holder img.lazy.yetToload").lazyload({skip_invisible:!1}).load(function(){var e=$(this);e.closest(".lazy-container").find(".loader").remove(),e.hasClass("catEntry_Image_PLP_Alt")&&e.hide(),e.hasClass("yetToload")&&e.removeClass("yetToload")})}function updateCompareBox(){var e=$.cookie("CompareItems_"+constants.ajaxParams.storeId);if(null!=e){e=e.split(";");for(var a=0;a<e.length;a++)try{$("#compare_"+e[a]).prop("checked","true"),$("#compare_"+e[a]).parent("label").addClass("on"),$("#compare_"+e[a]).closest(".item").addClass("selected")}catch(e){console.error(e)}}}var scrollProductsObject={};function updateBV(){}var loadMoreProduct=!0;function loadMoreFrameResultsDesktop(){loadMoreProduct=!1;var e=$("input.lazyload_scroll").last().val();""!==e&&void 0!==e&&null!==e&&"false"!==e&&($(".products_holder").append('<div class="loader"></div>'),$.ajax({url:e,dataType:"html",success:function(e){$(".products_holder").append(e),loadMoreProduct=!0,setupLabel(),toggleThumbnailImageOnHover(),invokeLazyLoadAfterNewImageAppend(),$(".products_holder").find(".loader").remove()},error:function(e,a,t){conole.log("Exception while fetching scroll results"),loadMoreProduct=!0,$(".products_holder").find(".loader").remove()}}))}var tabEvent="click",isTouch="ontouchstart"in window||navigator.msMaxTouchPoints>0;function templateSettings(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{%([\s\S]+?)%\}/g,escape:/\{%-([\s\S]+?)%\}/g}}function loadMoreSearchProducts(){scrollProductsObject={},loadMoreProduct=!1,templateSettings(),window.pageSize||(window.pageSize=24),window.totalCount||(window.totalCount=100),window.totalContentCount||(window.totalContentCount=100),window.AjaxCategoriesDisplayView||(window.AjaxCategoriesDisplayView=""),window.SearchDisplayView||(window.SearchDisplayContentView=""),"https:"==document.location.protocol?window.SearchDisplayView=window.SearchDisplayView.replace(/^http:\/\//i,"https://"):window.SearchDisplayView=window.SearchDisplayView.replace(/^https:\/\//i,"http://"),$(".products_holder").append('<div class="loader"></div>'),$.ajax({url:window.SearchDisplayView,type:"post",data:{beginIndex:window.beginIndex},success:function(e){var a=$("#moreProductsToDisplay");$(".products_holder").find(".loader").remove(),a.getProducts({data:e}),window.beginIndex=window.beginIndex+window.scrollPageSize,setupLabel(),toggleThumbnailImageOnHover(),invokeLazyLoadAfterNewImageAppend(),updateCompareBox(),window.beginIndex<window.pageSize&&(loadMoreProduct=!0),e=$.parseJSON(e),$.each(e,function(e,a){var t=a.upc,n={};n.url=a.url,scrollProductsObject[t]=n}),updateBV(),categoryDisplayJS.updateFavoriteLinks("TopCategoriesDisplay")}})}function loadMoreProducts(){scrollProductsObject={},loadMoreProduct=!1,templateSettings(),window.pageSize||(window.pageSize=20),window.totalCount||(window.totalCount=100),window.totalContentCount||(window.totalContentCount=100),window.AjaxCategoriesDisplayView||(window.AjaxCategoriesDisplayView=""),window.currentItemCount||(window.currentItemCount=12),"https:"==document.location.protocol?window.AjaxCategoriesDisplayView=window.AjaxCategoriesDisplayView.replace(/^http:\/\//i,"https://"):window.AjaxCategoriesDisplayView=window.AjaxCategoriesDisplayView.replace(/^https:\/\//i,"http://"),$(".products_holder").append('<div class="loader"></div>'),$.ajax({url:window.AjaxCategoriesDisplayView,type:"post",data:{beginIndex:window.beginIndex,currentItemCount:window.currentItemCount},success:function(e){var a=$("#moreProductsToDisplay");$(".products_holder").find(".loader").remove(),a.getProducts({data:e}),window.beginIndex=window.beginIndex+window.scrollPageSize,window.currentItemCount=window.currentItemCount+window.scrollPageSize,e.indexOf("ESPOT")>1&&(window.beginIndex=window.beginIndex-1),setupLabel(),toggleThumbnailImageOnHover(),invokeLazyLoadAfterNewImageAppend(),updateCompareBox(),window.beginIndex<window.pageSize&&(loadMoreProduct=!0),e=$.parseJSON(e),$.each(e,function(e,a){var t=a.upc,n={};n.url=a.url,scrollProductsObject[t]=n}),updateBV(),categoryDisplayJS.updateFavoriteLinks("TopCategoriesDisplay")}})}function initCarouselDashboard(){$(this).owlCarousel({margin:10,navigation:!0,slideSpeed:300,items:3,responsive:!0,navigationText:[],autoPlay:!1,addClassActive:!0,afterInit:function(){},afterMove:function(){},startDragging:function(){this.stop()}})}function updateTotalInput(e){$("input[name='account1']").val($("input[name='payment_card_1']").val().replace(new RegExp(CheckoutPayments.cardSeparator,"g"),"")),$("input[name='account1']").change()}function updateDateInput(){$(".expdateFinal").val($("select[name='payment_expire_month']").val()+"/"+$("select[name='payment_expire_year']").val()).change()}function updateShopCartCounter(e){try{void 0===e&&(e=1);var a=parseInt($("#cartQuantity").text())+e;$("#cartQuantity").text(a),0!=a?$(".header-cart-container .cart-icon-circle").addClass("cart-not-empty"):$(".header-cart-container .cart-icon-circle").removeClass("cart-not-empty")}catch(e){}}function getShopCartCounter(){var e=0;try{e=parseInt($("#cartQuantity").text())}catch(e){console.error(e)}return e}function repaint(){$("body").addClass("nothing").removeClass("nothing")}function mouseoverPass(e){document.getElementById("cc_cvc_1").type="text"}function mouseoutPass(e){document.getElementById("cc_cvc_1").type="password"}function findGetParameter(e){var a=null,t=[];return location.search.substr(1).split("&").forEach(function(n){(t=n.split("="))[0]===e&&(a=decodeURIComponent(t[1]))}),a}function maxFractionDigits(e,a){return(e=""+e).indexOf("$")>-1&&(e=e.replace("$","").trim()),Number(e).toFixed(a)}isTouch&&(tabEvent="touchstart"),$.fn.extend({initCarouselDashboard:initCarouselDashboard}),$(document).ready(function(){$("#myaccount2_rr").one("DOMSubtreeModified",function(){setTimeout(function(){$("#myaccount2_rr .carousel-items-container").initCarouselDashboard()},300)})});
//# sourceMappingURL=global.js.map