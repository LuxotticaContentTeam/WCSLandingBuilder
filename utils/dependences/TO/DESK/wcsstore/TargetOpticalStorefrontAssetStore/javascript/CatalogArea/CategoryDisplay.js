function rxInputToggle(){var t=$('input[name="rx"]:checked').val();$(".contact-my-doctor").toggle("doctor"==t),$(".upload-my-prescription").toggle("upload"==t),$(".fax-my-prescription").toggle("fax"==t),$(".text-my-prescription").toggle("text"==t)}function pdToggle(){var t=$("#rxPupilDistanceBoth").is(":checked");$(".pd-select-one").toggle(!t),$(".pd-select-both").toggle(t),$(".select-container-absolute").toggle(t),$("#rxPupilDistance").prop("disabled",t),$("#rxRightPupilDistance").prop("disabled",!t),$("#rxLeftPupilDistance").prop("disabled",!t)}function rxRightPrismToggle(){$(".right-prism-fields :input").prop("disabled",!$("#rxRightPrism").is(":checked"))}function rxLeftPrismToggle(){$(".left-prism-fields :input").prop("disabled",!$("#rxLeftPrism").is(":checked"))}function hideShowAddonsDiv(){var t=!1;$(".add-ons .lens-container .check-row ").each(function(){"block"==$(this).css("display")&&(t=!0)}),t?$("#hic-addons").show():($("#hic-addons").hide(),$("#hic-addons").text(" "))}function antiReflectiveSelect(t){var e=$(".ar-available:checked").length>0,a=$(".antireflective").toggle(e).find(":checkbox");t||(a.prop("checked",!1),addOnsClick(a)),hideShowAddonsDiv()}function calculateSummarySubtotal(){var t=0;$(".content-block").find(".price:visible").not(".listPrice").each(function(){t+=parseFloat($.trim($(this).html()).substring(1))}),$(".price-subtotal").html("$"+t.toFixed(2))}function populateTrialPack(t,e){$(t).find(".pack-name").html(e.name),$(t).find(".pack-short-description").html(e.shortDescription),$(t).find(".pack-link").attr("href",e.url)}function addOnsClick(t){if(t.is(":checked")){var e=t.parents(".step1"),a=e.find("label").html(),r=e.find(".offerprice").html();r||(r=e.find("span.price").html());var i=$("#addon-row-template").clone();i.find(".name").html(a),i.find(".price").html(r),i.attr("id","addon-row-"+t.val()),$(".lens-row:last").after(i.show())}else $("#addon-row-"+t.val()).remove();calculateSummarySubtotal()}function triggerContactLensUtag(t){var e=$("#categoryId"),a=$("#productId");if(""!=$.trim(e.val())&&""!=$.trim(a.val())){var r={contact_brand:$("#categoryId option:selected").text().toLowerCase(),contact_name:$("#productId option:selected").text().toLowerCase(),product_id:t.catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber};$(document).trigger("utag",["contactLensView",r])}}function triggerContactAdd(){var t=parseInt($("#rightQuantity").val(),10)+parseInt($("#leftQuantity").val(),10);$.cookie("lastCompletedStep","1",{path:"/"});var e={add_quantity:t,add_price:$("#contact-lens-price").val(),product_id:$("#productId").val()};$(document).trigger("utag",["addtobuy",e])}function triggerLensAdd(){val=$("#rxLensForm input[name=lensCatentryId]:checked").val(),price=$.trim($(".price-subtotal").text());var t={add_price:price,product_id:val};$(document).trigger("utag",["addtobuy",t])}function handleAddToCartUtag(t,e){try{var a=$(this),r=[],i=[],n=[];t=t||"addtobuy",e=e||[];if(a.is(".browsing-history *"))n.push("recently viewed"),r.push(a.closest(".container").find(".thumbnail-product-price").text()),i.push(a.closest(".container").find("[data-partNumber]").attr("data-partNumber"));else if(a.is(".product-detail *")){$(".product-price").each(function(){r.push($(this).text())});var s=$.trim($("#product-part-number").val());""==s&&(s=$.trim($("#bundle-part-numbers").val()));for(var o=s.split(","),d=0;d<o.length;d++)i.push(o[d]),n.push("product detail")}else n.push("browse results"),r.push(a.closest(".item-tile").find(".thumbnail-product-price").text()),i.push(a.closest("[data-partNumber]").attr("data-partNumber"));for(d=0;d<r.length;d++)r[d]=r[d].replace(/[^0-9.-]/g,"");var c={add_location:n.join(","),product_id:i.join(","),add_quantity:e.join(","),add_price:r.join(",")};$(document).trigger("utag",[t,c])}catch(t){console&&console.error&&console.error(t)}}function ajaxAddItemToTryAtHome(t){for(var e=$(t).data("catentryid").toString().split(","),a=$(t).data("bundleid"),r=[],i=0;i<e.length;i++)r.push(1);handleAddToCartUtag.call(t,"addtotry",r),categoryDisplayJS.AddItem2TryAtHomeCartAjax(e,{productId:a})}function openSticky(t){$(document).ready(function(){insuranceController.openFromToggle()})}categoryDisplayJS={entitledItems:[],entitledItemsArray:[],selectedProducts:new Object,selectedAttributes:new Object,errorMessages:new Object,langId:commerceLangId,storeId:commerceStoreId,catalogId:commerceCatalogId,orderId:"",ajaxShopCart:!0,ajaxMyAccount:!0,contextChanged:!1,isHistory:!1,merchandisingAssociationItems:[],baseCatalogEntryDetails:[],associationThumbnailIndex:1,totalAssociationCount:0,baseItemAddedToCart:!1,merchandisingProductAssociationAddToCart:!1,merchandisingProductAssociationForm:"",isParentBundleBean:!1,userType:constants.ajaxParams.loggedIn,moreInfoUrl:"",displayPrevAssociation:"",displayNextAssociation:"",defaultItemArray:[],currentPageType:"",currentCatalogEntryId:"",entitledItemJsonObject:null,isPopup:!1,displayPriceRange:!0,itemPriceJsonOject:[],initHistory:function(t,e){var a=new categoryDisplayJS.HistoryTracker(t,e);dojo.back.setInitialState(a)},processCategoryURL:function(){var t,e=location.hash,a=!1;if(e){t=e=e.substring(1,e.length);var r=e.indexOf("identifier",0);r>=0&&(t=e.substring(0,r)),a=!0,t=unescape(t)}a&&(isHistory=!0,wc.render.getRefreshControllerById("CategoryDisplay_Controller").url=t,wc.render.updateContext("CategoryDisplay_Context"))},setAjaxShopCart:function(t){this.ajaxShopCart=t},setAjaxMyAccount:function(t){this.ajaxMyAccount=t},setCommonParameters:function(t,e,a,r){this.langId=t,this.storeId=e,this.catalogId=a,this.userType=r},setEntitledItems:function(t){this.entitledItems=t},setEntitledItemsArray:function(t,e){this.entitledItemsArray[t]=e},setSelectedAttribute:function(t,e){console.debug(t+" : "+e),this.selectedAttributes[t]=e,this.moreInfoUrl=this.moreInfoUrl+"&"+t+"="+e},setSelectedAttributeJS:function(t,e){console.debug(t.replace(/'/g,"&#039;")+" : "+e.replace(/'/g,"&#039;")),this.selectedAttributes[t.replace(/'/g,"&#039;")]=e.replace(/'/g,"&#039;"),this.moreInfoUrl=this.moreInfoUrl+"&"+t.replace(/'/g,"&#039;")+"="+e.replace(/'/g,"&#039;")},changePrice:function(entitledItemId,isPopup,displayPriceRange){var entitledItemJSON;this.displayPriceRange=displayPriceRange,this.isPopup=isPopup,entitledItemJSON=null==dojo.byId(entitledItemId)||this.isPopup?this.getEntitledItemJsonObject():eval("("+dojo.byId(entitledItemId).innerHTML+")"),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();if(null!=catalogEntryId)if(null!=this.itemPriceJsonOject[catalogEntryId]&&"undefined"!=this.itemPriceJsonOject[catalogEntryId])this.displayPrice(this.itemPriceJsonOject[catalogEntryId].catalogEntry),console.debug("CategoryDisplay.changePrice: using stored json object.");else{var parameters={};parameters.storeId=this.storeId,parameters.langId=this.langId,parameters.catalogId=this.catalogId,parameters.productId=catalogEntryId,parameters.onlyCatalogEntryPrice="true",dojo.xhrPost({url:getAbsoluteURL()+"GetCatalogEntryDetailsByID",handleAs:"json-comment-filtered",content:parameters,service:this,load:categoryDisplayJS.displayPriceServiceResponse,error:function(t,e){console.debug("CategoryDisplay.changePrice: Unexpected error occurred during an xhrPost request.")}})}else console.debug("CategoryDisplay.changePrice: all attributes are not selected.")},displayPriceServiceResponse:function(t,e){categoryDisplayJS.itemPriceJsonOject[t.catalogEntry.catalogEntryIdentifier.uniqueID]=t,categoryDisplayJS.displayPrice(t.catalogEntry)},displayPrice:function(t){var e=categoryDisplayJS.isPopup;if(1==e&&(document.getElementById("productPrice").innerHTML=t.offerPrice,document.getElementById("productName").innerHTML=t.description[0].name,document.getElementById("productSKUValue").innerHTML=t.catalogEntryIdentifier.externalIdentifier.partNumber),0==e){var a="";if(a=!t.listPriced||t.listPrice<=t.offerPrice?"<span class='price bold'>"+MessageHelper.messages.PRICE+" </span><span class='price bold'>"+t.offerPrice+"</span>":"<span class='price bold'>"+MessageHelper.messages.PRICE+" </span><span class='price listPrice bold'>"+t.listPrice+"</span><div class='price offerprice bold'>"+t.offerPrice+"</div>",a+="<br />",1==categoryDisplayJS.displayPriceRange)for(var r in t.priceRange)a="null"!=t.priceRange[r].endingNumberOfUnits?a+"<span class='price bold'>"+MessageHelper.messages.TieredPricingDisp.replace("{0}",t.priceRange[r].startingNumberOfUnits).replace("{1}",t.priceRange[r].endingNumberOfUnits).replace("{2}",t.priceRange[r].localizedPrice)+"</span>":a+"<span class='price bold'>"+MessageHelper.messages.TieredPricingDispLast.replace("{0}",t.priceRange[r].startingNumberOfUnits).replace("{1}",t.priceRange[r].localizedPrice)+"</span>",a+="<br />";document.getElementById("WC_CachedProductOnlyDisplay_div_4").innerHTML=a,document.getElementById("catalog_link").innerHTML=t.description[0].name}},setSelectedAttributeOfProduct:function(t,e,a){selectedAttributesForProduct=new Object,this.selectedProducts[t]&&(selectedAttributesForProduct=this.selectedProducts[t]),selectedAttributesForProduct[e]=a,this.selectedProducts[t]=selectedAttributesForProduct},gotoASubCategoryDisplayPage:function(t,e,a,r){if(""!=(t=trim(t)))if(0!=MessageHelper.IsNumeric(t,!1))if(t>=1&&t<=e){MessageHelper.hideAndClearMessage();var i=r+"&beginIndex="+(t-1)*a;this.loadSubCategoryContentURL(i)}else MessageHelper.formErrorHandleClient(document.getElementById("subCategoriesListDisplayPageNum").id,MessageHelper.messages.ERROR_PAGE_NUM);else MessageHelper.formErrorHandleClient(document.getElementById("subCategoriesListDisplayPageNum").id,MessageHelper.messages.ERROR_PAGE_NUM);else MessageHelper.formErrorHandleClient(document.getElementById("subCategoriesListDisplayPageNum").id,MessageHelper.messages.ERROR_EMPTY_NUM)},getCatalogEntryId:function(){var t=[];for(attribute in this.selectedAttributes)t.push(attribute+"_"+this.selectedAttributes[attribute]);return this.resolveSKU(t)},getCatalogEntryIdforProduct:function(t){var e=[];for(attribute in t)e.push(attribute+"_"+t[attribute]);return this.resolveSKU(e)},getCatalogEntryIdforBundleProduct:function(t,e){var a=[];for(attribute in e)a.push(attribute+"_"+e[attribute]);return this.resolveSKUForBundleProduct(t,a)},resolveSKU:function(t){console.debug("Resolving SKU >> "+t+">>"+this.entitledItems);var e="",a=t.length;for(x in this.entitledItems){e=this.entitledItems[x].catentry_id;var r=this.entitledItems[x].Attributes,i=0;for(index in r)i++;if(0==a&&0==i)return e;if(0!=i&&a>=i){var n=0;for(attributeName in t){t[attributeName]in r&&n++}if(i==n)return console.debug("CatEntryId:"+e+" for Attribute: "+t),e}}return null},resolveSKUForBundleProduct:function(t,e){console.debug("Resolving SKU >> "+e+">>"+this.entitledItemsArray[t]);var a="",r=e.length;for(x in this.entitledItemsArray[t]){a=this.entitledItemsArray[t][x].catentry_id;var i=this.entitledItemsArray[t][x].Attributes,n=0;for(index in i)n++;if(0==r&&0==n)return a;if(0!=n&&r>=n){var s=0;for(attributeName in e){e[attributeName]in i&&s++}if(n==s)return console.debug("CatEntryId:"+a+" for Attribute: "+e),a}}return null},updateParamObject:function(t,e,a,r,i){if(null==t&&(t=[]),null!=t[e]&&r)if(dojo.lang.isArrayLike(t[e]))null!=i&&""!=i?t[e][i]=a:t[e].push(a);else{var n=t[e];t[e]=[],t[e].push(n),t[e].push(a)}else if(null!=i&&""!=i&&-1!=i)t[e+"_"+i]=a;else if(-1==i){for(var s=1;null!=t[e+"_"+s];)s++;t[e+"_"+s]=a}else t[e]=a;return t},setDefaultItem:function(t,e){this.defaultItemArray[t]=e},getDefaultItem:function(t){return this.defaultItemArray[t]},AddBundle2ShopCartAjax:function(t){var e=[];e.storeId=this.storeId,e.catalogId=this.catalogId,e.langId=this.langId,e.orderId=".",e.calculationUsage="-1,-2,-3,-4,-5,-6,-7";for(var a=t.numberOfProduct.value,r=1;r<=a;r++){var i=t["catEntryId_"+r].value;this.selectedProducts[i]&&(i=this.getCatalogEntryIdforBundleProduct(i,this.selectedProducts[i]));var n=t["quantity_"+r].value;if(null==n||""==n||n<=0)return void MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR);if(null==n||""==n||null==i)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);this.updateParamObject(e,"catEntryId",i,!1,-1),this.updateParamObject(e,"quantity",n,!1,-1),this.baseItemAddedToCart=!0;var s=document.getElementsByName("contractSelectForm_contractId_"+i);if(null!=s&&"undefined"!=s)for(j=0;j<s.length;j++)if(s[j].checked){t["contractId_"+r].value=s[j].value;break}var o=t["contractId_"+r].value;null!=o&&""!=o&&this.updateParamObject(e,"contractId",o,!1,-1)}submitRequest()&&(cursor_wait(),wc.service.invoke("AjaxAddOrderItem",e))},AddBundle2ShopCart:function(t){t.URL.value="AjaxOrderItemDisplayView";for(var e=t.numberOfProduct.value,a=1;a<=e;a++){var r=t["catEntryId_"+a].value;if(this.selectedProducts[r]){if(null==(r=this.getCatalogEntryIdforBundleProduct(r,this.selectedProducts[r])))return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);t["catEntryId_"+a].value=r}var i=t["quantity_"+a].value;if(null==i||""==i||i<=0)return void MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR);var n=document.getElementsByName("contractSelectForm_contractId_"+r);if(null!=n&&"undefined"!=n)for(j=0;j<n.length;j++)if(n[j].checked){t["contractId_"+a].value=n[j].value;break}}submitRequest()&&t.submit()},Add2ShopCart:function(entitledItemId,form,quantity,isPopup){var entitledItemJSON;entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();if(null!=catalogEntryId){if(this.merchandisingProductAssociationAddToCart)return void this.AddAssociation2ShopCart(catalogEntryId,quantity);form.catEntryId.value=catalogEntryId,form.productId.value=catalogEntryId,this.AddItem2ShopCart(form,quantity),hidePopup("second_level_category_popup")}else 1==isPopup?(dojo.byId("second_level_category_popup").style.zIndex="1",MessageHelper.formErrorHandleClient("addToCartLink",MessageHelper.messages.ERR_RESOLVING_SKU)):MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU)},AddItem2ShopCart:function(t,e){if(isPositiveInteger(e)){t.quantity.value=e;var a=document.getElementsByName("contractSelectForm_contractId");if(null!=a&&"undefined"!=a)for(i=0;i<a.length;i++)if(a[i].checked){t.contractId.value=a[i].value;break}submitRequest()&&t.submit()}else MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR)},Add2ShopCartAjax:function(entitledItemId,quantity,isPopup,customParams){var entitledItemJSON;entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();null!=catalogEntryId?(this.AddItem2ShopCartAjax(catalogEntryId,quantity,customParams),this.baseItemAddedToCart=!0,hidePopup("second_level_category_popup")):1==isPopup?(dojo.byId("second_level_category_popup").style.zIndex="1",MessageHelper.formErrorHandleClient("addToCartLinkAjax",MessageHelper.messages.ERR_RESOLVING_SKU)):(MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU),this.baseItemAddedToCart=!1)},setEntitledItemJsonObject:function(t){this.entitledItemJsonObject=t},getEntitledItemJsonObject:function(){return this.entitledItemJsonObject},ReplaceItemAjax:function(entitledItemId,quantity){var entitledItemJSON;entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId(),removeOrderItemId="",removeOrderItemId=replaceOrderItemId,typeId=document.getElementById("shipmentTypeId"),addressId="",shipModeId="";null!=typeId&&""!=typeId&&("2"==typeId.value?(addressId=document.getElementById("MS_ShipmentAddress_"+removeOrderItemId).value,shipModeId=document.getElementById("MS_ShippingMode_"+removeOrderItemId).value):(addressId=document.getElementById("addressId_all").value,shipModeId=document.getElementById("shipModeId_all").value)),null!=catalogEntryId?""==removeOrderItemId||this.ReplaceItemAjaxHelper(catalogEntryId,quantity,removeOrderItemId,addressId,shipModeId):MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU)},ReplaceItemNonAjax:function(entitledItemId,quantity,form){var entitledItemJSON;entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId(),removeOrderItemId="",removeOrderItemId=replaceOrderItemId;if(null!=catalogEntryId)if(""==removeOrderItemId);else{var addressId,shipModeId;if(form.orderItemId.value=removeOrderItemId,0==quantity&&console.debug("An invalid quantity was selected"),null!=form.shipmentTypeId&&""!=form.shipmenTypeId?("2"==form.shipmentTypeId.value?(addressId=document.getElementById("MS_ShipmentAddress_"+removeOrderItemId).value,shipModeId=document.getElementById("MS_ShippingMode_"+removeOrderItemId).value):(addressId=document.getElementById("addressId_all").value,shipModeId=document.getElementById("shipModeId_all").value),form.URL.value="OrderChangeServiceItemAddTO?calculationUsage=-1,-2,-3,-4,-5,-6,-7&catEntryId="+catalogEntryId+"&quantity="+quantity+"&addressId="+addressId+"&shipModeId="+shipModeId+"&URL=OrderChangeServiceShipInfoUpdate?URL="+form.URL.value):form.URL.value="OrderChangeServiceItemAddTO?calculationUsage=-1,-2,-3,-4,-5,-6,-7&catEntryId="+catalogEntryId+"&quantity="+quantity+"&URL="+form.URL.value,!submitRequest())return;form.submit()}else MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU)},AddItem2ShopCartAjax:function(t,e,a){var r={storeId:this.storeId,catalogId:this.catalogId,langId:this.langId,orderId:".",catEntryId:t,frame:t,action:"add",cache:!1,URL:"GetCatalogEntryDetailsByID",errorViewName:"LogonAjaxView"};$.extend(r,a);var i=null!=r.orderItemId&&""!=r.orderItemId,n=i?"UpdateOrderItemLensDataCmd":"OrderItemAddFrameCmd";"EYEGLASSES_FRAMES"==a.partType||"SUNGLASSES_FRAMES"==a.partType?$.post(getAbsoluteURL()+n,r,function(t){if(console.debug(t),t){var a=$.parseJSON(t),r={storeId:this.storeId,catalogId:this.catalogId,langId:this.langId,orderId:".",productId:a.productId,cache:!1,orderItemTotal:a.orderItemTotal,errorViewName:"LogonAjaxView"};$.get("GetCatalogEntryDetailsByID",r,function(t){if(t.catalogEntry){$(".add-to-cart-pdp-url").attr("href",t.catalogEntryURL);var r="",n="";$.each(t.catalogEntryAttributes.attributes,function(){null!=this.attributeIdentifier&&("COLOR"==this.attributeIdentifier.externalIdentifier.identifier&&(r=this.value.value),"RXABLE"==this.attributeIdentifier.externalIdentifier.identifier&&(n="RxAble"==this.value.value))}),$(".add-to-cart-color").html(r);var s=$.param({storeId:categoryDisplayJS.storeId,catalogId:categoryDisplayJS.catalogId,langId:categoryDisplayJS.langId,orderItemId:a.orderItemId});if($(".add-to-cart-add-lenses").toggle(n).attr("href",getAbsoluteURL()+"LensOptions?"+s),i||categoryDisplayJS.IncrementOrderItemCount(e),n)window.location=getAbsoluteURL()+"LensOptions?"+s;else{var o=$.param({storeId:categoryDisplayJS.storeId,catalogId:categoryDisplayJS.catalogId,langId:categoryDisplayJS.langId,URL:"AjaxOrderItemDisplayView",errorViewName:"AjaxOrderItemDisplayView",updatePrices:"1",calculationUsageId:"-1",orderId:"."});window.location=getAbsoluteURL()+"OrderCalculate?"+o}}else t.errorKey&&(utagFiller.setUnableToAddToCart(),MessageHelper.displayErrorMessage(t.errorMessage))},"json")}else t.errorKey&&(utagFiller.setUnableToAddToCart(),MessageHelper.displayErrorMessage(t.errorMessage))}):"CONTACT_LENSES"==a.partType&&$.post(getAbsoluteURL()+"OrderItemAddContactLensesCmd",r,function(t){if(void 0!==t.catalogEntry&&t.catalogEntry){var e=parseInt(a.rightQuantity)+parseInt(a.leftQuantity),r="";r=1==e?e+" box of "+t.catalogEntry.description[0].name+" contact lenses was just added to your cart":e+" boxes of "+t.catalogEntry.description[0].name+" contact lenses were just added to your cart",$.cookie("checkoutMessage",r,{path:"/"}),categoryDisplayJS.AddItem2ShopCartAjaxDisplayCL(t,e,"contacts"),categoryDisplayJS.IncrementOrderItemCount(e)}else if(t.errorKey){utagFiller.setUnableToAddToCart();try{var i=$.parseHTML(t.errorMessage),n="";$.each(i,function(t,e){n+=e.nodeValue+"<br/>"}),MessageHelper.displayErrorMessage(n,0,!1)}catch(e){MessageHelper.displayErrorMessage(t.errorMessage,0,!1)}}},"json")},AddItem2ShopCartAjaxDisplayShared:function(t,e,a){$("#addToCartContainer").removeClass().addClass("add-to-cart-"+a),$(".add-to-cart-price").text(t.orderItemTotal),$(".add-to-cart-name").html(t.catalogEntry.description[0].name),$(".add-to-cart-quantity").html(e),$(".add-to-cart-item-added").toggle(1==e),$(".add-to-cart-items-added").toggle(e>1),$(".add-to-cart-thumbnail").attr("src",t.catalogEntry.description[0].thumbnail);var r=$.param({storeId:categoryDisplayJS.storeId,catalogId:categoryDisplayJS.catalogId,langId:categoryDisplayJS.langId,URL:"AjaxOrderItemDisplayView",errorViewName:"AjaxOrderItemDisplayView",updatePrices:"1",calculationUsageId:"-1",orderId:"."});window.location=getAbsoluteURL()+"OrderCalculate?"+r},AddItem2ShopCartAjaxDisplayCL:function(t,e,a){$("#addToCartContainer").removeClass().addClass("add-to-cart-"+a),$(".add-to-cart-price").text(t.orderItemTotal),$(".add-to-cart-name").html(t.catalogEntry.description[0].name),$(".add-to-cart-quantity").html(e),$(".add-to-cart-item-added").toggle(1==e),$(".add-to-cart-items-added").toggle(e>1),$(".add-to-cart-thumbnail").attr("src",t.catalogEntry.description[0].thumbnail),window.openPDPMinicart()},IncrementOrderItemCount:function(t){var e=parseInt($("#order-quantity-header").text());$("#order-quantity-header").text(e+t)},AddItem2TryAtHomeCartAjax:function(t,e){var a={storeId:this.storeId,catalogId:this.catalogId,langId:this.langId,productId:t[0],URL:"GetCatalogEntryDetailsByID",errorViewName:"LogonAjaxView"};$.each(t,function(t,e){a["catEntryId_"+t]=e}),$.extend(a,e),$.post(getAbsoluteURL()+"TAHItemAddCmd",a,function(e){if(e.catalogEntry){$(".add-to-tah-thumbnail").attr("src",e.catalogEntry.description[0].thumbnail);var a="";$.each(e.catalogEntryAttributes.attributes,function(t){null!=t.attributeIdentifier&&"COLOR"==t.attributeIdentifier.externalIdentifier.identifier&&(a=t.value.value)}),$(".add-to-tah-color").html(a),$(".add-to-tah-name").html(e.catalogEntry.description[0].name),$(".add-to-tah-url").attr("href",e.catalogEntryURL),$(".add-to-tah-error").hide(),$(".add-to-tah-frame").show(),$(".tah-these-frames").show();var r=parseInt($("#tah-quantity-header").text());$("#tah-quantity-header").text(r+t.length)}else e.errorKey&&(utagFiller.setUnableToAddToCart(),$(".add-to-tah-error").html(e.errorMessage),$(".add-to-tah-frame").hide(),$(".add-to-tah-error").show())},"json")},ConfigureDynamicKit:function(t,e,a){var r=[];if(r.storeId=this.storeId,r.catalogId=this.catalogId,r.langId=this.langId,r.catEntryId=t,r.quantity=e,isPositiveInteger(e)){var i=document.getElementsByName("contractSelectForm_contractId");if(null!=i&&"undefined"!=i)for(s=0;s<i.length;s++)if(i[s].checked){r.contractId=i[s].value;break}if(null!=a&&"undefined"!=a)for(s in a)r[s]=a[s];if(submitRequest()){cursor_wait();var n="ConfigureView",s=0;for(param in r)n+=(0==s++?"?":"&")+param+"="+r[param];document.location.href=getAbsoluteURL()+n}}else MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR)},ReplaceItemAjaxHelper:function(t,e,a,r,i){var n=[];n.storeId=this.storeId,n.catalogId=this.catalogId,n.langId=this.langId,n.orderItemId=a,n.orderId=null!=this.orderId&&"undefined"!=this.orderId&&""!=this.orderId?this.orderId:".",n.calculationUsage="-1,-2,-3,-4,-5,-6,-7";var s=[];s.storeId=this.storeId,s.catalogId=this.catalogId,s.langId=this.langId,s.catEntryId=t,s.quantity=e,s.orderId=null!=this.orderId&&"undefined"!=this.orderId&&""!=this.orderId?this.orderId:".",s.calculationUsage="-1,-2,-3,-4,-5,-6,-7";var o=[];o.storeId=this.storeId,o.catalogId=this.catalogId,o.langId=this.langId,o.orderId=null!=this.orderId&&"undefined"!=this.orderId&&""!=this.orderId?this.orderId:".",o.calculationUsage="-1,-2,-3,-4,-5,-6,-7",o.allocate="***",o.backorder="***",o.remerge="***",o.check="*n";var d=!1;null!=r&&""!=r&&null!=i&&""!=i&&(o.addressId=r,o.shipModeId=i,d=!0),wc.service.declare({id:"AjaxReplaceItem",actionId:"AjaxReplaceItem",url:"AjaxOrderChangeServiceItemDeleteTO",formId:"",successHandler:function(t){d?wc.service.invoke("AjaxAddOrderItemTemp",s):wc.service.invoke("AjaxAddOrderItem",s)},failureHandler:function(t){t.errorMessage?MessageHelper.displayErrorMessage(t.errorMessage):t.errorMessageKey&&MessageHelper.displayErrorMessage(t.errorMessageKey),cursor_clear()}}),wc.service.declare({id:"AjaxAddOrderItemTemp",actionId:"AjaxAddOrderItemTemp",url:"AjaxOrderChangeServiceItemAddTO",formId:"",successHandler:function(t){wc.service.invoke("OrderItemAddressShipMethodUpdate",o)},failureHandler:function(t){MessageHelper.displayErrorMessage(t.errorMessageKey)}}),submitRequest()&&(cursor_wait(),wc.service.invoke("AjaxReplaceItem",n))},AddBundle2WishList:function(t){isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM");for(var e=t.numberOfProduct.value,a=1;a<=e;a++){var r=t["catEntryId_"+a].value;if(this.selectedProducts[r]){if(null==(r=this.getCatalogEntryIdforBundleProduct(r,this.selectedProducts[r])))return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);t["catEntryId_"+a].value=r}}t.action="InterestItemAdd",t.page.value="customerlinkwishlist",this.ajaxMyAccount?"G"==this.userType?t.URL.value="InterestItemDisplay":t.URL.value="AjaxLogonForm":"G"==this.userType?t.URL.value="InterestItemDisplay":t.URL.value="NonAjaxAccountWishListDisplayView",submitRequest()&&t.submit()},AddBundle2WishListAjax:function(t){isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM");var e=[];e.storeId=this.storeId,e.catalogId=this.catalogId,e.langId=this.langId,e.updateable=0,e.orderId=".";var a;a=t.catEntryIDS.value.toString().split(",");for(var r=0;r<a.length;r++){var i=document.getElementById("quantity_"+a[r]).value,n=a[r];if(this.selectedProducts[a[r]]&&(n=this.getCatalogEntryIdforBundleProduct(n,this.selectedProducts[a[r]])),0!=i&&null!=i||(i=1),null==i||""==i||null==n)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);this.updateParamObject(e,"catEntryId",n,!1,-1),this.updateParamObject(e,"quantity",i,!1,-1)}submitRequest()&&(cursor_wait(),wc.service.invoke("AjaxInterestItemAdd",e))},Add2WishListAjaxByID:function(t){if(null!=t){isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM");var e=[];if(e.storeId=this.storeId,e.catalogId=this.catalogId,e.langId=this.langId,e.catEntryId=t,e.updateable=0,e.URL="SuccessfulAJAXRequest",null!=document.getElementById("controllerURLWishlist")&&"undefined"!=document.getElementById("controllerURLWishlist")&&CommonControllersDeclarationJS.setControllerURL("WishlistDisplay_Controller",document.getElementById("controllerURLWishlist").value),!submitRequest())return;cursor_wait(),this.ajaxShopCart?wc.service.invoke("AjaxInterestItemAdd",e):wc.service.invoke("AjaxInterestItemAdd_shopCart",e)}else MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU)},Add2WishListAjax:function(entitledItemId){var entitledItemJSON;isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM"),entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();this.Add2WishListAjaxByID(catalogEntryId)},AddItem2WishListAjax:function(t){isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM");var e=[];e.storeId=this.storeId,e.catalogId=this.catalogId,e.langId=this.langId,e.catEntryId=t,e.updateable=0,e.URL="SuccessfulAJAXRequest",null!=document.getElementById("controllerURLWishlist")&&"undefined"!=document.getElementById("controllerURLWishlist")&&CommonControllersDeclarationJS.setControllerURL("WishlistDisplay_Controller",document.getElementById("controllerURLWishlist").value),submitRequest()&&(cursor_wait(),this.ajaxShopCart?wc.service.invoke("AjaxInterestItemAdd",e):wc.service.invoke("AjaxInterestItemAdd_shopCart",e))},Add2WishList:function(entitledItemId,form){var entitledItemJSON;isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM"),entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();this.Add2WishListByID(catalogEntryId,form)},Add2WishListByID:function(t,e){if(isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM"),null!=t){if(e.productId.value=t,e.catEntryId.value=t,e.action="InterestItemAdd",e.page.value="customerlinkwishlist",this.ajaxMyAccount?"G"==this.userType?e.URL.value="InterestItemDisplay":e.URL.value="AjaxLogonForm":"G"==this.userType?e.URL.value="InterestItemDisplay":e.URL.value="NonAjaxAccountWishListDisplayView",e.quantity.value="1",!submitRequest())return;e.submit()}else MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU)},AddItem2WishList:function(t){isAuthenticated||setWarningMessageCookie("WISHLIST_GUEST_ADDITEM"),t.action="InterestItemAdd",t.quantity.value="1",t.page.value="customerlinkwishlist",this.ajaxMyAccount?"G"==this.userType?t.URL.value="InterestItemDisplay":t.URL.value="AjaxLogonForm":"G"==this.userType?t.URL.value="InterestItemDisplay":t.URL.value="NonAjaxAccountWishListDisplayView",submitRequest()&&t.submit()},loadContentURL:function(t){submitRequest()&&(cursor_wait(),CommonControllersDeclarationJS.setControllerURL("CategoryDisplay_Controller",t),wc.render.updateContext("CategoryDisplay_Context"))},loadSubCategoryContentURL:function(t){MessageHelper.hideAndClearMessage(),submitRequest()&&(cursor_wait(),CommonControllersDeclarationJS.setControllerURL("SubCategoryDisplay_Controller",t),wc.render.updateContext("SubCategoryDisplay_Context"))},goBack:function(){categoryDisplayJS.loadContentURL(this.changeUrl),categoryDisplayJS.isHistory=!0},goForward:function(){categoryDisplayJS.loadContentURL(this.changeUrl),isHistory=!0},HistoryTracker:function(t,e){this.elementId=t,this.changeUrl=e},processBookmarkURL:function(){var t=location.hash;if(t&&(t=t.substring(1,t.length)),t){var e=t.indexOf("identifier",0);if(e>=0)t.substring(0,e-1)}},initializeMerchandisingAssociation:function(thumbnailIndex){var associationDisplay=document.getElementById("marchandisingAssociationDisplay"),totalPriceMsg=document.getElementById("totalPriceMsg").value,baseCatEntryJSON=eval("("+dojo.byId("baseCatEntryDetails").innerHTML+")");this.baseCatalogEntryDetails=baseCatEntryJSON;var basePrice=this.baseCatalogEntryDetails[0].baseCatEntry_Price;this.totalAssociationCount=this.baseCatalogEntryDetails[0].totalAssociations;var identifierJSON="associatedCatEntries_"+thumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")");this.merchandisingAssociationItems=associationEntryJSON;var totalPrice=parseFloat(basePrice)+parseFloat(this.merchandisingAssociationItems[0].catEntry_Price),dragType="";"ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type?dragType="product":"ItemBean"==this.merchandisingAssociationItems[0].catEntry_Type?dragType="item":"PackageBean"==this.merchandisingAssociationItems[0].catEntry_Type?dragType="package":"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type&&(dragType="bundle");var widgetHTML="";if(document.getElementById("addToCartLink")){var url="AjaxOrderItemDisplayView?storeId="+this.storeId+"&catalogId="+this.catalogId+"&langId="+this.langId;widgetHTML=widgetHTML+"<form name='OrderItemAddForm_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' action='OrderChangeServiceItemAddTO' method='post' id='OrderItemAddForm_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'>\n<input type='hidden' name='storeId' value='"+this.storeId+"' id='OrderItemAddForm_storeId_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' name='orderId' value='.' id='OrderItemAddForm_orderId_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' name='catalogId' value='"+this.catalogId+"' id='OrderItemAddForm_orderId_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' name='URL' value='"+url+"' id='OrderItemAddForm_url_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' name='errorViewName' value='InvalidInputErrorView' id='OrderItemAddForm_errorViewName_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' name='catEntryId' value='"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' id='OrderItemAddForm_catEntryId_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' name='productId' value='"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' id='OrderItemAddForm_productId_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' value='1' name='quantity' id='OrderItemAddForm_quantity_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' value='' name='page' id='OrderItemAddForm_page_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' value='-1,-2,-3,-4,-5,-6,-7' name='calculationUsage' id='OrderItemAddForm_calcUsage_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' value='0' name='updateable' id='OrderItemAddForm_updateable_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n<input type='hidden' value='' name='giftListId' id='OrderItemAddForm_giftListId_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'/>\n</form>\n"}widgetHTML+="<div class='scroller' id='WC_CategoryDisplayJS_div_1'>",this.totalAssociationCount>1&&(this.associationThumbnailIndex<this.totalAssociationCount&&(widgetHTML+="\t\t<a href='Javascript:categoryDisplayJS.showNextAssociation()'  id='WC_ProductAssociation_UpArrow_Link_1'>"),widgetHTML=widgetHTML+"\t\t<img src='"+this.baseCatalogEntryDetails[0].storeImage_Path+"i_up_arrow.png' alt='"+this.displayNextAssociation+"'/></a>"),widgetHTML=widgetHTML+" <br /><div id='baseContent_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"'","true"==this.merchandisingAssociationItems[0].showProductQuickView?widgetHTML=widgetHTML+" onmouseover='showPopupButton("+this.merchandisingAssociationItems[0].catEntry_Identifier+");' onmouseout='hidePopupButton("+this.merchandisingAssociationItems[0].catEntry_Identifier+");'>":widgetHTML+=" >","true"==this.merchandisingAssociationItems[0].productDragAndDrop&&(widgetHTML=widgetHTML+" <div dojoType='dojo.dnd.Source' jsId='dndSource' id="+this.merchandisingAssociationItems[0].catEntry_Identifier+" copyOnly='true' dndType='"+dragType+"'>\t\t<div class='dojoDndItem' dndType='"+dragType+"' id='WC_CategoryDisplayJS_div_draganddrop'>"),widgetHTML=widgetHTML+"\t<a href='"+this.merchandisingAssociationItems[0].catEntry_ProductLink+"'  id='img"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' onfocus='showPopupButton("+this.merchandisingAssociationItems[0].catEntry_Identifier+");'>","true"==this.merchandisingAssociationItems[0].productDragAndDrop&&6==dojo.isIE&&(widgetHTML=widgetHTML+"<iframe class='productDnDIFrame' scrolling='no' frameborder='0' src='"+getImageDirectoryPath()+"images/empty.gif'></iframe>"),widgetHTML=widgetHTML+"\t\t<img src='"+this.merchandisingAssociationItems[0].catEntry_Thumbnail+"' alt='"+this.merchandisingAssociationItems[0].catEntry_ShortDescription+"' class='img' width='70' height='70'/>\t</a><br />","true"==this.merchandisingAssociationItems[0].productDragAndDrop&&(widgetHTML+="\t\t</div>\t</div>"),"true"==this.merchandisingAssociationItems[0].showProductQuickView&&(widgetHTML=widgetHTML+" <div id='popupButton_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' class='main_quickinfo_button'><span class='secondary_button' >\n<span class='button_container' >\n<span class='button_bg' >\n<span class='button_top'>\n<span class='button_bottom'>\n<a id='QuickInfoButton_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' href='#' onclick='javaScript:var actionListImageAcct = new popupActionProperties(); actionListImageAcct.showWishList="+this.merchandisingAssociationItems[0].associationProductBuyable+"; actionListImageAcct.showAddToCart="+this.merchandisingAssociationItems[0].associationProductBuyable+"; showPopup("+this.merchandisingAssociationItems[0].catEntry_Identifier+",event,null,null,actionListImageAcct);' onkeypress='javaScript:var actionListImageAcct = new popupActionProperties(); actionListImageAcct.showWishList="+this.merchandisingAssociationItems[0].associationProductBuyable+"; actionListImageAcct.showAddToCart="+this.merchandisingAssociationItems[0].associationProductBuyable+"; showPopup("+this.merchandisingAssociationItems[0].catEntry_Identifier+",event,null,null,actionListImageAcct);' onblur='hidePopupButton("+this.merchandisingAssociationItems[0].catEntry_Identifier+");' role='button' aria-haspopup='true'>"+this.merchandisingAssociationItems[0].showProductQuickViewLable+"</a></span>\n</span>\n</span>\n</span>\n</span>\n</div>\n"),widgetHTML+="</div>",this.totalAssociationCount>1&&(this.associationThumbnailIndex>1&&(widgetHTML+="\t\t<a href='Javascript:categoryDisplayJS.showPreviousAssociation()'  id='WC_ProductAssociation_DownArrow_Link_1'>"),widgetHTML=widgetHTML+"\t\t<img src='"+this.baseCatalogEntryDetails[0].storeImage_Path+"i_down_arrow.png' alt='"+this.displayPrevAssociation+"'/></a>");var comboText=this.baseCatalogEntryDetails[0].associatedProductsName.replace(/%0/,this.baseCatalogEntryDetails[0].baseCatEntry_Name);comboText=comboText.replace(/%1/,this.merchandisingAssociationItems[0].catEntry_Name),widgetHTML=widgetHTML+"</div><div class='combo_text' id='WC_CategoryDisplayJS_div_2'>\n\t<h1 id='maHeader' class='status_msg'>"+comboText+"</h1>\n\t<span id='maPrice' class='grey'>"+totalPriceMsg+totalPrice.toFixed(2)+"</span>\n</div>\n",widgetHTML=widgetHTML+"<input type='hidden' id='compareImgPath_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' value='"+this.merchandisingAssociationItems[0].catEntry_Thumbnail_compare+"'/><input type='hidden' id='compareProductDetailsPath_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' value='"+this.merchandisingAssociationItems[0].catEntry_ProductLink+"'/><input type='hidden' id='compareImgDescription_"+this.merchandisingAssociationItems[0].catEntry_Identifier+"' value='"+this.merchandisingAssociationItems[0].catEntry_ShortDescription+"'/>",associationDisplay.innerHTML=null,associationDisplay.innerHTML=widgetHTML},showNextAssociation:function(){this.associationThumbnailIndex<this.totalAssociationCount&&(this.associationThumbnailIndex=this.associationThumbnailIndex+1,this.initializeMerchandisingAssociation(this.associationThumbnailIndex))},showPreviousAssociation:function(){this.associationThumbnailIndex>1&&(this.associationThumbnailIndex=this.associationThumbnailIndex-1,this.initializeMerchandisingAssociation(this.associationThumbnailIndex))},AddAssociation2ShopCartAjax:function(baseProductId,baseProductQuantity){var identifierJSON="associatedCatEntries_"+this.associationThumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")");if(this.merchandisingAssociationItems=associationEntryJSON,this.baseItemAddedToCart=!1,"ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type)this.Add2ShopCartAjax(baseProductId,baseProductQuantity),this.baseItemAddedToCart&&showPopup(this.merchandisingAssociationItems[0].catEntry_Identifier,function(t){return t},"marchandisingAssociationDisplay");else if("ItemBean"==this.merchandisingAssociationItems[0].catEntry_Type||"PackageBean"==this.merchandisingAssociationItems[0].catEntry_Type||"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var entitledItemJSON=eval("("+dojo.byId(baseProductId).innerHTML+")");this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId(),params=[];if(params.storeId=this.storeId,params.catalogId=this.catalogId,params.langId=this.langId,params.orderId=".",params.calculationUsage="-1,-2,-3,-4,-5,-6,-7",null==catalogEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);if(this.updateParamObject(params,"catEntryId",catalogEntryId,!1,-1),this.updateParamObject(params,"quantity",baseProductQuantity,!1,-1),"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var form=document.getElementById(this.merchandisingAssociationItems[0].catEntry_BundleFormId),catEntryArray=[];catEntryArray=form.catEntryIDS.value.toString().split(",");for(var i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),0!=qty&&null!=qty||(qty=1),null==qty||""==qty||null==catEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);this.updateParamObject(params,"catEntryId",catEntryId,!1,-1),this.updateParamObject(params,"quantity",qty,!1,-1)}}else this.updateParamObject(params,"catEntryId",this.merchandisingAssociationItems[0].catEntry_Identifier,!1,-1),this.updateParamObject(params,"quantity",1,!1,-1);if(!submitRequest())return;cursor_wait(),wc.service.invoke("AjaxAddOrderItem",params)}},AddMarchandisingAssociation2ShopCart:function(entitledItemId,form,quantity){var identifierJSON="associatedCatEntries_"+this.associationThumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")"),entitledItemJSON;this.merchandisingAssociationItems=associationEntryJSON,entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId_1=this.getCatalogEntryId();if("ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type){if(null==catalogEntryId_1)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);form.catEntryId_1.value=catalogEntryId_1,form.productId_1.value=catalogEntryId_1,form.quantity_1.value=quantity,this.merchandisingProductAssociationAddToCart=!0,this.merchandisingProductAssociationForm=form,showPopup(this.merchandisingAssociationItems[0].catEntry_Identifier,function(t){return t},"marchandisingAssociationDisplay")}else if("ItemBean"==this.merchandisingAssociationItems[0].catEntry_Type||"PackageBean"==this.merchandisingAssociationItems[0].catEntry_Type||"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){if(null==catalogEntryId_1)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);if(form.catEntryId_1.value=catalogEntryId_1,form.productId_1.value=catalogEntryId_1,form.quantity_1.value=quantity,"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var bundleForm=document.getElementById(this.merchandisingAssociationItems[0].catEntry_BundleFormId),catEntryArray=[];catEntryArray=bundleForm.catEntryIDS.value.toString().split(",");for(var catEntryCount=3,i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),0!=qty&&null!=qty||(qty=1),null==qty||""==qty||null==catEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);if(0==i)form.catEntryId_2.value=catEntryId,form.productId_2.value=catEntryId,form.quantity_2.value=qty;else{var input1=document.createElement("input");input1.setAttribute("id","OrderAssociationItemAddForm_catEntryId_"+catEntryId),input1.setAttribute("type","hidden"),input1.setAttribute("name","catEntryId_"+catEntryCount),input1.setAttribute("value",catEntryId),form.appendChild(input1);var input2=document.createElement("input");input2.setAttribute("id","OrderAssociationItemAddForm_productId_"+catEntryId),input2.setAttribute("type","hidden"),input2.setAttribute("name","productId_"+catEntryCount),input2.setAttribute("value",catEntryId),form.appendChild(input2);var quantity1=document.createElement("input");quantity1.setAttribute("id","OrderAssociationItemAddForm_quantity_"+catEntryId),quantity1.setAttribute("type","hidden"),quantity1.setAttribute("name","quantity_"+catEntryCount),quantity1.setAttribute("value","1"),form.appendChild(quantity1),catEntryCount+=1}}}else form.catEntryId_2.value=this.merchandisingAssociationItems[0].catEntry_Identifier,form.productId_2.value=this.merchandisingAssociationItems[0].catEntry_Identifier,form.quantity_2.value="1";if(!submitRequest())return;form.submit()}},AddAssociation2ShopCart:function(t,e){var a=this.merchandisingProductAssociationForm;if(this.merchandisingProductAssociationAddToCart=!1,this.isParentBundleBean){var r;r=a.catEntryIDS.value.toString().split(",");for(var i=1,n=0;n<r.length;n++){var s=document.getElementById("quantity_"+r[n]).value,o=r[n];if(this.selectedProducts[r[n]]&&(o=this.getCatalogEntryIdforProduct(this.selectedProducts[r[n]])),0!=s&&null!=s||(s=1),null==s||""==s||null==o)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);var d=document.createElement("input");d.setAttribute("id","OrderItemAddForm_catEntryId_"+o),d.setAttribute("type","hidden"),d.setAttribute("name","catEntryId_"+i),d.setAttribute("value",o),i+=1,a.appendChild(d)}var c=document.createElement("input");c.setAttribute("id","OrderItemAddForm_catEntryId_"+t),c.setAttribute("type","hidden"),c.setAttribute("name","catEntryId_"+i),c.setAttribute("value",t),a.appendChild(c);var l=document.createElement("input");l.setAttribute("id","OrderItemAddForm_quantity_"+t),l.setAttribute("type","hidden"),l.setAttribute("name","quantity_"+i),l.setAttribute("value",e),a.appendChild(l),a.URL.value="AjaxOrderItemDisplayView",this.isParentBundleBean=!1}else a.catEntryId_2.value=t,a.productId_2.value=t,a.quantity_2.value=e;submitRequest()&&(a.submit(),this.merchandisingProductAssociationForm="")},AddAssociationItem2ShopCartAjax:function(baseItemId,baseItemQuantity,customParams){var ajaxShopCartService="AjaxAddOrderItem",identifierJSON="associatedCatEntries_"+this.associationThumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")");if(this.merchandisingAssociationItems=associationEntryJSON,this.baseItemAddedToCart=!1,"ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type)this.AddItem2ShopCartAjax(baseItemId,baseItemQuantity,customParams),this.baseItemAddedToCart&&showPopup(this.merchandisingAssociationItems[0].catEntry_Identifier,function(t){return t},"marchandisingAssociationDisplay");else if("ItemBean"==this.merchandisingAssociationItems[0].catEntry_Type||"PackageBean"==this.merchandisingAssociationItems[0].catEntry_Type||"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var params=[];if(params.storeId=this.storeId,params.catalogId=this.catalogId,params.langId=this.langId,params.orderId=".",params.calculationUsage="-1,-2,-3,-4,-5,-6,-7",this.updateParamObject(params,"catEntryId",baseItemId,!1,-1),this.updateParamObject(params,"quantity",baseItemQuantity,!1,-1),"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var form=document.getElementById(this.merchandisingAssociationItems[0].catEntry_BundleFormId),catEntryArray=[];catEntryArray=form.catEntryIDS.value.toString().split(",");for(var i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),0!=qty&&null!=qty||(qty=1),null==qty||""==qty||null==catEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);this.updateParamObject(params,"catEntryId",catEntryId,!1,-1),this.updateParamObject(params,"quantity",qty,!1,-1)}}else this.updateParamObject(params,"catEntryId",this.merchandisingAssociationItems[0].catEntry_Identifier,!1,-1),this.updateParamObject(params,"quantity",1,!1,-1);if(!submitRequest())return;cursor_wait(),null!=customParams&&"undefined"!=customParams&&"dynamicKit"==customParams.catalogEntryType&&(ajaxShopCartService="AjaxAddPreConfigurationToCart"),wc.service.invoke(ajaxShopCartService,params)}},AddAssociationItem2ShopCart:function(form,quantity){var identifierJSON="associatedCatEntries_"+this.associationThumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")");if(this.merchandisingAssociationItems=associationEntryJSON,"ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type)quantity&&(form.quantity_1.value=quantity),this.merchandisingProductAssociationAddToCart=!0,this.merchandisingProductAssociationForm=form,showPopup(this.merchandisingAssociationItems[0].catEntry_Identifier,function(t){return t},"marchandisingAssociationDisplay");else if("ItemBean"==this.merchandisingAssociationItems[0].catEntry_Type||"PackageBean"==this.merchandisingAssociationItems[0].catEntry_Type||"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){if(quantity&&(form.quantity_1.value=quantity),"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var bundleForm=document.getElementById(this.merchandisingAssociationItems[0].catEntry_BundleFormId),catEntryArray=[];catEntryArray=bundleForm.catEntryIDS.value.toString().split(",");for(var catEntryCount=3,i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),0!=qty&&null!=qty||(qty=1),0==i)form.catEntryId_2.value=catEntryId,form.productId_2.value=catEntryId,form.quantity_2.value=qty;else{var input1=document.createElement("input");input1.setAttribute("id","OrderAssociationItemAddForm_catEntryId_"+catEntryId),input1.setAttribute("type","hidden"),input1.setAttribute("name","catEntryId_"+catEntryCount),input1.setAttribute("value",catEntryId),form.appendChild(input1);var input2=document.createElement("input");input2.setAttribute("id","OrderAssociationItemAddForm_productId_"+catEntryId),input2.setAttribute("type","hidden"),input2.setAttribute("name","productId_"+catEntryCount),input2.setAttribute("value",catEntryId),form.appendChild(input2);var quantity1=document.createElement("input");quantity1.setAttribute("id","OrderAssociationItemAddForm_quantity_"+catEntryId),quantity1.setAttribute("type","hidden"),quantity1.setAttribute("name","quantity_"+catEntryCount),quantity1.setAttribute("value","1"),form.appendChild(quantity1),catEntryCount+=1}}}else form.catEntryId_2.value=this.merchandisingAssociationItems[0].catEntry_Identifier,form.productId_2.value=this.merchandisingAssociationItems[0].catEntry_Identifier,form.quantity_2.value="1";if(!submitRequest())return;form.submit()}},AddAssociationBundle2ShopCartAjax:function(form){var identifierJSON="associatedCatEntries_"+this.associationThumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")");this.merchandisingAssociationItems=associationEntryJSON,this.baseItemAddedToCart=!1;var params=[];params.storeId=this.storeId,params.catalogId=this.catalogId,params.langId=this.langId,params.orderId=".",params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";var catEntryArray=[];catEntryArray=form.catEntryIDS.value.toString().split(",");for(var i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),0!=qty&&null!=qty||(qty=1),null==qty||""==qty||null==catEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);this.updateParamObject(params,"catEntryId",catEntryId,!1,-1),this.updateParamObject(params,"quantity",qty,!1,-1),this.baseItemAddedToCart="true"}if("BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var bundleForm=document.getElementById(this.merchandisingAssociationItems[0].catEntry_BundleFormId),innerCatEntryArray=[];innerCatEntryArray=bundleForm.catEntryIDS.value.toString().split(",");for(var i=0;i<innerCatEntryArray.length;i++){var qty=document.getElementById("quantity_"+innerCatEntryArray[i]).value,innerCatEntryId=innerCatEntryArray[i];if(this.getDefaultItem(innerCatEntryArray[i])&&(innerCatEntryId=this.getDefaultItem(innerCatEntryArray[i])),0!=qty&&null!=qty||(qty=1),null==qty||""==qty||null==innerCatEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);this.updateParamObject(params,"catEntryId",innerCatEntryId,!1,-1),this.updateParamObject(params,"quantity",qty,!1,-1)}}else"PackageBean"!=this.merchandisingAssociationItems[0].catEntry_Type&&"ItemBean"!=this.merchandisingAssociationItems[0].catEntry_Type||(this.updateParamObject(params,"catEntryId",this.merchandisingAssociationItems[0].catEntry_Identifier,!1,-1),this.updateParamObject(params,"quantity",1,!1,-1));submitRequest()&&(cursor_wait(),wc.service.invoke("AjaxAddOrderItem",params),"ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type&&showPopup(this.merchandisingAssociationItems[0].catEntry_Identifier,function(t){return t},"marchandisingAssociationDisplay"))},setOrderId:function(t){this.orderId=t},AddAssociationBundle2ShopCart:function(form){var identifierJSON="associatedCatEntries_"+this.associationThumbnailIndex,associationEntryJSON=eval("("+dojo.byId(identifierJSON).innerHTML+")");if(this.merchandisingAssociationItems=associationEntryJSON,this.isParentBundleBean=!0,"ProductBean"==this.merchandisingAssociationItems[0].catEntry_Type){this.merchandisingProductAssociationAddToCart=!0,this.merchandisingProductAssociationForm=form;var catEntryArray=[];catEntryArray=form.catEntryIDS.value.toString().split(",");for(var bundleItemsCount=1,i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),null==catEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);form["catEntryId_"+catEntryArray[i]].value=catEntryId,bundleItemsCount+=1}showPopup(this.merchandisingAssociationItems[0].catEntry_Identifier,function(t){return t},"marchandisingAssociationDisplay")}else if("ItemBean"==this.merchandisingAssociationItems[0].catEntry_Type||"PackageBean"==this.merchandisingAssociationItems[0].catEntry_Type||"BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var catEntryArray=[];catEntryArray=form.catEntryIDS.value.toString().split(",");for(var bundleItemsCount=1,i=0;i<catEntryArray.length;i++){var qty=document.getElementById("quantity_"+catEntryArray[i]).value,catEntryId=catEntryArray[i];if(this.getDefaultItem(catEntryArray[i])&&(catEntryId=this.getDefaultItem(catEntryArray[i])),null==catEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);form["catEntryId_"+catEntryArray[i]].value=catEntryId,bundleItemsCount+=1}if("BundleBean"==this.merchandisingAssociationItems[0].catEntry_Type){var bundleForm=document.getElementById(this.merchandisingAssociationItems[0].catEntry_BundleFormId),innerCatEntryArray=[];innerCatEntryArray=bundleForm.catEntryIDS.value.toString().split(",");for(var i=0;i<innerCatEntryArray.length;i++){var qty=document.getElementById("quantity_"+innerCatEntryArray[i]).value,innerCatEntryId=innerCatEntryArray[i];if(this.getDefaultItem(innerCatEntryArray[i])&&(innerCatEntryId=this.getDefaultItem(innerCatEntryArray[i])),0!=qty&&null!=qty||(qty=1),null==qty||""==qty||null==innerCatEntryId)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU);var input2=document.createElement("input");input2.setAttribute("id","OrderItemAddForm_catEntryId_"+innerCatEntryId),input2.setAttribute("type","hidden"),input2.setAttribute("name","catEntryId_"+bundleItemsCount),input2.setAttribute("value",innerCatEntryId),form.appendChild(input2);var quantity2=document.createElement("input");quantity2.setAttribute("id","OrderItemAddForm_quantity_"+innerCatEntryId),quantity2.setAttribute("type","hidden"),quantity2.setAttribute("name","quantity_"+bundleItemsCount),quantity2.setAttribute("value","1"),form.appendChild(quantity2),bundleItemsCount+=1}}else{var input2=document.createElement("input");input2.setAttribute("id","OrderItemAddForm_catEntryId_"+this.merchandisingAssociationItems[0].catEntry_Identifier),input2.setAttribute("type","hidden"),input2.setAttribute("name","catEntryId_"+bundleItemsCount),input2.setAttribute("value",this.merchandisingAssociationItems[0].catEntry_Identifier),form.appendChild(input2);var quantity2=document.createElement("input");quantity2.setAttribute("id","OrderItemAddForm_quantity_"+this.merchandisingAssociationItems[0].catEntry_Identifier),quantity2.setAttribute("type","hidden"),quantity2.setAttribute("name","quantity_"+bundleItemsCount),quantity2.setAttribute("value","1"),form.appendChild(quantity2)}if(form.URL.value="AjaxOrderItemDisplayView",!submitRequest())return;form.submit()}},addToNewListFromProductDetail:function(entitledItemId,quantityElemId,currentPage){var entitledItemJSON;MessageHelper.hideAndClearMessage(),entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();if(null==catalogEntryId)return MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU_REQ_LIST),void(null!=dijit.byId("second_level_category_popup")&&hidePopup("second_level_category_popup"));this.addItemToNewListFromProductDetail(catalogEntryId,quantityElemId,currentPage)},addItemToNewListFromProductDetail:function(t,e,a){if(MessageHelper.hideAndClearMessage(),null!=t){var r=document.getElementById(e).value;if(null==r||""==r||r<=0||!RequisitionList.isNumber(r))return MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR),void(null!=dijit.byId("second_level_category_popup")&&hidePopup("second_level_category_popup"));if(this.ajaxMyAccount)var i="AjaxLogonForm?page=createrequisitionlist";else i="RequisitionListDetailView?editable=true&newList=true";var n=document.createElement("form");n.setAttribute("method","POST");var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("value",a),s.setAttribute("name","previousPage"),n.appendChild(s),n.action=i+"&catEntryId="+t+"&quantity="+r+"&storeId="+this.storeId+"&catalogId="+this.catalogId+"&langId="+this.langId,document.body.appendChild(n),n.submit()}else MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU_REQ_LIST)},addBundleToNewListFromProductDetail:function(t,e){var a=t.numberOfProduct.value,r="";r=this.ajaxMyAccount?"AjaxLogonForm?page=createrequisitionlist":"RequisitionListDetailView?editable=true&newList=true";for(var i=1;i<=a;i++){var n=t["catEntryId_"+i].value;this.selectedProducts[n]&&(n=this.getCatalogEntryIdforBundleProduct(n,this.selectedProducts[n]));var s=t["quantity_"+i].value;if(null==s||""==s||s<=0||!RequisitionList.isNumber(s))return void MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR);if(null==n)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU_REQ_LIST);r=r+"&catEntryId="+n+"&quantity="+s}var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("value",e),o.setAttribute("name","previousPage"),t.appendChild(o),r=r+"&numberOfProduct="+t.numberOfProduct.value+"&storeId="+this.storeId+"&catalogId="+this.catalogId+"&langId="+this.langId,t.action=r,t.submit()},addToExistingRequisitionList:function(entitledItemId,quantityElemId,ajaxAddToCart){var entitledItemJSON;entitledItemJSON=null!=dojo.byId(entitledItemId)?eval("("+dojo.byId(entitledItemId).innerHTML+")"):this.getEntitledItemJsonObject(),this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId();null!=catalogEntryId?this.addItemToExistingRequisitionList(catalogEntryId,quantityElemId,ajaxAddToCart):MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU_REQ_LIST)},addBundleToExistingRequisitionList:function(t,e){for(var a=document.getElementsByName("RequisitionListTableDisplay_RequisitionListSelection"),r=0;r<a.length;r++)if(a.item(r).checked)var i=a.item(r).value;if(e){var n=[];n.storeId=this.storeId,n.catalogId=this.catalogId,n.langId=this.langId,n.requisitionListId=i;var s=t.numberOfProduct.value;for(r=1;r<=s;r++){var o=t["catEntryId_"+r].value;this.selectedProducts[o]&&(o=this.getCatalogEntryIdforBundleProduct(o,this.selectedProducts[o]));var d=t["quantity_"+r].value;if(null==d||""==d||d<=0||!RequisitionList.isNumber(d))return void MessageHelper.displayeErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR);if(null==d||""==d||null==o)return void MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU_REQ_LIST);this.updateParamObject(n,"catEntryId",o,!1,-1),this.updateParamObject(n,"quantity",d,!1,-1),this.baseItemAddedToCart=!0}if(!submitRequest())return;cursor_wait(),wc.service.invoke("requisitionListAddItem_popup",n)}else{if(t.action="RequisitionListItemUpdate?requisitionListId="+i,this.ajaxMyAccount?t.URL.value="AjaxLogonForm?page=editrequisitionlist&requisitionListId="+i+"&editable=true":t.URL.value="RequisitionListDetailView?requisitionListId="+i+"&editable=true",!submitRequest())return;cursor_wait(),t.submit()}},addItemToExistingRequisitionList:function(t,e,a){if(null!=t){var r=document.getElementById(e).value;if(!RequisitionList.isNumber(r)||r<=0)return"productPopUpQty"==e?(MessageHelper.displayErrorMessage(MessageHelper.messages.QUANTITY_INPUT_ERROR),void(null!=dijit.byId("second_level_category_popup")&&hidePopup("second_level_category_popup"))):void MessageHelper.formErrorHandleClient(e,MessageHelper.messages.QUANTITY_INPUT_ERROR);for(var i=document.getElementsByName("RequisitionListTableDisplay_RequisitionListSelection"),n=0;n<i.length;n++)if(i.item(n).checked)var s=i.item(n).value;if(a){var o={};if(o.requisitionListId=s,o.catEntryId=t,o.quantity=r,o.storeId=this.storeId,o.catalogId=this.catalogId,o.langId=this.langId,!submitRequest())return;cursor_wait(),wc.service.invoke("requisitionListAddItem_popup",o)}else{var d=document.forms.RequisitionListPopupForm;if(d.requisitionListId.value=s,d.quantity.value=r,d.catEntryId.value=t,this.ajaxMyAccount?d.URL.value="AjaxLogonForm?page=editrequisitionlist&requisitionListId="+s+"&editable=true":d.URL.value="RequisitionListDetailView?requisitionListId="+s+"&editable=true",!submitRequest())return;cursor_wait(),d.submit()}}else MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_RESOLVING_SKU_REQ_LIST)},setCurrentPageType:function(t){this.currentPageType=t},setCurrentCatalogEntryId:function(t){this.currentCatalogEntryId=t},removeFacet:function(t,e,a,r){categoryDisplayJS.removeFromFacetCookie(t,r,e);var i=window.location.search;if(i.length>0){i=i.substring(1);var n=encodeURIComponent(encodeURIComponent(t+":"+e));n=n.replaceAll("%252B","%2B");var s=new RegExp("(^|&)facet="+n,"g");i=(i=i.replace(s,"")).replace(/(^|&)metaData=[^&]*/g,""),document.location.href=document.location.protocol+"//"+document.location.host+document.location.pathname+"?"+i}else document.location.href.indexOf("contact-lenses")>=0?document.location.href="/to-us/contact-lenses":document.location.href.indexOf("eyeglasses")>=0?document.location.href="/to-us/eyeglasses":document.location.href.indexOf("sunglasses")>=0&&(document.location.href="/to-us/sunglasses");return!1},removeAllFacet:function(){for(var t=$.getUrlVars(),e={},a=0;a<t.length;a++){var r=t[a],i=$.getUrlVar(r);e[r]=i}delete e.facet,delete e.metaData;var n=document.location.protocol+"//"+document.location.host+document.location.pathname,s=!0;for(var r in e)s?(n+="?"+r+"="+encodeURIComponent(e[r]),s=!1):n+="&"+r+"="+encodeURIComponent(e[r]);return document.cookie="facets=;path=/;",document.cookie="query_facets=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.location.href=n,!1},constructQueryFacet:function(t){var e="(",a=t.replaceAll("[()]","").split("OR");if(a.length>1){for(var r=0;r<a.length;r++)if(a[r].length>0){var i=!1;r>0&&e.length>1&&(e+=" AND "),e=e+"(("+a[r]+")";for(var n=a[r].split(":")[0],s=r+1;s<a.length&&!i;){n==a[s].split(":")[0]?(e=e+" OR ("+a[s]+")",r=s,s++):(e+=")",i=!0,r=s-1)}}e=(e+="))").replaceAll(/\"/g,'\\"')}else e="";console.log("Query "+e),document.cookie="query_facets="+e+"; path=/"},removeFromFacetCookie:function(t,e,a){if(""!=e){var r=decodeURIComponent($.cookie("facets")).replace("|"+e+":"+a,"");document.cookie="facets="+r+"; path=/"}var i=getCookie("query_facet");null!=i&&(i=(i=i.replaceAll(/\\"/g,'"')).replaceAll(t+":"+a,"").replaceAll(" ","").replaceAll("=",""),categoryDisplayJS.constructQueryFacet(i))},handleCategorySubscription:function(t,e){if(1==e||"true"==e){var a=document.forms[t],r={};if(r.DM_ReqCmd=a.DM_ReqCmd.value,r.storeId=a.storeId.value,r.catalogId=a.catalogId.value,r.langId=a.langId.value,r.categoryId=a.categoryId.value,!submitRequest())return;cursor_wait(),wc.service.invoke("AjaxCategorySubscribe",r)}else{(a=document.forms[t]).URL.value=location.href,a.submit()}},loadMoreResults:function(t,e){var a=parseInt($("#loadMorePressedFlag").val());if(console.log("Load more... Waiting for products to load..."+a),0==a){$("#loadMorePressedFlag").val(1);e=e;var r=parseInt($("#resultsLeft").val());isNaN(r)&&(r=parseInt($("#resultsLeftContacts").val()));var i=parseInt($("#beginIndexCount").val());if(isNaN(i)&&(i=parseInt($("#beginIndexCountContacts").val())),console.log("loadMoreResults pageSize "+e+" resultsLeft "+r+" beginIndexCount "+i),r>0){var n={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:i,categoryId:t,pageSize:e,searchType:"0",facet:globalFacet};$.get("AjaxContactLensCategoryResultsView",n,function(t){r<e?($("#currentResults").text(parseInt($("#currentResults").text())+r),$("#currentResultsCopy").text(parseInt($("#currentResults").text())),$("#resultsLeft").length>0&&$("#resultsLeft").val(r-r),$("#resultsLeftContacts").length>0&&$("#resultsLeftContacts").val(r-r),$(".load-more.button-flat.red").hide()):($("#resultsLeft").length>0&&$("#resultsLeft").val(r-e),$("#resultsLeftContacts").length>0&&$("#resultsLeftContacts").val(r-r),$("#currentResults").text(parseInt($("#currentResults").text())+e),$("#currentResultsCopy").text(parseInt($("#currentResults").text())),$("#beginIndexCount").val(i+e),$(".__prjid5_showable").text($("#resultsLeft").val()),r-e<e&&$(".__prjid5_loadable").text($("#resultsLeft").val())),$(".results_grid").append(t),$("#Search_Area_div .results_grid .item_container").each(function(){manageListItem(discountedPricesManager,this),showBestDealBadge(this)}),monetateFiller.onContactsPLP(),$("#loadMorePressedFlag").val(0)},"html")}}},loadMoreResultsMobile:function(t){var e=parseInt($("#pageSize").val()),a=parseInt($("#resultsLeft").val()),r=parseInt($("#beginIndexCount").val());if(a>0){var i={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:r,categoryId:t,pageSize:e,searchType:"0"};$.get("AjaxContactLensCategoryResultsView",i,function(t){$(".results_grid").append(t),a<e?($("#currentResults").text(parseInt($("#currentResults").text())+a),$("#resultsLeft").val(a-a),$("#loadResultsButton").hide()):($("#resultsLeft").val(a-e),$("#currentResults").text(parseInt($("#currentResults").text())+e),$("#beginIndexCount").val(r+e)),monetateFiller.onContactsPLP()},"html")}},loadMoreFrameResultsMobile:function(t){var e=parseInt($("#pageSize").val()),a=parseInt($("#resultsLeft").val()),r=parseInt($("#beginIndexCount").val());if(a>0){var i={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:r,categoryId:t,pageSize:e,searchType:"0"};$.get("AjaxContactLensCategoryResultsView",i,function(t){$(".results_grid").append(t),a<e?($("#currentResults").text(parseInt($("#currentResults").text())+a),$("#resultsLeft").val(a-a),$("#loadResultsButton").hide()):($("#resultsLeft").val(a-e),$("#currentResults").text(parseInt($("#currentResults").text())+e),$("#beginIndexCount").val(r+e)),monetateFiller.onGlassesPLP()},"html")}},manageFacetFilter:function(t){for(var e=t.split("&"),a="(",r=0;r<e.length;r++){if(e[r].includes("facet"))a.length>1&&(a+="OR"),a+="("+e[r].split("=")[1].replaceAll("%3A",":").replaceAll("%22",'"')+")"}return a+=")",categoryDisplayJS.constructQueryFacet(a),t=t.replaceAll("%3A","%253A").replaceAll("%22","%2522"),document.location.href=t,!1},loadMoreFrameResultsDesktop:function(t,e){var a=decodeURIComponent(getUrlParameter("searchFilterType")),r=$("#currentSearchTerm").val();console.debug("categoryId: "+t+": "+r+":"+facetParameterValue);var i=parseInt($("#loadMorePressedFlag").val()),n=$("#searchType").val();if(void 0!=n&&""!=n||(n="0"),0==i){$("#loadMorePressedFlag").val(1);var s=parseInt($("#resultsLeft").val()),o=parseInt($("#beginIndexCount").val());if(console.debug("beginIndexCount: "+o+":"+e+":"+s+":"+t+" : "+globalFacet+": "+globalOrder),s>0){var d={};if("priceFilter"==a){console.debug("priceFilter: ");var c="";if("undefined"!=typeof globalFacet&&globalFacet.indexOf("price_USD")>-1){var l=decodeURIComponent(read_cookie("facets"));if(null!=l&&-1!=l.indexOf("PR:")){console.log("price cookie found");var u=l.split("PR:")[1].split("|")[0].split("-"),p=u[0],m=u[1];c="*"==m?"price_USD:({"+p+" "+m+"})":"price_USD:({"+p+" "+m+"} "+m+")",c=escape(c)}else c=globalFacet,d={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:o,categoryId:t,pageSize:e,searchType:n,facet:globalFacet,orderBy:globalOrder}}else console.log("price_USD not found"),c=globalFacet,d={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:o,categoryId:t,pageSize:e,searchType:n,facet:globalFacet,orderBy:globalOrder};d={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:o,categoryId:t,searchTerm:r,pageSize:e,searchType:n,facet:c,orderBy:globalOrder}}else d=""!=r&&"undefined"!=r?{storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:o,categoryId:t,searchTerm:r,pageSize:e,searchType:n,facet:facetParameterValue,metaData:globalMetadata,orderBy:globalOrder}:{storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,beginIndex:o,categoryId:t,pageSize:e,searchType:n,facet:facetParameterValue,metaData:globalMetadata,orderBy:globalOrder};$.get("AjaxFrameCategoryResultsView",d,function(t){$("#loadMorePressedFlag").val(0);var a=s-e;a<=e?($(".__prjid5_loadable").html(a),$(".__prjid5_showable").html(s-e)):($(".__prjid5_showable").html(s-e),$(".__prjid5_loadable").html(e)),s<=e?($("#currentResults").text(parseInt($("#currentResults").text())+s),$("#resultsLeft").val(s-s),$("#loadResultsButton").hide(),$(".items-shown",".resultsNumber").text(parseInt($("#currentResults").text()))):($("#resultsLeft").val(s-e),$("#currentResults").text(parseInt($("#currentResults").text())+e),$("#beginIndexCount").val(o+e),$(".items-shown",".resultsNumber").text(parseInt(e+o))),$(".products-holder").append(t),monetateFiller.onGlassesPLP()},"html")}}}},categoryDisplayJS.HistoryTracker.prototype.back=categoryDisplayJS.goBack,categoryDisplayJS.HistoryTracker.prototype.forward=categoryDisplayJS.goForward;var DiscountedPricesManager=function(){var t,e="ordered_boxes_qty",a="u",r="t",i="r",n="p",s=!1;this.init=function(a){if(a){for(var r in t={},a){var i=a[r],n={};$.extend(n,i);var d=$.map(i,function(t,e){return isNaN(parseInt(e))?null:e});d.sort(o),n[e]=d,t[r.toLowerCase()]=n}s=!0}},this.isInitialized=function(){return s},this.findUnitPriceByBoxes=function(t,a){var r=d(t);if(!r)return null;var i=r[e];if(!i||i.length<=0)return null;for(var n=0;n<i.length&&!(i[n]>a);n++);return c(r,n-1)},this.findFirstUnitPrice=function(t){var e=d(t);return e?c(e,0):null},this.findLastUnitPrice=function(t){var e=d(t);return e?c(e,999):null};var o=function(t,e){return t-e},d=function(e){return t&&e?t[e.toLowerCase()]:null};function c(t,s){var o=t[e];if(!o||o.length<=0)return null;if(s>=o.length)s=o.length-1;else if(s<0)return null;var d=o[s],c=t[d];return[d,c[a],c[r],t[i],c[n]]}};DiscountedPricesManager.formatPriceNumber=function(t){return"$"+(t=(""+(t=t.toFixed(2))).replace(",","."))},DiscountedPricesManager.formatMessage||(DiscountedPricesManager.formatMessage=function(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,function(t,a){return void 0!==e[a]?e[a]:t})});var discountedPricesManager=new DiscountedPricesManager;$(document).ready(function(){window.DISCOUNTS_MAP&&discountedPricesManager.init(window.DISCOUNTS_MAP)});var DiscountedLensesPricesManager=function(){this.internalPricesMap={},this.init=function(t){for(var e in this.internalPricesMap={},t){var a=t[e];this.internalPricesMap[e.toLowerCase()]=a}},this.findOfferPrice=function(t){var a=e(t);return a?a.o:null},this.findRetailPrice=function(t){var a=e(t);return a?a.r:null};var t=this,e=function(e){return e?t.internalPricesMap[e.toLowerCase()]:null}},discountedLensesPricesManager=new DiscountedLensesPricesManager;window.LENSES_DISCOUNTS_MAP&&discountedLensesPricesManager.init(window.LENSES_DISCOUNTS_MAP),$("#hic-lens .to-table .to-table-row").each(function(){var t=$(this).find("input.rx-lens-choice").val();if(t){var e=discountedLensesPricesManager.findOfferPrice(t);if(e){var a=discountedLensesPricesManager.findRetailPrice(t);$(this).find(".to-prices-list").length>0&&$(this).find(".to-prices-list").html("  <p class='clearfix list-price-row'>\t\t <span class='to-price  list-price'>"+formatPriceNumber(parseFloat(a))+"\t </span><span class='hide'>retail price:</span>  </p>\t  <p class='to-actual-price clearfix'> \t <span class='to-price bold product-price only-product-price'>   \t   <span class='price listPrice'>"+formatPriceNumber(parseFloat(a))+"\t   </span>   \t   <span class='price offerprice product-price'>"+formatPriceNumber(parseFloat(e))+"\t   </span>\t </span><span class='hide'>offer price:</span> </p><p class='clearfix list-insurance-price-row' style='display:none' >  <span class='to-price  insurance-price'>  </span>      <span class='hide'>price with insurance:</span> </p>")}}});var LookingForRelated=function(){this.map={};var t=!1;this.init=function(e){this.map=e,t=!0},this.getByProductCode=function(t,e){if(!t)return null;var a=this.map[t.toUpperCase()];return a?a[e]:void 0},this.getRelatedProductByProductCode=function(t){return this.getByProductCode(t,"target")},this.getHtmlByProductCode=function(t){return this.getByProductCode(t,"html")},this.isInitialized=function(){return t}},lookingForRelated=new LookingForRelated;$(document).ready(function(){window.RELATED_PRODUCTS_MAP&&lookingForRelated.init(window.RELATED_PRODUCTS_MAP)});var ContactsMapInformations=function(){this.init=function(t){this._internalMap=t,this._initialized=!0},this.getProductById=function(t){return this._initialized&&this._internalMap&&this._internalMap[t.toLowerCase()]?this._internalMap[t.toLowerCase()]:{}},this.getProductName=function(t){return this.getProductById(t).name},this.getProductBrand=function(t){return this.getProductById(t).brand},this.getProductManufacturer=function(t){return this.getProductById(t).manuf},this.getProductType=function(t){return this.getProductById(t).type},this.getProductWater=function(t){return this.getProductById(t).water},this.getProductMaterial=function(t){return this.getProductById(t).material},this.getProductUrl=function(t){return this.getProductById(t).url},this.getProductPublicationDate=function(t){return this.getProductById(t).pubDate},this.isInitialized=function(){return!1}},contactsMapInformations=new ContactsMapInformations;function calculateContactsTotal(){function t(t){window.console&&window.console.log&&window.console.log(t)}if(products&&products[0]){var e=products[0].product_id;if(e){e&&""!==e&&(e=e.toLowerCase());var a=0,r=0;""!=$(".contact-lens-price").text()&&(r=parseFloat($(".contact-lens-price").text().replace(/\$/,"")),a=parseFloat($("#rightQuantity").val())+parseFloat($("#leftQuantity").val()));var i,n=r*a,s=n,o=n,d=r,c=0;if(discountedPricesManager.isInitialized()){var l=discountedPricesManager.findUnitPriceByBoxes(e,a);if(l&&l.length>=4){var u=l[2];o=s=n+parseFloat(u),d=s/a}}if($.cookie("json_insurance")&&RiaHelper.checkSingleBenefit("contact")&&$("#insurance-content").hasClass("insurance-on")){var p=JSON.parse($.cookie("json_insurance")).data.contact[0];(c=p.discount+p.reimbursement)>0||(c=0);var m=s-c;m<0&&(c=s,m=0),$("#insurance-savings .price").text("-"+DiscountedPricesManager.formatPriceNumber(c)),d=(o=m)/a}i=n-o;DiscountedPricesManager.formatPriceNumber(s);var g=DiscountedPricesManager.formatPriceNumber(o),I=DiscountedPricesManager.formatPriceNumber(n),h=(DiscountedPricesManager.formatPriceNumber(i),DiscountedPricesManager.formatPriceNumber(i-c)),y=DiscountedPricesManager.formatPriceNumber(d);if(c>0?$("#insurance-savings").removeClass("hide"):$("#insurance-savings").addClass("hide"),i>0)if($(".to-total").text(g),$(".to-total-quantity").text(I),$(".to-total-saved-cl").show(),$("#saving-price").text("-"+h.slice(0,-3)),l){var f="$"+l[1];$(".price-per-box .listPrice").html(f),$(".price-per-box .boxDiscount").removeClass("hiddenBoxDiscount")}else $(".price-per-box .listPrice").html(y);else $(".to-total").text(I),$(".to-total-quantity").text(I),$(".price-per-box .listPrice").html(y),$(".to-total-saved-cl").hide(),$(".price-per-box .boxDiscount").addClass("hiddenBoxDiscount"),$(".to-total").removeClass("contact_lens_total_price_with_insurance"),$(".to-total-quantity").removeClass("contact_lens_total_price_with_insurance");a>=2&&"{0} boxes, {1}",$("#totals_price").text(DiscountedPricesManager.formatMessage(I));var v=$(".total-price").text(),E=Number(v.replace(/[^0-9.-]+/g,""));if($("#afterpayPlacement").length>0&&$("#afterpayPlacement").attr("data-amount",E),"undefined"!=typeof affirm){$("#affirmPrice").attr("data-amount",100*E);try{affirm.ui.ready(function(){affirm.ui.refresh()})}catch(t){console.error("Error refreshing Affirm: "+t)}}}else t("Cannot retrieve product-part from products[0]['product_id']!")}else t("This is not a PDP!")}$(document).ready(function(){window.CONTACTS_MAP&&contactsMapInformations.init(window.CONTACTS_MAP)});var performInitialLoad=!1;function selectContactLensProductIfLoading(){if(performInitialLoad){var t=$.getUrlVar("productId");$("#productId").val(t),$("#productId").change(),performInitialLoad=!1}}function verifyPrescriptionComplete(){$(".isNeeded.boxes").removeClass("orange"),$(".to-pdp-patient-info select").each(function(){$(this).is(":visible")&&null===$(this).val()&&!0}),$(".to-pdp-patient-info input[type=text]").each(function(){$(this).is(":visible")&&""===$(this).val()&&!0}),parseInt($("#rightQuantity").val())>0&&$("#table-right-eyes select").each(function(){$(this).is(":visible")&&null===$(this).val()&&!0}),parseInt($("#leftQuantity").val())>0&&$("#table-left-eyes select").each(function(){$(this).is(":visible")&&null===$(this).val()&&!0}),0===parseInt($("#rightQuantity").val())&&0===parseInt($("#leftQuantity").val())&&(!0,$(".isNeeded.boxes").addClass("orange"))}function getProductInformation(t){var e={storeId:categoryDisplayJS.storeId,catalogId:categoryDisplayJS.catalogId,langId:categoryDisplayJS.langId,productId:t};$.get("GetContactLensesByProductID",e,function(t){if(void 0!==t&&""!==t&&null!==t){var e=(t=$.parseJSON(t)).catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber,a={PRD_POWER:"Power",PRF_BASECURVE:"Bc",PRF_DIAMETER:"Dia",PRD_AXIS:"Axis",PRD_CYLINDER:"Cyl",PRD_COLOR:"Color",PRD_ADDITION_TXT:"Add"};if(t.catalogEntry.catalogEntryIdentifier.buyable&&1-t.catalogEntry.catalogEntryIdentifier.deleted){$.each(["rxRight","rxLeft"],function(e,r){$.each(t.attributes,function(t,e){var i=r+a[t],n=$("#"+i);$("span#"+i+"-span").remove(),$("input#"+i+"-input").remove(),n.html('<option disabled selected value="">-</option>'),e&&1==e.length?(n.parent().attr("disabled","disabled"),n.parent().find(".required-field").hide(),n.attr("disabled","disabled").hide().after('<span class="placeholder contact-lens" id="'+i+'-span">'+e[0]+"</span>").after('<input type="hidden" name="'+i+'" id="'+i+'-input" value="'+e[0]+'" />')):(n.parent().removeAttr("disabled"),$.each(e,function(t,e){n.append($("<option>",{value:e,text:e}))}),n.removeAttr("disabled").removeAttr("name").after('<input type="hidden" name="'+i+'" id="'+i+'-input" value="'+e[0]+'" />').change(function(){var t=$(this).attr("id")+"-input";$("#"+t).attr("value",$(this).val())}).show())})});var r=$("#rxRightCyl option").length>1||$("#rxRightAxis option").length>1;r=r&&0!=parseFloat($("#rxRightCyl option:nth-child(2)").val()),$(".astigmatism-only").toggle(r);var i=$("#rxRightColor option").length>1,n=i&&"Clear"==$("#rxRightColor option:nth-child(2)").val();n&&$("#rxRightColor, #rxLeftColor").val("Clear"),$(".color-only").toggle(i&&!n);var s=$("#rxRightAdd option").length>1;$(".add-only").toggle(s),verifyPrescriptionComplete()}var o=discountedPricesManager.findLastUnitPrice(e.toLowerCase());if(o){var d,c=0!==$(".partnumberitemrelpdp").length,l=o[0]*o[1];$(".partnumberitemrelpdp").each(function(){$(this).text();var t=discountedPricesManager.findLastUnitPrice($(this).text().toLowerCase());if(t){var e=t[0]*t[1];e<l?(d=$(this),l=e,c=!1):e===l&&(d=void 0,c=!1)}}),c?$(".product-info .badge-best-deal-pdp").show():d&&d.parent().find(".badgeitemrel").show()}calculateContactsTotal();var u,p=discountedPricesManager.findLastUnitPrice(e.toLowerCase()),m=0;if(p){m=(u=p[0])/2,$(".box_one_year").text(m);var g="Save the most when you buy "+u+" boxes.";$(".asp-message.required-msg ").text(g),p[1]!=p[3]&&($(".asp-message.required-msg ").removeClass("hide"),$(".price_one_year_value").text(-1*p[2]),$(".price_one_year_value").parent().parent().show(),$(".price_one_year_value").parent().parent().parent().parent().removeClass("hide"));var I=discountedPricesManager.findFirstUnitPrice(e.toLowerCase());I[0]!=p[0]?($(".box_six_months").text(I[0]/2),I[1]!=I[3]&&($(".price_six_months_value").text(-1*I[2]),$(".price_six_months_value").parent().parent().show(),$(".price_six_months_value").parent().parent().parent().parent().removeClass("hide")),p[1]!=p[3]||I[1]!=I[3]||p[1]==p[3]&&I[1]!=I[3]||p[1]!=p[3]&&(I[1],I[3]),$(".asp-message.required-msg ").removeClass("hide")):$(".box_six_months").text(I[0]/4)}else m=6,$(".box_one_year").text(2*m),$(".box_six_months").text(m);var h=$.parseJSON($.cookie("current_item_prescription"));$("#oneYearSupply").click(),$(".contact-lens-rx-area").show(),triggerContactLensUtag(t),cookiePrescriptionCheckNewItem(h),$("input[name=orderItemId]").val()&&(preselectContactPrescriptionInfo(),$("#customSupply").prop("checked",!0),$("#rightQuantity").change(),$("#leftQuantity").change(),$("#leftQuantity").parent().removeClass("disabled"),$("#rightQuantity").parent().removeClass("disabled"),$("#leftQuantity").removeAttr("tabindex"),$("#rightQuantity").removeAttr("tabindex"))}})}function preselectContactPrescriptionInfo(){$("select#rxRightPower option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=rightContactsPower]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxLeftPower option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=leftContactsPower]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxRightBc option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=rightContactsBaseCurve]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxLeftBc option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=leftContactsBaseCurve]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxRightDia option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=rightContactsDiameter]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxLeftDia option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=leftContactsDiameter]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxRightCyl option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=rightContactsCylinder]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$("select#rxLeftCyl option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("input[name=leftContactsCylinder]").val()).toFixed(2)&&$(this).prop("selected",!0).change()}),$('select#rxRightAxis option[value="'+$("input[name=rightContactsAxis]").val()+'"]').prop("selected",!0).change(),$('select#rxLeftAxis option[value="'+$("input[name=leftContactsAxis]").val()+'"]').prop("selected",!0).change(),$('select#rxRightAdd option[value="'+$("input[name=rightContactsAdd]").val()+'"]').prop("selected",!0).change(),$('select#rxLeftAdd option[value="'+$("input[name=leftContactsAdd]").val()+'"]').prop("selected",!0).change(),$('select#rightQuantity option[value="'+$("input[name=rightContactsQtyValue]").val()+'"]').prop("selected",!0).change(),$('select#leftQuantity option[value="'+$("input[name=leftContactsQtyValue]").val()+'"]').prop("selected",!0).change()}function setValueForSameEyes(){$("#rxRightColor").on("change",function(){$("#rxLeftColor").val($("#rxRightColor").val()),rxLeftColor.value=rxRightColor.value}),$("select#rxLeftPower option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("#rxRightPower").val()).toFixed(2)&&$(this).prop("selected",!0)}),$("select#rxLeftBc option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("#rxRightBc").val()).toFixed(2)&&$(this).prop("selected",!0)}),$("select#rxLeftDia option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("#rxRightDia").val()).toFixed(2)&&$(this).prop("selected",!0)}),$("select#rxLeftCyl option").each(function(){parseFloat($(this).val()).toFixed(2)==parseFloat($("#rxRightCyl").val()).toFixed(2)&&$(this).prop("selected",!0)}),$('select#rxLeftAxis option[value="'+$("#rxRightAxis").val()+'"]').prop("selected",!0),$('select#rxLeftAdd option[value="'+$("#rxRightAdd").val()+'"]').prop("selected",!0)}function manageListItem(t,e){var a=$(e).find(".item.item-tile"),r=a.attr("data-partnumber");if(r&&""!==r){r=r.toLowerCase();var i=t.findLastUnitPrice(r);if(i&&i[1]!=i[3]){var n=i[0],s=i[1],o=parseFloat(s),d=i[2],c=parseFloat(d),l=DiscountedPricesManager.formatPriceNumber(o),u=i[3],p=parseFloat(u),m=-1*c;if(p)var g=100*-(p-o)/p,I="%"+(g=Math.round(g)).toFixed(0);var h='<div class="offerprice">'+l+"</div>";if((E=a.find(".offerprice .productPriceSpan")).html(h),m>0){var y=a.find(".badges .badge-savings");y.html("SAVE "+DiscountedPricesManager.formatPriceNumber(m)),y.show()}var f=E.parent().parent().find("p").addClass("resetStyle"),v='<span class="listPrice">{0}</span>';1==n&&(v='<span class="listPrice">{0}</span>'),v=v+'<span class="redtxt percentprice" style="display: none;">'+I+'</span><div class="clearfix"></div>',v+=$.cookie("json_insurance")?'<span class="perbox-label">per box with instant savings before insurance</span>':'<span class="perbox-label">per box with instant savings</span>',f.html(DiscountedPricesManager.formatMessage(v,DiscountedPricesManager.formatPriceNumber(p)))}else{var E;h='<span class="offerprice">'+(E=a.find(".offerprice .productPriceSpan")).text().replace("per box","")+'</span><span class="list contactlenses per_box">&nbsp;per box</span>';E.html(h),(f=E.parent().parent().find("p")).text("")}}}function setupContactLenses101(){$(".content-types-Of-contacts .type-Content").hide(),$(".content-types-Of-contacts .type-Content:first").show(),$(".content-types-Of-contacts a").click(function(){$(".content-types-Of-contacts .type-Content").hide(),$(this).next(".type-Content").show()})}function buildMessage(t,e,a){if("EYEGLASSES_FRAMES"==e||"SUNGLASSES_FRAMES"==e){var r=a+" was just added to your cart";$.cookie("checkoutMessage",r,{path:"/"})}}function getUrlParameter(t){for(var e=window.location.search.substring(1).split("&"),a=0;a<e.length;a++){var r=e[a].split("=");if(r[0]==t)return r[1]}}function htmlEncode(t){return $("<div/>").text(t).html()}function showBestDealBadge(t){isBestDeal($(t).find(".item").attr("data-partnumber"))&&$(t).find(".badge-bestdeal-pdp").show()}function isBestDeal(t){var e=discountedPricesManager.findLastUnitPrice(t.toLowerCase());if(e){var a=!1,r=e[0]*e[1],i=getRelatedList(t);if(i&&i.length>0)for(related in a=!0,i){var n=discountedPricesManager.findLastUnitPrice(i[related].toLowerCase());if(n){var s=n[0]*n[1];(s<r||s===r)&&(a=!1)}}return a}}function getRelatedList(t){var e=[];return void 0!=window.RELATED_CONTACTS_MAP&&(e=RELATED_CONTACTS_MAP[t.toLowerCase()]),e}function cookiePrescriptionCheckNewItem(t){null==t||t.productId!==$("#productId").val()?$.cookie("current_item_prescription",JSON.stringify({productId:$("#productId").val()})):($.cookie("current_item_prescription",JSON.stringify(t)),cookiePrescriptionPopulateValues())}function cookiePrescriptionAddValue(t,e){var a=$.parseJSON($.cookie("current_item_prescription"));null!=a&&(a[t]=e,$.cookie("current_item_prescription",JSON.stringify(a)))}function cookiePrescriptionPopulateValues(){for(var t=$.parseJSON($.cookie("current_item_prescription")),e=["BIRTH_MONTH","BIRTH_DAY","BIRTH_YEAR","rxRightPower","rxLeftPower","rxRightBc","rxLeftBc","rxRightDia","rxLeftDia","rxRightCyl","rxLeftCyl","rxRightAxis","lxLeftAxis","rightQuantity","leftQuantity"],a=0;a<e.length;a++)t.hasOwnProperty(e[a])&&$("select#"+e[a]+' option[value="'+t[e[a]]+'"]').prop("selected",!0).change();var r=["FIRST_NAME","LAST_NAME"];for(a=0;a<r.length;a++)t.hasOwnProperty(r[a])&&$("input#"+r[a]).val(t[r[a]]);(t.hasOwnProperty("rightQuantity")||t.hasOwnProperty("leftQuantity"))&&(t.leftQuantity===$(".box_one_year").text()&&t.rightQuantity===$(".box_one_year").text()?$("#oneYearSupply").click():t.leftQuantity===$(".box_six_months").text()&&t.leftQuantity===$(".box_six_months").text()?$("#sixMonthsSupply").click():($("#customSupply").prop("checked",!0),$("#rightQuantity").change(),$("#leftQuantity").change(),$("#leftQuantity").parent().removeClass("disabled"),$("#rightQuantity").parent().removeClass("disabled"),$("#leftQuantity").removeAttr("tabindex"),$("#rightQuantity").removeAttr("tabindex"))),verifyPrescriptionComplete()}$(document).ready(function(){$(".ajaxAddItemToTryAtHome").click(function(){return ajaxAddItemToTryAtHome(this),!1}),$("#ShopCartDisplay").on("click",".ajaxAddItemToTryAtHome",function(){return ajaxAddItemToTryAtHome(this),!1}),$(".close-add-to-tah-modal").click(function(){return $("#AddToTryAtHomeModal").dialog("close"),!1}),$("#addToCartContainer").on("click",".add-to-cart-name.add-to-cart-contacts-only, .add-to-cart-close",function(){return $("#AddToCartModal").dialog("close"),!1}),$(".addRxLenses").click(function(){var t="yes"==$(this).val();$(".lens-options").toggle(t),$(".lens-color").toggle(t),$(".add-ons").toggle(t),$(".prescription").toggle(t),$(".send-prescription").toggle(t),$("#nonePrescription").prop("checked",!t),$(".rx-lens-choice, .catentry-radio, .addOns").prop("checked",!1),$("#rxLensForm select").val("")}),$(".rxInput").click(function(){rxInputToggle()}),$(".show-prism, .hide-prism").click(function(){return $(".show-prism").toggle(),$(".hide-prism").toggle(),$(".all-prism").toggle(),$("#rxRightPrism, #rxLeftPrism").prop("checked",!1),!1}),$("#rxRightPrism").click(function(){rxRightPrismToggle()}),$("#rxLeftPrism").click(function(){rxLeftPrismToggle()}),$("#rxPupilDistanceBoth").click(function(){pdToggle()}),antiReflectiveSelect(!0),$(".addOns").click(function(){addOnsClick($(this))}),$(".lens-color").on("click",".catentry-radio",function(){var t=$(this).parents(".lens-holder").find("label").clone().children().remove().end().text();$(".lens-row").find(".color").html(t),$("#lensColor").val(t)}),$("#rxLensForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",ignore:":disabled, :hidden",rules:{addRxLenses:{required:!0},rx:{required:!0},lens:{required:!0},productId:{required:!0},lensCatentryId:{required:!0},rxFirstName:{required:!0},rxLastName:{required:!0},rxDoctorName:{required:!0},rxDoctorNumber:{required:!0,number:!0},rxPupilDistance:{required:!0},rxRightPupilDistance:{required:!0},rxLeftPupilDistance:{required:!0},lensColor:{required:!0}},errorPlacement:function(t,e){"rx"==$(e).attr("name")?$(t).insertAfter(e.siblings("label")):"lens"==$(e).attr("name")?$(t).insertAfter($(".lens-color-default")):"productId"==$(e).attr("name")?$("[name^=productId]:visible").each(function(){var e=$(this);$error=$(t).clone(),$price=e.siblings(".price"),$error.insertAfter($price)}):"addRxLenses"==$(e).attr("name")?$(t).insertBefore(".checkedPrescription"):"rxPupilDistance"==$(e).attr("name")?$(t).insertAfter($(".pd-container")):$(t).insertAfter(e),$(t).attr("aria-live","rude")}}),$("#lensOptionsPageNext").click(function(){return document.URL.indexOf("fromPage=ShopCart")>0&&($("#addRxLenses1:checked").length>0&&$.cookie("checkoutMessage","Prescription has been removed for your lens",{path:"/"}),$("#addRxLenses2:checked").length>0&&$.cookie("checkoutMessage","Prescription has been added for your lens",{path:"/"})),$("#lensOptionsSubmitButton").click(),!1}),rxInputToggle(),pdToggle(),rxRightPrismToggle(),rxLeftPrismToggle();var t=$("#rxRightPrism, #rxLeftPrism").is(":checked");if($(".all-prism, .hide-prism").toggle(t),$(".show-prism").toggle(!t),$("#categoryId").change(function(){if(""!=$(this).val()){var t={storeId:constants.ajaxParams.storeId,catalogId:constants.ajaxParams.catalogId,langId:constants.ajaxParams.langId,categoryId:$(this).val()};$("#productId").empty().append($("<option></option>").text("select your lenses")).prop("disabled",!0),$.get("GetCatalogEntriesByCategoryID",t,function(t){$.each(t.catalogEntries,function(t,e){$("#productId").append($("<option></option>").attr("value",t).text(e))}),$("#productId").prop("disabled",!1),selectContactLensProductIfLoading()},"json")}else $("#productId").prop("disabled",!0)}),$("#productId").change(function(){if(""!=$(this).val()){var t={storeId:categoryDisplayJS.storeId,catalogId:categoryDisplayJS.catalogId,langId:categoryDisplayJS.langId,productId:$(this).val()};$.get("GetContactLensesByProductID",t,function(t){if(void 0!==t&&""!==t&&null!==t){var e=(t=$.parseJSON(t)).catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber;$(".contact-lens-product-image").attr("src",$("#akamaiContact").val()+e+"_fr.png?imwidth="),$(".contact-lens-name").html(t.catalogEntry.description[0].name),$(".contact-lens-price").html(t.catalogEntry.offerPrice),$(".contact-lens-short-description").html(t.catalogEntry.description[0].shortDescription);var a={PRD_POWER:"Power",PRF_BASECURVE:"Bc",PRF_DIAMETER:"Dia",PRD_AXIS:"Axis",PRD_CYLINDER:"Cyl",PRD_COLOR:"Color",PRD_ADDITION_TXT:"Add"};if(t.catalogEntry.catalogEntryIdentifier.buyable&&1-t.catalogEntry.catalogEntryIdentifier.deleted){$.each(["rxRight","rxLeft"],function(e,r){$.each(t.attributes,function(t,e){var i=r+a[t],n=$("#"+i);$("span#"+i+"-span").remove(),$("input#"+i+"-input").remove(),n.html("<option>"),e&&1==e.length?(n.parent().attr("disabled","disabled"),n.parent().find(".required-field").hide(),n.attr("disabled","disabled").hide().after('<span class="placeholder contact-lens" id="'+i+'-span">'+e[0]+"</span>").after('<input type="hidden" name="'+i+'" id="'+i+'-input" value="'+e[0]+'" />')):(n.parent().removeAttr("disabled"),$.each(e,function(t,e){n.append($("<option>",{value:e,text:e}))}),n.removeAttr("disabled").removeAttr("name").after('<input type="hidden" name="'+i+'" id="'+i+'-input" value="'+e[0]+'" />').change(function(){var t=$(this).attr("id")+"-input";$("#"+t).attr("value",$(this).val())}).show())})});var r=$("#rxRightCyl option").length>1||$("#rxRightAxis option").length>1;r=r&&0!=parseFloat($("#rxRightCyl option:nth-child(2)").val()),$(".astigmatism-only").toggle(r);var i=$("#rxRightColor option").length>1,n=i&&"Clear"==$("#rxRightColor option:nth-child(2)").val();n&&$("#rxRightColor, #rxLeftColor").val("Clear"),$(".color-only").toggle(i&&!n);var s=$("#rxRightAdd option").length>1;$(".add-only").toggle(s),verifyPrescriptionComplete()}calculateContactsTotal(),$(".contact-lens-rx-area").show(),triggerContactLensUtag(t)}})}else $(".contact-lens-product-area").hide()}),$("#contactLensesForm").validate({onfocusout:!1,onkeyup:!1,onclick:!1,errorClass:"required",errorElement:"span",errorPlacement:function(t,e){"rx"!=e[0].name.substring(0,2)&&"leftQuantity"!=e[0].name?t.attr("aria-live","rude").insertAfter(e):"rxFirstName"!=e[0].name&&"rxLastName"!=e[0].name||t.attr("aria-live","rude").insertAfter(e)},invalidHandler:function(t,e){for(var a in $(".contacts-error-incomplete").hide(),$(".contacts-error-box").hide(),$(".dob-error-box").hide(),e.errorMap)"rx"==a.substring(0,2)?($(".contacts-error-incomplete").show().attr("aria-live","rude"),$(".contact-lens-rx-area .asp-message").hide()):"leftQuantity"==a&&($(".contacts-error-box").show().attr("aria-live","rude"),$(".asp-message.required-msg").hide())},rules:{rxFirstName:{required:!0},rxLastName:{required:!0},rxRightPower:{required:function(){return $("#rightQuantity").val()>0}},rxRightCyl:{required:function(){return $("#rightQuantity").val()>0}},rxRightAxis:{required:function(){return $("#rightQuantity").val()>0}},rxRightBc:{required:function(){return $("#rightQuantity").val()>0}},rxRightDia:{required:function(){return $("#rightQuantity").val()>0}},rxRightColor:{required:function(){return $("#rightQuantity").val()>0}},rxRightAdd:{required:function(){return $("#rightQuantity").val()>0}},rightQuantity:{required:!0},rxLeftPower:{required:function(){return $("#leftQuantity").val()>0}},rxLeftCyl:{required:function(){return $("#leftQuantity").val()>0}},rxLeftAxis:{required:function(){return $("#leftQuantity").val()>0}},rxLeftBc:{required:function(){return $("#leftQuantity").val()>0}},rxLeftDia:{required:function(){return $("#leftQuantity").val()>0}},rxLeftColor:{required:function(){return $("#leftQuantity").val()>0}},rxLeftAdd:{required:function(){return $("#leftQuantity").val()>0}},leftQuantity:{required:!0,contactQuantity:{left:"#leftQuantity",right:"#rightQuantity"}},FIRST_NAME:{required:!0},LAST_NAME:{required:!0},BIRTH_MONTH:{required:!0,date:!0},BIRTH_DAY:{required:!0},BIRTH_YEAR:{required:!0},DOCTOR_CLINIC:{required:!0},DOCTOR_ADDRESS:{required:!0},DOCTOR_CITY:{required:!0},DOCTOR_STATE:{required:!0},DOCTOR_ZIP:{required:!0},DOCTOR_NUMBER:{required:!0}},messages:{BIRTH_MONTH:{required:"Is required"},BIRTH_DAY:{required:"Is required"},BIRTH_YEAR:{required:"Is required"}},submitHandler:function(t){$("form#contactLensesForm").find("select").each(function(){"1"===$(this).attr("data-remove-name")&&$(this).removeAttr("name")}),$(".contacts-error-incomplete").hide(),$(".contacts-error-box").hide(),$(".dob-error-box").hide(),categoryDisplayJS.AddItem2ShopCartAjax($("#productId").val(),null,$(t).serializeObject())}}),$("#ContactLensesRefillForm").submit(function(){return $(this).find(':input[name="rightQuantity"]').val()+$(this).find(':input[name="leftQuantity"]').val()==0?$(".contacts-refill-error-box").show():categoryDisplayJS.AddItem2ShopCartAjax($(this).find(':input[name="productId"]').val(),null,$(this).serializeObject()),!1}),$("#rightQuantity, #leftQuantity").change(function(){cookiePrescriptionAddValue($(this).attr("id"),$(this).val()),calculateContactsTotal(),utagFiller.updateContactsPDPProduct()}),$("#productId").length>0&&$.getUrlVar("mfname")&&$.getUrlVar("productId")){var e=$.getUrlVar("mfname").replace(/\+/g," ");performInitialLoad=!0,$("#categoryId").find('option[data-brandcategory="'+e+'"]').prop("selected",!0),$("#categoryId").change()}if($("ul.price .price:last").on("blur",function(){$("a.hovered").removeClass("hovered"),$("ul.price").addClass("hide").removeClass("hide")}),$(".item .round-button").focus("focus",function(){$(this).closest(".item").addClass("focused")}),$(".item .round-button").blur("focus",function(){$(this).closest(".item").removeClass("focused")}),"undefined"!=typeof currentTrialPack){for(var a=0,r=0,i=0;i<trialPacks.length;i++)if(trialPacks[i].catEntryId==currentTrialPack){a=i+1,(r=i-1)<0&&(r=trialPacks.length-1),a>=trialPacks.length&&(a=0);break}populateTrialPack(".last-pack",trialPacks[r]),populateTrialPack(".next-pack",trialPacks[a])}$(".rxInput").bind("change",function(){$('label[for="uploadPrescription"]').next().hasClass("required")&&($('label[for="uploadPrescription"]').next().remove(),$(".rxInput").unbind("change"))}),$(".contact-lens-rx-area #addToCartButton").on("click",function(t){currentOrderTAH&&(t.preventDefault(),$(".tah-error-message").text($("#tah-remove-tah-error").html()),$(".tah-error-message").show())}),$("#Search_Area_div").length>=1&&$("#Search_Area_div .results_grid .item_container").each(function(){manageListItem(discountedPricesManager,this),showBestDealBadge(this)})}),$(document).ready(function(){$("#__prjid5_insurance_toggle_CL .toggleInsurance_CL_btn").on("click",function(){null!=JSON.parse($.cookie("json_insurance"))?($("#__prjid5_insurance_toggle_CL div").toggleClass("active"),$("#__prjid5_insurance_toggle div").hasClass("active")&&sendDLOnInsuranceToggleClick(),calculateContactsTotal()):openSticky()})}),$(document).ready(function(){$("#rightQuantity").on("change",function(){verifyPrescriptionComplete()}),$("#leftQuantity").on("change",function(){verifyPrescriptionComplete()}),$("#rightQuantity").on("click",function(){$("#rightQuantity").removeClass("black"),$("#leftQuantity").removeClass("black")}),$("#leftQuantity").on("click",function(){$("#rightQuantity").removeClass("black"),$("#leftQuantity").removeClass("black")}),$(".contact-lens-rx-area select").on("change",function(){cookiePrescriptionAddValue($(this).attr("id"),$(this).val()),verifyPrescriptionComplete()})}),$(window).load(function(){JSON.parse(null!=$.cookie("json_insurance"))&&$("#__prjid5_insurance_toggle_CL .toggleInsurance_CL_btn").click()}),$(document).ready(function(){window.preventDefault=function(t){t.preventDefault()}}),$(document).ready(function(){$("#facet-type").hide();try{-1!=document.querySelector("#selectNoPrescription").querySelector(".to-container-medium").innerText.indexOf("???NON_PRESCRIPTION_VALUE_TEXT???")&&(document.querySelector("#selectNoPrescription").querySelector(".to-container-medium").innerText="This frame will arrive with non-prescription lenses.")}catch(t){}try{-1!=document.querySelector(".add-new-payment-method").querySelector(".add_new_payment_method_label").innerText.indexOf("???ADD_NEW_PAYMENT_METHOD???")&&(document.querySelector(".add-new-payment-method").querySelector(".add_new_payment_method_label").innerText="add new payment method")}catch(t){}$("#contactLensesForm").length>0&&getProductInformation($("#contactLensesForm input#productId")[0].defaultValue),$(".to-table-row.list-lenses").length>0&&$(".to-table-row.list-lenses").each(function(){0==$(this).find(".to-table-row").length&&$(this).css("display","none")}),$("#title-plp-shop").length>0&&$("#title-plp-shop").text($("#title-plp-shop").text().replace("sunglasses sunglasses","sunglasses"))});
//# sourceMappingURL=CategoryDisplay.js.map