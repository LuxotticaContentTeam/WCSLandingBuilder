"use strict";var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AddressBook=function(){function e(t){_classCallCheck(this,e),this.user=t,this.DELETE_BTN_CLASS="open-deleteaddress",this.SET_DEFHOME_BTN_CLASS="open-def-home",this.SET_DEFDELIVERY_BTN_CLASS="open-def-delivery",this.CONTAINER_CLASS="opsm-bordered-fluid-div",this.FRONTSIDE_CLASS="opsm-front-side",this.BACKSIDE_CLASS="opsm-back-side",this.getAB();var i=this;$("."+i.CONTAINER_CLASS).find("."+i.BACKSIDE_CLASS).hide(),$("."+i.DELETE_BTN_CLASS).on("click",function(){var e=$(this);i.deleteAdressBook(e)}),$("."+i.SET_DEFDELIVERY_BTN_CLASS).on("click",function(){var e=$(this);i.setDefaultDelivery(e)}),$("."+i.SET_DEFHOME_BTN_CLASS).on("click",function(){var e=$(this);i.setDefaultHome(e)})}return _createClass(e,[{key:"getAB",value:function(){}},{key:"setSaveAdressBook",value:function(){}},{key:"setDefaultHome",value:function(e){var t=$(e).parents("."+this.CONTAINER_CLASS).attr("id");$(e).hasClass("disabled")?($(".opsm-def-home").addClass("disabled"),$(e).removeClass("disabled"),$("#"+t).addClass("opsm-bordered-active")):($(y).addClass("disabled"),$("#"+t).parents("."+this.SET_DEFDELIVERY_BTN_CLASS).hasClass("disabled")&&$("#"+t).removeClass("opsm-bordered-active"))}},{key:"setDefaultDelivery",value:function(e){var t=$(e).parents("."+this.CONTAINER_CLASS).attr("id");$(e).hasClass("disabled")?($(".opsm-def-delivery").addClass("disabled"),$(e).removeClass("disabled"),$("#"+t).addClass("opsm-bordered-active")):($(y).addClass("disabled"),$("#"+t).parents("."+this.SET_DEFHOME_BTN_CLASS).hasClass("disabled")&&$("#"+t).removeClass("opsm-bordered-active"))}},{key:"deleteAdressBook",value:function(e){var t=this,i=$(e).parents("."+t.CONTAINER_CLASS).attr("id");$("#"+i).find("."+t.FRONTSIDE_CLASS).hide(),$("#"+i).find("."+t.BACKSIDE_CLASS).fadeIn(),$("#"+i).on("click",".cancel-remove-address",function(){$("#"+i).find("."+t.BACKSIDE_CLASS).hide(),$("#"+i).find("."+t.FRONTSIDE_CLASS).fadeIn()}),$("#"+i).on("click",".confirm-remove-address",function(){$("#"+i).parent(".single-card").remove()})}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AjaxSimpleRequest=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"ajaxLoginNotMergingCart",value:function(t){var i=t||{};return $.extend(i,{mergeCart:"false"}),e.ajaxLogin(i)}},{key:"ajaxLoginMergingCart",value:function(t){var i=t||{};return $.extend(i,{mergeCart:"true"}),e.ajaxLogin(i)}},{key:"ajaxLogin",value:function(e){var t=e||{},i={storeId:$("#storeId").val(),catalogId:$("#catalogId").val(),langId:$("#langId").val()};return $.extend(i,t,{reLogonURL:"/",errorViewName:"/",postSignInURL:"/",URL:"/"}),$.ajax({type:"POST",url:"/AjaxLogon",data:i,async:!0,dataType:"json"})}}]),e}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AutoCompleteGoogleMapsPlace=function(){function e(t,i,n,s,a,r,o){if(_classCallCheck(this,e),this.$inputEl=t,this.flagInputSelectedOnChoose=!1,void 0===this.$inputEl||null==this.$inputEl||!t.is("input"))return console.log("Gmap: element is not an input type"),void $(document).trigger("gmapApi:detached"+this.componentFormSfx);this.autocomplete=null,this.inputEl=t[0],window.gm_authFailure=window.gm_authFailure||this.unloadOnAuthHandler;this.componentForm=i||{subpremise:"short_name",street_number:"short_name",route:"long_name",locality:"long_name",colloquial_area:"long_name",administrative_area_level_1:"short_name",country:"short_name",postal_code:"short_name"},this.types=s||["address"],this.componentRestrictions=a||{country:[]},this.placeChangedCallback=r,this.apiErrorCallback=o,this.googleMapsApiKey=opsm.core.getGoogleMapsApiKey(),this.componentFormSfx=n||"",this.initHandleErrors(),$(document).on("gmapApi:detach"+this.componentFormSfx,{_this:this},this.unloadOnEvent),this.loadApiVar=null,this.loadGoogleApis()}return _createClass(e,[{key:"setCompRestrictions",value:function(e){null===this.autocomplete||void 0===this.autocomplete?this.componentRestrictions=e:this.autocomplete.setComponentRestrictions(e)}},{key:"loadGoogleApis",value:function(e){null==e&&(e=0);var t=this;window.gapisloading&&e<200?(t.loadApiVar&&clearTimeout(t.loadApiVar),t.loadApiVar=setTimeout(function(){t.loadGoogleApis(++e)},50)):"undefined"!=typeof google&&null!==google&&void 0!==google.maps&&null!==google.maps&&void 0!==google.maps.places&&null!==google.maps.places?t.$inputEl.one("focus",{_this:t},t.initOnInputEvent):"undefined"==this.googleMapsApiKey||"undefined"!=typeof google&&null!==google||(window.gapisloading=!0,$.getScript("https://maps.googleapis.com/maps/api/js?key="+this.googleMapsApiKey+"&libraries=places&sensor=false&language=en&region="+opsm.core.getCountryCode()).done(function(e,i){window.gapisloading=!1,t.$inputEl.one("focus",{_this:t},t.initOnInputEvent)}).fail(function(e,t,i){window.gapisloading=!1,console.log("Unable to load G-map api"),$(document).trigger("gmapApi:detached")}))}},{key:"initOnInputEvent",value:function(e){e.data._this.initAutocomplete(),e.data._this.initRemoveGStyles()}},{key:"onInputChange",value:function(e){var t=e.data._this.componentFormSfx;for(var i in e.data._this.flagInputSelectedOnChoose&&$(this).data("selected","false"),e.data._this.componentForm)$("."+i+t)[0]!==$(this)[0]&&(opsm.utils.setContent($("."+i+t),""),$("."+i+t).prop("disabled",!1));$(this).trigger("gmapApi:placeEdited")}},{key:"doFlagInputSelectedOnChoose",value:function(e){(void 0===e?"undefined":_typeof(e))===_typeof(!0)&&null!==e&&(this.flagInputSelectedOnChoose=e)}},{key:"functionCall",value:function(e){"function"==typeof e&&e.call()}},{key:"unloadOnAuthHandler",value:function(e){$(document).trigger("gmapApi:detached")}},{key:"unloadOnEvent",value:function(e,t){console.log("Unloading Gmap handlers on event"),"undefined"!=typeof google&&void 0!==google.maps&&void 0!==google.maps.event&&(e.data._this.restoreOriginalListener(e.data._this.inputEl),google.maps.event.clearInstanceListeners(e.data._this.inputEl),t&&$(document).trigger("gmapApi:detached"))}},{key:"unloadOnEventGlobally",value:function(e){e.data._this.unloadOnEvent(e,!0)}},{key:"initRemoveGStyles",value:function(){$("<style>.pac-logo:after {display: none !important;}</style>").appendTo($("head"))}},{key:"initHandleErrors",value:function(){var e=this;$(document).on("gmapApi:detached gmapApi:detach"+e.componentFormSfx,function(t){e.clear(),e.functionCall(e.apiErrorCallback)}),$(document).on("DOMNodeInserted",function(t){$(".pac-container .dismissButton").length&&$(".dismissButton").one("click",{_this:e},e.unloadOnEventGlobally)})}},{key:"clear",value:function(){this.$inputEl.off("change",this.onInputChange),this.$inputEl.off("focus",this.initOnInputEvent)}},{key:"initAutocomplete",value:function(){var e=this,t=e.componentFormSfx;null!==e.autocomplete&&void 0!==e.autocomplete||(this.selectFirstOnEnterOrFocusOut(this.inputEl),this.$inputEl.on("change",{_this:e},e.onInputChange),e.autocomplete=new google.maps.places.Autocomplete(this.inputEl),e.autocomplete.setTypes(this.types),e.autocomplete.setComponentRestrictions(this.componentRestrictions),e.autocomplete.setFields(["address_component"]),e.autocomplete.addListener("place_changed",function(){var i=e.autocomplete.getPlace(),n="";try{n=e.autocomplete.gm_accessors_.place.ue.formattedPrediction}catch(e){console.log("initAutocomplete: selectedPrediction fetching error")}if(void 0!==i.address_components){for(var s in e.componentForm)opsm.utils.setContent($("."+s+t),""),$("."+s+t).prop("disabled",!1);"function"==typeof e.placeChangedCallback?e.placeChangedCallback(i,e.componentFormSfx,n):e.googlePlaceAutocompleteClick(i),e.flagInputSelectedOnChoose&&e.$inputEl.data("selected","true"),e.$inputEl.trigger("gmapApi:placeSelected")}}))}},{key:"googlePlaceAutocompleteClick",value:function(e){for(var t=this.componentForm,i=_this.componentFormSfx,n="",s=0;s<e.address_components.length;s++){var a=e.address_components[s].types[0];if(t[a]){var r=e.address_components[s][t[a]];"colloquial_area"===a&&(n=r),opsm.utils.setContent($("."+a+i),r)}}""===opsm.utils.getContent($(".locality"+i))&&opsm.utils.setContent($(".locality"+i),n)}},{key:"restoreOriginalListener",value:function(e){e.removeEventListener?this.wrappedKeydownListener&&e.removeEventListener("keydown",this.wrappedKeydownListener):e.detachEvent&&this.wrappedKeydownListener&&e.detachEvent("keydown",this.wrappedKeydownListener),e.addEventListener?this.originalAddEventListener&&(e.addEventListener=this.originalAddEventListener):e.attachEvent&&this.originalAddEventListener&&(e.attachEvent=this.originalAddEventListener)}},{key:"selectFirstOnEnterOrFocusOut",value:function(e){var t=this,i=e.addEventListener?e.addEventListener:e.attachEvent;function n(n,s){if("keydown"==n){var a=s;t.wrappedBlurListener=function(t){if(!($(".pac-item-selected").length>0)){var i=$.Event("keydown",{keyCode:40,which:40}),n=$.Event("keydown",{keyCode:13,which:13});a.apply(e,[i]),a.apply(e,[n])}},s=function(t){var i=$(".pac-item-selected").length>0;if(13==t.which&&!i){var n=$.Event("keydown",{keyCode:40,which:40});a.apply(e,[n])}a.apply(e,[t])},t.wrappedKeydownListener=s}i.apply(e,[n,s])}t.originalAddEventListener=i,e.addEventListener?e.addEventListener=n:e.attachEvent&&(e.attachEvent=n)}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AutoCompleteGoogleMaps=function(){function e(t){var i=this;_classCallCheck(this,e),this.elmInput=$("#field-booking");var n=!0;this.elmInput.length&&"undefined"==typeof google&&$.getScript("//maps.googleapis.com/maps/api/js?sensor=false&key="+opsm.core.getGoogleMapsApiKey()+"&language=en&region="+opsm.core.getCountryCode()+"&libraries=places").done(function(e,i){"function"==typeof t&&t.call()}),this.elmInput.on("click",function(){n&&(i.handleAutocomplete(),n=!1)})}return _createClass(e,[{key:"handleAutocomplete",value:function(){var e=document.getElementById("field-booking"),t=new google.maps.places.Autocomplete(e,{types:["geocode"],componentRestrictions:{country:"au"}});t.addListener("place_changed",function(){var e,i=t.getPlace();void 0!==i.address_components&&(e=i,console.log(e))})}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AutoCompleteSuburb=function(){function e(t,i,n,s,a,r,o){_classCallCheck(this,e);var l=this;if(this.suburbId=t,this.elmInput=$("#"+this.suburbId),this.stateId=i,this.postcodeId=n,this.containerId=s,this.placeChangedCallback=o,this.countryCode=r,this.googleMapsApiKey=a,0!==this.elmInput.length){$("#"+this.containerId).hide();var d=!0;this.elmInput.length&&"undefined"==typeof google&&$.getScript("//maps.googleapis.com/maps/api/js?sensor=false&key="+this.googleMapsApiKey+"&language=en&region="+this.countryCode+"&libraries=places"),this.elmInput.on("click",function(){d&&(l.handleAutocomplete(),d=!1)})}}return _createClass(e,[{key:"handleAutocomplete",value:function(){var e=this,t=document.getElementById(e.suburbId),i=new google.maps.places.Autocomplete(t,{types:["geocode"],componentRestrictions:{country:e.countryCode}});i.addListener("place_changed",function(){var t,n=i.getPlace();void 0!==n.address_components&&("function"==typeof e.placeChangedCallback?e.placeChangedCallback(n):(t=n,$("#"+e.stateId).val(t.address_components[2].short_name).trigger("input"),$("#"+e.postcodeId).val(t.address_components[4].long_name).trigger("input"),$("#"+e.containerId).show()))})}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var OPSMAutoCompleteSuburb=function(){function e(t,i,n,s,a,r,o){_classCallCheck(this,e);var l=this;this.suburbId=t,this.elmInput=$("#"+this.suburbId),0!==this.elmInput.length&&(this.stateId=i,this.postcodeId=n,this.containerId=s,this.urlToCall=a,this.countryCode=r,this.minTermLength=3,void 0!==o&&(this.minTermLength=o),$("#"+this.containerId).hide(),this._addressSuggestionList=new Array,this.elmInput.autocomplete({source:function(e,t){l.getAddressData(e,t)},select:function(e,t){return l.setSelectedValue(e,t)},focus:function(e,t){},open:function(){$(".ui-autocomplete:visible").css({top:"+=1",left:"+=20",width:"-=40"}),$(".ui-autocomplete").css({"max-height":"14.5em","overflow-y":"auto"})}}).on("input",function(e){"true"===l.elmInput.data("selected")&&(l.checkActualValue()||(l.elmInput.removeData("selected"),$("#"+l.stateId).val("").trigger("input"),$("#"+l.postcodeId).val("").trigger("input"),$("#"+l.containerId).hide()))}).data("uiAutocomplete")._renderItem=function(e,t){return l.renderAddressValue(e,t)})}return _createClass(e,[{key:"getAddressData",value:function(e,t){var i=this,n=e.term;if(!(n&&n.length<i.minTermLength)){var s=(i.urlToCall.indexOf("?")>=0?i.urlToCall:i.urlToCall+"?")+"&term="+n;$.ajax({type:"POST",url:s,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){!function(e){if(e&&e.length&&e.length>=1)for(var t=new RegExp(", city$"),i=0;i<e.length;i++){var n=e[i],s=n.value;s&&t.test(s)&&(s=s.substring(0,s.length-", city".length),n.value=s)}}(e),t(e)},error:function(e,i,n){t(i+" - "+n.message),$(".ui-autocomplete").hide()}})}}},{key:"setSelectedValue",value:function(e,t){var i=t.item.value.split(",");if(null!=i&&i.length>=3){var n=$.trim(i[0]),s=$.trim(i[1]),a=$.trim(i[2]);opsm.utils.setContent(this.elmInput,n).data("selected","true").valid(),this.elmInput.trigger("paste"),$("#"+this.stateId).val(s).trigger("input").valid(),$("#"+this.postcodeId).val(a).trigger("input").valid(),$("#"+this.containerId).show().closest("form")}return!1}},{key:"renderAddressValue",value:function(e,t){var i=e;if(null!=t&&null!=t.term){e.show();var n=t.value.indexOf(t.term),s=this.countryCode,a="";if(-1!=n){var r=t.value.split(",");if(a=(a="<a>"+t.value.substring(0,n)+"<b>"+t.term+"</b>")+t.value.substring(n+t.term.length)+"</a>","AU"==s){var o=a.split(",");a=o[0]+","+o[1]+","+o[2],t.value=r[0]+","+r[1]+","+r[2]}if("NZ"==s){o=a.split(",");a=o[0]+","+o[1]+","+o[2],t.value=r[0]+","+r[1]+","+r[2]}}this._addressSuggestionList.push(t.value),i=$("<li></li>").data("ui-autocomplete-item",t).append(a).appendTo(e)}return i}},{key:"checkActualValue",value:function(){var e=$("#"+this.suburbId).val();for(var t in this._addressSuggestionList)if(t.value===e)return!0;return!1}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var BaetStepTwo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"tabSlider",value:function(){this.tabSliderNavEle.data("slick")||(this.tabSliderNavEle.not(".slick-initialized").slick({arrows:!0,speed:300,slidesToShow:5,slidesToScroll:5,variableWidth:!0,infinite:!1,responsive:[{breakpoint:1140,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:992,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:576,settings:{slidesToShow:2,slidesToScroll:2}}]}),this.initAppointment()),this.applyClickOnSlider(),this.updateAvailable()}},{key:"collapseTime",value:function(){Utils.isTabletAndAbove()?(this.appointmentEle.find(".baet-step-2--card-title").attr("data-toggle",""),this.appointmentEle.find(".baet-step-2--card-sign").attr("data-toggle","")):(this.appointmentEle.find(".baet-step-2--card-title").attr("data-toggle","collapse"),this.appointmentEle.find(".baet-step-2--card-sign").attr("data-toggle","collapse"))}},{key:"initAppointment",value:function(){var e;e=$("div[data-item=baet-step-2--slider-nav-item-0]").data("sync"),$("div[data-item=baet-step-2--slider-nav-item-0]").addClass("slide-selected"),e&&this.loadAppointment(e)}},{key:"loadAppointment",value:function(e){var t=this,i=this;i.apmtContentEle.html(""),$.getJSON(e,function(e){e.length>0?(e.forEach(function(e,i){var n=Utils.showAppointment(e,i);n.animateCss("fadeIn"),t.apmtContentEle.append(n)}),t.activeHour(),t.activeNextBtn()):i.loadMessage()})}},{key:"updateAvailable",value:function(){var e=$(".baet-step-2--slider-nav-item"),t="",i=void 0;e.each(function(){t=$(this).data("sync");var e=$(this).find(".article-eye-test--day-status");t&&$.getJSON(t,function(t){i=0,t.length>0&&t.forEach(function(e){i+=e.items.length}),e.html("("+i+" available)")})})}},{key:"loadMessage",value:function(){var e=$('<p class="baet-step-2--message">There are no available appointments on this day</p>');$(".baet-step-2--next-btn").attr("disabled","disabled"),this.apmtContentEle.html(e),this.apmtContentEle.animateCss("fadeIn")}},{key:"activeNextBtn",value:function(){var e=this.apmtContentEle.find(".article-card--item"),t=void 0;e.on("click",function(e){(t=$(e.target).parents(".baet-step-2--card-item")).hasClass("baet-step-2--card-booked")||(t.hasClass("baet-step-2--card-selected")?(t.removeClass("baet-step-2--card-selected"),$(".baet-step-2--next-btn").attr("disabled","disabled")):($(".baet-step-2--card-item").removeClass("baet-step-2--card-selected"),t.addClass("baet-step-2--card-selected"),$(".baet-step-2--next-btn").removeAttr("disabled")))})}},{key:"activeHour",value:function(){var e=$(".baet-step-2--card-item"),t=!1;e.each(function(e){$(this).hasClass("baet-step-2--card-booked")&&(t=!0,$(".baet-step-2--card").find('a[data-toggle="collapse"]').attr("aria-expanded","false").addClass("collapsed"),$(".baet-step-2--card").find(".collapse").removeClass("show"),$(this).parents(".baet-step-2--card").find('a[data-toggle="collapse"]').attr("aria-expanded","true").removeClass("collapsed"),$(this).parents(".baet-step-2--card").find(".collapse").addClass("show"),$(".baet-step-2--card-item").eq(parseInt(e)+1).addClass("baet-step-2--card-selected"),$(".baet-step-2--next-btn").removeAttr("disabled"))}),!t&&e.length>0&&($(".baet-step-2--card-item").eq(0).addClass("baet-step-2--card-selected"),$(".baet-step-2--next-btn").removeAttr("disabled"))}},{key:"applyClickOnSlider",value:function(){var e=this;this.tabSliderNavEle.find(".slick-slide").on("click",function(t){var i="",n=$(t.currentTarget).find(".baet-step-2--slider-nav-item");n.hasClass("slide-selected")||($(".baet-step-2--slider-nav-item").removeClass("slide-selected"),n.addClass("slide-selected"),(i=n.data("sync"))&&(e.apmtContentEle.html(""),e.loadAppointment(i)))})}},{key:"mobileStep2Baet",value:function(){var e=Math.floor($(".booking-calendar section.selected").index()/7)+1;$(window).width()<992&&($(".booking-calendar .inner").slick({arrows:!0,speed:300,variableWidth:!0,slidesToScroll:1,infinite:!1,mobileFirst:!0,initialSlide:e,responsive:[{breakpoint:1242,settings:"unslick"},{breakpoint:576,settings:{variableWidth:!0,slidesToScroll:2}},{breakpoint:750,settings:{variableWidth:!0,slidesToScroll:3}}]}),$(".hourAppointment").addClass("collapse"),$(".calendar-ok p").addClass("collapsed"),$(".calendar-ok p:first-of-type").removeClass("collapsed"),$(".hourAppointment:first-of-type").collapse("toggle"),$(".calendar-ok p").click(function(){$(this).toggleClass("collapsed"),$(this).next(".hourAppointment").collapse("toggle"),$(this).next(".hourAppointment")||$(".hourAppointment").collapse("hide")}))}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CharCounter=function e(t,i,n){_classCallCheck(this,e);var s=this;this.inputSelector=t,this.callback=i,this.initialSize=n,this.$input=$(this.inputSelector),0!==this.$input.length&&this.callback&&"function"==typeof this.callback&&(this.initialSize||(this.initialSize=30),this.$input.on("input",function(e){var t=function(e,t,i){var n=e;opsm.utils.checkSpecialKeys(i)||t.value.length>n-1&&(t.value=t.value.substring(0,n));return n-t.value.length}(s.initialSize,this,e);s.callback(t)}))};_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Checkout=function(){function e(){_classCallCheck(this,e);if(this.isRxCheckout="undefined"!=typeof cartHasItemsRX&&(!0===cartHasItemsRX||"true"===cartHasItemsRX)||"true"===$("#isRxOrder").val(),this.form=$("#checkout-form"),this.form.length){var t,i={debug:opsm.utils.debugForm(),onfocusout:function(e){$(e).valid()},rules:{debug:opsm.utils.debugForm(),firstname:{required:!0,minlength:2},lastname:{required:!0,minlength:2},"e-mail":{required:!0,email:!0,remoteEmail2:!0},phone:{required:!0,digits:!0,pattern:$("#checkout-shipping-phone").attr("pattern")},"street-address_1":{required:!0,minlength:3},"addressSuggest-bet":{required:!0,minlength:3,suburb_state_postcode:!0},"label-address":{required:function(e){return!r()},minlength:3},logonPassword:{required:function(){return"true"==$("#isRecurringOrderItem").val()},pwdPolicyCompliant:!0},logonPasswordVerify:{equalTo:"#save-details-password"},"firstname-billing":{required:{depends:function(e){return!a()}},minlength:3},"lastname-billing":{required:{depends:function(e){return!a()}},minlength:2},"street-address_1-billing":{required:{depends:function(e){return!a()}},minlength:3},billingAddressSuggestDiv:{required:{depends:function(e){return!a()}},minlength:3,suburb_state_postcode:!0},"checkout-billing-country":{required:{depends:function(e){return!a()}}},"label-address-billing":{required:function(e){return!r()&&!a()},minlength:3}},messages:{firstname:{required:$("#checkout-shipping-first-name").data("errors").required},lastname:{required:$("#checkout-shipping-last-name").data("errors").required},"e-mail":{required:r()&&$("#checkout-shipping-e-mail").length>=1?$("#checkout-shipping-e-mail").data("errors").required:"",email:r()&&$("#checkout-shipping-e-mail").length>=1?$("#checkout-shipping-e-mail").data("errors").email:"",remoteEmail2:r()&&$("#checkout-shipping-e-mail").length>=1?$("#checkout-shipping-e-mail").data("errors").remoteEmail2:""},phone:{required:$("#checkout-shipping-phone").length>=1?$("#checkout-shipping-phone").data("errors").required:"",digits:"#checkout-shipping-phone".length>=1?$("#checkout-shipping-phone").data("errors").digits:"",pattern:"#checkout-shipping-phone".length>=1?$("#checkout-shipping-phone").data("errors").pattern:""},"street-address_1":{required:$("#checkout-shipping-street-address_1").data("errors").required},"addressSuggest-bet":{required:$("#addressSuggest-bet").data("errors").required},"label-address":{required:!r()&&$("#checkout-shipping-label-address").length>=1?$("#checkout-shipping-label-address").data("errors").required:""},"firstname-billing":{required:$("#checkout-billing-first-name").data("errors").required},"lastname-billing":{required:$("#checkout-billing-last-name").data("errors").required},"street-address_1-billing":{required:$("#checkout-billing-street-address_1").data("errors").required},billingAddressSuggest:{required:$("#billingAddressSuggest").data("errors").required},"label-address-billing":{required:!r()&&$("#checkout-billing-label-address").length>=1?$("#checkout-billing-label-address").data("errors").required:""}},errorPlacement:function(e,t){e.addClass("invalid-feedback"),e.appendTo(t.closest(".form-group"))},highlight:function(e,t,i){$(e).closest(".form-group").addClass(t).removeClass(i),$(e).is("#save-details-password")&&$("#pwd-policy-error").removeClass("d-none")},unhighlight:function(e,t,i){$(e).closest(".form-group").removeClass(t).addClass(i),$(e).is("#save-details-password")&&$("#pwd-policy-error").addClass("d-none")},submitHandler:function(e){return!1},focusInvalid:!1,invalidHandler:function(e,t){t.numberOfInvalids()&&$("html, body").animate({scrollTop:$(t.errorList[0].element).offset().top},1e3)}};if(this.isRxCheckout){var n={firstname:{required:!0,minlength:2,maxlength:34},lastname:{required:!0,minlength:2,maxlength:34},"street-address_1":{required:!0,minlength:3,maxlength:34},"firstname-billing":{required:{depends:function(e){return!a()}},minlength:3,maxlength:34},"lastname-billing":{required:{depends:function(e){return!a()}},minlength:2,maxlength:34},"street-address_1-billing":{required:{depends:function(e){return!a()}},minlength:3}};$.extend(i.rules,n)}i=this.form.validate(i),this.validator=i,this.checkoutSpecialDeliveryInstructionsCharCounter=new CharCounter("#special-instructions-text",(t=$("#special-instructions-text").parent().find(".char-counter"),function(e){t.html(e)}),$("#special-instructions-text").data("length")?parseInt($("#special-instructions-text").data("length")):30),this.enableSelectForValidation(),this.handleLazyValid();var s=new Date;s.getMonth(),s.getFullYear();$("#expiry-date-input").datepicker({format:"mm/yyyy",startView:2,minViewMode:1,autoclose:!0,startDate:"+1d",container:"div#expire-date-only-new"})}function a(){return $("#additional-address").is(":checked")}function r(){return"true"===isGuestUser}}return _createClass(e,[{key:"checkElementValid",value:function(e){var t=!0;return $("#"+e+":visible").length&&(t=this.validator.check("#"+e),$("div#"+e).length&&void 0===$("div#"+e).attr("contenteditable")&&($("div#"+e).attr("contenteditable",""),this.validator.checkForm(),t=this.validator.check("#"+e),$("div#"+e).removeAttr("contenteditable"))),t}},{key:"handleLazyValid",value:function(){var e=this;$(document).ready(function(){e.form.length&&($(e.form).one("focus","div#addressSuggest-bet:visible",function(t){e.validator.checkForm()}),$(e.form).one("focus","div#billingAddressSuggest:visible",function(t){e.validator.checkForm()}))})}},{key:"enableSelectForValidation",value:function(){this.form.find(".delivery-address-wrapper .hybrid-select select").css({display:"block",visibility:"hidden"})}}],[{key:"paymentToggleBody",value:function(e){$(e).siblings("input.custom-control-input").is(":checked")&&!$(e).parent().next(".card-body").is(":hidden")?$(e).parent().next(".card-body").hide():($("#payment-selection .card-wrapper .custom-radio .custom-control-input").prop("checked",!1),$("#payment-selection .card-wrapper .card-body").hide(),$(e).siblings(".custom-control-input").prop("checked",!0),$(e).closest(".custom-radio").addClass("js-selected"),$(e).parent().next(".card-body").show(),$(e).siblings("input.custom-control-input").trigger("change"),$(e).closest(".custom-radio").trigger("opsm:change"))}}]),e}();!function(e){e(function(){e('.opsm-slideshow--slide[data-slide-type="single"]').slick({slidesToShow:1,slidesToScroll:1,infinite:!0,dots:!0}),e('.opsm-slideshow--slide[data-slide-type="myArea"]').slick({dots:!1,infinite:!1,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:1400,settings:{slidesToShow:3}},{breakpoint:1100,settings:{slidesToShow:2}},{breakpoint:700,settings:{slidesToShow:1}}]}),e('.opsm-slideshow--slide[data-slide-type="grid"]').slick({dots:!0,infinite:!1,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:992,settings:{slidesToShow:2}},{breakpoint:576,settings:{slidesToShow:1}}]}),e("#sample-form").validate({ignore:[],rules:{"field-1a":"required","field-1b":"required","field-1c":"required","field-1d":"required","field-2a":"required","field-2b":"required","drop-1a":"required","drop-1b":"required","drop-1c":"required","drop-1d":"required","drop-1e":"required","drop-1f":"required","drop-2a":"required","drop-2b":"required",textarea:"required"},messages:{"field-1a":"Required field","field-1b":"Required field","field-1c":"Required field","field-1d":"Required field","field-2a":"Required field","field-2b":"Required field","drop-1a":"Required field","drop-1b":"Required field","drop-1c":"Required field","drop-1d":"Required field","drop-1e":"Required field","drop-1f":"Required field","drop-2a":"Required field","drop-2b":"Required field",textarea:"Required field"},errorPlacement:function(e,t){e.addClass("invalid-feedback"),e.appendTo(t.closest(".form-group"))},highlight:function(t,i,n){e(t).closest(".form-group").addClass(i).removeClass(n)},unhighlight:function(t,i,n){e(t).closest(".form-group").removeClass(i).addClass(n)},submitHandler:function(e){return alert("submitted!"),!1}})})}(jQuery);_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}window.opsmData=window.opsmData||{},window.opsmData.userData=window.opsmData.userData||{};var CreditCard=function(){function e(t){_classCallCheck(this,e);var i=this;this.savedCCsezlection=$("#credit-card-options"),this.paymType=$("#payment-selection"),this.user=t,this.DELETE_BTN_CLASS="open-deletecard",this.SET_DEFHOME_BTN_CLASS="opsm-def-card",this.CONTAINER_CLASS="opsm-bordered-fluid-div",this.FRONTSIDE_CLASS="opsm-front-side",this.BACKSIDE_CLASS="opsm-back-side",this.NEW_CARD_VALUE="0",this.NEW_CARD_TITLE="Add new card",this.initSavedCards(),this.paymType.on("change","input.js-payment-type",function(e){var t=$(this).data("cc-nr");i.savedCCsezlection.val(t).change(),i.setSavedCreditCard()}),$("."+i.CONTAINER_CLASS+".opsm-bordered-active").find("."+i.DELETE_BTN_CLASS).hide(),$("."+i.CONTAINER_CLASS).find("."+i.BACKSIDE_CLASS).hide(),$("."+i.CONTAINER_CLASS).on("click","."+i.DELETE_BTN_CLASS,function(){i.deleteAdressBook(this)}),$("."+i.CONTAINER_CLASS).on("click","."+i.SET_DEFHOME_BTN_CLASS,function(e){var t=$(this),n=window.opsmData.userData;if(n.creditCard&&n.creditCard.length>0){var s=t.parents("."+i.CONTAINER_CLASS).attr("id");n.creditCard.forEach(function(e){e.id===s&&e.valid&&i.setCardDefault(e.id)})}}),$("#payment-selection input.js-payment-type:checked").length||$("#payment-selection .card-wrapper").first().find(".custom-radio label.custom-control-label").trigger("click")}return _createClass(e,[{key:"getAllCC",value:function(e){if(e){var t=window.opsmData.userData;t.creditCard&&t.creditCard.length>0&&t.creditCard.forEach(function(t){e(creditcard)})}}},{key:"deleteAdressBook",value:function(e){var t=this,i=$(e).parents("."+t.CONTAINER_CLASS).attr("id");$("#"+i).find("."+t.FRONTSIDE_CLASS).hide(),$("#"+i).find("."+t.BACKSIDE_CLASS).fadeIn(),$("#"+i).on("click",".cancel-remove-address",function(){$("#"+i).find("."+t.BACKSIDE_CLASS).hide(),$("#"+i).find("."+t.FRONTSIDE_CLASS).fadeIn()}),$("#"+i).on("click",".confirm-remove-address",function(){$("#"+i).parent(".col-lg-4").remove()})}},{key:"setCardDefault",value:function(e){var t=e;$("."+this.SET_DEFHOME_BTN_CLASS).addClass("disabled"),$("#"+t).find("."+this.SET_DEFHOME_BTN_CLASS).removeClass("disabled"),$("."+this.CONTAINER_CLASS).removeClass("opsm-bordered-active"),$("#"+t).addClass("opsm-bordered-active"),$("."+this.CONTAINER_CLASS).find("."+this.DELETE_BTN_CLASS).show(),$("#"+t).find("."+this.DELETE_BTN_CLASS).hide()}},{key:"initSavedCards",value:function(){var e=window.opsmData.userData,t=$(".js-saved-card-wrapper.js-template");e.creditCard&&e.creditCard.length>0?e.creditCard.forEach(function(e,i){if(e.valid){var n=t.clone();$(n).removeClass("d-none").removeClass("js-template"),$(n).find(".js-card-type").text(e.type),$(n).find(".js-card-nr").text(e.ending),$(n).find("input.js-payment-type").attr("data-cc-nr",e.id).attr("id",e.id),$(n).find(".custom-control-label").attr("for",e.id);var s=$(n).find("img.payment-logo");s.attr("src",s.attr("js-src").replace("[CARDNAME]",e.cardLogo)),s.attr("alt",e.altImg),$(n).insertBefore(".js-new-card-wrapper"),$(".js-new-card-wrapper").addClass("d-none"),$("#logged-new-address-collapse").insertBefore(".js-new-card-wrapper")}}):$("#logged-new-address-collapse").remove(),t.remove()}},{key:"setSavedCreditCard",value:function(){var e=this.savedCCsezlection.val(),t=window.opsmData.userData;$("#card-name").val("").prop("readonly",!1),t.creditCard&&t.creditCard.length>0&&t.creditCard.forEach(function(t){t.id===e&&$("#card-name").val(t.name).prop("readonly",!0)})}},{key:"getExpiryDate",value:function(e){return e.expiryMonth+"/"+e.expiryYear}}]),e}();!function(e){var t="input.datetimepicker-input"+String('[placeholder="MM/YYYY"]');e(document).ready(function(){e(t).length&&e(document).on("keyup",t,i)});var i=function(t){var i=e(this).val().replace(/[^0-9.]/g,"");i.length>6&&(i=i.substring(0,6)),i.length>2?e(this).val(i.substring(0,2)+"/"+i.substring(2)):2===i.length&&8!==t.keyCode?e(this).val(i+"/"):e(this).val(i),e(this).change()}}(jQuery);_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}window.opsmData=window.opsmData||{},window.opsmData.userData=window.opsmData.userData||{};var DeliveryAddress=function(){function e(t,i,n,s,a,r){_classCallCheck(this,e);var o=this;this.selectAddress=$("#"+t),this.savedAddress=$("#"+i),this.newAddressFields=$(s),this.myaccount=$("#"+n).length,this.newAddressLabel=a,this.userDataProperty=r,this.newAddressValue="0",0!==this.selectAddress.length&&(this.getAllAddress(),this.setSavedAddress(),this.selectAddress.on("change",function(){o.evaluateAddress()}))}return _createClass(e,[{key:"getAllAddress",value:function(){var e=this,t=window.opsmData.userData;if(e.selectAddress.empty(),t[e.userDataProperty].length>0&&t[e.userDataProperty].forEach(function(t){e.selectAddress.append($("<option></option>").val(t.id).html(t.labelshort))}),0===e.myaccount){if(t[e.userDataProperty].length<1){var i=e.selectAddress.closest(".opsm-form-group");i.siblings(".js-not-emoty-addr").addClass("d-none"),i.addClass("d-none")}e.selectAddress.append($("<option></option>").val(e.newAddressValue).html(e.newAddressLabel))}e.selectAddress.hybridSelect(),e.setSavedAddress()}},{key:"setSavedAddress",value:function(){var e=this,t=e.selectAddress.val(),i=window.opsmData.userData;i[e.userDataProperty].length>0?i[e.userDataProperty].forEach(function(i){if(t==i.id){var n="<p><span id='ship-to-name' class='d-block'>"+i.name+"</span><span id='ship-to-address' class='d-none font-weight-bold'>"+i.streetAddress+"</span><span class='d-block font-weight-bold'>"+i.labelshort+"</span><span id='ship-to-city-state-zip' class='d-block'>"+i.labellong+"</span>";$(e.savedAddress).html(n)}}):e.evaluateAddress()}},{key:"evaluateAddress",value:function(){function e(e){e.removeClass("d-none")}function t(e){e.addClass("d-none")}this.selectAddress.val()==this.newAddressValue?(t(this.savedAddress),e(this.newAddressFields)):(t(this.newAddressFields),e(this.savedAddress),this.setSavedAddress())}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var EyeTestBooking=function(){function e(){var t=this;(_classCallCheck(this,e),this.form=$("#book-eye-test-booking-form"),this.form.length)&&(this.form.find("#dob").inputmask("99/99/9999",{placeholder:"DD/MM/YYYY"}),this.form.find("#create-account").on("change",function(){t.form.find("#password, #password-2").val("")}),this.form.validate({ignore:[],rules:{title:{required:!0},"first-name":{required:!0},"last-name":{required:!0},dob:{required:!0,DateFormat:!0},email:{required:!0,email:!0},mobile:{required:!0,MobilePhoneAU:!0},password:{required:"#create-account:checked"},"password-2":{required:"#create-account:checked",equalTo:"#password"}},messages:{title:{required:"Required field"},"first-name":{required:"Required field"},"last-name":{required:"Required field"},dob:{required:"Required field"},email:{required:"Required field",email:"Email is not valid"},mobile:{required:"Required field",digits:"Invalid phone number"},password:{required:"Required field"},"password-2":{required:"Required field",equalTo:"Confirm password does not match"}},errorPlacement:function(e,t){e.addClass("invalid-feedback"),e.appendTo(t.closest(".form-group"))},highlight:function(e,t,i){$(e).closest(".form-group").addClass(t).removeClass(i)},unhighlight:function(e,t,i){$(e).closest(".form-group").removeClass(t).addClass(i)}}))}return _createClass(e,null,[{key:"getAptBook",value:function(e,t,i,n){e=e||"/AjaxGetBookAnEyeTestDataQuery",t=t||{};return $.ajax({dataType:"json",url:e,data:t,success:function(e,t,n){"function"==typeof i&&i(e)},error:function(e,t,i){"function"==typeof n&&n(e,t,i)}})}}]),e}(),_slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var REMOVE="REMOVE",REMOVE_HIDE="REMOVE_HIDE",WIDTH_CHIPS_TOTAL=50,CLASS_LINE_HORIZONTAL="line-horizontal",facetValues={OPTICAL:"Frames",SUN:"Sunglasses",FS:"Sphere",F:"Multi Focal",FT:"Toric",UNISEX:"Unisex",MALE:"Men",FEMALE:"Women",CHILD:"Kids",DEMO_LENS:"Demo"},Filter=function(){function e(){var t=this;_classCallCheck(this,e),$(window).scroll(function(){if(Utils.isSmallDesktopAndAbove()&&$("html").is(".csspositionsticky")){var e=$(window).scrollTop(),i=$(".products-listing").position().top,n=$(".header").height(),s=$("#opsm-header-sticky").is(".temp-hidden");e>=i-n&&!s?t.filters.css("top",n):t.filters.css("top","")}}),this.init(),this.filters.on("click",".filters--result-item .filters--result-item-remove",function(e){var i=$(e.target).closest(".filters--result-item"),n=i.data("filter"),s=i.data("value");"price"!==n?(t.filters.find('input[data-filter="'+n+"\"][value='"+s+"']").prop("checked",!1).trigger("change"),t.removeFilter(n,s),t.renderSeletedFilters({event:REMOVE}),t.toggleButtonReset()):(t.loadPriceFacet(t.priceRange.min,t.priceRange.max),t.executeFilter())}),this.filters.on("change","input[data-filter]",function(e,i){var n=!1,s=$(e.target),a=s.val(),r=s.data("filter"),o=s.siblings("label.custom-control-label").text();s.is(":checked")?(t.addFilter(r,a,o),s.hasClass("existing-on-load")||s.addClass("pending-sel"),t.changeSiblingOptionsVisib(s,"hide")):(n=!0,t.removeFilter(r,a),t.changeSiblingOptionsVisib(s,"show")),n?t.renderSeletedFilters({event:REMOVE_HIDE}):t.renderSeletedFilters({}),t.toggleButtonReset()}),this.filters.on("click",".filters--btn-reset",function(e){var i=$(e.target).closest(".filters--box");i.is(".filters--box--top")?(i.parent().find("input[data-filter].pending-sel").prop("checked",!1).trigger("change"),t.loadPriceFacet(t.priceRange.min,t.priceRange.max),i.parent().find("input[data-filter]:checked").not(".pending-sel").length&&(i.parent().find("input[data-filter]:checked").not("pending-sel").prop("checked",!1).trigger("change",["Reset"]),t.executeChange())):i.find(".filters--slider-range").length?(t.loadPriceFacet(t.priceRange.min,t.priceRange.max),t.executeChange()):(i.find("input[data-filter].pending-sel").prop("checked",!1).trigger("change"),i.find("input[data-filter]:checked").not(".pending-sel").length&&(i.find("input[data-filter]:checked").not("pending-sel").prop("checked",!1).trigger("change",["Reset"]),t.executeChange()))}),this.filters.on("click mouseenter touchstart",".filters--result-item-total",function(){t.styleInlineFilter(t.selectedFiltersContainer),t.scopeHoverFilter=!0,t.renderTemplateSeleted()}),this.filters.on("mouseleave",".filters--selected-filters",function(){t.closeResultMoreItem()}),this.filters.on("touchend",".card.filters--box:not(:first), .filters--header",function(){t.closeResultMoreItem()}),this.filters.on("touchend",".filters--content.accordion",function(e){e.target===t.filtersContent[0]&&t.closeResultMoreItem()}),this.filters.on("change",".filters--custom-checkbox input",function(e,i){t.executeChange(e,i),t.lastFacetId=$(e.target).attr("id")})}return _createClass(e,[{key:"init",value:function(){var e=this;this.btnOpenFilters=$("#product-filter-toggle"),this.filters=$("#filters"),this.filtersOverlay=this.filters.find(".filters--overlay"),this.filtersInner=this.filters.find(".filters--inner"),this.btnCloseFilters=this.filters.find(".filters--back-btn, .filters--close-btn"),this.btnApplyFilters=this.filters.find("#btn-apply-filters"),this.spanNoFilter=this.filters.find(".filters--no-result-item"),this.selectedFiltersContainer=this.filters.find(".filters--selected-filters"),this.filtersContent=this.filters.find(".filters--content"),this.selectedFiltersNumberText=$("#filter-filtering-items"),this.scopeHoverFilter=!1,this.selectedFilter=[],this.hideElementFilter={},this.showElementFilter={};var t=$("#filter-box-price .filter-price-min").val();t=t?parseInt(t):20;var i=$("#filter-box-price .filter-price-max").val();i=i?parseInt(i):990,this.priceRange={min:t,max:i},""!==this.lastFacetId&&$("#"+this.lastFacetId).closest(".card.filters--box").find(".filters--btn-toggle").click(),this.lastFacetId="",Modernizr.csspositionsticky||this.filters.affix({offset:{top:function(){return $(".prod-pg-header").length>0?this.top=$(".header").outerHeight()+$(".prod-pg-header").outerHeight():$(".search--result-head").length>0&&$(".search--result-subhead").length>0?this.top=$(".header").outerHeight()+$(".search--result-head").outerHeight()+$(".search--result-subhead").outerHeight():void 0},bottom:function(){return this.bottom=$(".footer").outerHeight()}}}).on("affixed.bs.affix",function(){var t=$(".filters--ie-wrapper");e.filters.css({width:t.width(),left:t.offset().left+15})}).on("affixed-top.bs.affix, affixed-bottom.bs.affix",function(){$(".filters--ie-wrapper");e.filters.css({width:"",left:""})}).parent().addClass("filters--ie-wrapper"),this.priceRangeSlider=this.filters.find(".filters--slider-range"),this.priceRangeSliderHandler=[this.priceRangeSlider.find(".filters--slider-handle--01 .filters--slider-handle-text"),this.priceRangeSlider.find(".filters--slider-handle--02 .filters--slider-handle-text")],this.priceRangeSlider.length&&this.priceRangeSlider.slider({range:!0,min:this.priceRange.min,max:this.priceRange.max,step:10,values:[this.priceRange.min,this.priceRange.max],create:function(){e.priceRangeSliderHandler[0].text("$"+e.priceRangeSlider.slider("values")[0]),e.priceRangeSliderHandler[1].text("$"+e.priceRangeSlider.slider("values")[1])},slide:function(t,i){var n=i.values[0],s=i.values[1];e.priceRangeSliderHandler[0].text("$"+n),e.priceRangeSliderHandler[1].text("$"+s);var a=n+","+s,r="$"+n+"-$"+s;n===s&&n===e.priceRange.min||n===s&&n===e.priceRange.max||n===e.priceRange.min&&s===e.priceRange.max?e.removeFilter("price"):e.addPriceFilter(a,r),e.renderSeletedFilters({}),e.toggleButtonReset()},stop:function(t,i){e.executeChange()}}),this.btnOpenFilters.on("click",function(){e.openFiltersSidebar()}),this.btnCloseFilters.on("click",function(){e.closeFiltersSidebar()}),this.btnApplyFilters.on("click",function(){e.closeFiltersSidebar(),e.executeFilter()}),this.filtersOverlay.on("click",function(){e.closeFiltersSidebar()}),this.renderSeletedFilters({callApply:!1}),this.toggleButtonReset()}},{key:"changeSiblingOptionsVisib",value:function(e,t){void 0!==e&&void 0!==t&&e.length&&("hide"==t?e.closest(".filters--custom-checkbox").not(".multivalue").siblings().hide():"show"==t&&e.closest(".filters--custom-checkbox").siblings().show())}},{key:"closeResultMoreItem",value:function(){this.scopeHoverFilter&&(this.applyFilters({}),this.scopeHoverFilter=!1)}},{key:"openFiltersSidebar",value:function(){this.filters.addClass("show"),this.filtersInner.animateCss("slideInLeft");var e={overflow:"hidden",position:"fixed"};$("body").css(e),$("html").css(e)}},{key:"closeFiltersSidebar",value:function(){var e=this;this.filtersInner.animateCss("slideOutLeft",function(){e.filters.removeClass("show"),e.filters.find(".collapse").collapse("hide")}),this.closeResultMoreItem(),$("body").removeAttr("style"),$("html").removeAttr("style")}},{key:"addFilter",value:function(e,t,i){this.selectedFilter.push({filter:e,value:t,text:i})}},{key:"addPriceFilter",value:function(e,t){var i=this.selectedFilter.filter(function(e){return"price"===e.filter});i.length?(i[0].value=e,i[0].text=t):this.addFilter("price",e,t)}},{key:"findFilter",value:function(e,t){return this.selectedFilter.filter(function(i){return i.filter===e&&(void 0!==t&&i.value===t||void 0===t)})}},{key:"removeFilter",value:function(e,t){var i=this.findFilter(e,t);i.length&&(this.selectedFilter=this.selectedFilter.filter(function(e){return i.indexOf(e)<0}))}},{key:"renderSeletedFilters",value:function(e){var t=e.event,i=void 0===t?"":t,n=e.callApply,s=void 0===n||n;this.renderTemplateSeleted(),!0===s&&this.applyFilters(i)}},{key:"renderTemplateSeleted",value:function(){var e="";this.selectedFiltersContainer.empty(),this.selectedFiltersNumberText.text("(0)"),this.selectedFilter.length?(this.spanNoFilter.addClass("d-none"),this.selectedFilter.forEach(function(t){var i=t.text,n=t.filter,s=t.value;e+='\n                    <div class="badge badge-pill filters--result-item" data-filter="'+n+"\" data-value='"+s+"'>\n                        <span>"+i+'</span>\n                        <a class="filters--result-item-remove pointer" tabindex="0"><span class="icon-close"></span></a>\n                    </div>\n                '}),this.selectedFiltersContainer.html(e),this.selectedFiltersNumberText.text("("+this.selectedFilter.length+")")):this.spanNoFilter.removeClass("d-none")}},{key:"applyFilters",value:function(e){var t=this,i=this.selectedFiltersContainer,n=this.shortFilterResult,s=this.scopeHoverFilter,a=this.visibleFilterResult,r=this.styleInlineFilter,o=0,l=!1,d=0,c=i.width(),u=i.children(),p=e===REMOVE;(p||e===REMOVE_HIDE)&&(this.hideElementFilter={},this.showElementFilter={}),u.each(function(e,n){var s=n.offsetWidth;(o+=s)+WIDTH_CHIPS_TOTAL>=c?(d+=1,l=!0,t.hideElementFilter[e]=n):(r(i),t.showElementFilter[e]=n)});s&&p?a(i,this):l&&n(d,this)}},{key:"shortFilterResult",value:function(e,t){var i=t.selectedFiltersContainer,n=t.showElementFilter;i.empty();var s='\n         <div class="badge badge-pill filters--result-item filters--result-item-total">\n            <span>+'+e+"</span>\n         </div>\n      ",a=!0,r=!1,o=void 0;try{for(var l,d=Object.entries(n)[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var c=l.value,u=_slicedToArray(c,2)[1];i.append(u)}}catch(e){r=!0,o=e}finally{try{!a&&d.return&&d.return()}finally{if(r)throw o}}i.append(s)}},{key:"visibleFilterResult",value:function(e,t){(0,t.styleInlineFilter)(e)}},{key:"styleInlineFilter",value:function(e){e.hasClass(CLASS_LINE_HORIZONTAL)&&e.removeClass(CLASS_LINE_HORIZONTAL)}},{key:"toggleButtonReset",value:function(){var e=this;this.filters.find(".filters--box:not(.filters--box--top)").each(function(t,i){var n=$(i).find(".filters--btn-reset");if($(i).find(".filters--slider-range").length){var s=e.priceRangeSlider.slider("values");s&&(s[0]===e.priceRange.min&&s[1]===e.priceRange.min||s[0]===e.priceRange.max&&s[1]===e.priceRange.max||s[0]===e.priceRange.min&&s[1]===e.priceRange.max)?n.addClass("d-none"):n.removeClass("d-none")}else{$(i).find("input[data-filter]:checked").length?n.removeClass("d-none"):n.addClass("d-none")}})}},{key:"loadPriceFacet",value:function(e,t){var i=this.priceRangeSlider.slider("values");if(0!==i.length&&(i[0]!==e||i[1]!==t)){var n=e+","+t,s="$"+e+"-$"+t;this.priceRangeSlider.slider("values",[""+e,""+t]),this.priceRangeSliderHandler[0].text("$"+e),this.priceRangeSliderHandler[1].text("$"+t),this.addPriceFilter(n,s),this.toggleButtonReset();var a={callApply:!1};(e===t&&e===this.priceRange.min||e===t&&e===this.priceRange.max||e===this.priceRange.min&&t===this.priceRange.max)&&(a.event=REMOVE),this.renderSeletedFilters(a)}}},{key:"executeFilter",value:function(){for(var e=[],t=[],i=0;i<this.selectedFilter.length;i++){var n=this.selectedFilter[i];if("price"===n.filter){var s=n.value.split(","),a=$("#price-facet-currency").val();null!=a&&e.push("facet="+encodeURIComponent("price_"+a+":({"+s[0]+" "+s[1]+'} "'+s[1]+'")'))}else e.push("facet="+encodeURIComponent(n.value))}if(t=e,null!=opsm&&void 0!==opsm.catalog&&null!==opsm.catalog&&void 0!==opsm.catalog.loadpanels&&null!==opsm.catalog.loadpanels){if($("#pageSizecookie").val("pageSize=18"),opsm.catalog.loadpanels($("#basePageURL").val(),t.join(","),!0,"GET",!1,void 0,function(){opsm.filters.init()}),null!=t){t=t.join(",").replace(/,/g,"&");var r=window.location.href.split("?")[0]+"?"+t;history.pushState("facet",document.title,r)}$("#pagesizeorderBy").val(),$("#pageSizecookie").val()}}},{key:"executeChange",value:function(e,t){if(!(void 0!==t&&"Init"===t||void 0!==t&&"Reset"===t)){if($("#btn-apply-filters").is(":visible")&&void 0!==e){if($(e.target).is(":checked"))return;if(!$(e.target).hasClass("existing-on-load")&&$(e.target).hasClass("pending-sel"))return void $(e.target).removeClass("pending-sel")}this.executeFilter()}}}],[{key:"facetValueLabel",value:function(e){switch(e.toUpperCase().replace(/\s+/g,"_")){case Utils.string_of_enum(facetValues,facetValues.OPTICAL):return facetValues.OPTICAL;case Utils.string_of_enum(facetValues,facetValues.SUN):return facetValues.SUN;case Utils.string_of_enum(facetValues,facetValues.FS):return facetValues.FS;case Utils.string_of_enum(facetValues,facetValues.F):return facetValues.F;case Utils.string_of_enum(facetValues,facetValues.FT):return facetValues.FT;case Utils.string_of_enum(facetValues,facetValues.UNISEX):return facetValues.UNISEX;case Utils.string_of_enum(facetValues,facetValues.MALE):return facetValues.MALE;case Utils.string_of_enum(facetValues,facetValues.FEMALE):return facetValues.FEMALE;case Utils.string_of_enum(facetValues,facetValues.CHILD):return facetValues.CHILD;case Utils.string_of_enum(facetValues,facetValues.DEMO_LENS):return facetValues.DEMO_LENS;case Utils.string_of_enum(facetValues,facetValues.STD):return facetValues.STD;case Utils.string_of_enum(facetValues,facetValues.L):return facetValues.L;case Utils.string_of_enum(facetValues,facetValues.S):return facetValues.S}return e}}]),e}();!function(e){e(document).ready(function(){e("#filters").length&&(opsm.filters=new Filter)})}(jQuery);_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var StickFooterBanner=function(){function e(){var t=this;_classCallCheck(this,e),this.element=$("#footer-sticky-banner"),this.closeBtn=this.element.find(".footer--sticky-banner-close-btn"),"undefined"!=typeof getCookie&&"extra10"===getCookie("extra10")&&this.hide(),this.closeBtn.on("click",function(){"undefined"!=typeof setCookie&&setCookie("extra10","extra10",1e3),t.hide()})}return _createClass(e,[{key:"show",value:function(){this.element.show().animateCss("slideInUp")}},{key:"hide",value:function(){var e=this;this.element.animateCss("slideOutDown",function(){e.element.hide(0)})}}]),e}(),FormSubscription=function e(){_classCallCheck(this,e),this.form=document.querySelector("#form-subscription"),this.form&&this.form.addEventListener("submit",function(e){!1===_this3.form.checkValidity()&&(e.preventDefault(),e.stopPropagation()),this.form.classList.add("was-validated")})};_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var OPSMHeader=function(){function e(){var t=this;_classCallCheck(this,e),this.basePath=window.location.origin,$.ajax({url:this.basePath+"/AjaxUserFavouriteListItems",dataType:"json",success:function(e){var t="",i=0,n=[];e.length&&e[0].items.length&&(t=e[0].items.join("_"),i=e[0].items.length,n=e[0].items),$(document).ready(function(){$("#wishlist-total-count").val(i),$("#added-products-favourites").attr("rel",t),$("#btn-favourite .header--cms-badge").html(i).trigger("change"),n.forEach(function(e,t,i){$('button.product--favourite[rel="'+e+'"]').addClass("product--favourite--yes").find("span.icon-heart-outline").addClass("icon-heart")})})},error:function(e,t,i){console.log(e.responseText)}}),$.ajax({url:this.basePath+"/AjaxCustomerHeaderInfos",dataType:"json",success:function(e){try{e.length&&$(document).ready(function(){var t=e[2];"G"===t?($(".header--g-user").removeClass("d-none"),$(".header--r-user").addClass("d-none"),$(".js-gr-ddm-reorder-cta").attr("href",$("input#js-gr-header--g-user").val()),$(".header--r-user ").not(".reorder-button").removeClass("d-flex"),$(".sidemenu--g-user").removeClass("d-none"),$(".sidemenu--r-user").addClass("d-none"),isLoggedInUser="false"):"R"===t&&($(".sidemenu--g-user").addClass("d-none"),$(".sidemenu--r-user").removeClass("d-none"),$(".js-gr-ddm-reorder-cta").attr("href",$("input#js-gr-header--r-user").val()),$(".header--g-user").addClass("d-none"),$(".header--r-user").not(".reorder-button").addClass("d-flex"),$(".header--r-user").removeClass("d-none"),isLoggedInUser="true")})}catch(e){console.log(e)}},error:function(e,t,i){console.log(e.responseText)}}),this.header=$(".header"),this.saleBanner=$("div#sale-off-banner"),this.notibarCloseBtn=$("#header-notibar-close"),this.notibarCloseBtn.on("click",function(){t.saleBanner.animateCss("fadeOutUp",function(){t.saleBanner.remove(),t.header.addClass("header--no-notibar")})}),this.header=$(".header"),this.headersticky=$("#opsm-header-sticky"),this.preHeader=$("#pre-header-strip"),this.navbarLeft=this.header.find("#header-mega-navbar-left"),this.underline=this.navbarLeft.find(".header--mega-navbar-underline"),this.headerWrapper=this.header.find(".header-wrapper");var i=$(window).scrollTop();if($(window).on("scroll",function(){var e=$(window).scrollTop();e>i&&e>t.header.height()?(e-i,t.megaMenuContainer.is(".show")||(t.headerWrapper.addClass("temp-hidden"),t.headerWrapper.attr({"data-aos":"fade-up"}),t.saleBanner.addClass("temp-hidden"),t.headersticky.addClass("temp-hidden"),t.preHeader.addClass("temp-hidden"))):(i-e>50||e<=t.header.height()+40)&&(t.megaMenuContainer.is(".show")?t.headerWrapper.removeAttr("data-aos"):(t.headerWrapper.removeClass("temp-hidden"),t.headerWrapper.attr({"data-aos":"fade-down"}),t.saleBanner.removeClass("temp-hidden"),t.headersticky.removeClass("temp-hidden"),t.preHeader.removeClass("temp-hidden"))),i=e,e>t.header.height()/t.header.height()?t.header.addClass("sticky-ing"):t.header.removeClass("sticky-ing"),e<=t.header.height()&&t.header.not(".sticky-ing")&&(t.headersticky.is("[data-aos]")&&t.headersticky.removeAttr("data-aos"),t.saleBanner.is("[data-aos]")&&t.saleBanner.removeAttr("data-aos")),t.adjustMegaTopPos()}),this.btnLogin=$("#btn-login .hidden-mobile"),this.btnLogin.length){this.userMenu=this.btnLogin.siblings(".dropdown-menu"),this.btnLogin.dropdown({offset:function(e){var i=t.btnLogin.outerWidth(),n=t.userMenu.width(),s=parseInt((n-i)/2,10),a=e.popper;return a.left=-s,Utils.isSmallDesktopAndAbove()&&(a.top=30),e}});var n=!1,s=!1;this.btnLogin.on("mouseenter",function(){s?s=!1:(n&&(clearTimeout(n),n=!1),t.userMenu.is(":hidden")&&t.btnLogin.dropdown("toggle"))}).on("mouseleave",function(){n=setTimeout(function(){t.userMenu.trigger("mouseleave")},200)}).on("touchstart",function(){s=!0}),this.userMenu.on("mouseenter",function(){n&&(clearTimeout(n),n=!1)}).on("mouseleave",function(){t.userMenu.is(":visible")&&t.btnLogin.dropdown("toggle")})}this.megaMenuLink=$(".header--mega-navbar-item-link"),this.megaMenus=$(".header--mega-navbar-contents"),this.megaMenuContainer=$(".header--mega-navbar-contents-container"),this.megaMenuWrapper=$(".header--mega-navbar-contents--wrapper"),this.megaMenuItem=$(".header--mega-navbar-item");var a=!1;this.mobileMenuToggle=$("#btn-toggle-sidemenu");this.megaMenuLink.off("click").on("click.mega",function(e){a&&(clearTimeout(a),a=!1);var i=$(e.target),n=i.data("target");null!=n&&(i.hasClass("hover")&&t.closeMegaMenu(),n&&t.megaMenus.filter(n).is(":hidden")&&t.openMegaMenu(n),t.megaMenuLink.filter(".hover").removeClass("hover"),i.addClass("hover"),t.adjustMegaTopPos(),e.preventDefault())}),$("body").on("click.mega.close",function(e){var i=t.megaMenus.filter(".show:not(.animated)");i.length&&e.pageY>i.offset().top+i.height()&&t.closeMegaMenu()}),$('.header--mega-navbar-category-content a[data-toggle="tab"]').on("show.bs.tab",function(e){var t=$(e.target),i=t.data("promo"),n=t.data("promo-cat");$('[data-promo-target="'+i+'"]').find('a[href="#'+n+"-"+i+'-promo"]').tab("show")});var r=!1;this.navbarLeft.on("click.mega.underline",".header--mega-navbar-item",function(e){var i=$(e.target),n=i.position();t.underline.addClass("show").css({left:n.left,width:i.outerWidth()})}),this.navbarLeft.on("mouseenter",".header--mega-navbar-item",function(e){if(!($(".header--mega-navbar-item-link.hover").length>0)){var i=$(e.target),n=i.position();t.underline.addClass("show").css({left:n.left,width:i.outerWidth()})}}),this.navbarLeft.on("mouseleave",function(){r=setTimeout(function(){0===t.megaMenus.filter(".show").length&&t.underline.removeClass("show")},500)}),this.megaMenuContainer.on("mouseleave",function(){r&&clearTimeout(r)})}return _createClass(e,[{key:"adjustMegaTopPos",value:function(){if(this.megaMenuContainer.is(":visible")){var e=0;$(window).scrollTop();e=this.header.is(".sticky-ing")?this.headersticky.height()+1:this.header.height()+1,this.megaMenuContainer.css("top",e)}}},{key:"openMegaMenu",value:function(e){var t=this,i=this.megaMenus.filter(":visible"),n=this.megaMenus.filter(e);$("html, body").css("overflow-y","hidden"),0===i.length?(this.megaMenuContainer.addClass("show animating"),this.adjustMegaTopPos(),n.animateCss("slideInDown",function(){n.addClass("show"),t.megaMenuContainer.removeClass("animating")})):(i.removeClass("fadeIn").animateCss("fadeOut",function(){i.removeClass("show")}),n.animateCss("fadeIn",function(){n.addClass("show")}))}},{key:"closeMegaMenu",value:function(){var e=this,t=this.megaMenus.filter(":visible");this.megaMenuContainer.addClass("animating out"),$("html, body").removeAttr("style"),t.animateCss("slideOutUp",function(){e.megaMenuContainer.removeClass("show animating out"),e.megaMenus.removeClass("animated slideInDown slideOutUp fadeIn fadeOut show")}),this.megaMenuLink.removeClass("hover"),this.underline.removeClass("show")}}],[{key:"getFavList",value:function(){return($("#added-products-favourites").attr("rel")||"").split("_").filter(function(e){return""!=e})}},{key:"isPendingFavReq",value:function(){return $("#pending-products-favourites").attr("rel")||!1}},{key:"setPendingFavReq",value:function(e){$("#pending-products-favourites").attr("rel",e)}},{key:"updateFavBadge",value:function(e,t){e=e||0,t=t||"";e=parseInt(e);var i=$("#wishlist-total-count").val();i&&""!==i||(i="0"),$("#wishlist-total-count").val(parseInt(i)+e);var n=parseInt($("#wishlist-total-count").val());if(n>0?$("#btn-favourite .header--cms-badge").text(n).removeClass("d-none"):$("#btn-favourite .header--cms-badge").text("0").addClass("d-none"),$("#added-products-favourites").length){var s=($("#added-products-favourites").attr("rel")||"").split("_");e>0?s.push(t+""):e<0&&(s=s.filter(function(e,i,n){return e!=t})),$("#added-products-favourites").attr("rel",s.join("_"))}}},{key:"favItemListServerResp",value:function(e){e=e||{};var t=parseInt(e.itemsCount||"0");e.actualFavItems&&(window.favItemsData=e.actualFavItems),$("#wishlist-total-count").val(t),t>0?$("#btn-favourite .header--cms-badge").text(t).removeClass("d-none"):$("#btn-favourite .header--cms-badge").text("0").addClass("d-none")}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var HomeCarousel=function(){function e(){var t=this;_classCallCheck(this,e),this.carouselMain=$(".carousel"),this.carouselNav=$(".carousel-nav"),this.popularProducts=$(".popular-products--inner"),this.complementProducts=$(".complement-products--inner"),this.underline=this.carouselNav.find(".carousel-nav--underline"),this.carouselMain.slick({infinite:!0,slidesToScroll:1,autoplay:!0,autoplaySpeed:5e3,arrows:!1,responsive:[{breakpoint:768,settings:{autoplay:!1,dots:!0}}]}).on("beforeChange",function(e,i,n,s){t.handleUnderline(s),t.handleNav(s)}),this.navItem=$(".carousel-nav .carousel-nav--item"),this.navItem.on("click",function(e){t.navItem.removeClass("active");var i=$(e.target);t.navItem.find(i).addClass("active"),t.carouselMain.slick("slickGoTo",t.navItem.index(i))});var i=void 0;$(window).resize(function(){clearTimeout(i),i=setTimeout(function(){var e=t.carouselMain.slick("slickCurrentSlide");t.handleUnderline(e),t.handleNav(e)},100)}),this.handleUnderline(0),this.handleNav(0);if($("#popular-product-carousel-count").length>0)try{parseInt($("#popular-product-carousel-count").val())}catch(e){}!$(".pg-product-detail").length>0&&this.popularProducts.slick({infinite:!1,slidesToShow:4,slidesToScroll:1,refresh:!0,responsive:[{breakpoint:992,settings:{slidesToShow:2}},{breakpoint:768,settings:{slidesToShow:1}}]}),this.complementProducts.slick({infinite:!1,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:992,settings:{slidesToShow:2}},{breakpoint:600,settings:{slidesToShow:1}}]})}return _createClass(e,[{key:"handleNav",value:function(e){this.navItem.removeClass("active").eq(e).addClass("active")}},{key:"handleUnderline",value:function(e){var t=this.navItem.eq(e);t.length&&this.underline.css({left:t.offset().left,width:t.outerWidth(),opacity:1})}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Home=function(){function e(){_classCallCheck(this,e),this.brandsWeLoveSliderMobileCls="brands-we-love--slider-sm",this.brandsWeLoveSliderTabletCls="brands-we-love--slider-md",this.brandsWeLoveSlider=$("."+this.brandsWeLoveSliderMobileCls),this.brandSlider(),this.aos()}return _createClass(e,[{key:"brandSlider",value:function(){this.brandsWeLoveSlider.data("slick")||this.brandsWeLoveSlider.not(".slick-initialized").slick({arrows:!1,infinite:!0,speed:300,slidesToShow:2,slidesToScroll:2,centerMode:!1,variableWidth:!0})}},{key:"aos",value:function(){AOS.init({duration:1e3,disable:"phone"})}}]),e}();!function(e){var t={parentSlideClass:"slide-inner-wrapper",slickSlideClass:"slick-slide",slickInitializedClass:"slick-initialized"};function i(i,n){n=n||{};if(n=e.extend(t,n),i.closest("."+n.slickSlideClass).length){var s=i.closest("."+n.slickSlideClass),a=s.closest("."+n.slickInitializedClass);a.length&&a.slick("slickRemove",s.data("slick-index"))}else{var r=n.parentSlideClass||"";r.length?i.closest(r).remove():i.remove()}}e.fn.imgRemove=function(n){n=n||{};return n=e.extend(t,n),this.each(function(t){"img"==this.tagName.toLowerCase()&&i(e(this),t)})};e.fn.checkErrImg=function(n){n=n||t;return n=e.extend(t,n),this.each(function(t){if("img"==this.tagName.toLowerCase()){var n=e(this),s=n.attr("src")||"";e.ajax({url:s,type:"GET",statusCode:{200:function(e,t,i){n.removeClass("src-err-rem")},404:function(e,s,a){i(n,t)}},error:function(e,s,a){i(n,t)}})}})}}(jQuery),$(function(){$(document).ready(function(){$("img.src-err-rem").one("load",function(e){$(this).checkErrImg()}),$("img.src-err-rem").one("error",function(e){$(this).imgRemove()}),setTimeout(function(){$("img.src-err-rem").each(function(){$(this).attr("src",$(this).attr("src"))})},200)})});_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ManualInput=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"suffix",value:function(e,t){return"_"+("number"==typeof e?""+e:"string"==typeof e?e.trim():"0")+"_"+("number"==typeof t?""+t:"string"==typeof t?t.trim():"0")}},{key:"saveExtendedPrescription",value:function(e,t){var i=t||"";sessionStorage.setItem("RXPanelSaveLensSelectionExt"+i,JSON.stringify(e))}},{key:"loadExtendedPrescription",value:function(e){var t=e||"";return JSON.parse(sessionStorage.getItem("RXPanelSaveLensSelectionExt"+t))}},{key:"clearExtendedPrescription",value:function(e){var t=e||"";sessionStorage.removeItem("RXPanelSaveLensSelectionExt"+t)}},{key:"isoDateTimeStrToDateStr",value:function(e){try{return new Date(e).toISOString().split("T")[0]}catch(t){return console.error("ManualInput - isoDateTimeStrToDateStr ",e,t),""}}},{key:"trimNumValueTo",value:function(e,t){try{return isNaN(parseFloat(e))?t:(""+e).trim()}catch(i){return console.error("ManualInput - trimNumValueTo ",e,i),t}}},{key:"trimNumValueOneDecimalTo",value:function(e,t){try{return isNaN(parseFloat(e))?t:""+parseFloat(e).toFixed(1)}catch(i){return console.error("ManualInput - trimNumValueOneDecimalTo ",e,i),t}}},{key:"trimNumValueTwoDecimalTo",value:function(e,t){try{return isNaN(parseFloat(e))?t:""+parseFloat(e).toFixed(2)}catch(i){return console.error("ManualInput - trimNumValueOneDecimalTo ",e,i),t}}},{key:"trimStringValueTo",value:function(e,t){try{return"string"==typeof e?e.trim():t}catch(i){return console.error("ManualInput - trimStringValueTo ",e,i),t}}},{key:"resolvePD",value:function(t){var i=t||{},n={visionType:"READING"==i.rxType?"NEAR":"DISTANCE"==i.rxType?"DISTANCE":"PROGRESSIVE"==i.rxType?"NEARDISTANCE":"",leftPupDist:"",rightPupDist:"",bothPD:""},s=e.trimNumValueOneDecimalTo((i.PD||{}).OS,""),a=e.trimNumValueOneDecimalTo((i.PD||{}).OD,"");return""==s&&""!=a?n.bothPD=e.trimNumValueOneDecimalTo(a,""):(n.leftPupDist=s,n.rightPupDist=a),n}},{key:"resolvePrism",value:function(t){var i=t||{},n={leftUDPrism:e.trimNumValueTwoDecimalTo((i.VPRISM||{}).OS,""),leftUDPdir:e.trimStringValueTo(e.parsePrismDir((i.VBASEDIR||{}).OS),""),rightUDPrism:e.trimNumValueTwoDecimalTo((i.VPRISM||{}).OD,""),rightUDPdir:e.trimStringValueTo(e.parsePrismDir((i.VBASEDIR||{}).OD),""),leftIOPrism:e.trimNumValueTwoDecimalTo((i.HPRISM||{}).OS,""),leftIOPdir:e.trimStringValueTo(e.parsePrismDir((i.HBASEDIR||{}).OS),""),rightIOPrism:e.trimNumValueTwoDecimalTo((i.HPRISM||{}).OD,""),rightIOPdir:e.trimStringValueTo(e.parsePrismDir((i.HBASEDIR||{}).OD),"")};return n.leftUDPrismFMT=e.trimStringValueTo(n.leftUDPrism,"-")+" "+e.trimStringValueTo(e.parsePrismDirFMT(n.leftUDPdir),""),n.rightUDPrismFMT=e.trimStringValueTo(n.rightUDPrism,"-")+" "+e.trimStringValueTo(e.parsePrismDirFMT(n.rightUDPdir),""),n.leftIOPrismFMT=e.trimStringValueTo(n.leftIOPrism,"-")+" "+e.trimStringValueTo(e.parsePrismDirFMT(n.leftIOPdir),""),n.rightIOPrismFMT=e.trimStringValueTo(n.rightIOPrism,"-")+" "+e.trimStringValueTo(e.parsePrismDirFMT(n.rightIOPdir),""),(!isNaN(parseFloat(n.leftUDPrism))&&""==n.leftUDPdir||isNaN(parseFloat(n.leftUDPrism))&&""!=n.leftUDPdir)&&console.error("ManualInput - resolvePrism - error: leftUDPrism / leftUDPdir ",n.leftUDPrism,n.leftUDPdir),(!isNaN(parseFloat(n.rightUDPrism))&&""==n.rightUDPdir||isNaN(parseFloat(n.rightUDPrism))&&""!=n.rightUDPdir)&&console.error("ManualInput - resolvePrism - error: rightUDPrism / rightUDPdir ",n.rightUDPrism,n.rightUDPdir),(!isNaN(parseFloat(n.leftIOPrism))&&""==n.leftIOPdir||isNaN(parseFloat(n.leftIOPrism))&&""!=n.leftIOPdir)&&console.error("ManualInput - resolvePrism - error: leftIOPrism / leftIOPdir ",n.leftIOPrism,n.leftIOPdir),(!isNaN(parseFloat(n.rightIOPrism))&&""==n.rightIOPdir||isNaN(parseFloat(n.rightIOPrism))&&""!=n.rightIOPdir)&&console.error("ManualInput - resolvePrism - error: rightIOPrism / rightIOPdir ",n.rightIOPrism,n.rightIOPdir),n}},{key:"parsePrismDir",value:function(e){return{IN:"BI",OUT:"BO",UP:"BU",DOWN:"BD",UKN:""}["string"==typeof e?e.toUpperCase():"UKN"]}},{key:"parsePrismDirFMT",value:function(e){return{IN:"BI(in)",OUT:"BO(out)",UP:"BU(up)",DOWN:"BD(down)",BI:"BI(in)",BO:"BO(out)",BU:"BU(up)",BD:"BD(down)",UKN:""}["string"==typeof e?e.toUpperCase():"UKN"]}},{key:"toCheckoutPrescr",value:function(t,i){var n=t||"",s=i||{},a=e.resolvePD(s),r=e.resolvePrism(s);return{locked:"0",lensproductId:n,verified:s.verified||"1",issueDate:e.isoDateTimeStrToDateStr(s.issueDate),leftSph:e.trimNumValueTo((s.SPH||{}).OS,""),rightSph:e.trimNumValueTo((s.SPH||{}).OD,""),leftCyl:e.trimNumValueTo((s.CYL||{}).OS,""),rightCyl:e.trimNumValueTo((s.CYL||{}).OD,""),leftAxis:e.trimNumValueTo((s.AX||{}).OS,""),rightAxis:e.trimNumValueTo((s.AX||{}).OD,""),leftAdd:e.trimNumValueTo((s.ADD||{}).OS,""),rightAdd:e.trimNumValueTo((s.ADD||{}).OD,""),leftSegH:"",leftOCH:"",rightSegH:"",rightOCH:"",visionType:"READING"==s.rxType?"NEAR":"DISTANCE"==s.rxType?"DISTANCE":"PROGRESSIVE"==s.rxType?"NEARDISTANCE":"",bothPD:a.bothPD,leftPupDist:a.leftPupDist,rightPupDist:a.rightPupDist,leftUDPrism:r.leftUDPrism,leftUDPdir:r.leftUDPdir,rightUDPrism:r.rightUDPrism,rightUDPdir:r.rightUDPdir,leftIOPrism:r.leftIOPrism,leftIOPdir:r.leftIOPdir,rightIOPrism:r.rightIOPrism,rightIOPdir:r.rightIOPdir,leftUDPrismFMT:r.leftUDPrismFMT,rightUDPrismFMT:r.rightUDPrismFMT,leftIOPrismFMT:r.leftIOPrismFMT,rightIOPrismFMT:r.rightIOPrismFMT}}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var MapStoreLocator=function(){function e(t,i){var n=this;_classCallCheck(this,e),this.elmMap=$("#map"),0!==this.elmMap.length&&(this.searchStore=$("#searchStore-find"),this.btnShowMore=$("#btn-show-more"),this.storeList=$(".select-store--list-inner"),this.spinner=$("#load-more-product-spinner"),this.showMoreWrap=$(".select-store--showmore"),this.mapWrap=$(".select-store--maps"),this.mapSticky=$(".select-store--maps--sticky"),this.btnSelectMap=$("#select-map"),this.btnBackListMap=$("#back-list-view"),this.mapInstance={},this.listMarket=[],this.storeItem=$(".select-store--item"),this.btnUseMyLocation=$("#use-my-location"),this.dataStore=[],this.newDataStore=[],i||this.btnUseMyLocation.on("click",function(){if(n.btnUseMyLocation.find(".loading").removeClass("d-none"),navigator.geolocation)try{navigator.geolocation.getCurrentPosition(n.showPosition.bind(n))}catch(e){n.useGoogleApiToGetLocation()}else n.useGoogleApiToGetLocation()}),t||this.init(),i?this.handleFavoriteStore():(this.searchStore.on("submit",function(e){var t=$("#field-booking").val();e.preventDefault(),n.handleSearchStore(t)}),this.btnShowMore.on("click",function(){n.btnShowMore.addClass("d-none"),n.spinner.removeClass("d-none"),n.showMoreStore(function(){n.btnShowMore.removeClass("d-none"),n.spinner.addClass("d-none")})})),this.btnSelectMap.on("click",function(){n.mapSticky.addClass("open"),n.storeList.addClass("openMobile"),$("html").addClass("openMaps")}),this.btnBackListMap.on("click",function(){n.mapSticky.removeClass("open"),n.storeList.removeClass("openMobile"),$("html").removeClass("openMaps")}),Modernizr.csspositionsticky||($(".select-store--maps").parent().addClass("filters--ie-wrapper"),$(".select-store--maps").affix({offset:{top:function(){return this.top=$(".filters--ie-wrapper").offset().top},bottom:function(){return this.bottom=$(".footer").outerHeight()}}}).on("affixed.bs.affix",function(){var e=$(".filters--ie-wrapper");$(".select-store--maps").css({width:e.width(),left:e.offset().left,top:$(".header").outerHeight()})}).on("affixed-top.bs.affix, affixed-bottom.bs.affix",function(){$(".select-store--maps").css({left:"",top:""})})),$(window).scroll(function(){if(Utils.isSmallDesktopAndAbove()&&$("html").is(".csspositionsticky")){var e=$(window).scrollTop(),t=$(".select-store--content").position().top,i=$(".header").is(".sticky-ing")?$("#opsm-header-sticky").height():0,s=$("#opsm-header-sticky").is(".temp-hidden");e>=t-i&&!s?n.mapSticky.css("top",i):n.mapSticky.css("top","")}}))}return _createClass(e,[{key:"useGoogleApiToGetLocation",value:function(){var e=this;$.ajax({url:"//www.googleapis.com/geolocation/v1/geolocate?key="+opsm.core.getGoogleMapsApiKey(),type:"post",success:function(t){if(t.location){var i={coords:{latitude:t.location.lat,longitude:t.location.lng}};e.showPosition(i)}},complete:function(){e.btnUseMyLocation.find(".loading").addClass("d-none")}})}},{key:"showPosition",value:function(e){this.btnUseMyLocation.find(".loading").addClass("d-none");var t="//maps.googleapis.com/maps/api/geocode/json?latlng="+e.coords.latitude+","+e.coords.longitude+"&sensor=true";$.getJSON(t,function(e){if(e.results.length){var t=e.results[0].formatted_address;document.getElementById("field-booking").value=t,$("#searchStore").submit()}else alert("Sorry! We could not locate your position.")})}},{key:"setMarkerColor",value:function(e,t,i){var n=this;this.listMarket.length>0&&this.listMarket.forEach(function(s,a){a==i?(n.listMarket[a].setOptions({position:new google.maps.LatLng(e,t),map:n.mapInstance,icon:{url:imageDirectoryPath+"images/icons/icon_marker_selected.png",labelOrigin:new google.maps.Point(16,19)}}),n.mapInstance.panTo(new google.maps.LatLng(e,t))):n.listMarket[a].setOptions({icon:{url:imageDirectoryPath+"images/icons/icon_marker.png",labelOrigin:new google.maps.Point(13,14)}})})}},{key:"handleSearchStore",value:function(e){var t=this;this.storeList.empty(),this.showMoreWrap.addClass("d-none"),this.newDataStore=[];var i=[];this.removeMarkers(),e.length?($.getJSON("favorite-store.json",function(e){i=e}),$.getJSON("search-store.json",function(e){t.dataStore=e,e.slice(0,4).forEach(function(e,n){var s=!1;i.forEach(function(t,i){e.id===t.id&&(s=!0)});var a=Utils.showStore(e,n,s);a.animateCss("fadeIn"),t.storeList.append(a),t.initMarker(e,n)}),e.length>0?t.mapWrap.removeClass("d-none"):t.mapWrap.addClass("d-none"),e.length>=4?t.showMoreWrap.removeClass("d-none"):t.showMoreWrap.addClass("d-none"),t.handleClickStore()})):(this.storeList.empty(),this.showMoreWrap.addClass("d-none"),this.mapWrap.addClass("d-none"))}},{key:"handleFavoriteStoreAjax",value:function(){var e=this;this.storeList.empty(),this.showMoreWrap.addClass("d-none"),this.newDataStore=[];this.removeMarkers(),window.getFavStoreAjaxURL&&$.getJSON("favorite-store.json",function(t){e.dataStore=t,t.length>0?(t.forEach(function(t,i){var n=Utils.showStoreFavorite(t,i);n.animateCss("fadeIn"),e.storeList.append(n),e.initMarker(t,i)}),t.length>0?e.mapWrap.removeClass("d-none"):e.mapWrap.addClass("d-none"),t.length>=4?e.showMoreWrap.removeClass("d-none"):e.showMoreWrap.addClass("d-none"),e.handleClickStore()):($(".select-store--list").remove(),$(".select-store--maps").remove())})}},{key:"handleFavoriteStore",value:function(){var e=this;this.storeList.empty(),this.showMoreWrap.addClass("d-none"),this.newDataStore=[];this.removeMarkers();var t=window.favStoreList?window.favStoreList:[];e.dataStore=t,t.length>0?(t.forEach(function(t,i){var n=Utils.showStoreFavorite(t,i);n.animateCss("fadeIn"),e.storeList.append(n),e.initMarker(t,i)}),t.length>0?e.mapWrap.removeClass("d-none"):e.mapWrap.addClass("d-none"),t.length>=4?e.showMoreWrap.removeClass("d-none"):e.showMoreWrap.addClass("d-none"),e.handleClickStore(),e.mapInstance.panTo(new google.maps.LatLng(t[0].lat,t[0].lng))):($(".select-store--list").remove(),$(".select-store--maps").remove())}},{key:"handleClickStore",value:function(){var e=this;$(".select-store--item").click(function(t){var i=$(this),n=(i.data("index"),i.data("lng")),s=i.data("lat");e.mapInstance.panTo(new google.maps.LatLng(s,n))})}},{key:"initMarker",value:function(e,t){var i=this,n=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e.lng),map:this.mapInstance,label:{text:""+e.id,color:"#fff",fontFamily:"ProximaNova-Bold",fontSize:"14"},title:""+e.nameStreet,icon:{url:imageDirectoryPath+"images/icons/icon_marker.png",labelOrigin:new google.maps.Point(13,14)},url:""+e.url,id:""+t});this.listMarket.push(n),n.addListener("click",function(){i.mapInstance.panTo(new google.maps.LatLng(e.lat,e.lng))})}},{key:"showMoreStore",value:function(e){var t=this,i=[];$.getJSON("favorite-store.json",function(e){i=e});var n=this.newDataStore.length,s=this.dataStore.slice(n,n+4);this.newDataStore.length===this.dataStore.length&&this.showMoreWrap.addClass("d-none"),s.length&&(s.forEach(function(s,a){var r=!1;i.forEach(function(e,t){s.id==e.id&&(r=!0)});var o=Utils.showStore(s,n+a,r);o.animateCss("fadeIn"),t.storeList.append(o),t.initMarker(s,n+a),"function"==typeof e&&e.call()}),this.handleClickStore())}},{key:"removeMarkers",value:function(){for(var e=0;e<this.listMarket.length;e++)this.listMarket[e].setMap(null);this.listMarket=[]}},{key:"init",value:function(){var e={zoom:14,center:new google.maps.LatLng(-33.86882,151.209296),streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1,styles:[{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text",stylers:[{visibility:"off"}]}]},t=document.getElementById("map");this.mapInstance=new google.maps.Map(t,e)}}]),e}(),AutoCompleteGoogleMapsOmnys=function(){function e(t){var i=this;_classCallCheck(this,e),this.elmInput=$("#field-booking");var n=!0;this.elmInput.length&&"undefined"==typeof google&&$.getScript("//maps.googleapis.com/maps/api/js?sensor=false&key="+opsm.core.getGoogleMapsApiKey()+"&language=en&region="+opsm.core.getCountryCode()+"&libraries=places").done(function(e,i){"function"==typeof t&&t.call()}),this.elmInput.on("click",function(){n&&(i.handleAutocomplete(),n=!1)})}return _createClass(e,[{key:"handleAutocomplete",value:function(){var e=document.getElementById("field-booking"),t=new google.maps.places.Autocomplete(e,{types:["geocode"],componentRestrictions:{country:"au"}});t.addListener("place_changed",function(){var e=t.getPlace();e.address_components})}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var MapStore=function(){function e(t){var i=this;_classCallCheck(this,e),this.elmMap=$("#map"),0!==this.elmMap.length&&(this.searchStore=$("#searchStore"),this.btnShowMore=$("#btn-show-more"),this.storeList=$(".select-store--list-inner"),this.spinner=$("#load-more-product-spinner"),this.showMoreWrap=$(".select-store--showmore"),this.mapWrap=$(".select-store--maps"),this.mapSticky=$(".select-store--maps--sticky"),this.btnSelectMap=$("#select-map"),this.btnBackListMap=$("#back-list-view"),this.mapInstance={},this.listMarket=[],this.storeItem=$(".select-store--item"),this.btnUseMyLocation=$("#use-my-location"),this.dataStore=[],this.newDataStore=[],this.btnUseMyLocation.on("click",function(){if(i.btnUseMyLocation.find(".loading").removeClass("d-none"),navigator.geolocation)try{navigator.geolocation.getCurrentPosition(i.showPosition.bind(i))}catch(e){console.log(e),i.useGoogleApiToGetLocation()}else i.useGoogleApiToGetLocation()}),t||this.init(),this.searchStore.on("submit",function(e){var t=$("#field-booking").val();e.preventDefault(),i.handleSearchStore(t)}),this.btnShowMore.on("click",function(){i.btnShowMore.addClass("d-none"),i.spinner.removeClass("d-none"),i.showMoreStore(function(){i.btnShowMore.removeClass("d-none"),i.spinner.addClass("d-none")})}),this.btnSelectMap.on("click",function(){i.mapSticky.addClass("open"),i.storeList.addClass("openMobile"),$("html").addClass("openMaps")}),this.btnBackListMap.on("click",function(){i.mapSticky.removeClass("open"),i.storeList.removeClass("openMobile"),$("html").removeClass("openMaps")}),Modernizr.csspositionsticky||($(".select-store--maps").parent().addClass("filters--ie-wrapper"),$(".select-store--maps").affix({offset:{top:function(){return this.top=$(".filters--ie-wrapper").offset().top},bottom:function(){return this.bottom=$(".footer").outerHeight()}}}).on("affixed.bs.affix",function(){var e=$(".filters--ie-wrapper");$(".select-store--maps").css({width:e.width(),left:e.offset().left,top:$(".header").outerHeight()})}).on("affixed-top.bs.affix, affixed-bottom.bs.affix",function(){$(".select-store--maps").css({left:"",top:""})})),$(window).scroll(function(){if(Utils.isSmallDesktopAndAbove()&&$("html").is(".csspositionsticky")){var e=$(window).scrollTop(),t=$(".select-store--content").position().top,n=$(".header").is(".sticky-ing")?$("#opsm-header-sticky").height():0,s=$("#opsm-header-sticky").is(".temp-hidden");e>=t-n&&!s?i.mapSticky.css("top",n):i.mapSticky.css("top","")}}))}return _createClass(e,[{key:"useGoogleApiToGetLocation",value:function(){var e=this;$.ajax({url:"//www.googleapis.com/geolocation/v1/geolocate?key="+opsm.core.getGoogleMapsApiKey(),type:"post",success:function(t){if(t.location){var i={coords:{latitude:t.location.lat,longitude:t.location.lng}};e.showPosition(i)}},complete:function(){e.btnUseMyLocation.find(".loading").addClass("d-none")}})}},{key:"showPosition",value:function(e){this.btnUseMyLocation.find(".loading").addClass("d-none");var t="//maps.googleapis.com/maps/api/geocode/json?latlng="+e.coords.latitude+","+e.coords.longitude+"&sensor=true";$.getJSON(t,function(e){if(e.results.length){var t=e.results[0].formatted_address;document.getElementById("field-booking").value=t,$("#searchStore").submit()}else alert("Sorry! We could not locate your position.")})}},{key:"setMarkerColor",value:function(e,t,i){var n=this;this.listMarket.length>0&&this.listMarket.forEach(function(s,a){a==i?(n.listMarket[a].setOptions({position:new google.maps.LatLng(e,t),map:n.mapInstance,icon:"images/icons/icon_marker_selected.png"}),n.mapInstance.panTo(new google.maps.LatLng(e,t))):n.listMarket[a].setOptions({icon:"images/icons/icon_marker.png"})})}},{key:"handleSearchStore",value:function(e){var t=this;this.storeList.empty(),this.showMoreWrap.addClass("d-none"),this.newDataStore=[],this.removeMarkers(),e.length?$.getJSON("search-store.json",function(e){var i;t.dataStore=e;var n=e.slice(0,4);(i=t.newDataStore).push.apply(i,_toConsumableArray(n)),n.forEach(function(e,i){var n=Utils.showStore(e,i);n.animateCss("fadeIn"),t.storeList.append(n),t.initMarker(e,i)}),e.length>0?t.mapWrap.removeClass("d-none"):t.mapWrap.addClass("d-none"),e.length>=4?t.showMoreWrap.removeClass("d-none"):t.showMoreWrap.addClass("d-none"),t.handleClickStore()}):(this.storeList.empty(),this.showMoreWrap.addClass("d-none"),this.mapWrap.addClass("d-none"))}},{key:"handleClickStore",value:function(){var e=this;$(".select-store--item").click(function(t){var i=$(this);$(".select-store--item").removeClass("select-store--item--selected"),i.addClass("select-store--item--selected");var n=i.data("index"),s=i.data("lng"),a=i.data("lat");e.setMarkerColor(a,s,n),e.prev_infowindow&&e.prev_infowindow.close()})}},{key:"initMarker",value:function(e,t){var i=this,n=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e.lng),map:this.mapInstance,label:{text:""+e.id,color:"#fff",fontFamily:"ProximaNova-Bold",fontSize:"14"},title:""+e.nameStreet,icon:"images/icons/icon_marker.png",url:""+e.url,id:""+t});this.listMarket.push(n);var s=new google.maps.InfoWindow({maxWidth:200});this.prev_infowindow=null,n.addListener("click",function(){var a='\n      <div class="info-window">\n        <h5>'+n.title+'</h5>\n        <div class="address">\n          <p>'+e.address+", Tel: "+e.tel+'</p>\n          <a href="'+n.url+'">Select store</a>\n        </div>\n      </div>';i.prev_infowindow&&i.prev_infowindow.close(),i.setMarkerColor(e.lat,e.lng,n.id),s.setContent(a),s.open(n.get("map"),n),i.prev_infowindow=s,i.mapInstance.panTo(new google.maps.LatLng(e.lat,e.lng)),$(".select-store--item").removeClass("select-store--item--selected"),i.newDataStore.length>0&&i.newDataStore.forEach(function(e,i){i==t&&$(".select-store--item").eq(i).addClass("select-store--item--selected")})}),this.mapInstance.addListener("click",function(){s.close()})}},{key:"showMoreStore",value:function(e){var t,i=this,n=this.newDataStore.length,s=this.dataStore.slice(n,n+4);(t=this.newDataStore).push.apply(t,_toConsumableArray(s)),this.newDataStore.length===this.dataStore.length&&this.showMoreWrap.addClass("d-none"),s.length&&(s.forEach(function(t,s){var a=Utils.showStore(t,n+s);a.animateCss("fadeIn"),i.storeList.append(a),i.initMarker(t,n+s),"function"==typeof e&&e.call()}),this.handleClickStore())}},{key:"removeMarkers",value:function(){for(var e=0;e<this.listMarket.length;e++)this.listMarket[e].setMap(null);this.listMarket=[]}},{key:"init",value:function(){var e={zoom:14,center:new google.maps.LatLng(-33.86882,151.209296),streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1,styles:[{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text",stylers:[{visibility:"off"}]}]},t=document.getElementById("map");t&&(this.mapInstance=new google.maps.Map(t,e))}}]),e}();!function(e){e(function(){e("[data-parallax]").paroller();var t=e(document).height();setInterval(function(){e(document).height()!==t&&(e(window).triggerHandler("resize"),t=e(document).height())},1e3)})}(jQuery);_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PaymentMethod=function(){function e(){_classCallCheck(this,e);var t=this;this.paymethod=$("#payment-method-options"),this.paymethodWrap=$("#payment-method-wrapper"),0!==this.paymethod.length&&(this.paymethodWrap.hide(),this.getField(),this.paymethod.on("change",function(){t.paymethodWrap.hide(),t.getField()}))}return _createClass(e,[{key:"getCC",value:function(){}},{key:"getField",value:function(){var e=$('[name="payment-method-options"]').val(),t=this;$.ajax({type:"POST",url:"WalletProcess",async:!1,data:{},dataType:"json",success:function(i){var n=i.paymentMethods;n.length>0&&(n.forEach(function(t){var i="Payment";switch(t.paymentTypeEnum.value){case"001":i="visa";break;case"002":i="mc";break;case"003":i="amex";break;case"004":i="paypal"}if($("#cc_brand").val(t.paymentTypeEnum.value),(t.sno+":"+i+":"+t.subscriptionId).startsWith(e))if("paypal"===i)$("#card-name").html(t.cardName);else{var n=t.expiryDate.split(" ");$("#card-name").html(t.cardName),$("#billing-expires").html(n[1]+" "+n[5])}}),t.paymethodWrap.show())}})}},{key:"getExpiryDate",value:function(e){return e.expiryMonth+"/"+e.expiryYear}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PDP=function(){function e(t){var i=this;if(_classCallCheck(this,e),$(".pg-product-detail").length){this.upc=$("#analyticsPDPUpc").val()||"",this.isReload=t||!1,this.hasInventoryCheck=$("#hasInventoryCheck").val(),this.isContactLensBrand=$("#isContactLensBrand").val(),this.btnAddToCart=$(".product--add-to-cart-btn"),this.formCheckAvailability=$(".product--form-check-availability"),this.listAvailabilityStatus=$(".product--availability-list");this.productSliderMain=$(".product--slider-main"),this.productSliderNav=$(".product--slider-nav");if(this.sliderDesktopCover=$(".product--slider-main-cover--dt"),this.sliderMobileCover=$(".product--slider-main-cover--mb"),this.reviewShortcut=$(".product--info-area ƒl.product--rating-stars"),this.complimentSlider=$("#pdp-product-compliment"),this.lightboxSlideshow=$("#lightbox-slideshow"),this.colorSelectors=$(".product--thumbnail-color-selectors"),this.subscribeBox=$(".product--contact-subs-box"),this.colorSlider=$(".product--thumbnail-colors ul"),this.colorWrapper=$(".product--thumbnail-colors"),this.zn=null,this.containerEl=document.getElementById("modal-zoom"),this.zoomInBtn=document.getElementById("zoom-in"),this.zoomOutBtn=document.getElementById("zoom-out"),this.zoomTransition="transform 0.4s ease-out",this.zoomed=!1,this.scale=1,this.defaultSpriteSpinOptions={responsive:!0,animate:!1,frameTime:80,sense:1,senseLane:1},this.formCheckAvailability.validate({rules:{postcode:{required:!0,digits:!0}},errorPlacement:function(e,t){e.addClass("invalid-feedback"),e.insertAfter(t.parent())},highlight:function(e,t,i){$(e).parent().addClass(t).removeClass(i)},unhighlight:function(e,t,i){$(e).parent().removeClass(t).addClass(i)},submitHandler:function(){var e=i.formCheckAvailability.find("#postcode").val();$.getJSON("product-availability.json",function(t){var n="",s="Click & Collect available at ",a="Available at ",r="Not available at ",o="This product is not available near you, please contact customer care on 1800 626 300 for AU or search another post code",l="",d="",c="";n=0!=t.length&&2e3!=e?function(){for(var e=0;e<t.length;e++){var i='<a href="#"><strong>'+t[e].store+"</strong></a>";t[e].available?t[e].clickAndCollect?d=s+" "+i:l=a+" "+i:c=r+" "+i}return'<div><span class="icon icon-check"></span>'+l+'</div>\n                        <div><span class="icon icon-check"></span>'+d+'</div>\n                        <div><span class="icon icon-cross"></span>'+c+"</div>"}():'<div><span class="icon icon-cross"></span>'+o+"</div>",i.listAvailabilityStatus.empty().html(n)})}}),this.hasInventoryCheck&&opsm&&opsm.InventoryCheckManager&&"function"==typeof opsm.InventoryCheckManager.getCustomInventoryAsync?(opsm.InventoryCheckManager.getCustomInventoryAsync($("#analyticsPDPUpc").val()).then(this.fetchCustInvSuccess).catch(e.fetchCustInvErr),$("#fit-size-select button").not(".isCurrent").each(function(){var t=$(this).data("upc")||"";(t=""+t).length&&opsm.InventoryCheckManager.getCustomInventoryAsync(t).then(e.fetchCustInvSuccessSize)})):e.fetchCustInvErr(null,"error","Missing inventory manager - opsm.InventoryCheckManager.getCustomInventoryAsync not defined"),"true"==this.isContactLensBrand&&utagFiller.asyncAddCustomInventory(this.upc,1,1),createProductImagesSlider(),setTimeout(function(){i.sliderMobileCover.fadeOut()},3e3),$(window).width()>768&&this.colorSlider.find("li").length>6)this.colorSlider.not(".slick-initialized").slick({dots:!1,infinite:!1,slidesToShow:6,slidesToScroll:1});else if($(window).width()<=768&&this.colorSlider.find("li").length>5){this.colorWrapper.addClass("fluid-slider"),this.colorWrapper.prepend('<button type="button" class="arrow-prev" style="display: none;"></button>'),this.colorWrapper.append('<button type="button" class="arrow-next"></button>');var n=$(".product--thumbnail-color-selectors")[0].scrollWidth;this.colorSelectors.on("scroll",function(){var e=$(".product--thumbnail-color-selectors").scrollLeft();n-e==$(".product--thumbnail-color-selectors").width()?$(".fluid-slider .arrow-next").hide():$(".fluid-slider .arrow-next").show(),e>60?$(".fluid-slider .arrow-prev").show():$(".fluid-slider .arrow-prev").hide()}),$(".arrow-next").on("click",function(){var e,t=$(".product--thumbnail-color-selectors").scrollLeft()+8;$(".product--thumbnail-color-selector").each(function(){var i=$(this)[0].offsetLeft;i>t&&(null==e||Math.abs(i-t)<Math.abs(e-t))&&(e=i)}),$(".product--thumbnail-color-selectors").animate({scrollLeft:e},100)}),$(".arrow-prev").on("click",function(){var e,t=$(".product--thumbnail-color-selectors").scrollLeft()-8;$(".product--thumbnail-color-selector").each(function(){var i=$(this)[0].offsetLeft;i<t&&(null==e||Math.abs(i-t)<Math.abs(e-t))&&(e=i)}),$(".product--thumbnail-color-selectors").animate({scrollLeft:e},100)})}$(".contact-lenses").length>0&&($(window).width()>=768?$(".contact-lenses .product--sidebar-col").niceScroll({autohidemode:"hidden",cursorwidth:"0px",railoffset:{top:0,left:-16}}):$("#product--sidebar-col").getNiceScroll().remove(),$("#full-image-container").addClass("fixed-header").css("width",$("#full-image-body").width()+"px"),$(".breadcrumbtrail").addClass("fixed-header fixed-animation"),$(window).on("scroll",function(){var e;$(window).scrollTop()+$(window).height()<=$("#product--sidebar-col").offset().top+$("#product--sidebar-col").outerHeight()?$(".header--sticky").hasClass("temp-hidden")?($(".breadcrumbtrail").addClass("fixed-animation"),$("#full-image-container").addClass("fixed-0").removeClass("fixed-header absolute-top"),$(".breadcrumbtrail").removeAttr("style").addClass("fixed-0").removeClass("fixed-header absolute-top")):($("#full-image-container").removeClass("fixed-0 absolute-top").addClass("fixed-header"),$(".breadcrumbtrail").removeAttr("style").removeClass("fixed-0 absolute-top").addClass("fixed-header")):(e=$(".header--sticky").hasClass("temp-hidden")?$(".contact-lenses .product--slider-main").offset().top-153:$(".contact-lenses .product--slider-main").offset().top,$("#full-image-container").removeClass("fixed-0 fixed-header").addClass("absolute-top"),$(".breadcrumbtrail").css("top",e+"px").removeClass("fixed-0 fixed-header fixed-animation").addClass("absolute-top"))})),$(".equivalent-widget").length>0&&($("#full-image-body").addClass("equivalent"),$(window).width()<=768&&$(".single-equivalent").length>1&&$(".equivalent-widget").not(".slick-initialized").slick({dots:!1,infinite:!1,slidesToShow:1.1,slidesToScroll:1,arrows:!1}),$(window).width()>768&&($(".single-equivalent").length>2?$(".equivalent-widget").not(".slick-initialized").slick({dots:!1,infinite:!1,slidesToShow:2,slidesToScroll:1,arrows:!1}):1==$(".single-equivalent").length?$(".equivalent-widget").addClass("col-12-grid"):$(".equivalent-widget").removeClass("col-12-grid"))),this.reviewShortcut.on("click",function(){$("#collapseReviews").collapse("show"),$("html, body").animate({scrollTop:$(".product--details-info").position().top})}),this.complimentSlider.not(".slick-initialized").slick({dots:!1,infinite:!1,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:992,settings:{slidesToShow:2}},{breakpoint:576,settings:{slidesToShow:1}}]}),$("[data-open-lightbox]").on("click",function(){Utils.isTablet()&&i.lightboxSlideshow.modal("show")}),$(window).width()<=768&&$("#info-accordion .collapse").on("show.bs.collapse",function(e){var t=$(this).closest(".card"),i=$($(this).data("parent")).find(".collapse.show"),n=0;0!==t.prevAll().filter(i.closest(".card")).length&&(n=i.height()),$("html,body").animate({scrollTop:t.offset().top-n-150},200)}),this.colorSelectors.on("click","a",function(e){}),$(window).on("orientationchange",function(){var e=window.orientation,t=$(window).outerHeight(),i=screen.width<screen.height?screen.width:screen.height;90===e||-90===e?(t<i?t:i)<576&&($("html").addClass("opsm-landscape"),setTimeout(function(){$(".product--slider-mobile .product--slider-main-cover--dt").fadeOut()},2e3)):$("html").removeClass("opsm-landscape")}),this.adjustTopSticky(),e.handleShopButtons(),attachAjaxLoadEvent(this)}}return _createClass(e,[{key:"reload",value:function(){this.constructor(!0)}},{key:"updateProductOnColor",value:function(e){$('[data-pdp-update="image"]').attr("src",e.image),$('[data-pdp-update="color"]').html(e.color),$('[data-pdp-update="sprites"]').data("images",e.sprites.join(",")).spritespin(jQuery.extend({source:e.sprites},this.defaultSpriteSpinOptions)),$('[data-pdp-update="price"]').html(e.price);for(var t="",i=0;i<e.size.length;i++)t+='<option value="'+e.size[i]+'">'+e.size[i]+"</option>";$('[data-pdp-update="size"]').html(t).hybridSelect("buildDropdownMenu")}},{key:"adjustTopSticky",value:function(){$(".product--info-right"),$(".product--info-area"),$(".header");var e=$("#opsm-header-sticky");$(".product--prescription");$(window).scroll(function(){if(Utils.isTabletAndAbove())e.height(),e.is(".temp-hidden")})}},{key:"fetchCustInvSuccess",value:function(t,i){if(t.errorCode||t.errorMessage)console.warn("AjaxCatalogEntryInventory",t.errorMessage,t.errorCode),e.showCtaOnStock($("#available-wrapper")),$("#analyticsPDPAvailable").val("Available"),$("#analyticsOOSOptions").val("");else if(t.hasOwnProperty("quantity")||t.hasOwnProperty("active")){console.log("AjaxCatalogEntryInventory","Result",t);var n=t;n.quantity>0?(e.showCtaOnStock($("#available-wrapper")),$("#analyticsPDPAvailable").val("Available"),$("#analyticsOOSOptions").val("")):1===n.active?(e.showCtaOnStock($("#oos-wrapper")),$("#analyticsPDPAvailable").val("Out-of-stock"),$("#analyticsOOSOptions").val("FindStore")):0===n.active?(e.showCtaOnStock($("#disco-wrapper")),$("#analyticsPDPAvailable").val("Not-for-sale"),$("#analyticsOOSOptions").val("FindStore")):(e.showCtaOnStock($("#available-wrapper")),$("#analyticsPDPAvailable").val("Available"),$("#analyticsOOSOptions").val("")),this.isReload||pdp.isReload||window.pdp.isReload?utagFiller.asyncPDPProductUpdate(n.partNumber,n.active,n.quantity):utagFiller.asyncAddCustomInventory(n.partNumber,n.active,n.quantity)}e.handleShopButtons()}},{key:"activateZoom",value:function(e){if(!e){this.scale=1;var t=this.containerEl.querySelector(".slick-current img");this.zn=new ZoomNode(t)}return!e}},{key:"onItemChange",value:function(e,t){if(this.zn){this.zn.destroy(),this.scale=1,this.updateZoomButtons();var i=e.querySelector("img");this.zn=new ZoomNode(i),this.zoomed=!0}}},{key:"initZoom",value:function(){var e=this;window.scrollTo({top:0,left:0,behavior:"smooth"}),$("#modal-zoom").modal(),Utils.blockPageScroll(!0),$("#slide-zoom").hasClass("slick-initialized")||$("#slide-zoom").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,adaptiveHeight:!0,infinite:!0,swipeToSlide:!0,vertical:!0,verticalSwiping:!0,dots:!0,responsive:[{breakpoint:768,settings:{swipe:!1,adaptiveHeight:!1,vertical:!1,verticalSwiping:!1,variableWidth:!0,customPaging:function(e,t){return'<div><img src=" '+e.$slides.eq(t).find("img").attr("src")+'?impolicy=OP_PDP_thumb "/></div>'}}}]}).on("afterChange",function(t,i,n){var s=document.querySelector("#slide-zoom").querySelector("div.slick-slide[data-slick-index='"+n+"']");$(window).width()>768&&(i.setOption("touchThreshold",5),i.setOption("swipe",!0),i.setOption("swipeToSlide",!0)),e.onItemChange(s)}).on("wheel",Utils.onSliderWheel);var t=$("#slide-main").slick("slickCurrentSlide");$("#slide-zoom").slick("slickGoTo",t,!0),this.activateZoom(this.zoomed)}},{key:"zoomInFunction",value:function(){this.scale+=.5,this.scale>ZOOM_MAX&&(this.scale=ZOOM_MAX),this.updateZoomButtons(),this.zn.zoom(this.scale,this.zoomTransition)}},{key:"zoomOutFunction",value:function(){this.scale-=.5,this.scale<ZOOM_MIN&&(this.scale=ZOOM_MIN),this.updateZoomButtons(),this.zn.zoom(this.scale,this.zoomTransition)}},{key:"updateButton",value:function(e,t){console.log(this.scale),this.scale==t?e.setAttribute("disabled",""):e.removeAttribute("disabled")}},{key:"updateZoomButtons",value:function(){this.updateButton(this.zoomInBtn,ZOOM_MAX),this.updateButton(this.zoomOutBtn,ZOOM_MIN)}},{key:"destroyZoom",value:function(){this.zn&&(this.zn.destroy(),this.scale=1,this.updateZoomButtons()),Utils.blockPageScroll(!1),$("#slide-zoom").slick("unslick"),$("#modal-zoom").modal("hide")}}],[{key:"handleShopButtons",value:function(){if($(".add-to-cart-btn--sticky-bar:visible").length>0&&0==$("body.giftcard").length){var e=$(".add-to-cart-btn--sticky-bar").outerHeight(),t=$(".add-to-cart-btn--sticky-bar").offset().top+e,i=$(".footer").offset().top,n=$(".header-wrapper").outerHeight();$(window).on("scroll",function(){if($(".product--info-area").css("padding-bottom",e+"px"),$(".header--sticky").hasClass("temp-hidden"))var s=$(window).scrollTop();else s=$(window).scrollTop()+n;var a=$(window).scrollTop()+$(window).height();i=$(".footer").offset().top,s>=t?a>=i?($(".add-to-cart-btn--sticky-bar").hasClass("sticky")||$(".add-to-cart-btn--sticky-bar").hasClass("sticky-ing"))&&($(".add-to-cart-btn--sticky-bar").parent().hasClass("add-to-cart-btn--wrapper")&&$(".add-to-cart-btn--sticky-bar").prependTo(".product--info-area"),$(".product--info-area").hasClass("position-relative")||$(".product--info-area").addClass("position-relative"),$(".add-to-cart-btn--sticky-bar").removeClass("sticky"),$(".add-to-cart-btn--sticky-bar").removeClass("sticky-ing"),$(".add-to-cart-btn--sticky-bar").hasClass("absolute")||$(".add-to-cart-btn--sticky-bar").addClass("absolute")):($(".add-to-cart-btn--sticky-bar").parent().hasClass("add-to-cart-btn--wrapper")&&$(".add-to-cart-btn--sticky-bar").prependTo(".product--info-area"),$(".add-to-cart-btn--sticky-bar").hasClass("sticky-ing")||$(".add-to-cart-btn--sticky-bar").addClass("sticky-ing"),$(".add-to-cart-btn--sticky-bar").hasClass("sticky")||($(".add-to-cart-btn--sticky-bar").hasClass("absolute")?($(".add-to-cart-btn--sticky-bar").addClass("sticky"),$(".add-to-cart-btn--sticky-bar").removeClass("absolute")):setTimeout(function(){$(".add-to-cart-btn--sticky-bar").addClass("sticky")},0)),$(".add-to-cart-btn--wrapper").css("height",e+"px")):($(".add-to-cart-btn--sticky-bar").hasClass("sticky")||$(".add-to-cart-btn--sticky-bar").hasClass("sticky-ing"))&&($(".add-to-cart-btn--sticky-bar").removeClass("sticky"),$(".add-to-cart-btn--sticky-bar").hasClass("sticky-ing")&&setTimeout(function(){$(".add-to-cart-btn--sticky-bar").removeClass("sticky-ing"),$(".add-to-cart-btn--sticky-bar").prependTo(".add-to-cart-btn--wrapper")},100))})}}},{key:"showCtaOnStock",value:function(e){if(e&&$(e).length){var t=$("#oos-wrapper, #disco-wrapper, #available-wrapper");t.addClass("d-none"),e.removeClass("d-none"),t.not(e).remove()}}},{key:"fetchCustInvSuccessSize",value:function(e,t){if(e.errorCode||e.errorMessage)console.warn("AjaxCatalogEntryInventory",e.errorMessage,e.errorCode);else if(e.hasOwnProperty("partNumber")&&(e.hasOwnProperty("quantity")||e.hasOwnProperty("active"))){var i=e;i.quantity>0||(1===i.active?$('#fit-size-select button[data-upc="'+e.partNumber+'"]').addClass("js-gr-oos"):0===i.active&&$('#fit-size-select button[data-upc="'+e.partNumber+'"]').addClass("js-gr-oos"))}}},{key:"fetchCustInvErr",value:function(t,i,n){console.warn("AjaxCatalogEntryInventory",n),e.showCtaOnStock($("#available-wrapper")),$("#analyticsPDPAvailable").val("Available"),e.handleShopButtons()}}]),e}();function ajaxPageLoad(e,t){var i={elements:[],preserveChildElements:[],texts:[],attributes:{},changeHistory:!0,onLoad:function(){}};i=$.extend(i,t),$.ajax({cache:!0,url:e,type:"GET",dataType:"html",beforeSend:function(){window.pdpAjaxReqStarted=!0},success:function(t){var n=$(t),s=$("body");if(i.changeHistory){var a=n.filter("title").text();history.replaceState(function(e){var t,i=0;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i}(e),a,e),document.title=a}for(var r in i.elements){var o=i.elements[r],l=$(o,n),d=$(o,s),c=[];for(var u in i.preserveChildElements){var p=i.preserveChildElements[u];d.children(p).length&&(c.push(p),l.children(p).length&&l.children(p).replaceWith(d.children(p).clone()))}if(c.length){var h=d.children(),f=l.children();c.forEach(function(e,t,i){h=h.not(e),f=f.not(e)}),$(h).each(function(e,t){$(this).remove()}),$(f).each(function(e,t){d.append($(this))})}else l.length?$(o,s).replaceWith(l):d.remove()}"function"==typeof i.onLoad&&i.onLoad()}})}function ajaxPageLoad_caller(e){if(window.pdpAjaxReqStacked=e||"",!window.pdpAjaxReqStarted){ajaxPageLoad(e,{elements:['[data-slot-id="2"]','[data-slot-id="3"]','[data-slot-id="4"]',"#accordion","#pdp-info-container"],preserveChildElements:["#virtual-mirror-wrapper","#modal-vm-policy","#modal-vm-snap"],texts:[],attributes:{},changeHistory:!0,onLoad:function(){"undefined"!=typeof currentMobileSpritespin&&null!==currentMobileSpritespin&&currentMobileSpritespin.length>0&&currentMobileSpritespin.spritespin("destroy"),$('[data-toggle="hybridSelect"]').hybridSelect(),window.pdp.reload(),window.sizingAndFit=new SizingAndFit,window.pdpAjaxReqStarted=!1,window.pdpAjaxReqStacked=window.pdpAjaxReqStacked.replace(e,""),$(document).trigger("pdp:ajax-reloaded")}})}}function attachAjaxLoadEvent(e){$(document).off("pdp:ajax-reloaded").on("pdp:ajax-reloaded",function(){$("#virtual-mirror-wrapper").trigger("pdp:vm:ajax-reloaded"),setTimeout(function(){$(".slick-initialized").slick("reinit")},500),window.pdpAjaxReqStacked&&window.pdpAjaxReqStacked.length&&!window.pdpAjaxReqStarted?(ajaxPageLoad_caller(window.pdpAjaxReqStacked),window.pdpAjaxReqStacked=""):e.colorSelectors.find(".js-gr-loading").removeClass("js-gr-loading")}),$("[data-slot-id='4'] .ajaxReload li:not('.isCurrent') a").on("click",function(e){$(this).hasClass("dropdown-item")||($(this).closest("li").closest("ul").find("li").removeClass("js-gr-loading"),$(this).closest("li").addClass("js-gr-loading"),ajaxPageLoad_caller(this.href)),e.preventDefault()}),$("[data-slot-id='4'] .ajaxReload #fit-size-select button").not(".isCurrent").click(function(e){ajaxPageLoad_caller($(this).data("url")),e.preventDefault()}),$("[data-slot-id='3']").on("afterChange",".ajaxReload#virtual-mirror-variants",function(e,t,i){var n=$(t.$slides.get(i)),s=n.find(".variant-slide").data("upc"),a=n.find(".variant-slide").data("url");s!=($("#image_partn").val()||$("#analyticsPDPUpc").val()||$("[data-analytics-upc]").data("analytics-upc"))&&(ajaxPageLoad_caller(a),e.preventDefault())})}_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PLP=function(){function e(){var t=this;if(_classCallCheck(this,e),0!==$("#products-listing-list").length){this.productListingList=$("#products-listing-list"),this.sortFilterEle=$(".sort-filter-mb"),this.headerSticky=$(".header--sticky"),this.placeholder=$(".sort-filter-mb--pos-placeholder"),this.btnLoadMore=$("#btn-show-more"),this.spinner=$("#load-more-product-spinner");var i=$(window).scrollTop(),n="down";$(window).scroll(function(){n=$(window).scrollTop()>i?"down":"up",i=$(window).scrollTop(),"down"===n?t.destroyFixPos():i<t.placeholder.offset().top-t.headerSticky.height()?t.destroyFixPos():t.initFixPos()})}}return _createClass(e,[{key:"initFixPos",value:function(){this.sortFilterEle.addClass("sticky")}},{key:"destroyFixPos",value:function(){this.sortFilterEle.removeClass("sticky")}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PrescriptionLeadTime=function(){function e(){if(_classCallCheck(this,e),$(".main-container .product--info-area.contact-lenses").length){var t=this;$(document).on("change",".prescription-table select",function(e){var i=$(this).attr("name");t.checkInput(-1!==i.indexOf("right")?"right":"left")})}}return _createClass(e,[{key:"showMessage",value:function(e){$("#cl-combination-error-leadtime-message").html(e),$(".cl-combination-error-leadtime").show()}},{key:"clearMessage",value:function(){$("#cl-combination-error-leadtime-message").html(""),$(".cl-combination-error-leadtime").hide()}},{key:"checkInput",value:function(e){var t=this,i="select#"+e,n=$(i+"-boxes").val(),s=parseInt(n);if(isNaN(s)||s<1)return t.clearMessage(),!1;var a=$(i+"-power").val(),r=$(i+"-bc").val(),o=$(i+"-dia").val(),l=$(i+"-cyl").val(),d=$(i+"-axis").val(),c=$(i+"-add").val(),u=$(i+"-color").val(),p={productId:$("#parentCatentryIdforLens").val(),storeId:WCParamJS.storeId,langId:WCParamJS.langId},h=!0;void 0!==a&&(p.spherePower=a,null===a&&(h=!1)),void 0!==r&&(p.baseCurve=r,null===r&&(h=!1)),void 0!==o&&(p.diameter=o,null===o&&(h=!1)),void 0!==l&&(p.cylinder=l,null===l&&(h=!1)),void 0!==d&&(p.axis=d,null===d&&(h=!1)),void 0!==c&&(p.addPower=c,null===c&&(h=!1)),void 0!==u&&(p.tintColor=u,null===u&&(h=!1)),h?(t.clearMessage(),$.ajax({url:"/AjaxPrescriptionLeadTime",data:p,cache:!0,success:function(e){var i=e.isLeadtime;if(null!==e&&!0===i){var n="Sorry, this product has a longer lead time than usual. <span class='font-weight-bold'>"+e.message+".</span>";t.showMessage(n)}else t.clearMessage()},error:function(){t.clearMessage()}})):t.clearMessage()}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var boxesLeftTxt=void 0,powerLeftTxt=void 0,bcLeftTxt=void 0,diaLeftTxt=void 0,cylLeftTxt=void 0,axisLeftTxt=void 0,addLeftTxt=void 0,colorLeftTxt=void 0,boxesRightTxt=void 0,powerRightTxt=void 0,bcRightTxt=void 0,diaRightTxt=void 0,cylRightTxt=void 0,axisRightTxt=void 0,addRightTxt=void 0,colorRightTxt=void 0,notSelectedValue=void 0;"undefined"!=typeof isAddPrescrPage&&!0===isAddPrescrPage?(boxesLeftTxt="notdefined",powerLeftTxt="cl-os-sphere",bcLeftTxt="cl-os-bc",diaLeftTxt="cl-os-dia",cylLeftTxt="cl-os-cyl",axisLeftTxt="cl-os-axis",addLeftTxt="cl-os-add",colorLeftTxt="cl-os-color",boxesRightTxt="notdefined",powerRightTxt="cl-od-sphere",bcRightTxt="cl-od-bc",diaRightTxt="cl-od-dia",cylRightTxt="cl-od-cyl",axisRightTxt="cl-od-axis",addRightTxt="cl-od-add",colorRightTxt="cl-od-color",notSelectedValue="0"):(boxesLeftTxt="left-boxes",powerLeftTxt="left-power",bcLeftTxt="left-bc",diaLeftTxt="left-dia",cylLeftTxt="left-cyl",axisLeftTxt="left-axis",addLeftTxt="left-add",colorLeftTxt="left-color",boxesRightTxt="right-boxes",powerRightTxt="right-power",bcRightTxt="right-bc",diaRightTxt="right-dia",cylRightTxt="right-cyl",axisRightTxt="right-axis",addRightTxt="right-add",colorRightTxt="right-color",notSelectedValue=null);var issueDateTxt="start-date",expiryDateTxt="expiry-date",BOXES="boxes",POWER="power",BC="baseCurve",DIA="dia",CYL="cyl",AXIS="axis",ADD="add",COLOR="color",classShowList="dropdown--prescription-show",classShowBtn="dropdown--prescription-showBtn",state=1,firstLoadPage=!1,newPrescription=!1,dataPrescriptions=null,isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},renderVal=function(e,t){if(""!==t){if(e.is("select")){var i=e.find('option[value="'+t+'"]');if(!i.length&&opsm.utils.isInt(t)&&(i=e.find('option[value="'+parseFloat(t).toFixed(2)+'"]').length?e.find('option[value="'+parseFloat(t).toFixed(2)+'"]'):e.find('option[value="'+parseFloat(t).toFixed()+'"]')),!i.length&&!isNaN(t)){var n=parseFloat(t);e.find("option").each(function(){isNaN($(this).attr("value"))||parseFloat($(this).attr("value"))!=n||(i=$(this))})}i.length&&i.prop("selected",!0)}e.trigger("change")}},checkVal=function(e,t){if(""!==t){if(e.is("select")){var i=0===e.find('option[value="'+t+'"]').length;if(!0===i&&opsm.utils.isInt(t)&&(i=0===e.find('option[value="'+parseFloat(t).toFixed(2)+'"]').length&&0===e.find('option[value="'+parseFloat(t).toFixed()+'"]').length),!0===i&&!isNaN(t)){var n=parseFloat(t);e.find("option").each(function(){isNaN($(this).attr("value"))||(i=parseFloat($(this).attr("value"))!=n&&i)})}return i}if(e.is("input")){var s=e.val()!==t;return!0!==s||isNaN(t)||isNaN(e.val())||(s=parseFloat(t)!=parseFloat(e.val())),s}return!0}return!1},checkApplyData=function(e,t){var i=t.boxesLeft,n=t.powerLeft,s=t.bcLeft,a=t.diaLeft,r=t.cylLeft,o=t.axisLeft,l=t.addLeft,d=t.colorLeft,c=t.boxesRight,u=t.powerRight,p=t.bcRight,h=t.diaRight,f=t.cylRight,g=t.axisRight,m=t.addRight,v=t.colorRight;for(var b in e){var y=!1;if(b==BOXES||b==POWER||b==BC||b==DIA||b==CYL||b==AXIS||b==ADD||b==COLOR){var $=_slicedToArray(e[b],2),C=$[0],w=$[1];switch(b){case"expiryDate":case"expired":break;case BOXES:(y=checkVal(i,C))||(y=checkVal(c,w));break;case POWER:(y=checkVal(n,C))||(y=checkVal(u,w));break;case BC:(y=checkVal(s,C))||(y=checkVal(p,w));break;case DIA:(y=checkVal(a,C))||(y=checkVal(h,w));break;case CYL:(y=checkVal(r,C))||(y=checkVal(f,w));break;case AXIS:(y=checkVal(o,C))||(y=checkVal(g,w));break;case ADD:(y=checkVal(l,C))||(y=checkVal(m,w));break;case COLOR:(y=checkVal(d,C))||(y=checkVal(v,w))}}if(y)return!1}return!0},applyData=function(e,t){var i=t.boxesLeft,n=t.powerLeft,s=t.bcLeft,a=t.diaLeft,r=t.cylLeft,o=t.axisLeft,l=t.addLeft,d=t.colorLeft,c=t.boxesRight,u=t.powerRight,p=t.bcRight,h=t.diaRight,f=t.cylRight,g=t.axisRight,m=t.addRight,v=t.colorRight,b=t.issueDate,y=t.expiryDate;for(var $ in e)if($==BOXES||$==POWER||$==BC||$==DIA||$==CYL||$==AXIS||$==ADD||$==COLOR){var C=_slicedToArray(e[$],2),w=C[0],S=C[1];switch($){case BOXES:renderVal(i,w),renderVal(c,S);break;case POWER:renderVal(n,w),renderVal(u,S);break;case BC:renderVal(s,w),renderVal(p,S);break;case DIA:renderVal(a,w),renderVal(h,S);break;case CYL:renderVal(r,w),renderVal(f,S);break;case AXIS:renderVal(o,w),renderVal(g,S);break;case ADD:renderVal(l,w),renderVal(m,S);break;case COLOR:renderVal(d,w),renderVal(v,S)}}b.val(e.issueDate),y.val(e.expiryDate)},renderInsertNewPrescription=function(){var e=window.prescriptionS3B,t=[e.powerLeft,e.cylLeft,e.axisLeft,e.powerRight,e.cylRight,e.axisRight];$("#same-on-both").prop("checked",!1).attr("disabled",null),$("#prescription-step-1 select option").prop("selected",!1).removeAttr("selected"),$("#prescription-step-1 select").val("-").change(),$("#prescription-step-1 .required").removeClass("error"),t.forEach(function(e){var t=$(e.siblings("button"));e.attr("disabled",!1),t.attr("disabled",!1),t.removeClass("prescription-btn-disabled"),$(t.children(".icon")).css("display","block")}),$("#start-date").attr("disabled",!1),$("#start-date").removeClass("prescription-disabled"),$("#start-date").val(""),$("#expiry-date").attr("disabled",!1),$("#expiry-date").removeClass("prescription-disabled"),$("#expiry-date").val(""),$(e.boxesLeft).val("1").change(),$(e.boxesRight).val("1").change()},selectPrescriptionPDP=function(e){if("undefined"===e&&(e=void 0),void 0===$(e).attr("disabled")||!1===$(e).attr("disabled")){$("#prescription-added-msg").hide(),$("#prescription-not-valid-msg").hide(),$(".prescription-list").find(".single-prescription.selected").removeClass("selected"),$(e).addClass("selected");var t=$(e).find('input[name="presNumber"]').val();handleData(dataPrescriptions,t)}},handleData=function(e,t){var i=null;firstLoadPage=!1,state=2,e.forEach(function(e){t===e.id&&(i=e)}),$("#prescription-not-valid-msg").hide();var n=window.prescriptionS3B,s=n.boxesLeft,a=n.boxesRight,r=n.powerLeft,o=n.cylLeft,l=n.axisLeft,d=n.addLeft,c=n.bcLeft,u=n.diaLeft,p=n.powerRight,h=n.cylRight,f=n.axisRight,g=n.addRight,m=n.bcRight,v=n.diaRight;if(isEmpty(i))renderInsertNewPrescription();else{renderInsertNewPrescription();var b=[r,o,l,d,c,u,p,h,f,g,m,v],y=[s,a];checkApplyData(i,n)?(applyData(i,n),b.forEach(function(e){var t=$(e.siblings("button"));e.attr("disabled",!0),t.attr("disabled",!0),t.addClass("prescription-btn-disabled"),$(t.children(".icon")).css("display","none")}),y.forEach(function(e){if("0"==e.val()){var t=$(e.siblings("button"));e.attr("disabled",!0),t.attr("disabled",!0),t.addClass("prescription-btn-disabled"),$(t.children(".icon")).css("display","none")}}),$("#start-date").attr("disabled","disabled"),$("#start-date").addClass("prescription-disabled"),$("#expiry-date").attr("disabled","disabled"),$("#expiry-date").addClass("prescription-disabled"),$("#same-on-both").prop("checked",!1).attr("disabled","disabled"),$("#prescription-added-msg").show()):$("#prescription-not-valid-msg").show()}window.prescription.updateBtnCartValue()},inititalValidateField=function(){},startValidate=function(e){var t=e.val(),i=e.attr("id"),n=i+"-error",s=document.createElement("label");s.className="error invalid-feedback",s.id=n,s.htmlFor=i;var a=$(e).closest(".form-group.required.opsm-form-group"),r=a.find(".dropdown.form-control"),o=e.siblings("#"+n).length;0===o&&r.append(s);var l=function(){$(r).find(".error.invalid-feedback").text(""),s.style.display="none",a.removeClass("error").addClass("valid")};"-"===t?($(r).find(".error.invalid-feedback").text("Required field"),s.style.display="block",a.addClass("error")):l(),0===o&&(firstLoadPage=!0),(0===o||!state&&!newPrescription)&&l()},PrescriptionS3B=function(){function e(){_classCallCheck(this,e),this.userPrescription=$(".prescription-list"),this.skipUnmatchedPresc=this.userPrescription.hasClass("js-fn-skip-unmatch-pres"),this.prescription=$(".product--prescription"),this.isFavPage=!1,"undefined"!=typeof isFavoritePage&&!0===isFavoritePage&&(this.isFavPage=!0,this.prescription=$(".product--modal-prescription")),this.isAddPage=!1,"undefined"!=typeof isAddPrescrPage&&!0===isAddPrescrPage&&(this.isAddPage=!0,this.prescription=$(".rx_form_cl .my-account-prescriptions-add-eyes")),this.boxesLeft=this.prescription.find("#"+boxesLeftTxt),this.powerLeft=this.prescription.find("#"+powerLeftTxt),this.bcLeft=this.prescription.find("#"+bcLeftTxt),this.diaLeft=this.prescription.find("#"+diaLeftTxt),this.cylLeft=this.prescription.find("#"+cylLeftTxt),this.axisLeft=this.prescription.find("#"+axisLeftTxt),this.addLeft=this.prescription.find("#"+addLeftTxt),this.colorLeft=this.prescription.find("#"+colorLeftTxt),this.boxesRight=this.prescription.find("#"+boxesRightTxt),this.powerRight=this.prescription.find("#"+powerRightTxt),this.bcRight=this.prescription.find("#"+bcRightTxt),this.diaRight=this.prescription.find("#"+diaRightTxt),this.cylRight=this.prescription.find("#"+cylRightTxt),this.axisRight=this.prescription.find("#"+axisRightTxt),this.addRight=this.prescription.find("#"+addRightTxt),this.colorRight=this.prescription.find("#"+colorRightTxt),this.issueDate=this.prescription.find("#"+issueDateTxt),this.expiryDate=this.prescription.find("#"+expiryDateTxt),this.scrollToError(),this.prescription.on("click",".product--prescription-slider-item",function(e){if(void 0===$(this).parent().attr("disabled")||!1===$(this).parent().attr("disabled")){var t="product--prescription-slider-item-selected";$("body").find("."+t).removeClass(t),$(this).addClass(t);var i=$(e.target).closest(".product--prescription-slider-nav-item").find(".product--prescription-slider-item-title").attr("data-prescription-id");handleData(dataPrescriptions,i)}}),this.prescription.on("click",".dropdown--component",function(){if(void 0===$(this).attr("disabled")||!1===$(this).attr("disabled")){var e=$(".dropdown--prescription-btn"),t=$(".dropdown--prescription-list"),i=$(this).find(".dropdown--component-title"),n=$(i).attr("data-prescription-id"),s=$(i).text();e.removeClass("dropdown--prescription-showBtn"),e.text(n&&n.length>0?s:"Enter new prescription"),t.removeClass("dropdown--prescription-show"),handleData(dataPrescriptions,n)}}),this.initialLoad()}return _createClass(e,[{key:"handleClass",value:function(e,t){$(t).hasClass(classShowList)?($(e).removeClass(classShowBtn),t.removeClass(classShowList)):($(e).addClass(classShowBtn),$(t).addClass(classShowList))}},{key:"nonCheckedEyes",value:function(e){var t=window.prescriptionS3B.boxesRight;e.forEach(function(e){switch(e.attr("disabled",!1),!0){case firstLoadPage:case!state:$(e.siblings()[0]).attr("disabled",!1);break;default:e===t&&$(e.siblings()[0]).attr("disabled",!1)}})}},{key:"calculateExistingPrescription",value:function(){var e=this,t=[];return $(".existing-prescription").each(function(){var i={},n=$(this);i.id=n.find("input[name=presNumber]").val();var s=n.find("input[name=optomName]").val();""===s&&(s="Prescription"),i.title=s,i.expired=n.find("input[name=expired]").val(),i.issueDate=n.find("input[name=issueDate]").val(),i.expiryDate=n.find("input[name=expiryDate]").val(),i.boxes=[n.find("input[name=leftLensQuantity]").val(),n.find("input[name=rightLensQuantity]").val()],i.power=[n.find("input[name=leftLensPower]").val(),n.find("input[name=rightLensPower]").val()],i.baseCurve=[n.find("input[name=leftLensBaseCurve]").val(),n.find("input[name=rightLensBaseCurve]").val()],i.dia=[n.find("input[name=leftLensDiameter]").val(),n.find("input[name=rightLensDiameter]").val()],i.cyl=[n.find("input[name=leftLensCylinder]").val(),n.find("input[name=rightLensCylinder]").val()],i.axis=[n.find("input[name=leftLensAxis]").val(),n.find("input[name=rightLensAxis]").val()],i.add=[n.find("input[name=leftLensAdd]").val(),n.find("input[name=rightLensAdd]").val()],i.color=[n.find("input[name=leftLensColor]").val(),n.find("input[name=rightLensColor]").val()],e.skipUnmatchedPresc&&!checkApplyData(i,e)?e.discardPrescription(n):t.push(i)}),t}},{key:"discardPrescription",value:function(e){if(void 0!==e&&$(e).length)if(e.closest(".slick-initialized").length){var t=e.closest(".slick-initialized"),i=e.closest(".slick-slide");isNaN(i.attr("data-slick-index"))||t.slick("slickRemove",parseInt(i.attr("data-slick-index")))}else e.closest("[data-prescription-id]").length&&e.closest("[data-prescription-id]").remove()}},{key:"initialLoad",value:function(){var e=this;if(dataPrescriptions=this.calculateExistingPrescription(),$("#user-prescr-wrapper .prescription-list [data-prescription-id]").length>1&&$("#user-prescr-wrapper .prescription-list.js-gr-slide-cust").length&&($("#user-prescr-wrapper .prescription-list-wrapper").addClass("slick-mode"),$("#user-prescr-wrapper .prescription-list").removeClass("d-grid col-2-grid").slick({slidesToShow:2,slidesToScroll:2,infinite:!1,dots:!0,arrows:!1})),this.isFavPage){this.buildListExistingPrescription(dataPrescriptions);var t=$(".dropdown--prescription-btn"),i=$(".dropdown--prescription-list");$(t).on("click",function(n){n.stopPropagation(),e.handleClass(t,i)}).stop(),$("body").click(function(e){!$(e.target).parents().is(".dropdown-prescription")&&$(i).hasClass(classShowList)&&($(t).removeClass(classShowBtn),$(i).removeClass(classShowList))})}[this.powerLeft,this.powerRight].forEach(function(e){e.data("wrapper-class")&&-1!=e.data("wrapper-class").indexOf("native-select")&&(Utils.moveDefaultOptionBefore(e,"0.00"),Utils.scrollToSelectedOptionOnOpen(e))},this),this.showSelectOrDropdownOnly()}},{key:"showSelectOrDropdownOnly",value:function(){window.prescriptionS3B;var e=[this.boxesLeft,this.powerLeft,this.bcLeft,this.diaLeft,this.cylLeft,this.axisLeft,this.addLeft,this.colorLeft,this.boxesRight,this.powerRight,this.bcRight,this.diaRight,this.cylRight,this.axisRight,this.addRight,this.colorRight];Utils.isNotDesktopDevice()&&($(document).ready(function(){e.forEach(function(e){e.is("select")&&$(e.siblings(".dropdown-menu")).css("visibility","hidden")})}),e.forEach(function(e){$(e.siblings("button[data-toggle='dropdown']")).children(".icon").click(!1)}))}},{key:"buildListExistingPrescription",value:function(e){var t=$(".product--prescription-existing");if(Array.isArray(e)&&e.length>0){var i="",n="";e.forEach(function(e){var t=e.id,s=e.title,a=e.issueDate,r=e.expiryDate,o=e.baseCurve,l=e.power,d="";""!==o[0]&&""!==o[1]&&(d="<li>Base Curve: "+o[0]+", "+o[1]+"</li>");var c="";""!==l[0]&&""!==l[1]&&(c="<li>Power: "+l[0]+", "+l[1]+"</li>");var u='<small class="ml-0 product--prescription--existing-issue">Issued '+a+"</small>",p='<span class="dropdown--component-issue">Issued '+a+"</span>",h="";"true"===e.expired&&(h='disabled="disabled"',u='<small class="ml-0 product--prescription--existing-issue">Expired '+r+"</small>",p='<span class="dropdown--component-issue">Expired '+r+"</span>"),i+='\n              <div class="item product--prescription-slider-nav-item" '+h+'>\n                <div class="product--prescription-slider-item">\n                    <h5 class="product--prescription-slider-item-title" data-prescription-id="'+t+'">'+s+"</h5>\n                    "+u+'\n                    <ul class="list-unstyled m-0 prescription--existing-info">\n                        '+d+"\n                        "+c+"\n                    </ul>\n                </div>\n            </div>\n           ",n+='\n            <li class="dropdown--component" '+h+'>\n                <h4 class="dropdown--component-title" data-prescription-id="'+t+'">'+s+"</h4>\n                "+p+'\n                <div class="dropdown--component-info"><span>Base Curve:</span><span>'+o[0]+", "+o[1]+'</span></div>\n                <div class="dropdown--component-info"><span>Power:</span><span>'+l[0]+", "+l[1]+"</span></div>\n            </li>\n          "});var s='<div class="product--prescription-exist-box-tb dropdown-prescription">\n        <button class="dropdown--prescription-btn">Enter new prescription</button>\n        <ul class="dropdown--prescription-list">\n        \t<li class="dropdown--prescription-name dropdown--component"> Enter new prescription</li>\n            '+n+'\n        </ul>\n     </div>\n    <div class="product--prescription-exist-box mt-4">\n        <div class="product--prescription-slider-nav-wrapper">\n        \t<div class="product--prescription-slider-nav">\n\t\t\t    <div class="item product--prescription-slider-nav-item">\n\t\t\t        <div class="product--prescription-slider-item product--prescription-slider-item-selected text-center">\n\t\t\t\t        <div class="product--prescription-add-item mt-4">+</div>\n\t\t\t\t        <h5 class="product--prescription-slider-item-title m-auto">Enter new prescription</h5>\n\t\t\t\t     </div>\n\t\t\t\t</div>\n                '+i+'\n            </div>\n        </div>\n    </div>\n    <div id="prescription-not-valid-msg" class="cannot-apply-existing-prescription" style="margin-top: 15px; display: none;">Cannot apply prescription: values don\'t match</div>';return $(t).append(s)}return $(t).append('\n        <div class="prescription--no-existing">You do not have any existing prescriptions from our OPSM stores.</div>\n      ')}},{key:"tabSlider",value:function(){var e=$(".product--prescription-slider-nav");this.isFavPage||e.data("slick")||e.not(".slick-initialized").slick({arrows:!0,speed:300,slidesToShow:2,slidesToScroll:1,variableWidth:!0,infinite:!1,responsive:[{breakpoint:1140,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:992,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:576,settings:{slidesToShow:2,slidesToScroll:1}}]})}},{key:"findFirstError",value:function(){return $("#left-boxes").length&&!$("#left-boxes").valid()?$("#left-boxes"):$("#left-power").length&&!$("#left-power").valid()?$("#left-power"):$("#left-bc").length&&!$("#left-bc").valid()?$("#left-bc"):$("#left-dia").length&&!$("#left-dia").valid()?$("#left-dia"):$("#left-cyl").length&&!$("#left-cyl").valid()?$("#left-cyl"):$("#left-axis").length&&!$("#left-axis").valid()?$("#left-axis"):$("#left-add").length&&!$("#left-add").valid()?$("#left-add"):$("#left-color").length&&!$("#left-color").valid()?$("#left-color"):$("#right-boxes").length&&!$("#right-boxes").valid()?$("#right-boxes"):$("#right-power").length&&!$("#right-power").valid()?$("#right-power"):$("#right-bc").length&&!$("#right-bc").valid()?$("#right-bc"):$("#right-dia").length&&!$("#right-dia").valid()?$("#right-dia"):$("#right-cyl").length&&!$("#right-cyl").valid()?$("#right-cyl"):$("#right-axis").length&&!$("#right-axis").valid()?$("#right-axis"):$("#right-add").length&&!$("#right-add").valid()?$("#right-add"):$("#right-color").length&&!$("#right-color").valid()?$("#right-color"):$("#start-date").length&&!$("#start-date").valid()?$("#start-date"):$("#expiry-date").length&&!$("#expiry-date").valid()?$("#expiry-date"):$("#prescription-valid").length&&!$("#prescription-valid").valid()?$("#prescription-valid"):null}},{key:"scrollToError",value:function(){var e=this;if($(".product--prescription").length){var t=void 0;$("#prescr-sel-pdp").click(function(){t&&clearTimeout(t);var i=e.findFirstError();if(void 0!==i&&null!=i){var n=$(i).parent().offset().top-$(window).height()/2;$([document.documentElement,document.body]).animate({scrollTop:n},200),$(".product--sidebar-col").getNiceScroll().doScrollPos(0,$(i).parent().position().top)}else $([document.documentElement,document.body]).animate({scrollTop:$(".product--prescription").offset().top},200),$(".product--sidebar-col").getNiceScroll().doScrollPos(0,$(".product--prescription").position().top);t=setTimeout(function(){var e=$(".header--sticky");$(e).addClass("temp-hidden").attr("data-aos","fade-up")},550)}).stop()}}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){var e=function(e){var t="select#"+e,i=$(t+"-boxes").val(),n=parseInt(i);if(isNaN(n)||n<1)return!0;var s=!0;if($(".prescription-"+e+" select").each(function(){null===$(this).val()&&(s=!1)}),!s)return!1;var a={productId:$("#parentCatentryIdforLens").val(),storeId:WCParamJS.storeId,langId:WCParamJS.langId},r=$(t+"-power").val(),o=$(t+"-bc").val(),l=$(t+"-dia").val(),d=$(t+"-cyl").val(),c=$(t+"-axis").val(),u=$(t+"-add").val(),p=$(t+"-color").val();return void 0!==r&&(a.spherePower=r),void 0!==o&&(a.baseCurve=o),void 0!==l&&(a.diameter=l),void 0!==d&&(a.cylinder=d),void 0!==c&&(a.axis=c),void 0!==u&&(a.addPower=u),void 0!==p&&(a.tintColor=p),$.ajax({url:"/AjaxPrescriptionValidator",data:a,cache:!0,async:!1,success:function(e){return s=e.isValidPrescription},error:function(){return s=!1,!1}}),s};$.validator.addMethod("bothClCombination",function(){return e("left")||e("right")},$.validator.format("Unfortunately both products are not available in the prescription that you have entered. Please check your prescription again or visit your local OPSM store.")),$.validator.addMethod("leftClCombination",function(){return e("left")},$.validator.format("Unfortunately the left-eye product is not available in the prescription that you have entered. Please check your prescription again or visit your local OPSM store")),$.validator.addMethod("rightClCombination",function(){return e("right")},$.validator.format("Unfortunately the right-eye product is not available in the prescription that you have entered. Please check your prescription again or visit your local OPSM store"))}();var Prescription=function(){function e(){var t=this;if(_classCallCheck(this,e),this.prescription=$(".product--prescription"),"undefined"!=typeof isFavoritePage&&!0===isFavoritePage&&(this.isFavPage=!0,this.prescription=$(".product--modal-prescription")),0!==this.prescription.length){if(this.purchaseTypeRadio=$('input[name="purchase-type"'),this.subscribeRadio=$("input#subscribe-now"),this.singlePurchaseRadio=$("input#one-off"),this.modalPrescription=$("#modal-prescription"),this.loggedInWrapper=this.prescription.find(".prescription--loggedin"),this.loggedInNotWrapper=this.prescription.find(".prescription--not-loggedin"),this.startDate=this.prescription.find("#start-date"),this.expiryDate=this.prescription.find("#expiry-date"),this.chbSameOnBoth=this.prescription.find(".prescription--same-on-both"),this.formStep1=this.prescription.find("#prescription-step-1"),this.step1=this.prescription.find(".prescription--step-1"),this.step2=this.prescription.find(".prescription--step-2"),this.btnBackStep1=this.prescription.find("#back-step-1"),this.existPresDropdownArea=this.prescription.find(".prescription--existing-pres-dropdown"),this.msgNoExistingPres=this.prescription.find(".prescription--no-existing"),this.prescrValidCheckbox=$("#prescription-valid"),this.isFavPage?(this.btnAddToCart=this.prescription.find("#add-to-cart-pdp"),this.btnAddPrescr=this.prescription.find(".prescription--add-prescription")):(this.btnAddToCart=$(".prescription--add-to-cart"),this.btnAddPrescr=$(".prescription--add-prescription")),this.existPrescriptionListMobile=this.prescription.find("#prescription-existing"),this.existPrescriptionListDesktop=this.prescription.find(".prescription--existing-pres-list"),this.bindInput(),this.bindSelectionHandler(),$("#right-boxes, #left-boxes").on("change",Subscription.updateLensOrderFrequency),this.modalPrescription.on("show.bs.modal",function(e){if(t.isFavPage){var i=$(".product--prescription-slider-nav");i.data("slick")||i.not(".slick-initialized").one("firstShown",function(e){$(this).on("init",function(){$(".product--prescription-slider-nav").on("wheel",{tabSliderNavEle:i},function(e){e.preventDefault();var t=e.data.tabSliderNavEle;e.originalEvent.deltaY>0?t.slick("slickNext"):t.slick("slickPrev")})}).slick({arrows:!1,dots:!0,speed:300,slidesToShow:3,slidesToScroll:1,vertical:!0,verticalSwiping:!0,verticalScrolling:!0,infinite:!1,responsive:[{breakpoint:1140,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:992,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:576,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:368,settings:{slidesToShow:1,slidesToScroll:1}}]})}),i.trigger("firstShown")}else window.user?t.loggedInNotWrapper.addClass("d-none"):t.loggedInWrapper.addClass("d-none");t.step1.removeClass("d-none"),t.step2.addClass("d-none")}),this.isFavPage&&$("input#singleCLProduct").length&&"false"===$("input#singleCLProduct").val()){var i=this;$(".opsm-modal-link.prescription-btn").off().on("click",window,function(e){e.stopImmediatePropagation();var t=$(this).data("prdid"),n=$(this).data("prdpn"),s=$(this).data("url");$("#contactLensPrice").remove(),$("#subscriptionPrice").remove(),i.prescription.append('<input type="hidden" id="subscriptionPrice" value="'+$(this).siblings("input#offerPriceString-"+$(this).data("id")).val()+'" />'),i.prescription.append('<input type="hidden" id="contactLensPrice" value="'+$(this).siblings("input#listPriceString-"+$(this).data("id")).val()+'" />'),$.ajax({url:s,data:{productId:t,partNumber:n,storeId:WCParamJS.storeId,langId:WCParamJS.langId,catalogId:WCParamJS.catalogId},success:i.handleAjaxModal,error:function(e,t,i){$(".product--modal-prescription:visible").modal("hide"),opsm.utils.showAlertError("Sorry some error occurred, try again later")}})})}if(this.formStep1.validate({ignore:[],rules:{"left-boxes":{notBothZero:"#right-boxes"},"left-power":{leftEyeSelected:!0},"left-bc":{leftEyeSelected:!0},"left-dia":{leftEyeSelected:!0},"left-cyl":{leftEyeSelected:!0},"left-axis":{leftEyeSelected:!0},"right-boxes":{notBothZero:"#left-boxes"},"right-power":{rightEyeSelected:!0},"right-bc":{rightEyeSelected:!0},"right-dia":{rightEyeSelected:!0},"right-cyl":{rightEyeSelected:!0},"right-axis":{rightEyeSelected:!0},"start-date":{required:function(){return $("#left-boxes").val()>0||$("#right-boxes").val()>0},DateFormatByMYIssueDate:!0,DateFormatMonthValidation:$("#month-valid-config").val()||12},"expiry-date":{DateFormatByMYExpiryDate:!0},bevalid:{bothClCombination:!0,leftClCombination:!0,rightClCombination:!0},"prescription-valid":{required:function(){return $("#left-boxes").val()>0||$("#right-boxes").val()>0}}},messages:{"left-boxes":{required:"Required field"},"left-power":{required:"Required field"},"left-bc":{required:"Required field"},"left-dia":{required:"Required field"},"left-cyl":{required:"Required field"},"left-axis":{required:"Required field"},"right-boxes":{required:"Required field"},"right-power":{required:"Required field"},"right-bc":{required:"Required field"},"right-dia":{required:"Required field"},"right-cyl":{required:"Required field"},"right-axis":{required:"Required field"},"start-date":{required:"Required field"},"prescription-valid":{required:"Please confirm your prescription is valid"}},errorPlacement:function(e,t){"bevalid"==t.attr("name")?(e.appendTo($(".cl-combination-error-placement")),$(".cl-combination-error-placement").show()):"prescription-valid"==t.attr("name")&&(e.addClass("red"),e.appendTo(t.closest(".form-group")))},highlight:function(e,t,i){$(e).closest(".form-group").addClass(t).removeClass(i)},unhighlight:function(e,t,i){$(e).closest(".form-group").removeClass(t).addClass(i)},submitHandler:function(e,t){opsm.product.addToCartContactLensAndTorics(e,t)}}),this.existPrescriptionListMobile.on("change",function(){var e=t.existPrescriptionListMobile.val();e?t.existPrescriptionListDesktop.find('input[type="radio"][value="'+e+'"]').prop("checked",!0):t.existPrescriptionListDesktop.find('input[type="radio"]').prop("checked",!1),t.selectPrescription(e)}),this.existPrescriptionListDesktop.on("change",'input[type="radio"]',function(e){var i=$(e.target).val();t.existPrescriptionListMobile.val(i).trigger("change"),t.selectPrescription(i)}),this.btnBackStep1.on("click",function(){t.step1.removeClass("d-none"),t.step2.addClass("d-none")}),this.isFavPage){var n=this;this.btnAddPrescr.off().on("click",function(e){$(this).hasClass("disabled")||(n.step2.find("table>tbody>tr").each(function(){var e=$(this);"-"===e.find("td a[id]").text()?e.hasClass("hide")||e.addClass("hide"):e.removeClass("hide")}),n.step1.toggleClass("d-none"),n.step2.toggleClass("d-none"))})}this.purchaseTypeRadio.on("change",function(e){"subscribe-now"==$(this).attr("id")?($(".product--after-pay").toggleClass("d-none",e.target.checked),$("#js-sub-price-div").toggleClass("d-none",!e.target.checked),$("#js-nosub-price-div").toggleClass("d-none",e.target.checked),this.subscribeRadio.prop("checked",this.subscribeRadio.is(":checked")),this.updateBtnCartValue()):($(".product--after-pay").toggleClass("d-none",!e.target.checked),$("#js-sub-price-div").toggleClass("d-none",e.target.checked),$("#js-nosub-price-div").toggleClass("d-none",!e.target.checked),this.singlePurchaseRadio.prop("checked",this.singlePurchaseRadio.is(":checked")),this.updateBtnCartValue())}),$(".product--modal-prescription:visible").length&&this.btnAddToCart.on("click",function(){$(".product--modal-prescription:visible").modal("hide")}),this.prescrValidCheckbox.on("change",function(e){t.updateBtnCartValue()}),this.updateBtnCartValue()}}return _createClass(e,[{key:"handleAjaxModal",value:function(t){$(t).find("form#prescription-step-1 .row.prescription-eye.prescription-left").length>0&&$(t).find("form#prescription-step-1 .row.prescription-eye.prescription-right").length>0?($(".product--modal-prescription").find("form#prescription-step-1 .row.prescription-eye.prescription-left").replaceWith($(t).find("form#prescription-step-1 .row.prescription-eye.prescription-left")),$(".product--modal-prescription").find("form#prescription-step-1 .row.prescription-eye.prescription-right").replaceWith($(t).find("form#prescription-step-1 .row.prescription-eye.prescription-right")),$(".product--prescription-existing.prescription--loggedin").find(".product--prescription-exist-box-tb.dropdown-prescription, .product--prescription-exist-box, .prescription--no-existing, #prescription-not-valid-msg").remove(),$('[data-toggle="hybridSelect"]').hybridSelect(),window.prescription=new e,window.prescriptionS3B=new PrescriptionS3B,$(".product--modal-prescription:hidden").modal()):($(".product--modal-prescription:visible").modal("hide"),opsm.utils.showAlertError("Sorry some error occurred, try again later"))}},{key:"bindInput",value:function(){$(".prescription .prescription--step-1 .opsm-form-group input.form-control-plaintext").each(function(){var e=$(this);$(".prescription .prescription--step-2 td+td#"+e.attr("id")+"-value").text(e.val())})}},{key:"bindSelectionHandler",value:function(){var e=this;$(e.prescription.find(".prescription--step-1 .opsm-form-control select")).add($(e.startDate)).add($(e.expiryDate)).each(function(){var t=$(this);$(t.attr("id")+"-value"),t.on("change",function(){t.closest(".opsm-form-group").removeClass("blue"),t.closest("form").attr("data-activated",!0);var i="#"+t.attr("id");if($(i+"-value").text(t.val()),e.chbSameOnBoth.is(":checked")&&i.indexOf("right")>-1&&($(i.replace("right","left")+"-value").val($(i+"-value").val()).trigger("change"),$(i.replace("right","left")).val($(i).val()).trigger("change")),i.endsWith("-boxes")){var n=parseInt($("#right-boxes").val())+parseInt($("#left-boxes").val());isNaN(n)||($(".box-counter-label").length?(1==n&&$(".box-counter-label").text("Box"),$(".box-counter").text(n)):1==n?$(".box-counter").text("1 Box"):$(".box-counter").text(n+" Boxes"))}else $(".cl-combination-error-placement").hide().empty();e.updateBtnCartValue()})});var t=this.prescription.find("#selected-expiry-value");this.expiryDate.on("change.datetimepicker",function(e){t.text(e.currentTarget.value)}),this.chbSameOnBoth.on("change",function(t){t.target.checked?($(e.prescription).find(".prescription--step-1 .opsm-form-control select[id*='left']").each(function(){var e="#"+$(this).attr("id");e.endsWith("-boxes")||$(e).val($(e.replace("left","right")).val()).trigger("change").hybridSelect("select").hybridSelect("disable")}),$(e.prescription).find(".prescription--step-1 input[id*='left']").each(function(){var e="#"+$(this).attr("id"),t=$(e).next();e.endsWith("-boxes")||$(t).attr("disabled","")}),$(e.prescription).find(".prescription--step-1 .left-title").addClass("disabled")):($(e.prescription).find(".prescription--step-1 .opsm-form-control select[id*='left']").each(function(){var e="#"+$(this).attr("id"),t=$(e.replace("left","right")).attr("disabled");if(void 0===t||!1===t){$(this).hybridSelect("enable",!0)}}),$(e.prescription).find(".prescription--step-1 input[id*='left']").each(function(){var e="#"+$(this).attr("id"),t=$(e).next();e.endsWith("-boxes")||$(t).removeAttr("disabled","")}),$(e.prescription).find(".prescription--step-1 .left-title").removeClass("disabled"))})}},{key:"updateBtnCartValue",value:function(){var e=this.prescription.find("#left-boxes"),t=this.prescription.find("#right-boxes"),i=this.prescription.find("#total-value"),n=parseFloat($("#contactLensPrice").val()),s=parseFloat($("#subscriptionPrice").val()),a=parseFloat($("#afterPayInstallm").val()),r=0;e.length&&e.val()&&(r+=parseInt(e.val(),10)),t.length&&t.val()&&(r+=parseInt(t.val(),10));var o=n*r,l=s*r,d=o/a,c=l/a;isNaN(o)||i.text("$"+o.toFixed(2)),isNaN(l)||this.isFavPage?!isNaN(l)&&this.isFavPage&&1==this.subscribeRadio.prop("checked")&&i.text("$"+l.toFixed(2)):(1==this.subscribeRadio.prop("checked")?$("span#js-afterpayPrice").text(c.toFixed(2)):$("span#js-afterpayPrice").text(d.toFixed(2)),$(".js-listPrice").text("$"+o.toFixed(2)),$(".js-offerPrice").text("$"+l.toFixed(2)));var u=!0;0==r&&(u=!1),e.val()>0&&$(this.prescription).find(".prescription--step-1 .prescription-eye.prescription-left .opsm-form-group .opsm-form-control select").each(function(){var e=$(this).val();null==e&&(u=!1)}),t.val()>0&&$(this.prescription).find(".prescription--step-1 .prescription-eye.prescription-right .opsm-form-group .opsm-form-control select").each(function(){var e=$(this).val();null==e&&(u=!1)});var p=$(this.startDate).val(),h=$(this.expiryDate).val();(null===p.match(/^(0[1-9]|1[012])[\/]\d{4}$/)||""!==h&&null===p.match(/^(0[1-9]|1[012])[\/]\d{4}$/))&&(u=!1),this.prescription.find("#prescription-valid").is(":checked")||(u=!1),this.isFavPage?u?this.btnAddPrescr.removeClass("disabled"):this.btnAddPrescr.addClass("disabled"):u?(this.btnAddToCart.removeClass("hide"),this.btnAddPrescr.addClass("hide")):(this.btnAddToCart.addClass("hide"),this.btnAddPrescr.removeClass("hide"))}},{key:"selectPrescription",value:function(e){var t=window.existingPrescription.filter(function(t){return t.id===e});if(t.length){var i=t[0],n=this.prescription.find("#left-bc"),s=this.prescription.find("#left-bc-value"),a=this.prescription.find("#left-power"),r=this.prescription.find("#left-power-value"),o=this.prescription.find("#right-bc"),l=this.prescription.find("#right-bc-value"),d=this.prescription.find("#right-power"),c=this.prescription.find("#right-power-value");n.length&&(n.val(i.baseCurve),n.trigger("change")),s.length&&s.text(i.baseCurve),a.length&&(a.val(i.power[0]),a.trigger("change")),r.length&&r.text(i.power[0]),o.length&&(o.val(i.baseCurve),o.trigger("change")),l.length&&l.text(i.baseCurve),d.length&&(d.val(i.power[1]),d.trigger("change")),c.length&&c.text(i.power[1])}}}]),e}(),AllSKUsMap=function(){function e(){_classCallCheck(this,e),this.skusMap={}}return _createClass(e,[{key:"addSku",value:function(e){this.skusMap[e.attributesString()]=e}},{key:"getSkuByCLProduct",value:function(e){return this.skusMap[e.attributesString()]}},{key:"getSkusByAttributes",value:function(e,t,i,n,s,a,r){return this.getSkuByCLProduct(new CLProduct(null,null,e,t,i,n,s,a,r))}}]),e}(),CLProduct=function(){function e(t,i,n,s,a,r,o,l,d){_classCallCheck(this,e),this.catentryId=t,this.partnumber=i,this.setSpherePower(n),this.setBaseCurve(s),this.setDiameter(a),this.setCylinder(r),this.setAxis(o),this.setAddPower(l),this.setTintColor(d)}return _createClass(e,[{key:"getSpherePower",value:function(){return this.spherePower}},{key:"setSpherePower",value:function(e){this.spherePower=this.normalizeNumber(e)}},{key:"getBaseCurve",value:function(){return this.baseCurve}},{key:"setBaseCurve",value:function(e){this.baseCurve=this.normalizeNumber(e)}},{key:"getDiameter",value:function(){return this.diameter}},{key:"setDiameter",value:function(e){this.diameter=this.normalizeNumber(e)}},{key:"getCylinder",value:function(){return this.cylinder}},{key:"setCylinder",value:function(e){this.cylinder=this.normalizeNumber(e)}},{key:"getAxis",value:function(){return this.axis}},{key:"setAxis",value:function(e){this.axis=this.normalizeNumber(e)}},{key:"getAddPower",value:function(){return this.addPower}},{key:"setAddPower",value:function(e){this.addPower=this.normalizeNumber(e)}},{key:"getTintColor",value:function(){return this.tintColor}},{key:"setTintColor",value:function(e){this.tintColor=this.normalizeString(e)}},{key:"getCatentryId",value:function(){return this.catentryId}},{key:"setCatentryId",value:function(e){this.catentryId=e}},{key:"getPartnumber",value:function(){return this.partnumber}},{key:"setPartnumber",value:function(e){this.partnumber=e}},{key:"normalizeNumber",value:function(e){if(!e)return"";var t=parseFloat(e);return isNaN(t)?"x":t}},{key:"normalizeString",value:function(e){return e?e.toLowerCase():""}},{key:"attributesString",value:function(){return[this.spherePower,this.baseCurve,this.diameter,this.cylinder,this.axis,this.addPower,this.tintColor].join("|")}},{key:"identifierString",value:function(){return[this.catentryId,this.partnumber].join("_")}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Product=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"changeProductColor",value:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.target).closest(".product--color-item");t.addClass("product--color-item--default").siblings(".product--color-item").removeClass("product--color-item--default");var i=t.closest(".product"),n=i.find(".product--primary-img"),s=i.find(".product--secondary-img"),a=t.data("product-primary-image"),r=t.data("product-secondary-image"),o=t.data("product-is-polarized"),l=t.data("product-disc-perc")||"",d=parseFloat(t.data("product-price")),c=parseFloat(t.data("product-listprice")),u=t.data("product-partnumber"),p=t.data("product-unique-id");n.find("img").attr({src:a.src}),s.length&&s.find("img").attr({src:r.src});var h=i.find(".product--polarised");"Y"===o?h.removeClass("d-none"):h.addClass("d-none"),i.find(".product--badge.ct_badge--discount").text(l.length?l+" off":"").toggleClass("d-none",0==l.length),d===c||isNaN(c)?i.find(".price-title").html("$"+d.toFixed(2)):i.find(".price-title").html('<span class="product--price product--price--old">$'+c.toFixed(2)+'</span><span class="product--price product--price--new">$'+d.toFixed(2)+"</span>");var f=i.attr("href");i.find(".product--color-item").each(function(){var e=$(this).data("product-partnumber");f=f.split(e).join(u)}),i.attr("href",f),i.find(".product--favourite").attr("rel",p),OPSMHeader.getFavList().indexOf(p)>-1?(i.find(".product--favourite").addClass("product--favourite--yes").find(".icon").addClass("icon-heart"),i.find(".product--favourite").removeClass("product--favourite--yes").find(".icon").removeClass("icon-heart-outline")):i.find(".product--favourite").removeClass("product--favourite--yes").find(".icon").removeClass("icon-heart")}},{key:"addToCart",value:function(e,t,i){$(".header--sticky.aos-init.aos-animate").removeClass("temp-hidden");var n=$(t.target).closest("a, button"),s=$("#btn-cart").find(".badge"),a=s.text()?parseInt(s.text(),10):0;n.find(".button--label");!1===n.is(".added")?s.text(a+e):s.text(a-1)}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ScrollSpalla=function(){function e(t,i,n){_classCallCheck(this,e);var s=this;function a(e){return e.length>0&&!e.hasClass("nofix")}this.binarioSelector=t,this.contenutoSelector=i,this.margins=n,this.$binario=$(t),this.$contenuto=$(i),a(this.$binario)&&a(this.$contenuto)&&setTimeout(function(){s.init()},100)}return _createClass(e,[{key:"init",value:function(){this.$binario.trigger("detach.ScrollToFixed");var e=this.$contenuto.offset().top+this.$contenuto.height()-this.$binario.height()-this.margins.top;e>0&&function(e,t,i){e.scrollToFixed({marginTop:t,limit:i,zIndex:1,postFixed:function(){e.addClass("resetLeft")},preFixed:function(){e.removeClass("resetLeft")}})}(this.$binario,this.margins.marginTop,e-this.margins.bottom)}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var SearchOverlay=function(){function e(){var t=this;_classCallCheck(this,e),this.articlesBlog=[],this.productListing,this.topSearches=[],this.storeId=$("#storeId").val(),this.catalogId=$("#catalogId").val(),this.langId=$("#langId").val(),this.waitTime=1e3,this.mapViewRequested={},this.showType=2,this.btnOpenSearch=$("#btn-search,#btn-search-mob"),this.searchOverlay=$("#search-overlay"),this.bodyHomePage=$("#body-home-page"),this.btnCloseSearch=this.searchOverlay.find("#search-overlay-close"),this.searchInput=this.searchOverlay.find("#search-input"),this.divPopularSearches=this.searchOverlay.find("#searches-found"),this.btnSearchSubmit=this.searchOverlay.find("#search-submit"),this.searchForm=this.searchOverlay.find("#searchForm"),this.formAction=this.searchOverlay.find("form#searchForm[action]").attr("action"),this.divSearchArticlesFound=this.searchOverlay.find("#search-result-article-blog"),this.labelSearchResult=this.searchOverlay.find("#search-result-label"),this.divPopularResults=this.searchOverlay.find("#popular-results-espot"),this.divSuggestedKeywords=this.searchOverlay.find("#suggested-keywords"),this.divSuggestedProductsLabel=this.searchOverlay.find("#search-result-label-products"),this.divSuggestedProducts=this.searchOverlay.find("#suggested-products-views"),this.divPopularResults.find("a").each(function(e,i){t.topSearches.push($(i).text())}),this.searchForm.on("submit",function(e){e.preventDefault(),$(this).children(":input#search-input").attr("disabled","disabled"),$(this).unbind("submit").submit()}),this.btnOpenSearch.on("click",function(){t.searchOverlay.fadeIn(),t.searchInput.focus(),t.bodyHomePage.css("overflow","hidden"),t.divPopularSearches.show(function(){t.showTopSearch()})}),this.btnCloseSearch.on("click",function(){t.bodyHomePage.css("overflow",""),t.closeSearchOvl()}),this.searchInput.on("input",function(){clearTimeout(t.currentWait),t.updateAction(),t.currentWait=setTimeout(function(){t.startRequestSearching()},t.waitTime)}),this.productNav=$("#search-result-product-nav"),this.articleNav=$("#search-result-article-nav"),this.productTab=$("#search-result-products"),this.articleTab=$("#search-result-articles"),this.articleTab.addClass("search--result-tab--disabled"),this.productNav.on("click",function(){t.articleNav.removeClass("search--result-sub-header--active"),t.productNav.addClass("search--result-sub-header--active"),t.articleTab.removeClass("search--result-tab--active").addClass("search--result-tab--inactive"),t.productTab.removeClass("search--result-tab--inactive").addClass("search--result-tab--active")}),this.articleNav.on("click",function(){t.productNav.removeClass("search--result-sub-header--active"),t.articleNav.addClass("search--result-sub-header--active"),t.articleTab.removeClass("search--result-tab--inactive").addClass("search--result-tab--active"),t.productTab.removeClass("search--result-tab--active").addClass("search--result-tab--inactive")}),this.handleIE()}return _createClass(e,[{key:"updateAction",value:function(){var e=this.searchInput.val().trim().replace(" ","+");this.searchForm.attr("action",this.formAction+e)}},{key:"startRequestSearching",value:function(){var e=this,t=""+this.searchInput.val().replace("-"," ").trim();t&&t.length>1&&new RegExp(t,"ig");-1!=t.indexOf("contact")&&(t="contact"),"lense"!=t&&"lens"!=t||(t="contact"),this.searchInput.val()?(this.btnSearchSubmit.removeClass("search--submit--disabled"),this.btnSearchSubmit.addClass("search--submit--enabled")):(this.btnSearchSubmit.removeClass("search--submit--enabled"),this.btnSearchSubmit.addClass("search--submit--disabled")),""!==t?this.requestSearching(t,function(){return e.renderResults()},function(){return e.showTopSearch}):this.showTopSearch()}},{key:"requestSearching",value:function(e,t,i){var n=this;if(this.keyword=e,this.startedReqKeywords=!0,this.startedReqProducts=!0,this.showType=2,$.ajax({url:"SearchAutoSuggestKeywordsJson",dataType:"json",aysnc:!1,data:{searchTerm:e,storeId:this.storeId,langId:this.langId,catalogId:this.catalogId},success:function(e){n.showType=n.showType/2,n.articlesBlog=e,n.startedReqKeywords=!1,"function"!=typeof t||n.startedReqProducts||t.call(n)},error:function(){try{utagFiller.asyncSendErrorEvolvedDetails("Unable to search for pages",null,"Client","Search")}catch(e){}"function"==typeof i&&i.call(n)}}),void 0!==this.mapViewRequested[e]&&null!==this.mapViewRequested[e]&&this.mapViewRequested[e]){var s=void 0;$(".suggested-products-view").each(function(){$(this).data("suggested-products-term")===e&&(s=$(this))}),void 0!==s&&0!==s.find(".product.card").length?(this.showType=0,t.call(this)):this.startedReqProducts=!1}else this.mapViewRequested[e]=!0,$.ajax({url:"SearchAutoSuggestProductsView",data:{searchTerm:e,storeId:this.storeId,langId:this.langId,catalogId:this.catalogId,reqType:"ajax"},type:"GET",success:function(i){n.showType=0,n.createViewWithProducts(e,i),n.startedReqProducts=!1;try{$(i).filter("title").text()&&-1!=$(i).filter("title").text().toLowerCase().indexOf("error")&&utagFiller.asyncSendErrorEvolvedDetails("Unable to search for products",null,"Client","Search")}catch(e){}"function"!=typeof t||n.startedReqKeywords||t.call(n)},error:function(){try{utagFiller.asyncSendErrorEvolvedDetails("Unable to search for products",null,"Client","Search")}catch(e){}n.mapViewRequested[e]=!1,"function"==typeof i&&i.call(n)}})}},{key:"renderResults",value:function(){switch(this.showType){case 0:this.showProductResults();break;case 1:this.showArticleResults();break;case 2:this.showTopSearch();break;default:this.showTopSearch()}}},{key:"createViewWithProducts",value:function(e,t){var i=this.divSuggestedProducts.find(".suggested-products-view"),n=void 0;i.each(function(){$(this).data("search-keyword")===e&&(n=$(this))}),null==n&&($("#suggested-products-views").append(t),0===$(t).filter(".row").find(".product.card").length&&(this.showType=2),$(".ghost-thumbnail").parent().addClass("d-none"))}},{key:"showProductResults",value:function(e){this.labelSearchResult.hide(),this.divPopularResults.hide(),this.divSuggestedKeywords.hide(),this.divSuggestedProductsLabel.show(),this.divSuggestedProducts.show(),this.divSuggestedProducts.find(".suggested-products-view").hide();var t=this.keyword;this.divSuggestedProducts.find(".suggested-products-view").each(function(){$(this).data("suggested-products-term")==t&&$(this).show()})}},{key:"showArticleResults",value:function(){if(this.articlesBlog.length>0){var e=[];this.articlesBlog.forEach(function(t){e.push(t.name)}),this.labelSearchResult.text("Suggested Articles"),this.labelSearchResult.show(),this.divPopularResults.hide(),this.divSuggestedKeywords.show(),this.divSuggestedKeywords.empty(),this.divSuggestedProductsLabel.hide(),this.divSuggestedProducts.hide();var t=$("<div></div>");if(e.length>0)e.slice(0,5).forEach(function(e){"string"==typeof e?t.append('<a href="#" class="list-group-item search--searches-found" data-search-term="'+e+'">'+e+"</a>"):t.append('<a href="#" class="list-group-item search--searches-found" data-search-term="'+e.title+'">'+e.title+"</a>")}),this.divSuggestedKeywords.append(t)}else this.showTopSearch()}},{key:"showTopSearch",value:function(){this.labelSearchResult.text("Popular searches"),this.labelSearchResult.show(),this.divPopularResults.show(),this.divSuggestedKeywords.hide(),this.divSuggestedProductsLabel.hide(),this.divSuggestedProducts.hide()}},{key:"getUrlOrigin",value:function(){return window.location.origin}},{key:"closeSearchOvl",value:function(){this.searchInput.val(""),this.searchOverlay.fadeOut()}},{key:"handleIE",value:function(){if(!Modernizr||!Modernizr.input||!Modernizr.input.placeholder){var e=this.searchInput;$("#btn-search").length&&$("#btn-search").on("click",function(){e.length&&function(e){var t=$(e);if(t.length){var i=t.css("color");""==t.val()&&""!=t.attr("placeholder")&&(t.val(t.attr("placeholder")),t[0].setSelectionRange(0,0),t.css("color","rgb(85, 85, 85)")),$(document).one("keydown blur click",e,function(){$(this).val()==$(this).attr("placeholder")&&($(this).val(""),$(this).css("color",i))})}}("input#search-input")})}}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Sidemenu=function(){function e(){var t=this;_classCallCheck(this,e);var i=this;this.BODY_SHOW_SIDEMENU_CLASS="open-sidemenu",this.SIDEMENU_ACTIVE_CLASS="sidemenu--active",this.SIDEMENU_INNER_CLASS="sidemenu--inner",this.SIDEMENU_ENTER_EFFECT="slideInLeft",this.SIDEMENU_EXIT_EFFECT="slideOutLeft",this.SIDEMENU_HASCHILD_CLASS="sidemenu--item--has-child",this.SIDEMENU_MAINNAV_CLASS="sidemenu--main",this.SIDEMENU_SUBNAV_CLASS="sidemenu--subnav",this.SIDEMENU_SUBNAV_BTNBACK_CLASS="sidemenu--subnav-back-btn",this.SIDEMENU_OVERLAY_CLASS="sidemenu--overlay",this.SIDEMENU_FIRSTLEVEL_CLASS="sidemenu--subnav-first-level",this.menuEle=$("#sidemenu"),this.btnCloseOpen=$("#btn-toggle-sidemenu"),this.body=$("html, body"),this.btnCloseOpen.off("click").on("click",function(){$("#btn-toggle-sidemenu").hasClass("sidemenu--btn-close")?t.closeMenu():t.openMenu()}),$("."+this.SIDEMENU_HASCHILD_CLASS).on("click","> a",function(e){e.preventDefault();var t=$(this).attr("to-level");i.openSubMenu($(this).parent(),t)}),$("."+this.SIDEMENU_SUBNAV_BTNBACK_CLASS).on("click",function(){var e=$(this).attr("to-level");i.closeSubMenu($(this).closest("."+i.SIDEMENU_SUBNAV_CLASS),e)}),$("."+this.SIDEMENU_OVERLAY_CLASS).on("click",function(){t.closeMenu()})}return _createClass(e,[{key:"openMenu",value:function(){var e=this;this.menuEle.is(":hidden")&&!this.btnCloseOpen.hasClass("sidemenu--btn-close")&&(this.body.addClass(this.BODY_SHOW_SIDEMENU_CLASS),document.documentElement.style.setProperty("--win-height",$(window).height()+"px"),this.menuEle.addClass(this.SIDEMENU_ACTIVE_CLASS).find("."+this.SIDEMENU_INNER_CLASS).animateCss(this.SIDEMENU_ENTER_EFFECT),this.menuEle.find("."+this.SIDEMENU_OVERLAY_CLASS).animateCss("fadeIn",function(){e.menuEle.find("."+e.SIDEMENU_OVERLAY_CLASS).addClass("show")}),this.btnCloseOpen.addClass("sidemenu--btn-close"))}},{key:"closeMenu",value:function(){var e=this;this.menuEle.is(":hidden")&&!this.btnCloseOpen.hasClass("sidemenu--btn-close")||(this.body.removeClass(this.BODY_SHOW_SIDEMENU_CLASS),this.menuEle.find("."+this.SIDEMENU_OVERLAY_CLASS).animateCss("fadeOut",function(){e.menuEle.find("."+e.SIDEMENU_OVERLAY_CLASS).removeClass("show")}),this.menuEle.find("."+this.SIDEMENU_INNER_CLASS).animateCss(this.SIDEMENU_EXIT_EFFECT,function(){e.menuEle.removeClass(e.SIDEMENU_ACTIVE_CLASS),e.menuEle.find("."+e.SIDEMENU_SUBNAV_CLASS).not("."+e.SIDEMENU_FIRSTLEVEL_CLASS).removeClass(e.SIDEMENU_SUBNAV_CLASS+"--active")}),this.btnCloseOpen.removeClass("sidemenu--btn-close"))}},{key:"mobileLinklistVisibility",value:function(e){void 0!==e?($(".placeholder-content-mobile").css("display","none"),$(".placeholder-sidebar-mobile").css("display","none"),$(".level-"+e).css("display","block")):console.log("Level unknown for mobile menu")}},{key:"openSubMenu",value:function(e,t){this.mobileLinklistVisibility(t),$(e).children("."+this.SIDEMENU_SUBNAV_CLASS).addClass(this.SIDEMENU_SUBNAV_CLASS+"--active").animateCss("slideInRight")}},{key:"closeSubMenu",value:function(e,t){var i=this;this.mobileLinklistVisibility(t),$(e).animateCss("slideOutRight",function(){$(e).removeClass(i.SIDEMENU_SUBNAV_CLASS+"--active")})}}]),e}();_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var SidemenuUser=function(){function e(){_classCallCheck(this,e);var t=this;this.BODY_SHOW_SIDEMENU_CLASS="open-sidemenu",this.SIDEMENU_ACTIVE_CLASS="sidemenu--active",this.SIDEMENU_INNER_CLASS="sidemenu--inner",this.SIDEMENU_ENTER_EFFECT="slideInLeft",this.SIDEMENU_EXIT_EFFECT="slideOutLeft",this.SIDEMENU_HASCHILD_CLASS="sidemenu--item--has-child",this.SIDEMENU_MAINNAV_CLASS="sidemenu--main",this.SIDEMENU_SUBNAV_CLASS="sidemenu--subnav",this.SIDEMENU_SUBNAV_BTNBACK_CLASS="sidemenu--subnav-back-btn",this.SIDEMENU_OVERLAY_CLASS="sidemenu--overlay",this.menuEle=$("#sidemenuaccount"),this.btnClose=$(".sidemenu--btn-close"),this.body=$("html, body"),0!==this.menuEle.length&&(this.btnClose.on("click",function(){t.closeMenu()}),$("."+this.SIDEMENU_OVERLAY_CLASS).on("click",function(){t.closeMenu()}))}return _createClass(e,[{key:"openMenu",value:function(){var e=this;this.menuEle.is(":hidden")&&(this.body.addClass(this.BODY_SHOW_SIDEMENU_CLASS),document.documentElement.style.setProperty("--win-height",$(window).height()+"px"),this.menuEle.addClass(this.SIDEMENU_ACTIVE_CLASS).find("."+this.SIDEMENU_INNER_CLASS).animateCss(this.SIDEMENU_ENTER_EFFECT),this.menuEle.find("."+this.SIDEMENU_OVERLAY_CLASS).animateCss("fadeIn",function(){e.menuEle.find("."+e.SIDEMENU_OVERLAY_CLASS).addClass("show")}))}},{key:"closeMenu",value:function(){var e=this;this.menuEle.is(":hidden")||(this.body.removeClass(this.BODY_SHOW_SIDEMENU_CLASS),this.menuEle.find("."+this.SIDEMENU_OVERLAY_CLASS).animateCss("fadeOut",function(){e.menuEle.find("."+e.SIDEMENU_OVERLAY_CLASS).removeClass("show")}),this.menuEle.find("."+this.SIDEMENU_INNER_CLASS).animateCss(this.SIDEMENU_EXIT_EFFECT,function(){e.menuEle.removeClass(e.SIDEMENU_ACTIVE_CLASS),e.menuEle.find("."+e.SIDEMENU_SUBNAV_CLASS).removeClass(e.SIDEMENU_SUBNAV_CLASS+"--active")}))}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var SizingAndFit=function e(){_classCallCheck(this,e);var t={S:"#small",STD:"#standard",L:"#wide"},i=$("#modal-sizing-fit");if(0!==i.length){i.find(".lens-width").text($("#lens-width").val()),i.find(".bridge-width").text($("#bridge-width").val());i.find(".product--size-brief-select"),i.find(".product--size-brief-content");this.tabClick=i.find(".btn");var n=$("input#display-size");i.find(".btn").addClass("active"),n.val()&&t[n.val()]&&(i.find(".btn").removeClass("active"),i.find(".btn[data-target='"+t[n.val()]+"']").addClass("active"))}};!function(e){e(function(){e('.opsm-slideshow--slide[data-slide-type="grid-area"]').not(".slick-initialized").slick({dots:!1,infinite:!1,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:992,settings:{slidesToShow:3}},{breakpoint:576,settings:{slidesToShow:1}}]})})}(jQuery);_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var SortBy=function(){function e(t){var i=this;_classCallCheck(this,e),this.ele=$(t),0!==this.ele.length&&(this.nativeSelect=this.ele.find("select"),this.dropdown=this.ele.find(".dropdown"),this.setText(),this.nativeSelect.on("change",function(){i.setText()}),this.dropdown.find(".dropdown-item").on("click",function(e){var t=$(e.target).data("value");i.nativeSelect.val(t),i.setText()}))}return _createClass(e,[{key:"setText",value:function(){var e=this.nativeSelect.find("option:selected");this.ele.find(".sort-by--selected-text").html(e.html())}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}$(document).ready(function(){new SortBy("#product-sort-by")});var StickyBookingSummary=function e(){var t=this;_classCallCheck(this,e),this.booking=$("#booking-summary"),0!==this.booking.length&&(Modernizr.csspositionsticky||this.booking.affix({offset:{top:function(){return this.top=$(".header").outerHeight()+$(".baet-step").outerHeight()+$(".baet-step--back-nav").outerHeight()},bottom:function(){return this.bottom=$(".footer").outerHeight()+210}}}).on("affixed.bs.affix",function(){var e=$(".booking--ie-wrapper");t.booking.css({width:e.width(),left:""})}).on("affixed-bottom.bs.affix",function(){var e=$(".booking--ie-wrapper");t.booking.css({width:e.width(),left:15})}).parent().addClass("booking--ie-wrapper"))};!function(e){e(document).ready(function(){e("#booking-summary").length&&new StickyBookingSummary})}(jQuery);_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Subscription=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"updateLensOrderFrequency",value:function(){var e=parseInt($("#left-boxes").val()),t=parseInt($("#right-boxes").val()),i=parseFloat($("#refill").attr("attr-freq"));if(!isNaN(i)&&(isNaN(e)&&(e=0),isNaN(t)&&(t=0),0!=e+t)){var n=0;if(0<e&&(n=e*i),0<t&&(n=t*i<n||n<1?t*i:n),n<1)console.error("Bad value for refillPeriodDays "+n);else{var s=n%30,a=Math.floor(n/30)+" months";0!=s&&(a+=" and "+s+" days"),$(".the-period").html(a);var r=n+"_DAY",o="";if($("#freq-selection option.recommended").length&&(-1!=(o=$("#freq-selection option.recommended").html()).indexOf(" (Recommended)")&&(o=o.slice(0,o.indexOf(" (Recommended)")),$("#freq-selection option.recommended").html(o)),$("#freq-selection option.recommended").removeClass("recommended")),$("#freq-selection option[value='"+r+"']").length)-1!=(o=$("#freq-selection option[value='"+r+"']").html()).indexOf(" (Recommended)")&&(o=o.slice(0,o.indexOf(" (Recommended)"))),$("#freq-selection option[value='"+r+"']").html(o+" (Recommended)").addClass("recommended");else{$('<option class="recommended" value="'+r+'">Every '+a+" (Recommended)</option>").appendTo($("#freq-selection"));var l=$("#freq-selection").find("option");Array.prototype.sort.bind(l)(function(e,t){try{var i=parseInt($(e).attr("value").split("_")[0]),n=parseInt($(t).attr("value").split("_")[0]);return i<n?-1:i>n?1:0}catch(e){return 0}}),$("#freq-selection").append(l);try{$("#freq-selection").hybridSelect("buildDropdownMenu")}catch(e){}}$("#freq-selection").val(r).trigger("change");try{$("#freq-selection").hybridSelect("select")}catch(e){}}}}},{key:"checkAddRecommOptionCart",value:function(e){if(void 0!==e&&e.length&&e.is("select")&&e.find("option.recommended").length<1){var t=e.val(),i=parseFloat(e.closest(".freq-wrapper").find("input.refill-calc").attr("attr-freq"));if(isNaN(i))return;var n=i%30,s=Math.floor(i/30)+" months";0!=n&&(s+=" and "+n+" days");var a=i+"_DAY";if(!e.find("option.recommended").length&&!e.find("option[value='"+a+"']").length){$('<option class="recommended" value="'+a+'">Every '+s+" (Recommended)</option>").appendTo(e);var r=e.find("option");Array.prototype.sort.bind(r)(function(e,t){try{var i=parseInt($(e).attr("value").split("_")[0]),n=parseInt($(t).attr("value").split("_")[0]);return i<n?-1:i>n?1:0}catch(e){return 0}}),e.append(r),e.val(t);try{e.hybridSelect("buildDropdownMenu"),e.hybridSelect("select")}catch(e){}}}var o=$("#ord-attr-refill-str").val();if(!o||o.length<1){var l=parseFloat(e.closest(".freq-wrapper").find("input.refill-calc").attr("attr-freq")),d=e.closest(".freq-wrapper").find("input.refill-uom-calc").attr("attr-freq-uom");o=d&&d.length&&!isNaN(l)?l+"_"+d:"notExistingValue"}if("notExistingValue"!==o&&void 0!==e&&e.length){if(e.is("select")&&e.find('option[value="'+o+'"]').length<1){var c=parseFloat($("#ord-attr-refill").attr("attr-freq"));if(isNaN(c))return;var u=c%30,p=Math.floor(c/30)+" months";0!=u&&(p+=" and "+u+" days"),$('<option selected value="'+o+'">Every '+p+"</option>").appendTo(e);r=e.find("option");Array.prototype.sort.bind(r)(function(e,t){try{var i=parseInt($(e).attr("value").split("_")[0]),n=parseInt($(t).attr("value").split("_")[0]);return i<n?-1:i>n?1:0}catch(e){return 0}}),e.append(r)}e.val(o);try{e.hybridSelect("select")}catch(e){}}}}]),e}();function addMonths(e,t){var i=e.getDate();return e.setMonth(e.getMonth()+ +t),e.getDate()!=i&&e.setDate(0),e}!function(e){e.validator.addMethod("leftEyeSelected",function(t,i){var n=e("#left-boxes").val();return!!e("#same-on-both:checked").length||(null==n||"0"===n||void 0!==e(i).val()&&null!==e(i).val())},"Required Field"),e.validator.addMethod("rightEyeSelected",function(t,i){var n=e("#right-boxes").val();return null==n||"0"===n||void 0!==e(i).val()&&null!==e(i).val()},"Required Field"),e.validator.addMethod("notBothZero",function(t,i,n){return 0!=t||0!=e(n).val()},"Please select at least 1 box"),e.validator.addMethod("DateFormatByMY",function(e,t){if(e.match(/^(0[1-9]|1[012])[\/]\d{4}$/)){var i=e.split("/");return new Date(parseInt(i[1]),parseInt(i[0])-1).getTime()<(new Date).getTime()}return this.optional(t)},"Please enter a date in the format MM/YYYY"),e.validator.addMethod("DateFormatByMYIssueDate",function(e,t){if(""===e)return!0;if(e.match(/^(0[1-9]|1[012])[\/]\d{4}$/)){var i=e.split("/");return new Date(parseInt(i[1]),parseInt(i[0])-1).getTime()<(new Date).getTime()}return!1},"Please enter a valid date in the format MM/YYYY"),e.validator.addMethod("DateFormatMonthValidation",function(e,t,i){if(""===e)return!0;var n=isNaN(i)?12:parseInt(i);if(e.match(/^(0[1-9]|1[012])[\/]\d{4}$/)){var s=e.split("/"),a=!0,r=new Date(parseInt(s[1]),parseInt(s[0])-1);r=addMonths(r,n);var o=new Date;(o=new Date(o.getFullYear(),o.getMonth(),o.getDate()+1)).setMilliseconds(o.getMilliseconds()-1),a=r>o}return a},"Your prescription start date is more than 18 months before today's date. This means your prescription has expired. Please check that your prescription details are correct."),e.validator.addMethod("DateFormatByMYExpiryDate",function(e,t){if(e.match(/^(0[1-9]|1[012])[\/]\d{4}$/)){var i=e.split("/");return new Date(parseInt(i[1]),parseInt(i[0])).getTime()>(new Date).getTime()}return this.optional(t)},"Please enter a valid date in the format MM/YYYY"),e.validator.addMethod("DateFormat",function(e,t){return e.match(/^(0[1-9]|[12][0-9]|3[01])[\/](0[1-9]|1[012])[\/]\d{4}$/)},"Please enter a date in the format DD/MM/YYYY"),e.validator.addMethod("MobilePhoneAU",function(e,t){return e.match(/^\({0,1}((0|\+?61)(4))\){0,1}[0-9]{2}(\ |-){0,1}[0-9]{2}(\ |-){0,1}[0-9]{1}(\ |-){0,1}[0-9]{3}$/)},"Please enter a valid phone number"),e.validator.addMethod("pwdPolicyCompliant",function(e,t,i){function n(e,t,i,n){return function(e,t){var i=t.exec(e);return null!=i&&i[0].length>=1}(e,new RegExp(t))?(s=i,a=n,r=document.getElementById(s),a&&s&&null!=r&&r.classList.add(a),!0):(function(e,t){var i=document.getElementById(e);t&&e&&null!=i&&i.classList.remove(t)}(i,n),!1);var s,a,r}return this.optional(t)||function(e){var t=document.getElementById("REGEX_PASSWORD_ONE_UPPER").value,i=document.getElementById("REGEX_PASSWORD_ONE_LOWER").value,s=document.getElementById("REGEX_PASSWORD_ONE_NUMBER").value,a=document.getElementById("REGEX_PASSWORD_ONE_SPECIAL").value,r=document.getElementById("REGEX_PASSWORD_MIN_LENGTH").value,o=!0;return o=(o=(o=(o=(o=o&&n(e,new RegExp(t),"atLeastOneUpperCase","checked"))&&n(e,new RegExp(i),"atLeastOneLowerCase","checked"))&&n(e,new RegExp(s),"atLeastOneNumber","checked"))&&n(e,new RegExp(a),"atLeastOneSpecial","checked"))&&n(e,new RegExp(r),"minLength","checked")}(e)},"")}(jQuery);var Component=videojs.getComponent("Component"),OptionalHeading=videojs.extend(Component,{constructor:function(e,t){Component.apply(this,arguments),t.heading&&this.updateTextContent(t.heading)},createEl:function(){return videojs.createEl("div",{className:"opsm-video--heading"})},updateTextContent:function(e){"string"!=typeof e&&(e=""),videojs.emptyEl(this.el()),videojs.appendContent(this.el(),e)}});videojs.registerComponent("OptionalHeading",OptionalHeading),$(function(){$(".opsm-video").each(function(e,t){var i=$(t),n=i.find(".video-js")[0],s=videojs(n);i.data("heading")&&s.addChild("OptionalHeading",{heading:i.data("heading")})})});var opsm=window.opsm||{};!function(e,t,i,n){n.VirtualMirrorManager=function(){var e,s=!1,a=[];i(t).on("click","#try-on-btn",function(e){var n=i('script[src="'+i("#VMMV_API_URL").val()+'"]');console.log("VMMV script "+n.length),s&&0!==n.length?r():(!function(e){console.log("VMMV load start "+e);var i=t.createElement("script");i.setAttribute("type","text/javascript"),i.src=e,i.onload=function(){console.log("VMMV load end "+e),r()},i.onerror=function(){console.log("VMMV error loading "+e)},t.head.appendChild(i)}(i("#VMMV_API_URL").val()),s=!0)});var r=function(){a.length=0;var s=u();i.ajax({url:"/AjaxUserFavouriteListItems",dataType:"json",async:!1,success:function(e){if(e.length>0&&e[0].items.length>0)for(var t=0;t<s.length;t++)s[t].code===""+e[0].items&&a.push(s[t].upc)},error:function(e,t,i){console.error("VMMV wishlist AjaxUserFavouriteListItems "+t)}}),console.log("VMMV wishlist "+JSON.stringify(a));var r={selector:"#vmmv-container",locale:i("#try-on-btn").data("localevm"),prices:c(),products:s,store:{id:"",storeId:"",type:"",name:"",address:"",standAlone:!0,logo:"",region:"AU"},analytics:{adobeSessionId:"",sourcePosition:"",pageEnvironment:"",storeGlobalId:"",style:"",pagePlatform:"",pageBrand:"",storeId:"",storeRegion:"",storeCompany:"",source:""},style:"",fromStore:!0,termsAndConditions:location.origin+"/terms-of-use",vmInit:{source:"VMMV_OPSM",key:"99749c5d-616c-42b2-acb0-73925faea4ae",channel:"ecommerce",brand:"OPSM"},onClose:function(){i("#vm-modal").modal("hide"),null!=e&&e.unmount()},onAddPrescriptionLenses:function(e){if(console.log("VMMV onAddPrescriptionLenses "+e.code+" "+JSON.stringify(e)),d(e.upc))console.log("VMMV onAddPrescriptionLenses OOS "+e.upc),i(".vmmv-add-prescription-modal-close-modal-button").click(),i("#vm-modal-oos").modal();else for(var n=u(),s=0;s<n.length;s++)if(console.log("VMMV onAddPrescriptionLenses data "+n[s].code),n[s].code===e.code){var a=n[s].link+(n[s].link.includes("?")?"&openlenspanel=true":"?openlenspanel=true");console.log("VMMV onAddPrescriptionLenses redirect "+a),t.location.href=a}},onAddToBag:function(e){if(console.log("VMMV onAddToBag "+e.code+" "+JSON.stringify(e)),!d(e.upc))return n.product.addToCart(null,e.code);console.log("VMMV onAddToBag OOS "+e.upc),i(".vmmv-add-prescription-modal-close-modal-button").click(),i("#vm-modal-oos").modal()},wishlistedUpcs:a,onToggleWishlist:function(e){console.log("VMMV onToggleWishlist "+e.code+" "+JSON.stringify(e));var t={catEntryId:e.code,storeId:i("#storeId").val(),quantity:"1",updatable:"0"};return Utils.addToFav("/FavouritesAddCmd",t,l,o),Promise.resolve()},onShare:function(e,t){return fetch(e).then(function(e){return e.blob()}).then(function(e){var i=new File([e],t.upc+".jpg",{type:e.type}),n={title:t.brand,text:t.name,files:[i]};return Promise.resolve(n)})},isPictureModeEnabled:!0,isTryOnEnabled:!0,isVideoModeEnabled:!0,isUploadPictureEnabled:!0,isTakePictureEnabled:!0,isTakeScreenshotEnabled:!0};i("#vm-modal").modal(),e=new vmmv.VMWidgetApp(r),i("#vm-modal").on("shown.bs.modal",function(){i("#vmmv-container").css("height",i("#vm-modal .modal-body").height()+"px"),e.init()}),i("#vm-modal").on("hidden.bs.modal",function(){null!=e&&e.unmount()})};function o(e,t,i){console.error("VMMV errorAddFav: "+t+"\n"+i)}function l(e){if(console.log("VMMV successAddFav "+e.itemAddStatus),"ALREADY_FAV"==e.itemAddStatus){var t={catEntryId:e.catEntryId[0],storeId:e.storeId,quantity:"1"};return Utils.removeFromFav("/FavouritesDeleteCmd",t)}"limitExceeded"==e.itemAddStatus&&n.utils.showAlertError("Only 20 or less items can be saved")}function d(e){var t=!1;return i(".list-inline.product--thumbnail-color-selectors").find(".list-inline-item.product--thumbnail-color-selector ").each(function(n,s){var a=""+i(s).children("a").data("upc"),r=""+i(s).children("a").data("oos");e===a&&"true"===r&&(t=!0)}),t}function c(){var e=[];return i(".list-inline.product--thumbnail-color-selectors").find(".list-inline-item.product--thumbnail-color-selector ").each(function(t,n){var s={upc:""+i(n).children("a").data("upc"),current:{text:""+i(n).children("a").data("offer-price-string"),value:""+i(n).children("a").data("offer-price")},currency:""+i(n).children("a").data("currency")};""!==i(n).children("a").data("list-price")&&(s.previous={text:""+i(n).children("a").data("list-price-string"),value:""+i(n).children("a").data("list-price")}),e.push(s)}),console.log("VMMV prices "+JSON.stringify(e)),e}function u(){var e=[],t=""+i(".list-inline.product--thumbnail-color-selectors").find(".list-inline-item.product--thumbnail-color-selector.active").children("a").data("upc");return i(".list-inline.product--thumbnail-color-selectors").find(".list-inline-item.product--thumbnail-color-selector ").each(function(n,s){var a={upc:""+i(s).children("a").data("upc"),code:""+i(s).children("a").data("code"),name:""+i(s).children("a").data("name"),styleName:""+i(s).children("a").data("name"),colorCode:""+i(s).children("a").data("color"),thumbnailUrl:""+i(s).children("a").data("img-thumb-vto"),brand:{name:"OPSM",logoUrl:"https://media.opsm.com/DDM/brand.png?differentUrl=true"},frameColorLabel:""+i(s).children("a").data("color"),lensColorLabel:""+i(s).children("a").data("lens-color"),rxAvailable:i(s).children("a").data("roxable"),link:i(s).children("a")[0].href};a.upc===t?e.unshift(a):e.push(a)}),console.log("VMMV data "+JSON.stringify(e)),e}}()}(window,document,jQuery,opsm);var ZOOM_MAX,ZOOM_MIN=1;ZOOM_MAX=window.matchMedia("(min-width: 768px)").matches?3:6;var PINCH_FRICTION=.04;function ZoomNode(e){var t=this,i=0,n=0,s=0,a=0,r=1,o=[],l=-1,d=!1,c=0;function u(t){o.push(t),s=t.offsetX,a=t.offsetY,e.style.transition="",t.preventDefault()}function p(u){if(0!=o.length)if(function(e){for(var t=0;t<o.length;t++)if(e.pointerId==o[t].pointerId){o[t]=e;break}}(u),2==o.length){var p=function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.hypot(i,n)}(o[0],o[1]);if(l>0){var h=p/l*PINCH_FRICTION;p>l&&((c=r+h)<ZOOM_MAX?t.zoom(c):c=ZOOM_MAX),p<l&&((c=r-h)>ZOOM_MIN?t.zoom(c):c=ZOOM_MIN),window.pdp.scale=c,window.pdp.updateZoomButtons()}l=p}else if(1==o.length&&-1==l&&!d){var g=e.getBoundingClientRect();u.pageX,u.pageY,i=i+u.pageX-s*r-g.left,n=n+u.pageY-a*r-g.top;var m=80*(u.target.getBoundingClientRect().width/2+window.innerWidth/2)/100;(i>m||i<-1*m)&&(i=0),f(i,n,r)}}function h(e){!function(e){for(var t=0;t<o.length;t++)if(o[t].pointerId==e.pointerId){o.splice(t,1);break}}(e),o.length<2&&(l=-1,d=!1),1==o.length&&(d=!0),e.preventDefault()}function f(t,i,n){e.style.transform="matrix("+n+", 0, 0, "+n+", "+t+", "+i+")"}e.classList.add("zooming"),t.zoom=function(t,s){r=Math.min(Math.max(t,ZOOM_MIN),ZOOM_MAX),e.style.transition=s||"",f(i,n,r)},t.reset=function(){i=0,n=0,r=1,e.style.transition="",e.classList.remove("zooming"),f(0,0,1)},t.bindEvents=function(){e.addEventListener("pointerdown",u),e.addEventListener("pointermove",p),e.addEventListener("pointerup",h),e.addEventListener("pointerout",h),e.addEventListener("pointercancel",h)},t.unbindEvents=function(){e.removeEventListener("pointerdown",u),e.removeEventListener("pointermove",p),e.removeEventListener("pointerup",h),e.removeEventListener("pointerout",h),e.removeEventListener("pointercancel",h)},t.destroy=function(){t.unbindEvents(),t.reset()},t.bindEvents()}_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t="hybridSelect";function i(i,n){var s=i,a=e(i),r=null,o=null;function l(){o.empty(),a.children().each(function(t,i){e(i).is("optgroup")?(o.append('<h6 class="dropdown-header">'+e(i).attr("label")+"</h6>"),e(i).children().each(function(t,i){o.append('<a tabindex="0" class="pointer dropdown-item '+(e(i).attr("hidden")?"hidden":"")+"\n                            "+(e(i).is(":disabled")?"disabled":"")+" "+(e(i).is(":selected")?"active":"")+'"\n                            data-value="'+e(i).attr("value")+'" '+(e(i).attr("ajax-href")?'href="'+e(i).attr("ajax-href")+'"':"")+">\n                                "+(e(i).data("template")||e(i).text())+"\n                            </a>")})):o.append('<a tabindex="0" class="pointer dropdown-item '+(e(i).attr("hidden")?"hidden":"")+"\n                        "+(e(i).is(":disabled")?"disabled":"")+" "+(e(i).is(":selected")?"active":"")+'"\n                        data-value="'+e(i).attr("value")+'" '+(e(i).attr("ajax-href")?'href="'+e(i).attr("ajax-href")+'"':"")+">\n                             "+(e(i).data("template")||e(i).text())+"\n                        </a>")});var t=r.find(".btn");a.is(":disabled")?t.attr("disabled",!0):t.attr("disabled",!1),e(".product--info-area.contact-lenses").length>0?e(".hybrid-select .dropdown-menu").niceScroll({cursorcolor:"#2D2A26",autohidemode:!1,cursorwidth:"2px",cursorborder:"0px solid #2D2A26",railpadding:{top:20,right:20,left:0,bottom:20},railoffset:{top:40,right:20,left:0,bottom:40}}):e(".hybrid-select .dropdown-menu").niceScroll({cursorcolor:"#ccc",autohidemode:!1,cursorwidth:"10px",railpadding:{top:0,right:12,left:0,bottom:0}}),d()}function d(){var e=r.find(".btn"),t=c();e.find(".selected-text").html(t.html()),r.find(".dropdown-menu").find(".dropdown-item").removeClass("active").filter('[data-value="'+t.val()+'"]').addClass("active"),a.find("option").removeAttr("selected").filter('[value="'+t.val()+'"]').attr("selected","true"),p()}function c(){return a.find("option:selected")}function u(e){void 0!==n[e]&&n[e].call(s)}function p(){try{var e=a.closest("form");e.data("validator")&&e.data("validator").element(a)}catch(e){console.error("Could not call valid() method on element",a,e)}}return n=e.extend({},e.fn[t].defaults,n),a.wrap('<div class="dropdown hybrid-select"></div>'),r=a.parent(),n.wrapperClass&&r.addClass(n.wrapperClass),a.data("wrapper-class")&&r.addClass(a.data("wrapper-class")),r.append('\n                <button type="button" class="btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                    <span class="selected-text">'+c().text()+'</span>\n                    <span class="warn-icon-wrapper flex-grow-1 d-none"><span class="invalid-feedback ml-auto mr-2 my-0 warn-icon"></span></span>\n                    <span class="icon icon-chevron-thin-right"></span>\n                </button>\n                <div class="dropdown-menu">\n                </div>\n            '),o=r.find(".dropdown-menu"),"right"!==n.dropdownMenuDirection&&"right"!==a.data("dropdown-menu-direction")||o.addClass("dropdown-menu-right"),!0!==n.noNative&&!0!==a.data("no-native")||r.addClass("hybrid-select--no-native"),l(),o.on("click","a",function(){r.find(".selected-text").text(e(this).text()),o.find(".active").removeClass("active"),e(this).addClass("active"),a.val(e(this).data("value")),a.trigger("change"),p()}),a.on("change."+t,function(){d()}),u("onInit"),{option:function(e,t){if(!t)return n[e];n[e]=t},destroy:function(){a.each(function(){var i=e(this);u("onDestroy"),i.removeData("plugin_"+t)})},buildDropdownMenu:l,refresh:l,enable:function(e){r.find(".btn").removeAttr("disabled"),a.removeAttr("disabled"),!0!==e&&p()},disable:function(){r.find(".btn").attr("disabled",!0),a.attr("disabled",!0),p()},select:d}}e.fn[t]=function(n){if("string"==typeof arguments[0]){var s,a=arguments[0],r=Array.prototype.slice.call(arguments,1);return this.each(function(){if(!e.data(this,"plugin_"+t)||"function"!=typeof e.data(this,"plugin_"+t)[a])throw new Error("Method "+a+" does not exist on jQuery."+t);s=e.data(this,"plugin_"+t)[a].apply(this,r)}),void 0!==s?s:this}if("object"===(void 0===n?"undefined":_typeof(n))||!n)return this.each(function(){e.data(this,"plugin_"+t)||e.data(this,"plugin_"+t,new i(this,n))})},e.fn[t].defaults={onInit:function(){},onDestroy:function(){},dropdownMenuDirection:"",noNative:!1}}(jQuery),function(e){e(document).ready(function(){e('[data-toggle="hybridSelect"]').hybridSelect()})}(jQuery);_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=function t(i,n){this.options=e.extend({},t.DEFAULTS,n),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function i(i){return this.each(function(){var n=e(this),s=n.data("bs.affix"),a="object"==(void 0===i?"undefined":_typeof(i))&&i;s||n.data("bs.affix",s=new t(this,a)),"string"==typeof i&&s[i]()})}t.VERSION="3.3.7",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(e,t,i,n){var s=this.$target.scrollTop(),a=this.$element.offset(),r=this.$target.height();if(null!=i&&"top"==this.affixed)return s<i&&"top";if("bottom"==this.affixed)return null!=i?!(s+this.unpin<=a.top)&&"bottom":!(s+r<=e-n)&&"bottom";var o=null==this.affixed,l=o?s:a.top;return null!=i&&s<=i?"top":null!=n&&l+(o?r:t)>=e-n&&"bottom"},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=this.$element.height(),n=this.options.offset,s=n.top,a=n.bottom,r=Math.max(e(document).height(),e(document.body).height());"object"!=(void 0===n?"undefined":_typeof(n))&&(a=s=n),"function"==typeof s&&(s=n.top(this.$element)),"function"==typeof a&&(a=n.bottom(this.$element));var o=this.getState(r,i,s,a);if(this.affixed!=o){null!=this.unpin&&this.$element.css("top","");var l="affix"+(o?"-"+o:""),d=e.Event(l+".bs.affix");if(this.$element.trigger(d),d.isDefaultPrevented())return;this.affixed=o,this.unpin="bottom"==o?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==o&&this.$element.offset({top:r-i-a})}};var n=e.fn.affix;e.fn.affix=i,e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},null!=n.offsetBottom&&(n.offset.bottom=n.offsetBottom),null!=n.offsetTop&&(n.offset.top=n.offsetTop),i.call(t,n)})})}(jQuery),$.fn.extend({animateCss:function(e,t){var i=function(e){var t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var i in t)if(void 0!==e.style[i])return t[i]}(document.createElement("div"));return this.addClass("animated "+e).one(i,function(){$(this).removeClass("animated "+e),"function"==typeof t&&t()}),this}});_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Utils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"string_of_enum",value:function(e,t){for(var i in e)if(e[i]==t)return i;return null}},{key:"showAppointment",value:function(e,t){var i,n=!1,s=void 0;return 0==t&&(n=!0),s=$('\n      <div class="card baet-step-2--card">\n        <div class="card-header baet-step-2--card-header">\n          <a tabindex="0" data-toggle="collapse" class="baet-step-2--card-title pointer" data-target="#collapse-'+t+'" aria-expanded="'+n+'" aria-controls="collapse-'+t+'">'+e.name+'\n            <span class="baet-step-2--card-subtitle">('+e.items.length+' available)</span>\n          </a>\n          <a tabindex="0" data-toggle="collapse" class="tab-accordion--sign baet-step-2--card-sign '+(n?"":"collapsed")+'" data-target="#collapse-'+t+'" aria-expanded="'+n+'" aria-controls="collapse-'+t+'"></a>\n        </div>\n        <div class="collapse baet-step-2--card-body '+(n?"show":"")+'" id="collapse-'+t+'">\n        </div>\n      </div>\n    '),i=this.showHours(e.items),s.find(".baet-step-2--card-body").append(i),s}},{key:"showHours",value:function(e){var t=$('<ul class="list-unstyled baet-step-2--card-list"></ul>');return e.forEach(function(e,i){var n=$('\n        <li class="baet-step-2--card-item">\n          <div class="article-card--item">\n            <div class="article-card--item-inner">\n              <span class="article-card--time">'+e.time+"</span>\n            </div>\n          </div>\n        </li>  \n      ");e.booking&&(n=$('\n          <li class="baet-step-2--card-item baet-step-2--card-booked">\n            <div class="article-card--item">\n              <div class="article-card--item-inner">\n                <span class="article-card--time">'+e.time+'</span>\n                <span class="article-card--booked">Existing booking</span>\n              </div>\n            </div>\n          </li>  \n        ')),t.append(n)}),t}},{key:"showStore",value:function(e,t){var i=e.openingHours.map(function(e){return'<li><span class="day">'+e.day+"</span><span>"+e.time+"</span></li>"});return $('\n    <div class="select-store--item" data-index="'+t+'" data-lat="'+e.lat+'" data-lng="'+e.lng+'">\n      <div class="select-store--item--marker">\n        <span class="icon"><img src="'+imageDirectoryPath+'images/icons/icon_marker.png"></span>\n        <span class="number">'+e.id+'</span>\n      </div>\n      <div class="select-store--item--info">\n        <div class="select-store--item--inner">\n          <h6 class="select-store--item--street">'+e.nameStreet+'</h6>\n          <p class="select-store--item--add">'+e.address+'</p>\n          <div class="select-store--item--openhours">\n            <a class="btn btn-link collapsed" data-toggle="collapse" href="#tab'+e.id+'" role="button" aria-expanded="false" aria-controls="tab'+e.id+'">\n              <span class="text">Opening hours</span>\n              <span class="icon icon-chevron-left"></span>\n            </a>\n            <div class="collapse" id="tab'+e.id+'" data-parent="#accordion">\n              <ul class="list-unstyled select-store--item--hour">\n                '+i.join("")+'\n              </ul>\n            </div>\n          </div>\n        </div>\n        <a href="baet-step-2.html" class="button button--primary button--primary--dark"><span class="button--label">select store</span></a>\n      </div>\n    </div>\n    ')}},{key:"showArticle",value:function(e){return $('\n      <div class="card search--result-articles--card">\n        <div class="card-body search--result-article-card">\n          <h4 class="card-title"><a href="'+e.link+'">'+e.title+'</a></h5>\n          <p class="card-text">'+e.content+'</p>\n          <a class="card-link search--result-article-card-link" href="'+e.link+'">Read more</a>\n        </div>\n      </div>\n    ')}},{key:"showStoreFavorite",value:function(e,t){var i=e.openingHours.map(function(e){return'<li><span class="day">'+e.day+"</span><span>"+e.time+"</span></li>"});return $('\n    <div class="select-store--item opsm-bordered-fluid-div mb-4 '+(e.isPref?"select-store--item--selected":"")+'" '+(e.isPref?"disabled":"")+' style="padding:0;display:block" data-index="'+t+'" data-lat="'+e.lat+'" data-lng="'+e.lng+'">\n      <div class="opsm-bordered-header">\n        <div class="div-flex w-100">\n          <p><strong><span class="number">'+e.id+".</span> "+e.nameStreet+'</strong></p>\n        </div>\n      </div>\n      <div class="opsm-bordered-body py-0">\n        <p class="visible-mobile"><img src="//maps.googleapis.com/maps/api/staticmap?center='+e.lat+", "+e.lng+"&zoom=15&size=640x300&key="+opsm.core.getGoogleMapsApiKey()+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=icon:"+imageDirectoryPath+"images/icons/icon_marker.png|"+e.lat+","+e.lng+'" /></p>\n          <p class="select-store--item--add">'+e.address+'</p>\n        <p><a class="strong underline" target="_blank" href="https://www.google.com/maps/search/?api=1&query='+e.nameStreet+"+"+e.address+'" >Get directions</a></p>\n        <p>Tel: <strong>'+e.tel+"</strong></p>\n        <p>Open today: <strong>"+e.today+'</strong></p>\n        <hr/>\n        <div class="select-store--item--openhours">\n          <a class="btn btn-link collapsed" data-toggle="collapse" href="#tab'+e.id+'" role="button" aria-expanded="false" aria-controls="tab'+e.id+'">\n            <span class="text">Opening hours</span>\n            <span class="icon icon-chevron-left"></span>\n          </a>\n        <div class="collapse" id="tab'+e.id+'" data-parent="#accordion">\n          <ul class="list-unstyled select-store--item--hour">\n            '+i.join("")+'\n          </ul>\n        </div>\n        <p class="pt-3 pb-2"><a href="'+e.url+'" class="strong underline">Book an eye test</a></p>\n        <a id="openstoredetail-'+e.id+'" class="button button--primary button--primary--dark" style="padding:13px 15px;width:auto"><span class="button--label">store details</span></a>\n        <br/>\n        <p class="text-right pt-5"><a href="'+e.deleteUrl+'" class="fav-store-remove"><span class="fa icon-close pr-2" style="font-size:.8rem"></span><span class="underline">Remove</span></a></p> \n      </div>\n    </div>')}},{key:"openDetailStore",value:function(e,t){$.getJSON("search-store.json",function(e){e.forEach(function(e,i){if(e.id===t){$("#store-name").html(e.nameStreet),$("#store-address").html(e.address),$("#store-tel .value").html(e.tel),$("#store-fax .value").html(e.fax),$("#store-openGmap,#store-openGmapMob").attr("href","https://www.google.com/maps/search/?api=1&query="+e.nameStreet+"+"+e.address);var n=e.openingHours.map(function(e){return'<li><span class="label">'+e.day+'</span><span class="value">'+e.time+"</span></li>"}),s=e.slidesStore.map(function(e){return'<div class="opsm-slideshow--slide-item"><img src="'+e.pic+'"/></div>'});$("#store-openinghours").html(n),$("#store-screenmap img").attr("src","//maps.googleapis.com/maps/api/staticmap?center="+e.lat+","+e.lng+"&zoom=15&size=640x300&key="+opsm.core.getGoogleMapsApiKey()+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=icon:"+imageDirectoryPath+"images/icons/icon_marker.png|"+e.lat+","+e.lng),$("#store-slideshow .opsm-slideshow--slide").html(s);var a=$('.opsm-slideshow--slide[data-slide-type="storedetail"]');a.not(".slick-initialized").slick({slidesToShow:1,slidesToScroll:1,infinite:!0,dots:!0}),$("#opsm-modal-detailstore").modal(),$("#opsm-modal-detailstore").on("hidden.bs.modal",function(){a.slick("unslick")})}})})}},{key:"showProduct",value:function(e,t){var i=$('<div class="col-12 col-sm-6 col-xl-4"></div>'),n=$('<a href="pdp-frames.html" class="product card"></a>'),s=$('<div class="product--img"></div>');return n.append(this.productBadge(e.badge)),s.append(this.productImage(e.name,e.images,"primary")),e.imagesHover&&(s.addClass("product--img--dual"),s.append(this.productImage(e.name,e.imagesHover,"secondary"))),n.append(s),"search"===t?n.append(this.productContent(e.name,"",e.price,e.colors)):n.append(this.productContent(e.name,e.desc,e.price,e.colors)),i.append(n),i}},{key:"productImage",value:function(e,t,i){var n=$('<div class="product--'+i+'-img"></div>');return n.append('<img class="card-img-top" src="images/'+(t.src?t.src:"")+'" srcset="images/'+(t.src2x?t.src2x:"")+" 2x, images/"+(t.src3x?t.src3x:"")+' 3x" alt="'+(e||"")+'"/>'),n}},{key:"productBadge",value:function(e){var t=$('<div class="product--top d-flex align-items-center"></div>');return e.text&&t.append('<div class="product--badge text-uppercase product--badge--'+e.color+'">'+e.text+"</div>"),t.append('<button class="product--favourite btn btn-link ml-auto" onclick="Product.toggleFavourite(event, 111)" title="Favourite"><span class="icon icon-star-outline"></span></button>'),t}},{key:"productContent",value:function(e,t,i,n){var s="d-flex align-items-center justify-content-center",a=$('<div class="product--content card-body"></div>'),r=$('<div class="product--description">'+t+"</div>"),o=$('<ul class="list-unstyled product--colors '+s+'"></ul>');return n.forEach(function(e,t){var i=$('<li  class="product--color-item '+(0===t?"product--color-item--default":"")+'" \n              onmouseover="Product.changeProductColor(event)" \n              data-product-primary-image=""\n              data-product-secondary-image="">\n          <span class="catalogue-color catalogue-color--lg catalogue-color--frames--'+e.name+'"></span>\n        </li>');e.primaryImage&&i.attr("data-product-primary-image",JSON.stringify(e.primaryImage)),e.secondaryImage&&i.attr("data-product-secondary-image",JSON.stringify(e.secondaryImage)),o.append(i)}),a.append('<h5 class="product--name">'+e+"</h5>"),t&&a.append(r),"string"==typeof i?a.append('<h6 class="price-title product--price '+s+'">'+i+"</h6>"):a.append('<h6 class="price-title product--price '+s+'">\n          <span class="product--price product--price--old">'+i.old+'</span>\n          <span class="product--price product--price--new">'+i.new+"</span>\n        </h6>"),o.append('<li class="product--color-more">+2</li>'),a.append(o),a}},{key:"isNotDesktopDevice",value:function(){return void 0!==window.orientation||/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)}},{key:"isMobile",value:function(){return!Modernizr.mq("(min-width: 768px)")}},{key:"isTabletAndAbove",value:function(){return Modernizr.mq("(min-width: 768px)")}},{key:"isTablet",value:function(){return Modernizr.mq("(min-width: 768px)")&&!Modernizr.mq("(min-width: 992px)")}},{key:"isSmallDesktopAndAbove",value:function(){return Modernizr.mq("(min-width: 992px)")}},{key:"isSmallDesktop",value:function(){return Modernizr.mq("(min-width: 992px)")&&!Modernizr.mq("(min-width: 1200px)")}},{key:"isLargeDesktop",value:function(){return Modernizr.mq("(min-width: 1200px)")}},{key:"scrollToSelectedOptionOnOpen",value:function(e){null!=e&&(e.is("select")||e.is(".dropdown-menu"))&&"native-select"!=e.data("wrapper-class")&&e.parent().on("click","button[data-toggle='dropdown']",function(){var e=$(this).siblings(".dropdown-menu").first(),t=e.children(".dropdown-item.active");t.length&&setTimeout(function(){var i=e.scrollTop()+t.offset().top-e.offset().top-(e.height()/2-t.height()/2);e.scrollTop(i)},60)})}},{key:"findSelectOptionByNerbyValue",value:function(e,t){if(void 0!==t&&null!=e&&(e.is("select")||e.is(".dropdown-menu"))&&!isNaN(t)){var i=parseFloat(t).toFixed(),n=parseFloat(t).toFixed(2);if(e.is("select")){var s=e.find("option[value='"+n+"']").first();s.length||(s=e.find("option[value='"+i+"']").first());for(var a=0,r=i;!s.length&&a<5;a++,r++)s=e.find("option[value^='-"+r+"']").first();return s}if(e.is(".dropdown-menu")){var o=e.find(".dropdown-item[data-value='"+n+"']").first();o.length||(o=e.find(".dropdown-item[data-value='"+i+"']").first());for(var l=0,d=i;!o.length&&l<5;l++,d++)o=e.find(".dropdown-item[data-value^='-"+d+"']").first();return o}}}},{key:"moveDefaultOptionBefore",value:function(t,i,n){var s=e.findSelectOptionByNerbyValue(t,i);if(void 0!==s&&s.length){var a=n;null==a&&(a=t.find("option:disabled")),a.length||(a=t.find("option:selected")),a.length&&(a.remove(),s.before(a),t.hybridSelect("buildDropdownMenu"))}}},{key:"onSliderWheel",value:function(e){var t=e.originalEvent.deltaY,i=$(e.currentTarget),n=i.slick("slickCurrentSlide");!i.closest(".slick-initialized").length||$("body.contactlenses").length>0||t<0&&0==n||t>0&&n==i.data("slider-length")-1||(e.preventDefault(),t<=0?i.slick("slickPrev"):i.slick("slickNext"))}},{key:"blockPageScroll",value:function(e){var t=document.querySelector("html");e?t.classList.add("no-scroll"):t.classList.remove("no-scroll")}},{key:"scrollToTarget",value:function(e){var t=$(e).offset().top;window.scrollTo({top:t,left:0,behavior:"smooth"})}},{key:"addToFav",value:function(t,i,n,s){var a=t||"/FavouritesAddCmd";return e.interestItemsOperation(a,i,n,s)}},{key:"removeFromFav",value:function(t,i,n,s){var a=t||"/FavouritesDeleteCmd";return e.interestItemsOperation(a,i,n,s)}},{key:"interestItemsOperation",value:function(e,t,i,n){if("true"===OPSMHeader.isPendingFavReq())return console.log("interestItemsOperation: waiting operation to complete."),Promise.resolve();OPSMHeader.setPendingFavReq(!0);e=e||"/FavouritesAddCmd",t=t||{};return $.ajax({dataType:"json",url:e,data:t,success:function(e,t,n){OPSMHeader.setPendingFavReq(!1),OPSMHeader.favItemListServerResp(e),"function"==typeof i&&i(e)},error:function(e,t,i){OPSMHeader.setPendingFavReq(!1),"function"==typeof n&&n(e,t,i)}})}},{key:"updateCartBadge",value:function(e){void 0!==(e=e||$("#cartCount").val()||$("#order-items-quantity").val())&&("0"==e?$("#btn-cart .badge").text(""):$("#btn-cart .badge").text(e))}},{key:"setCookie",value:function(e,t,i){var n=void 0;"[object Date]"===Object.prototype.toString.call(i)?n=i:(n=new Date).setTime(n.getTime()+864e5*i),document.cookie=e+"="+t+";path=/;expires="+n.toGMTString()}},{key:"getCookie",value:function(e){var t=document.cookie.match("(^|;) ?"+encodeURIComponent(e)+"=([^;]*)(;|$)");return t?decodeURIComponent(t[2]):null}}]),e}();function toggleCollapse(e,t){$(e).hasClass("show")?$(t).removeClass("show"):($(t).removeClass("show"),$(e).addClass("show"))}function subsDetailsModalsResetForm(e,t){$(e)[0].reset(),$(e).find(".not-empty").removeClass("not-empty"),$(e).addClass("d-none"),$(t).removeClass("d-none")}function toggleConfirmationBtn(e){var t=$(e).find("#prescription-valid"),i=$(e).find(".save-changes");1==$(t).prop("checked")?$(i).removeAttr("disabled").removeClass("disabled"):$(i).attr("disabled",!0).addClass("disabled")}function materialInputEmptyCheck(e){var t,i="";t=$(this).length>0?$(this):$(e),$(t).find("input").length>0?i=t.find("input").val():t.find("textarea").length>0?i=t.find("textarea").val():t.find("div.opsm-form-control").length>0&&(i=t.find("div.opsm-form-control").text()),""!=i?t.addClass("not-empty"):t.removeClass("not-empty")}function openModal(e){$(".modal.show").length>0&&$(".modal.show").modal("hide"),setTimeout(function(){$(e).modal("show")},500)}function betRecaptchaCallback(){$("#deleteAppointmentForm button").removeAttr("disabled"),$("#rescheduleBtn").removeClass("pointer-none disabled")}function betRecaptchaExpiredCallback(){$("#deleteAppointmentForm button").attr("disabled","true"),$("#rescheduleBtn").addClass("pointer-none disabled")}function betFormRecaptchaCallback(){$("#button-booknow").removeAttr("disabled")}function betFormRecaptchaExpiredCallback(){$("#button-booknow").attr("disabled","true")}function openOrderSummary(){var e;e=$("#checkout_presc_step").length<=0||$("#checkout_presc_step").hasClass("d-none")?$("#checkout_no_presc_step"):$("#checkout_presc_step");var t=$(e).find("#orderSummary"),i=$(e).find(".side-col");$(t).collapse("show"),$(t).on("shown.bs.collapse",function(){var e=$("#header-checkout").height()+$(i).height()+$(t).height();$("#main").css("height",e+"px").addClass("overflow-hidden"),$(".open-btn.order-summary-trigger").addClass("d-none"),$(".close-btn.order-summary-trigger").removeClass("d-none")})}function closeOrderSummary(){$("#checkout_presc_step").length<=0||$("#checkout_presc_step").hasClass("d-none")?$("#checkout_no_presc_step #orderSummary").collapse("hide"):$("#checkout_presc_step #orderSummary").collapse("hide"),$("#main").removeAttr("style").removeClass("overflow-hidden"),$(".close-btn.order-summary-trigger").addClass("d-none"),$(".open-btn.order-summary-trigger").removeClass("d-none")}function toggleClassCtrl(e,t,i){$(e).closest(i).toggleClass(t)}function feValidationClasses(e){$(e).valid(),""==$(e).val()?$(e).parent().addClass("empty"):$(e).parent().removeClass("empty")}$.ajaxSetup({cache:!1}),$(document).ready(function(){$("iframe").each(function(){$(this).attr("title")||$(this).attr("title","OPSM")}),window.sidemenu=new Sidemenu,window.opsmheader=new OPSMHeader,window.searchoverlay=new SearchOverlay;$("#btn-toggle-sidemenu");window.footerStickyBanner=new StickFooterBanner,window.formSubscription=new FormSubscription,window.plp=new PLP,window.pdp=new PDP,window.sizingAndFit=new SizingAndFit,window.prescription=new Prescription,window.prescriptionS3B=new PrescriptionS3B,window.prescriptionLeadTime=new PrescriptionLeadTime,window.homeCarousel=new HomeCarousel,window.homepage=new Home;var e=new MapStore(!0);if(window.mapStore=e,window.autoCompleteGoogleMaps=new AutoCompleteGoogleMaps(function(){e.init()}),window.eyeTestBooking=new EyeTestBooking,window.eyeTestStep2=new BaetStepTwo,window.deliveryAddress=new DeliveryAddress("logged-address","saved-address","myaccount-area",".only-new-address-shipping","New address","deliveryAddress"),window.billingAddress=new DeliveryAddress("logged-address-billing","saved-address-billing","myaccount-area",".only-new-address-billing","New address","billingAddress"),$("div#checkout").length){var t={subpremise:"short_name",street_number:"short_name",route:"long_name",locality:"long_name",colloquial_area:"long_name",administrative_area_level_1:"short_name",country:"short_name",postal_code:"short_name"},i={country:opsm.core.getCountryCode()},n=["address"],s=function(e,t,i){t=t||"";for(var n=this.componentForm,s="",a="",r="",o=0;o<e.address_components.length;o++){var l=e.address_components[o].types[0];if(n[l]){var d=e.address_components[o][n[l]];"colloquial_area"===l&&(s=d),"subpremise"===l&&(r=d),"street_number"===l&&(a=d),$("."+l+t).length&&opsm.utils.setContent($("."+l+t),d)}if("administrative_area_level_2"===l)var c=e.address_components[o].short_name;if("administrative_area_level_3"===l)var u=e.address_components[o].short_name;if("nz"===opsm.core.getCountryCode()&&"sublocality_level_1"===l)var p=e.address_components[o].short_name}if("nz"===opsm.core.getCountryCode()&&(p=p||!1)&&opsm.utils.setContent($(".locality"+t),p),""===opsm.utils.getContent($(".locality"+t))&&opsm.utils.setContent($(".locality"+t),s),a.length&&(r.length&&(a=r+"/"+a),opsm.utils.setContent($(".route"+t),a+", "+opsm.utils.getContent($(".route"+t)))),"-billing"==t&&$("#checkout-billing-country").val()&&"AU"!==$("#checkout-billing-country").val()&&"NZ"!==$("#checkout-billing-country").val()&&opsm.utils.setContent($(".administrative_area_level_1"+t),u&&u!==opsm.utils.getContent($(".locality"+t))?u:c&&c!==opsm.utils.getContent($(".locality"+t))?c:opsm.utils.getContent($(".administrative_area_level_1"+t))?opsm.utils.getContent($(".administrative_area_level_1"+t)):opsm.utils.getContent($(".locality"+t))),opsm.utils.changeGmapPlaceApiResults($(".administrative_area_level_1"+t),"administrative_area_level_1"),i)try{var h=i.split(",");if(h.length>1)for(var f=0;f<h.length;f++)if(f>0&&-1!==h[f].indexOf(opsm.utils.getContent($(".locality"+t)).trim())){opsm.utils.setContent($(".route"+t),h.slice(0,f).join(",").trim());break}}catch(e){console.log("placeChangedCallback: selectedPrediction parsing error")}},a=function(e){$("#checkout-shipping-street-address_1").valid(),$("#checkout-shipping-street-address_1").trigger("paste"),$("#addressSuggest-bet").length&&($("#addressSuggest-bet").parent().length?$("#addressSuggest-bet").parent().show():$("#addressSuggest-bet").show(),$("#hiddenStatePostcode").length&&$("#hiddenStatePostcode").show(),$("#addressSuggest-bet").attr("contenteditable",""),$("#addressSuggest-bet").closest("form#checkout-form").data("validator")&&$("#addressSuggest-bet").closest("form#checkout-form").data("validator").checkForm(),opsm.utils.getContent($("#addressSuggest-bet")).trim().length?($("#addressSuggest-bet").parent().addClass("not-empty"),opsm.utils.getContent($("#addressSuggest_state")).trim().length&&opsm.utils.getContent($("#addressSuggest_postcode")).trim().length?$("#addressSuggest-bet").data("selected","true").valid():($("#addressSuggest-bet").data("selected","false").valid(),opsm.utils.setContent($("#addressSuggest-bet-error"),"The selected address is incomplete"))):($("#addressSuggest-bet").parent().removeClass("not-empty"),$("#addressSuggest-bet").data("selected","false").valid(),opsm.utils.setContent($("#addressSuggest-bet-error"),"The selected address is incomplete")),$("#addressSuggest-bet").blur(),$("#addressSuggest-bet").removeAttr("contenteditable").css("background-color",$("input.form-control[readonly]").css("background-color")))},r=function(e){$("#checkout-billing-street-address_1").valid(),$("#checkout-billing-street-address_1").trigger("paste"),$("#billingAddressSuggest").length&&($("#billingAddressSuggest").parent().length?$("#billingAddressSuggest").parent().show():$("#billingAddressSuggest").show(),$("#hiddenStatePostcode-billing").length&&$("#hiddenStatePostcode-billing").show(),$("#billingAddressSuggest").attr("contenteditable",""),$("#billingAddressSuggest").closest("form#checkout-form").data("validator")&&$("#billingAddressSuggest").closest("form#checkout-form").data("validator").checkForm(),opsm.utils.getContent($("#billingAddressSuggest")).trim().length?($("#billingAddressSuggest").parent().addClass("not-empty"),opsm.utils.getContent($("#billingAddress_state")).trim().length&&opsm.utils.getContent($("#billingAddress_postcode")).trim().length?$("#billingAddressSuggest").data("selected","true").valid():($("#billingAddressSuggest").data("selected","false").valid(),opsm.utils.setContent($("#billingAddressSuggest-error"),"The selected address is incomplete"))):($("#billingAddressSuggest").parent().removeClass("not-empty"),$("#billingAddressSuggest").data("selected","false").valid(),opsm.utils.setContent($("#billingAddressSuggest-error"),"The selected address is incomplete")),$("#billingAddressSuggest").blur(),$("#billingAddressSuggest").removeAttr("contenteditable").css("background-color",$("input.form-control[readonly]").css("background-color")))},o=!1;$(document).on("gmapApi:detached",function(){o=!0});if($("#hiddenStatePostcode").hide(),function e(){var t=function(){opsm.utils.getContent($("#addressSuggest-bet"))&&opsm.utils.getContent($("#addressSuggest_state"))&&opsm.utils.getContent($("#addressSuggest_postcode"))?(opsm.utils.setContent($("#checkout-shipping-street-address_1"),$.cookie("checkout-shipping-street-address_1_"+$("#storeId").val())),$("#addressSuggest-bet").data("selected","true"),$("#hiddenStatePostcode").length&&$("#hiddenStatePostcode").show(),$("#addressSuggest-bet").parent().length?$("#addressSuggest-bet").parent().show():$("#addressSuggest-bet").show()):($("#addressSuggest-bet").data("selected","false"),opsm.utils.setContent($("#addressSuggest-bet-error"),"The selected address is incomplete")),$("#addressSuggest-bet").attr("contenteditable",""),$("#addressSuggest-bet").closest("form#checkout-form").data("validator")&&$("#addressSuggest-bet").closest("form#checkout-form").data("validator").checkForm(),$("#addressSuggest-bet").blur(),e()};$("#checkout-order-billing-shipping").one("change","#logged-address",e),$("#checkout-order-billing-shipping").off("restoreCookie:shippingAddressComplete","#addressSuggest-bet"),$("#checkout-order-billing-shipping").one("restoreCookie:shippingAddressComplete","#addressSuggest-bet",t),$("#checkout-order-billing-shipping").off("restoreCookie:shippingAddressPartial","#addressSuggest-bet"),$("#checkout-order-billing-shipping").one("restoreCookie:shippingAddressPartial","#addressSuggest-bet",t),!o&&$("#addressSuggest-bet").length&&(opsm.utils.getContent($("#addressSuggest-bet"))||opsm.utils.getContent($("#addressSuggest_state"))||opsm.utils.getContent($("#addressSuggest_postcode"))?($("#hiddenStatePostcode").length&&$("#hiddenStatePostcode").show(),$("#addressSuggest-bet").removeAttr("contenteditable").css("background-color",$("input.form-control[readonly]").css("background-color")),$("#addressSuggest-bet").parent().length?$("#addressSuggest-bet").parent().show():$("#addressSuggest-bet").show()):(opsm.utils.setContent($("#checkout-shipping-street-address_1"),""),$("#addressSuggest-bet").parent().length?$("#addressSuggest-bet").parent().hide():$("#addressSuggest-bet").hide()),$(".delivery-address-wrapper").off("gmapApi:placeEdited gmapApi:placeSelected","#checkout-shipping-street-address_1",a),$(".delivery-address-wrapper").on("gmapApi:placeEdited gmapApi:placeSelected","#checkout-shipping-street-address_1",a))}(),!$("#ship-to-store-id").length||!$("#ship-to-store-id").val())new AutoCompleteGoogleMapsPlace($("#checkout-shipping-street-address_1"),t,"-shipping",n,i,s,function(){console.log("gApiErrorCallback called for shipping address"),"undefined"!=typeof google&&void 0!==google.maps&&void 0!==google.maps.event&&google.maps.event.clearInstanceListeners($("#checkout-shipping-street-address_1")),$(".delivery-address-wrapper").off("gmapApi:placeEdited gmapApi:placeSelected","#checkout-shipping-street-address_1",a),$("#addressSuggest-bet").attr("contenteditable","").css("background-color",$("input#checkout-shipping-street-address_1").css("background-color"));var e=$("#addressValidationResults").val();window.autoCompleteSuburbShipping=new OPSMAutoCompleteSuburb("addressSuggest-bet","addressSuggest_state","addressSuggest_postcode","hiddenStatePostcode",e,opsm.core.getCountryCode()),$("#addressSuggest-bet").length&&($("#addressSuggest-bet").parent().length?$("#addressSuggest-bet").parent().show():$("#addressSuggest-bet").show()),$("#hiddenStatePostcode").show()});$("#hiddenStatePostcode-billing").hide(),function e(){var t=function(){opsm.utils.getContent($("#billingAddressSuggest"))&&opsm.utils.getContent($("#billingAddress_state"))&&opsm.utils.getContent($("#billingAddress_postcode"))?(opsm.utils.setContent($("#checkout-billing-street-address_1"),$.cookie("checkout-billing-street-address_1_"+$("#storeId").val())),$("#billingAddressSuggest").data("selected","true"),$("#hiddenStatePostcode-billing").length&&$("#hiddenStatePostcode-billing").show(),$("#billingAddressSuggest").parent().length?$("#billingAddressSuggest").parent().show():$("#billingAddressSuggest").show()):($("#billingAddressSuggest").data("selected","false"),opsm.utils.setContent($("#billingAddressSuggest-error"),"The selected address is incomplete")),$("#billingAddressSuggest").attr("contenteditable",""),$("#billingAddressSuggest").closest("form#checkout-form").data("validator")&&$("#billingAddressSuggest").closest("form#checkout-form").data("validator").checkForm(),$("#billingAddressSuggest").blur(),e()};$("#checkout-order-billing-shipping").one("change","#logged-address-billing",e),$("#checkout-order-billing-shipping").off("restoreCookie:billingAddressComplete","#billingAddressSuggest"),$("#checkout-order-billing-shipping").one("restoreCookie:billingAddressComplete","#billingAddressSuggest",t),$("#checkout-order-billing-shipping").off("restoreCookie:billingAddressPartial","#billingAddressSuggest"),$("#checkout-order-billing-shipping").one("restoreCookie:billingAddressPartial","#billingAddressSuggest",t),!o&&$("#billingAddressSuggest").length&&(opsm.utils.getContent($("#billingAddressSuggest"))||opsm.utils.getContent($("#billingAddress_state"))||opsm.utils.getContent($("#billingAddress_postcode"))?($("#hiddenStatePostcode-billing").length&&$("#hiddenStatePostcode-billing").show(),$("#billingAddressSuggest").removeAttr("contenteditable").css("background-color",$("input.form-control[readonly]").css("background-color")),$("#billingAddressSuggest").parent().length?$("#billingAddressSuggest").parent().show():$("#billingAddressSuggest").show()):(opsm.utils.setContent($("#checkout-billing-street-address_1"),""),$("#billingAddressSuggest").parent().length?$("#billingAddressSuggest").parent().hide():$("#billingAddressSuggest").hide()),$(".delivery-address-wrapper").off("gmapApi:placeEdited gmapApi:placeSelected","#checkout-billing-street-address_1",r),$(".delivery-address-wrapper").on("gmapApi:placeEdited gmapApi:placeSelected","#checkout-billing-street-address_1",r))}();var l=new AutoCompleteGoogleMapsPlace($("#checkout-billing-street-address_1"),t,"-billing",n,$("#checkout-billing-country").val()?{country:[String($("#checkout-billing-country").val())]}:{country:[]},s,function(){console.log("gApiErrorCallback called for billing address"),"undefined"!=typeof google&&void 0!==google.maps&&void 0!==google.maps.event&&google.maps.event.clearInstanceListeners($("#checkout-billing-street-address_1")),$(".delivery-address-wrapper").off("gmapApi:placeEdited gmapApi:placeSelected","#checkout-billing-street-address_1",r),$("#billingAddressSuggest").attr("contenteditable","").css("background-color",$("input#checkout-billing-street-address_1").css("background-color")),$(".delivery-address-wrapper").off("change","#checkout-billing-country");var e=$("#checkout-billing-country"),t=e.find("option[value='AU']"),i=e.find("option[value='NZ']");e.empty(),e.append(t),e.append(i),e.hybridSelect("buildDropdownMenu"),e.val(countryCode||"AU").trigger("change");var n=$("#addressValidationResults").val();n=n+"&selectedCountryCode="+($("#checkout-billing-country").val()||countryCodee),window.autoCompleteSuburbBilling=new OPSMAutoCompleteSuburb("billingAddressSuggest","billingAddress_state","billingAddress_postcode","hiddenStatePostcode-billing",n,$("#checkout-billing-country").val()||countryCode),$(".delivery-address-wrapper").on("change","#checkout-billing-country",function(){window.autoCompleteSuburbBilling.urlToCall=$("#addressValidationResults").val()+"&selectedCountryCode="+$(this).val(),opsm.utils.setContent($("#billingAddressSuggest"),""),opsm.utils.setContent($("#billingAddress_state"),""),opsm.utils.setContent($("#billingAddress_postcode"),"")}),$("#billingAddressSuggest").length&&($("#billingAddressSuggest").parent().length?$("#billingAddressSuggest").parent().show():$("#billingAddressSuggest").show()),$("#hiddenStatePostcode-billing").show()});$(".delivery-address-wrapper").on("change","#checkout-billing-country",function(){l.setCompRestrictions($("#checkout-billing-country").val()?{country:[String($("#checkout-billing-country").val())]}:{country:[]})}),$("#checkout-billing-country").closest(".dropdown.hybrid-select").find(".dropdown-menu").on("click",".dropdown-item",function(){$(".delivery-address-wrapper").one("change","#checkout-billing-country",function(){opsm.utils.setContent($("#billingAddressSuggest"),""),opsm.utils.setContent($("#billingAddress_state"),""),opsm.utils.setContent($("#billingAddress_postcode"),"")})}),$("div#checkout").on("click",".gmap-detach-streetaddress",function(e){e.preventDefault(),$(this).hide();var t="gmapApi:detach-"+$(this).data("address");$("div#checkout").trigger(t)})}else{var d=$("#addressValidationResults").val();window.autoCompleteSuburbShipping=new OPSMAutoCompleteSuburb("addressSuggest-bet","addressSuggest_state","addressSuggest_postcode","hiddenStatePostcode",d,u);var c=$("#addressValidationResults").val(),u=$("#countryAddressSuggest").val();"AU"!=u&&"NZ"!=u||(c=c+"&selectedCountryCode="+u),window.autoCompleteSuburbBilling=new OPSMAutoCompleteSuburb("billingAddressSuggest","billingAddress_state","billingAddress_postcode","hiddenStatePostcode-billing",c,u)}if(window.checkout=new Checkout,$("#map").hasClass("storepage")){var p=new MapStoreLocator(!0,!1);window.mapStore=p,window.autoCompleteGoogleMaps=new AutoCompleteGoogleMapsOmnys(function(){p.init()})}!$("#map").hasClass("favstorepage")||"undefined"!=typeof google&&null!==google||$.getScript("https://maps.google.com/maps/api/js?sensor=false&key="+opsm.core.getGoogleMapsApiKey()+"&language=en&region="+opsm.core.getCountryCode(),function(){var e=new MapStoreLocator(!1,!0);window.mapStore=e}),window.sidemenuAccount=new SidemenuUser,$("#btn-login-mobile .visible-mobile").on("click",function(e){e.preventDefault(),e.stopPropagation(),window.sidemenuAccount.openMenu()}),window.paymentMethod=new PaymentMethod,$("#dob").inputmask("99/99/9999",{placeholder:"DD/MM/YYYY"}),$(".opsm-modal-link").each(function(e,t){var i=$(t),n=i.data("target");i.on("click",function(e){$(n).modal({backdrop:"static"})})}),$(".qty-set").each(function(e,t){var i=$(t),n=parseInt(i.find("input").val());1==n&&i.find(".less-qty").addClass("disabled"),i.on("click",".less-qty",function(){n>1&&(n--,i.find("input").val(n),1==n&&i.find(".less-qty").addClass("disabled"))}),i.on("click",".more-qty",function(){n++,i.find("input").val(n),i.find(".less-qty").removeClass("disabled")})}),$(".greybox").on("click",function(){if($(this).find(".summary-title").length>0){var e=$(this).find(".summary-title");$(e).hasClass("collapsed")?$(this).addClass("whitebox"):$(this).removeClass("whitebox")}}),$(".pg-product-detail").length>0&&$(".popular-products--inner").slick({infinite:!0,slidesToShow:4,slidesToScroll:1,refresh:!0,arrows:!1,responsive:[{breakpoint:992,settings:{slidesToShow:2}},{breakpoint:768,settings:{slidesToShow:1,variableWidth:!0}}]}),$(".opsm-scrollpane").each(function(e,t){$(t).niceScroll({cursorcolor:"#ccc"})}),$('.check-gift input[type="checkbox"]').on("change",function(){var e=$(this).attr("id"),t=$(this).parent(".check-gift"),i=t.next(".form-gift");i.find(".price-message").hide(),t.toggleClass("checked"),$('.check-gift input[type="checkbox"]').is(":checked")?(i.on("click",".cancel-btn",function(){i.find("input, textarea").val("")}),i.on("click",".add-btn",function(){i.find("a").hide(),i.find("input, textarea").attr("readonly",!0),i.find("a.re-edit").show(),$(".row[data-check="+e+"]").find(".price-message").show()}),i.on("click",".re-edit",function(){i.find("a").show(),i.find("input, textarea").attr("readonly",!1),i.find("a.re-edit").hide(),$(".row[data-check="+e+"]").find(".price-message").hide()})):$(".row[data-check="+e+"]").find(".price-message").hide()}),$("#promoinput form").on("click","#verify-code",function(){var e=$("#promo-field").val();$.getJSON("promocode.json",function(t){"OK"==t.verify?($(".promo-code-insert").hide(),$(".promo-code-ok").show(),$("#promocode-insert").html(e),$("#price-discount").html(t.discount)):($(".promo-code-ok").hide(),$(".promo-code-insert").show(),$("#promocode-insert").empty(),$("#price-discount").empty())})}),$("textarea.limit-charapter").on("blur",function(e){var t=$(this).val(),i=t.length,n=$(this).data("limit"),s=parseInt(n-i);if($(this).next(".counter-charapter").find("span").text(s),s<=0&&0!==e.which&&0!==e.charCode)return $(this).val(t.substring(0,i-1)),!1}),$("textarea.limit-charapter").keypress(function(e){var t=$(this).val(),i=t.length,n=$(this).data("limit"),s=parseInt(n-i);if($(this).next(".counter-charapter").find("span").text(s),s<=0&&0!==e.which&&0!==e.charCode)return $(this).val(t.substring(0,i-1)),!1}),$(".select-all").click(function(){$(".contact-option-input").prop("checked",!0),$("#no-promo").prop("checked",!1)}),$("#no-promo").click(function(){$(".contact-option-input").prop("checked",!1)}),$('[name="leaveornotcc"]').length>0&&$('[name="leaveornotcc"]').on("change",function(){$("#radioinsertcc").is(":checked")?$(".reentryDiv").show():$(".reentryDiv").hide()}),$(window).scroll(function(){$("#loginpage").length>0&&$(window).width()<=768&&($("#opsm-header-sticky").css("position","static"),$(".header--notibar").css("position","static"))}),$("#frameadv-ui .card").on("click",function(){$(window).scrollTop(0)}),$(".material-input").each(function(){materialInputEmptyCheck(this)}),$("#security-code-body").on("shown.bs.collapse",function(){$("body").on("click",function(e){0==$(e.target).parents("#security-code-body").length&&"security-code-body"!=$(e.target).attr("id")&&($("#security-code-body").collapse("hide"),$("body").off("click"))})}),$(document).on("change",".material-input",materialInputEmptyCheck),$("#pupillary-distance-box .hybrid-select button").on("click",function(e){var t=e.target,i=$(t).next();$(i).hasClass("show")||($(i).on("mouseenter",function(){$("body, html").addClass("modal-open")}),$(i).on("mouseleave",function(){$("body, html").removeClass("modal-open")}))}),$(".purchase-selection .custom-control-input").on("click",function(){"subscribe-now"==$(this).attr("id")?$(".subscription-box").hasClass("d-none")&&$(".subscription-box").removeClass("d-none"):$(".subscription-box").hasClass("d-none")||$(".subscription-box").addClass("d-none")})}),String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(void 0!==t?t:" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),$(document).ready(function(){function e(e,t){var i=e.position();t.css({left:i.left,width:e.width()})}$('[data-toggle="tab-accordion"]').each(function(t,i){var n=$(i).find(".tab-accordion--tab-part"),s=$(i).find(".tab-accordion--accordion-part"),a=$(i).find(".tab-accordion--underline");function r(){e(n.find("a").not(".collapsed").first().parent(),a)}n.find("a").on("click",function(e){var t=$(e.currentTarget),i=$(e.currentTarget).data("target"),a=$(i);n.find("a").removeClass("tab-accordion--bold"),t.hasClass("collapsed")?(s.find(".collapse").removeClass("tab-accordion--show"),t.removeClass("tab-accordion--bold")):(e.stopPropagation(),$(a).addClass("tab-accordion--show"),t.addClass("tab-accordion--bold"))}),s.find(".collapse").on("show.bs.collapse",function(t){var i=t.target.id;e(n.find('[data-target="#'+i+'"]').parent(),a)}),r();var o=!1;$(window).on("resize",function(){o&&(clearTimeout(o),o=!1),o=setTimeout(function(){r()},100)})}),$(".opsm-tab-content").each(function(t,i){var n=$(i),s=n.find(".opsm-tab-content--underline"),a=n.find(".opsm-tab-content--nav");function r(){e(a.find(".nav-link.active"),s)}n.find('a[data-toggle="tab"]').on("shown.bs.tab",function(t){e($(t.target),s)}),setTimeout(function(){r()},200);var o=!1;$(window).on("resize",function(){o&&(clearTimeout(o),o=!1),o=setTimeout(function(){r()},100)})})});
