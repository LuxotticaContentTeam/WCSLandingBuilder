(this["webpackJsonp@abstract/frameadvisor-ui"]=this["webpackJsonp@abstract/frameadvisor-ui"]||[]).push([[3],{511:function(e,n,t){"use strict";t.d(n,"a",(function(){return z})),t.d(n,"b",(function(){return G})),t.d(n,"c",(function(){return j}));var o=t(515),r=t(4),i=t.n(r);function a(e){if(e&&"undefined"!==typeof window){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.innerHTML=e,document.head.appendChild(n),e}}function c(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&d(e,n)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,n){return(d=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function b(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function m(e,n,t){return(m=b()?Reflect.construct:function(e,n,t){var o=[null];o.push.apply(o,n);var r=new(Function.bind.apply(e,o));return t&&d(r,t.prototype),r}).apply(null,arguments)}function v(e){var n="function"===typeof Map?new Map:void 0;return(v=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,o)}function o(){return m(e,arguments,f(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),d(o,e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,n){return!n||"object"!==typeof n&&"function"!==typeof n?h(e):n}function I(e){var n=b();return function(){var t,o=f(e);if(n){var r=f(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return y(this,t)}}function T(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(s){r=!0,i=s}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return t}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return E(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return E(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}a("#bipa-overlay-root-style.bipa-overlay {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-content: center;\n  justify-content: center;\n  font-size: 0.85rem;\n}\n#bipa-overlay-root-style.bipa-overlay * {\n  box-sizing: border-box;\n}\n#bipa-overlay-root-style.bipa-overlay h1 {\n  font-size: 1.4rem;\n  margin: 0;\n}\n#bipa-overlay-root-style.bipa-overlay span {\n  margin: 0;\n}\n#bipa-overlay-root-style.bipa-overlay .note-text {\n  font-size: 0.6rem;\n  color: #AAAAAA;\n}\n#bipa-overlay-root-style.bipa-overlay .note-warning {\n  color: red;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container {\n  position: relative;\n  font-family: sans-serif;\n  height: 100%;\n  width: 100%;\n  max-width: 80vw;\n  display: flex;\n  margin: 0;\n  background-color: white;\n  color: black;\n  overflow: auto;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container .long-text {\n  overflow: auto;\n  min-height: 10%;\n  text-align: left;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container .line {\n  width: 100%;\n  margin: 0 0 1rem 0;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container .buttons {\n  display: flex;\n  justify-content: center;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container button {\n  padding: 0.2rem;\n  height: 2.6rem;\n  color: #000000;\n  background-color: #FFFFFF;\n  border: 1px solid #000000;\n  border-radius: 1.3rem;\n  margin: 0 0.6rem 0 0 !important;\n  flex-grow: 1;\n  cursor: pointer;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container button:hover {\n  background-color: #EEEEEE;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container button.confirm {\n  color: #FFFFFF;\n  background-color: #000000;\n  border: 1px solid #000000;\n  margin: 0 0 0 0.6rem !important;\n}\n#bipa-overlay-root-style.bipa-overlay #bipa-component-container button.confirm:hover {\n  background-color: #222222;\n  border: 1px solid #222222;\n}\n@media (min-width: 768px) {\n  #bipa-overlay-root-style.bipa-overlay #bipa-component-container {\n    max-width: 60vw;\n  }\n  #bipa-overlay-root-style.bipa-overlay #bipa-component-container button {\n    max-width: 10rem;\n  }\n}");var _=function(e){p(t,e);var n=I(t);function t(e,o,r){var i;return c(this,t),(i=n.call(this,o)).type=e,i.name=e,i.message=o,i.stack=null===r||void 0===r?void 0:r.stack,Object.setPrototypeOf(h(i),t.prototype),i}return t}(v(Error)),O=function(e){p(t,e);var n=I(t);function t(e){var o;return c(this,t),o=n.call(this,t.type,"translation missing for locale: ".concat(e)),Object.setPrototypeOf(h(o),t.prototype),o}return t}(_);O.type="MissingTranslationError";var A=function(e){p(t,e);var n=I(t);function t(e,o){var r;return c(this,t),r=n.call(this,t.type,e,o),Object.setPrototypeOf(h(r),t.prototype),r}return t}(_);A.type="BipaServiceError";var P=function(e){p(t,e);var n=I(t);function t(e,o,r){var i;return c(this,t),(i=n.call(this,t.type,e,r)).fieldErrors=o,Object.setPrototypeOf(h(i),t.prototype),i}return t}(_);P.type="BipaSubmissionError";var g,w={PRIVACY_AGREEMENT_TITLE:"Biometric data consent",PRIVACY_FIRST_AGREEMENT:"We need your consent to record your face's biometric data and proceed with our eyewear suggestion experience. We will not store any of your information in our database and once the process is finished, we will delete all of your personal data.",PRIVACY_IMPLICIT_AGREEMENT:"By continuing you accept",PRIVACY_IMPLICIT_TERMS_AND_CONDITIONS:"Terms and Conditions",PRIVACY_IMPLICIT_TERMS_PRIVACY_CONJUNCTION:" and ",PRIVACY_IMPLICIT_PRIVACY_POLICY:"Privacy Policy",PRIVACY_BUTTON_SUBMIT:"Submit",PRIVACY_BUTTON_CANCEL:"Cancel",BIPA_FORM_TITLE:"Biometric data consent",BIPA_CITIZEN_DECLARATION:"I declare I'm an Illinois citizen",BIPA_FORM_SUBTITLE:"Due to some Illinois regulations we need to ask you some information, please fill in your details below.",BIPA_FORM_NAME:"Name",BIPA_FORM_SURNAME:"Surname",BIPA_FORM_EMAIL:"E-mail",BIPA_IMPLICIT_AGREEMENT:"By continuing you accept",BIPA_IMPLICIT_TERMS_AND_CONDITIONS:"Terms and Conditions",BIPA_IMPLICIT_TERMS_PRIVACY_CONJUNCTION:" and ",BIPA_IMPLICIT_PRIVACY_POLICY:"Privacy Policy",BIPA_FORM_IMPLICIT_AGREEMENT:"By continuing you accept Luxottica's Terms and Conditions and below BIPA Notice.",BIPA_FORM_BUTTON_SUBMIT:"Submit",BIPA_FORM_BUTTON_CANCEL:"Cancel",BIPA_SERVER_ERROR:"There was a problem with the server, please check insered informations or network connection"},k=function(e){g=u(u(u({},g),w),e)},N=function(e){return g[e]?g[e]:""},C="NotBlank",R="Size",M=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,B=function(e,n){return{objectName:"bipaConsentPublic",field:e,message:n}},S=function(e){var n=[];return null!==e&&void 0!==e&&e.firstName?null!==e&&void 0!==e&&e.firstName&&e.firstName.trim().length<2&&n.push(B("firstName",R)):n.push(B("firstName",C)),null!==e&&void 0!==e&&e.lastName?null!==e&&void 0!==e&&e.lastName&&e.lastName.trim().length<2&&n.push(B("lastName",R)):n.push(B("lastName",C)),null!==e&&void 0!==e&&e.email?null!==e&&void 0!==e&&e.email&&e.email.trim().length<2?n.push(B("email",R)):null!==e&&void 0!==e&&e.email&&!e.email.trim().match(M)&&n.push(B("email","Pattern")):n.push(B("email",C)),n};a("#bipa-overlay-root-style #bipa-biometric-agreement {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement #BIOMETRIC_AGREEMENT_TITLE {\n  text-align: center;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement .field {\n  width: 100%;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement .field label {\n  text-align: left;\n  margin: auto;\n  position: relative;\n  float: left;\n  padding: 0.5rem;\n  margin-bottom: calc(-50%);\n  color: #555;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement .field input {\n  padding: 0.3rem;\n  margin: 0;\n  width: 100%;\n  font-size: 1rem;\n  border: 2px solid #DDDDDD;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement .field input.error {\n  border: 2px solid red;\n  color: red;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement .field input:value ~ label {\n  background-color: lightblue;\n}\n#bipa-overlay-root-style #bipa-biometric-agreement .field .active label {\n  display: none;\n}");var j,U=function(e){var n,t,a,c=T(Object(r.useState)(null!==(n=e.formPrefill)&&void 0!==n&&n.firstName?e.formPrefill.firstName:""),2),s=c[0],l=c[1],u=T(Object(r.useState)(!1),2),p=u[0],f=u[1],d=T(Object(r.useState)(null!==(t=e.formPrefill)&&void 0!==t&&t.lastName?e.formPrefill.lastName:""),2),b=d[0],m=d[1],v=T(Object(r.useState)(!1),2),h=v[0],y=v[1],I=T(Object(r.useState)(null!==(a=e.formPrefill)&&void 0!==a&&a.email?e.formPrefill.email:""),2),E=I[0],_=I[1],O=T(Object(r.useState)(!1),2),P=O[0],g=O[1],w=T(Object(r.useState)(!1),2),k=w[0],C=w[1],R=Object(r.useRef)(void 0);Object(r.useEffect)((function(){var n,t;null===(n=e.callbacks)||void 0===n||null===(t=n.onDisplayPage)||void 0===t||t.call(n,"BIOMETRIC_FORM")}),[]);var M=function(e,n){e.target.value&&""!==e.target.value?n(e.target.value):n("")},B=p||h||P;return i.a.createElement("div",{id:"bipa-biometric-agreement"},i.a.createElement("div",{className:"top"},i.a.createElement("h1",{id:"BIOMETRIC_AGREEMENT_TITLE",className:"line"},N(j.BIPA_FORM_TITLE)),i.a.createElement("p",{id:"BIPA_FORM_SUBTITLE",className:"line"},N(j.BIPA_FORM_SUBTITLE)),B&&i.a.createElement("p",{id:"bipa-field-warning",className:"note-warning"},N(j.BIPA_FORM_ERROR)),k&&i.a.createElement("p",{id:"bipa-server-warning",className:"note-warning"},N(j.BIPA_SERVER_ERROR)),i.a.createElement("div",{className:"field line"},i.a.createElement("input",{ref:R,name:"BIPA_FORM_NAME",id:"bipa-data-collection-name",className:p?"error":"",autoComplete:"given-name",value:s,onChange:function(e){f(!1),M(e,l)},placeholder:N(j.BIPA_FORM_NAME)})),i.a.createElement("div",{className:"field line"},i.a.createElement("input",{name:"BIPA_FORM_SURNAME",id:"bipa-data-collection-surname",className:h?"error":"",autoComplete:"family-name",value:b,onChange:function(e){y(!1),M(e,m)},placeholder:N(j.BIPA_FORM_SURNAME)})),i.a.createElement("div",{className:"field line"},i.a.createElement("input",{name:"BIPA_FORM_EMAIL",id:"bipa-data-collection-email",className:P?"error":"",autoComplete:"email",value:E,onChange:function(e){g(!1),M(e,_)},placeholder:N(j.BIPA_FORM_EMAIL)})),i.a.createElement("div",{id:"bipa-mandatory-field",className:"note-text"},N(j.BIPA_FORM_MANDATORY_FIELD))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"line buttons"},i.a.createElement("button",{id:"bipa-cancel-button",onClick:e.onCancel},i.a.createElement("span",{id:"BIPA_FORM_BUTTON_CANCEL"},N(j.BIPA_FORM_BUTTON_CANCEL))),i.a.createElement("button",{id:"bipa-submit-button",onClick:function(){var n={firstName:s,lastName:b,email:E};k||C(!1);var t=S(n).map((function(e){return e.field}));s||f(!0),b||y(!0),E||g(!0),s&&b&&E?t.length>0?(t.includes("firstName")&&f(!0),t.includes("lastName")&&y(!0),t.includes("email")&&g(!0),R.current.scrollIntoView()):Object(o.f)({source:e.source,environment:e.environment,accessToken:e.accessToken,refreshToken:e.refreshToken,firstName:n.firstName,lastName:n.lastName,email:n.email,bipaVersion:e.bipaVersion,onAuthUpdated:e.callbacks.onAuthUpdated}).then((function(t){t.ok?e.onBipaSubmit(n):t.status<404?t.json().then((function(e){var n=null!==e&&void 0!==e&&e.fieldErrors?e.fieldErrors.map((function(e){return e.field})):[];console.info(n),n.includes("firstName")&&f(!0),n.includes("lastName")&&y(!0),n.includes("email")&&g(!0)})):(C(!0),e.onError(new A("failed to submit bipa form due to response=".concat(t.status," ").concat(t.statusText))))})).catch((function(n){C(!0),e.onError(n)})):R.current.scrollIntoView()},className:"confirm"},i.a.createElement("span",{id:"BIPA_FORM_BUTTON_SUBMIT"},N(j.BIPA_FORM_BUTTON_SUBMIT))))))};a("#bipa-overlay-root-style #privacy-agreement {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container {\n  overflow-y: scroll;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scrollable-content #PRIVACY_AGREEMENT_TITLE {\n  text-align: center;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scrollable-content #BIPA_CITIZEN_QUESTION {\n  font-weight: bold;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scrollable-content #PRIVACY_AGREEMENT_TEXT p {\n  text-align: left !important;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scrollable-content #BIPA_FORM_BIPA_AGREEMENT p {\n  text-align: left !important;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scrollable-content .blank-footer {\n  width: 100%;\n  height: 100px;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scroll-gradient {\n  width: 100%;\n  height: 30%;\n  background: linear-gradient(0deg, white 0%, rgba(255, 255, 255, 0) 100%);\n  position: sticky;\n  bottom: 0;\n  pointer-events: none;\n}\n#bipa-overlay-root-style #privacy-agreement .scrollable-container .scroll-gradient.hidden {\n  display: none;\n}\n#bipa-overlay-root-style #privacy-agreement .footer-bar {\n  width: 100%;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  flex-direction: column;\n  background-color: #FFFFFF;\n  align-items: center;\n  box-shadow: 0px 0px 10px #AAAAAA;\n  z-index: 1;\n}\n#bipa-overlay-root-style #privacy-agreement .footer-bar .footer-content {\n  width: 100%;\n  padding: 0 1rem;\n}\n@media (min-width: 768px) {\n  #bipa-overlay-root-style #privacy-agreement .footer-bar .footer-content {\n    max-width: 60vw;\n  }\n}\n#bipa-overlay-root-style #privacy-agreement .footer-bar .footer-content #bipa-privacy-policy-notice {\n  text-align: center;\n}"),function(e){e.PRIVACY_AGREEMENT_TITLE="PRIVACY_AGREEMENT_TITLE",e.PRIVACY_AGREEMENT_TEXT="PRIVACY_AGREEMENT_TEXT",e.PRIVACY_FIRST_AGREEMENT="PRIVACY_FIRST_AGREEMENT",e.PRIVACY_IMPLICIT_AGREEMENT="PRIVACY_IMPLICIT_AGREEMENT",e.PRIVACY_IMPLICIT_TERMS_AND_CONDITIONS="PRIVACY_IMPLICIT_TERMS_AND_CONDITIONS",e.PRIVACY_IMPLICIT_TERMS_PRIVACY_CONJUNCTION="PRIVACY_IMPLICIT_TERMS_PRIVACY_CONJUNCTION",e.PRIVACY_IMPLICIT_PRIVACY_POLICY="PRIVACY_IMPLICIT_PRIVACY_POLICY",e.PRIVACY_BUTTON_SUBMIT="PRIVACY_BUTTON_SUBMIT",e.PRIVACY_BUTTON_CANCEL="PRIVACY_BUTTON_CANCEL",e.BIPA_CITIZEN_DECLARATION="BIPA_CITIZEN_DECLARATION",e.BIPA_CITIZEN_QUESTION="BIPA_CITIZEN_QUESTION",e.BIPA_FORM_TITLE="BIPA_FORM_TITLE",e.BIPA_FORM_SUBTITLE="BIPA_FORM_SUBTITLE",e.BIPA_FORM_NAME="BIPA_FORM_NAME",e.BIPA_FORM_SURNAME="BIPA_FORM_SURNAME",e.BIPA_FORM_EMAIL="BIPA_FORM_EMAIL",e.BIPA_FORM_ERROR="BIPA_FORM_ERROR",e.BIPA_FORM_MANDATORY_FIELD="BIPA_FORM_MANDATORY_FIELD",e.BIPA_IMPLICIT_AGREEMENT="BIPA_IMPLICIT_AGREEMENT",e.BIPA_IMPLICIT_TERMS_AND_CONDITIONS="BIPA_IMPLICIT_TERMS_AND_CONDITIONS",e.BIPA_IMPLICIT_TERMS_PRIVACY_CONJUNCTION="BIPA_IMPLICIT_TERMS_PRIVACY_CONJUNCTION",e.BIPA_IMPLICIT_PRIVACY_POLICY="BIPA_IMPLICIT_PRIVACY_POLICY",e.BIPA_FORM_IMPLICIT_AGREEMENT="BIPA_FORM_IMPLICIT_AGREEMENT",e.BIPA_FORM_BIPA_AGREEMENT="BIPA_FORM_BIPA_AGREEMENT",e.BIPA_FORM_BUTTON_SUBMIT="BIPA_FORM_BUTTON_SUBMIT",e.BIPA_FORM_BUTTON_CANCEL="BIPA_FORM_BUTTON_CANCEL",e.BIPA_NO="BIPA_NO",e.BIPA_SERVER_ERROR="BIPA_SERVER_ERROR",e.BIPA_YES="BIPA_YES"}(j||(j={})),a('#bipa-overlay-root-style .yes-no-checkbox {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n#bipa-overlay-root-style .yes-no-checkbox .no, #bipa-overlay-root-style .yes-no-checkbox .yes {\n  opacity: 0.5;\n}\n#bipa-overlay-root-style .yes-no-checkbox .no.selected, #bipa-overlay-root-style .yes-no-checkbox .yes.selected {\n  opacity: 1;\n  font-weight: bold;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch {\n  position: relative;\n  display: inline-block;\n  width: 2.4rem;\n  height: 1.4rem;\n  margin: 0 0.5rem;\n  /* Rounded sliders */\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch .slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #DDDDDD;\n  -webkit-transition: 0.2s;\n  transition: 0.2s;\n  border: 0rem solid #DDDDDD;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch .slider::before {\n  position: absolute;\n  content: "";\n  height: 1.12rem;\n  width: 1.12rem;\n  left: 0.14rem;\n  bottom: 0.14rem;\n  background-color: #FFFFFF;\n  -webkit-transition: 0.2s;\n  transition: 0.2s;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch input:checked + .slider {\n  background-color: #000000;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch input:focus + .slider {\n  box-shadow: 0 0 0rem black;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch input:checked + .slider::before {\n  -webkit-transform: translateX(1rem);\n  -ms-transform: translateX(1rem);\n  transform: translateX(1rem);\n  background-color: #FFFFFF;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch .slider.round {\n  border-radius: 0.7rem;\n}\n#bipa-overlay-root-style .yes-no-checkbox .switch .slider.round::before {\n  border-radius: 50%;\n}');var x=function(e){return i.a.createElement("div",{className:"yes-no-checkbox"},i.a.createElement("span",{className:"no".concat(e.checked?"":" selected")},N(j.BIPA_NO)),i.a.createElement("label",{className:"switch"},i.a.createElement("input",{type:"checkbox",checked:e.checked,onChange:function(n){e.onChange(n.target.checked)}}),i.a.createElement("span",{className:"slider round"})),i.a.createElement("span",{className:"yes".concat(e.checked?" selected":"")},N(j.BIPA_YES)))},F=function(e){var n=T(Object(r.useState)(!0),2),t=n[0],o=n[1];Object(r.useEffect)((function(){var n,t;null===(n=e.callbacks)||void 0===n||null===(t=n.onDisplayPage)||void 0===t||t.call(n,"PRIVACY");try{document.getElementsByClassName("scrollable-container")[0].clientHeight>=document.getElementsByClassName("scrollable-content")[0].clientHeight&&o(!1)}catch(r){}}),[]);return i.a.createElement("div",{id:"privacy-agreement"},i.a.createElement("div",{className:"scrollable-container",onScroll:function(e){e.currentTarget.scrollTop<2?!t&&o(!0):t&&o(!1)}},i.a.createElement("div",{className:"scrollable-content"},i.a.createElement("h1",{id:"PRIVACY_AGREEMENT_TITLE"},N(j.PRIVACY_AGREEMENT_TITLE)),i.a.createElement("div",{id:"bipa-record-consent",className:"line"},i.a.createElement("p",{id:"bipa-record-consent-text"},i.a.createElement("span",{id:"PRIVACY_FIRST_AGREEMENT",dangerouslySetInnerHTML:{__html:N(j.PRIVACY_FIRST_AGREEMENT)}}))),"US"===e.region&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"bipa-citizen-question-container",className:"line"},i.a.createElement("label",{htmlFor:"bipa-citizen-checkbox"},i.a.createElement("span",{id:"BIPA_CITIZEN_QUESTION"},N(j.BIPA_CITIZEN_QUESTION)))),i.a.createElement("div",{id:"bipa-citizen-switch",className:"line"},i.a.createElement(x,{checked:e.isIllinoisUser,onChange:function(n){e.onSetIllinoisUser(n)}}))),i.a.createElement("span",{id:"PRIVACY_AGREEMENT_TEXT",dangerouslySetInnerHTML:{__html:"".concat(N(j.PRIVACY_AGREEMENT_TEXT))}}),"US"===e.region&&i.a.createElement("span",{id:"BIPA_FORM_BIPA_AGREEMENT",className:"small",dangerouslySetInnerHTML:{__html:"".concat(N(j.BIPA_FORM_BIPA_AGREEMENT))}}),i.a.createElement("div",{className:"blank-footer"})),i.a.createElement("div",{className:"scroll-gradient".concat(t?"":" hidden")})),i.a.createElement("div",{id:"bipa-footer-bar",className:"footer-bar"},i.a.createElement("div",{className:"footer-content"},i.a.createElement("p",{id:"bipa-privacy-policy-notice"},i.a.createElement("span",{id:"PRIVACY_IMPLICIT_AGREEMENT",dangerouslySetInnerHTML:{__html:"".concat(N(j.PRIVACY_IMPLICIT_AGREEMENT),"&nbsp;")}}),i.a.createElement("a",{target:"_blank",rel:"noreferrer",href:e.privacyOptions.termsAndConditions.href,onClick:e.callbacks.onTermsAndConditionsClick&&function(n){n.preventDefault(),e.callbacks.onTermsAndConditionsClick()}},i.a.createElement("span",{id:"PRIVACY_IMPLICIT_TERMS_AND_CONDITIONS"},N(j.PRIVACY_IMPLICIT_TERMS_AND_CONDITIONS)))),i.a.createElement("div",{className:"line buttons"},i.a.createElement("button",{id:"bipa-cancel-button",onClick:e.onCancel},i.a.createElement("span",{id:"PRIVACY_BUTTON_CANCEL"},N(j.PRIVACY_BUTTON_CANCEL))),i.a.createElement("button",{id:"bipa-submit-button",onClick:e.onSubmit,className:"confirm"},i.a.createElement("span",{id:"PRIVACY_BUTTON_SUBMIT"},N(j.PRIVACY_BUTTON_SUBMIT)))))))},L={setBiometricCookie:function(e){L.biometricCookieExists(e)||(document.cookie="".concat(L.getBiometricCookieName(e),";").concat("path=/"))},biometricCookieExists:function(e){return"BASIC"===e?document.cookie.includes(L.getBiometricCookieName("BASIC"))||document.cookie.includes(L.getBiometricCookieName("BIOMETRIC")):"BIOMETRIC"===e&&document.cookie.includes(L.getBiometricCookieName("BIOMETRIC"))},getBiometricCookieName:function(e){return"BIOMETRIC"===e?"MlProcessImageConsent=true":"BasicImageConsent=true"}},V="https://d5nhc6q3o19l2.cloudfront.net",D=function(e,n,t){if("BASIC"===e){var o="".concat(V,"/vmmv/v1/prod/privacy/application_").concat(t,".json");return fetch(o).then((function(e){if(e.ok)return e.json();throw new O(t)}))}var r="".concat(V,"/frame-advisor/v2/").concat(Y(n),"/privacy/privacy_").concat(t,".json");return fetch(r).then((function(e){if(e.ok)return e.json();throw new O(t)}))},Y=function(e){switch(e){case"STAGING":return"dev";case"PRODUCTION":return"prod";case"ACCEPTANCE":default:return"test"}},G=function(e){var n=Object(r.useRef)(!0),t=T(Object(r.useState)(!1),2),a=t[0],c=t[1],s=T(Object(r.useState)(void 0),2),l=s[0],p=s[1],f=T(Object(r.useState)(void 0),2),d=f[0],b=f[1],m=function(){a?p("BIOMETRIC_FORM"):(L.setBiometricCookie(e.type),e.callbacks.onSubmit())},v=function(n){L.setBiometricCookie(e.type),e.callbacks.onSubmit(n)},h=function(){e.callbacks.onUserReject()};Object(r.useEffect)((function(){n.current&&(n.current=!1,Object(o.b)({environment:e.environment,version:e.tokenVersion,accessToken:e.accessToken,refreshToken:e.refreshToken,onAuthUpdated:e.callbacks.onAuthUpdated}).then((function(n){return Promise.all([D(e.type,e.environment,e.locale),"US"===e.region?Object(o.a)({locale:e.locale,environment:e.environment,accessToken:n.accessToken,refreshToken:n.refreshToken,onAuthUpdated:e.callbacks.onAuthUpdated}):Promise.resolve(void 0)])})).then((function(n){var t,o,r=null!==n&&void 0!==n&&null!==(t=n[1])&&void 0!==t&&t.text?n[1].text:void 0,i=null!==n&&void 0!==n&&null!==(o=n[1])&&void 0!==o&&o.version?n[1].version:void 0;k(u(u({},n[0]),{},{BIPA_FORM_BIPA_AGREEMENT:r},e.privacy.localizationText)),b(i),p("PRIVACY")})).catch((function(n){e.callbacks.onError(n)})))}),[]);return i.a.createElement("div",{id:"bipa-overlay-root-style",className:"bipa-overlay"},i.a.createElement("div",{id:"bipa-component-container"},function(e,n){return"PRIVACY"===n?i.a.createElement(F,{privacyOptions:e.privacy,callbacks:e.callbacks,region:e.region,isIllinoisUser:a,onSetIllinoisUser:function(e){c(e)},onSubmit:m,onCancel:h}):"BIOMETRIC_FORM"===n?i.a.createElement(U,{accessToken:e.accessToken,refreshToken:e.refreshToken,environment:e.environment,source:e.source,bipaVersion:d,privacyOptions:e.privacy,callbacks:e.callbacks,formPrefill:e.formPrefill,onBipaSubmit:v,onCancel:function(){return p("PRIVACY")},onError:e.callbacks.onError}):void 0}(e,l)))},z={getCookieName:function(e){return L.getBiometricCookieName(e)},biometricCookieExists:function(e){return L.biometricCookieExists(e)},getBipaVersion:function(e){return Object(o.a)({locale:e.locale,environment:e.environment,accessToken:e.accessToken,refreshToken:e.refreshToken,onAuthUpdated:e.onAuthUpdated})},saveBipaEntry:function(e){var n=S(e.formData);return n.length>0?Promise.reject(new P("failed client-side bipa form validation",n)):Object(o.f)({environment:e.environment,accessToken:e.accessToken,refreshToken:e.refreshToken,onAuthUpdated:e.onAuthUpdated,bipaVersion:e.bipaVersion,source:e.source,firstName:e.formData.firstName,lastName:e.formData.lastName,email:e.formData.email}).then((function(e){return e.json().then((function(n){return{response:e,body:n}}))})).then((function(e){return e.response.ok?e.response:null!==(n=e.body)&&void 0!==n&&n.title&&null!==(t=e.body)&&void 0!==t&&t.message?Promise.reject(new P("".concat(e.body.title,": ").concat(e.body.message),e.body.fieldErrors)):Promise.reject(new P("failed to contact bipa server",void 0));var n,t})).catch((function(e){throw e instanceof P?e:new P("failed to contact bipa server",void 0)}))}}},515:function(e,n,t){"use strict";t.d(n,"a",(function(){return M})),t.d(n,"b",(function(){return Y})),t.d(n,"c",(function(){return D})),t.d(n,"d",(function(){return X})),t.d(n,"e",(function(){return z})),t.d(n,"f",(function(){return S})),t.d(n,"g",(function(){return V})),t.d(n,"h",(function(){return L})),t.d(n,"i",(function(){return Z}));var o=t(6),r=t.n(o),i=t(10),a=t(93),c=t(498),s=t(488),l=t(489),u=t(529),p=t(495);function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){b(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var m="https://test-gateway-vtoprofile.luxdeepblue.com",v="https://acceptance-gateway-vtoprofile.luxdeepblue.com",h="https://gateway-vtoprofile.luxdeepblue.com",y={STAGING:{loginFaUrl:"".concat(m,"/auth/fradv/token"),loginVmUrl:"".concat(m,"/auth/vm/token"),refreshUrl:"".concat(m,"/auth/refresh"),bipaTextUrl:"".concat(m,"/services/vtobipams/public/v2/bipa/version"),bipaSubmitFormUrl:"".concat(m,"/services/vtobipams/public/v1/bipa-consent"),videoSessionUrl:"".concat(m,"/services/vtovideoprofilems/public/v3/video"),enrichUrl:"".concat(m,"/services/vtovideoprofilems/public/v1/ml-enrich"),vtoUrl:"".concat(m,"/services/vtovideoprofilems/public/v1/basel-mesh"),additionalInfoUrl:"".concat(m,"/services/vtovideoprofilems/public/v1/additional-info"),poseExtractionUrl:"".concat(m,"/services/vtovideoprofilems/public/v1/poses-extraction"),statusUrl:"".concat(m,"/services/vtovideoprofilems/public/v2/status"),pdStatusUrl:"".concat(m,"/services/vtomedicalinfoms/public/v1/pupillary-distance/status"),profileUrl:"".concat(m,"/services/vtovideoprofilems/public/v3/get-video-profile")},ACCEPTANCE:{loginFaUrl:"".concat(v,"/auth/fradv/token"),loginVmUrl:"".concat(v,"/auth/vm/token"),refreshUrl:"".concat(v,"/auth/refresh"),bipaTextUrl:"".concat(v,"/services/vtobipams/public/v2/bipa/version"),bipaSubmitFormUrl:"".concat(v,"/services/vtobipams/public/v1/bipa-consent"),videoSessionUrl:"".concat(v,"/services/vtovideoprofilems/public/v3/video"),enrichUrl:"".concat(v,"/services/vtovideoprofilems/public/v1/ml-enrich"),vtoUrl:"".concat(v,"/services/vtovideoprofilems/public/v1/basel-mesh"),additionalInfoUrl:"".concat(v,"/services/vtovideoprofilems/public/v1/additional-info"),poseExtractionUrl:"".concat(v,"/services/vtovideoprofilems/public/v1/poses-extraction"),statusUrl:"".concat(v,"/services/vtovideoprofilems/public/v2/status"),pdStatusUrl:"".concat(v,"/services/vtomedicalinfoms/public/v1/pupillary-distance/status"),profileUrl:"".concat(v,"/services/vtovideoprofilems/public/v3/get-video-profile")},PRODUCTION:{loginFaUrl:"".concat(h,"/auth/fradv/token"),loginVmUrl:"".concat(h,"/auth/vm/token"),refreshUrl:"".concat(h,"/auth/refresh"),bipaTextUrl:"".concat(h,"/services/vtobipams/public/v2/bipa/version"),bipaSubmitFormUrl:"".concat(h,"/services/vtobipams/public/v1/bipa-consent"),videoSessionUrl:"".concat(h,"/services/vtovideoprofilems/public/v3/video"),enrichUrl:"".concat(h,"/services/vtovideoprofilems/public/v1/ml-enrich"),vtoUrl:"".concat(h,"/services/vtovideoprofilems/public/v1/basel-mesh"),additionalInfoUrl:"".concat(h,"/services/vtovideoprofilems/public/v1/additional-info"),poseExtractionUrl:"".concat(h,"/services/vtovideoprofilems/public/v1/poses-extraction"),statusUrl:"".concat(h,"/services/vtovideoprofilems/public/v2/status"),pdStatusUrl:"".concat(h,"/services/vtomedicalinfoms/public/v1/pupillary-distance/status"),profileUrl:"".concat(h,"/services/vtovideoprofilems/public/v3/get-video-profile")}},I=function(e,n){return y[e][n]},T=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e,o,r){var i;return Object(a.a)(this,t),(i=n.call(this,o)).type=e,i.name=e,i.message=o,i.stack=null===r||void 0===r?void 0:r.stack,Object.setPrototypeOf(Object(c.a)(i),t.prototype),i}return t}(Object(u.a)(Error));(function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e){var o;return Object(a.a)(this,t),(o=n.call(this,t.type,"microservice environment ".concat(e," is not valid"))).env=e,Object.setPrototypeOf(Object(c.a)(o),t.prototype),o}return t}(T)).type="EnvironmentError";var E=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e,o){var r;return Object(a.a)(this,t),r=n.call(this,t.type,e,o),Object.setPrototypeOf(Object(c.a)(r),t.prototype),r}return t}(T);E.type="InputError";var _=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e){var o;return Object(a.a)(this,t),(o=n.call(this,t.type,"bipa agreement text cannot be found for locale ".concat(e))).locale=e,Object.setPrototypeOf(Object(c.a)(o),t.prototype),o}return t}(T);_.type="LocaleError";var O=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e,o){var r;return Object(a.a)(this,t),r=n.call(this,t.type,e,o),Object.setPrototypeOf(Object(c.a)(r),t.prototype),r}return t}(T);O.type="RequestError";var A=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e){var o;return Object(a.a)(this,t),o=n.call(this,t.type,"request has timed out after ".concat(e,"ms")),Object.setPrototypeOf(Object(c.a)(o),t.prototype),o}return t}(T);A.type="TimeoutError";var P=p.b.getInstance().getLoggerInfo("@luxottica/vto-microservices","2.2.0","RequestHelper");function g(e){return new Promise((function(n){return setTimeout(n,e)}))}var w=function(e,n,t,o){var a=!1,c=Date.now();return new Promise(function(){var s=Object(i.a)(r.a.mark((function i(s,l){return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!a){r.next=3;break}return r.abrupt("return");case 3:if(!o()){r.next=5;break}return r.abrupt("return");case 5:if(!(Date.now()-c>n)){r.next=8;break}return l(new A(n)),r.abrupt("return");case 8:return r.next=10,t().then((function(e){a=!0,s(e)})).catch((function(){P.debug("continue poll")}));case 10:return r.next=12,g(e);case 12:r.next=0;break;case 14:case"end":return r.stop()}}),i)})));return function(e,n){return s.apply(this,arguments)}}())},k=function(e,n,t){return fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(e.accessToken),accept:"*/*"}}).then((function(e){if(e.ok)return e.json();throw new Error("FAILED POLL")})).then((function(e){P.debug(e);var n=e.filter((function(e){return t.includes(e.type)}));if(n.length>0){var o=n.every((function(e){return["OK","KO"].includes(e.progress)})),r=n.every((function(e){return"OK"===e.progress}));if(o)return r;throw new Error("processing incomplete")}throw new Error("processing incomplete")})).catch((function(e){throw P.debug(e),e}))},N=function(e){return e.ok?e.json():e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))},C=function(e){var n=I(e.environment,"refreshUrl");return fetch(n,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json"},body:JSON.stringify({refresh_token:e.refreshToken})}).then((function(e){return e.ok?e.json():e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))})).then((function(n){var t={accessToken:n.access_token,refreshToken:n.refresh_token};return e.onAuthUpdated&&e.onAuthUpdated(t),t})).catch((function(e){throw e}))},R=function(e){var n=I(e.environment,"bipaTextUrl");return fetch(n,{method:"GET",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)}})},M=function(e){var n,t;return R(e).then((function(n){return 401===n.status?C(e).then((function(n){return R(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(e){return N(e)})).then((function(o){n=o.version,t=o.description;var r=JSON.parse(o.jsonUrl);if(r[e.locale])return fetch(r[e.locale]);throw new _(e.locale)})).then((function(e){return N(e)})).then((function(e){return{version:n,description:t,text:e.BIPA_AGREEMENT}}))},B=function(e){var n=I(e.environment,"bipaSubmitFormUrl");return fetch(n,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "bipaVersion": '.concat(e.bipaVersion,', "channel": "').concat(e.source,'", "firstName": "').concat(e.firstName,'", "lastName": "').concat(e.lastName,'", "email": "').concat(e.email,'" }')})},S=function(e){return B(e).then((function(n){return 401===n.status?C(e).then((function(n){return B(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n}))},j=function(e){var n=I(e.environment,"profileUrl");return fetch("".concat(n,"/").concat(e.videoId),{method:"GET",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)}})},U=function(e){return j(e).then((function(n){return 401===n.status?C(e).then((function(n){return j(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(e){return e.ok?e.json():e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))})).then((function(e){var n={};return n.properties=e.mlInformations,n.videoId=e.uuid,n}))},x=function(e){var n=new FormData;return n.append("file",new File([e.img],"take0.jpg",{type:"image/jpeg"})),fetch("".concat(e.uploadPath,"/take0.jpg"),{method:"POST",headers:{Accept:"*/*",Authorization:"Bearer ".concat(e.accessToken)},body:n})},F=function(e){var n=I(e.environment,"enrichUrl"),t=I(e.environment,"vtoUrl");return Promise.all([e.enableMachineLearning?fetch(n,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "uuid": "'.concat(e.videoId,'" }')}):void 0,e.enableVto?fetch(t,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "uuid": "'.concat(e.videoId,'" }')}):void 0])},L=function(e){return x(e).then((function(n){return 401===n.status?C(e).then((function(n){return x(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(e){return e.ok?void 0:e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))}))},V=function(e){return new Promise((function(n,t){var o=e.imgData.width,r=e.imgData.height,i=document.createElement("canvas");i.width=o,i.height=r;var a=i.getContext("2d");a?(a.putImageData(e.imgData,0,0),i.toBlob((function(e){e?n(e):t(new O("failed to extract image from canvas"))}),"image/jpeg",.95)):t(new O("failed to extract image from canvas"))})).then((function(n){return L(d(d({},e),{},{img:n}))}))},D=function(e){return e.enableMachineLearning||e.enableVto?F(e).then((function(n){return n[0]&&n[0].ok&&401===n[0].status||n[1]&&n[1].ok&&401===n[1].status?C(e).then((function(n){return F(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(n){if(void 0!==n[0]&&!n[0].ok||void 0!==n[1]&&!n[1].ok)throw new O("failed to poll status with sessionId=".concat(e.videoId));var t=[],o=[];if(e.enableVto&&o.push("BASEL_MESH"),e.enableMachineLearning){o.push("ML_INFORMATION");var r="".concat(I(e.environment,"pdStatusUrl"),"/").concat(e.videoId);t.push(w(1e3,3e4,(function(){return k(e,r,["PD"])}),e.shouldCancel))}var i="".concat(I(e.environment,"statusUrl"),"/").concat(e.videoId);return t.push(w(1e3,3e4,(function(){return k(e,i,o)}),e.shouldCancel)),Promise.all(t).then((function(e){return e.every((function(e){return!!e}))}))})).then((function(n){if(n)return U(e);throw new O("failed to poll status with sessionId=".concat(e.videoId))})):Promise.reject(new E("enableMachineLearning and enableVto cannot both be set to false"))},Y=function(e){if(e.accessToken&&e.refreshToken)return Promise.resolve({accessToken:e.accessToken,refreshToken:e.refreshToken});var n=1===e.version?"loginVmUrl":"loginFaUrl",t=I(e.environment,n);return fetch(t,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json"},body:JSON.stringify({rememberMe:!0})}).then((function(e){return e.ok?e.json():e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))})).then((function(n){var t,o={accessToken:n.access_token,refreshToken:n.refresh_token};return null===(t=e.onAuthUpdated)||void 0===t||t.call(e,o),o}))},G=function(e){var n=I(e.environment,"videoSessionUrl");return fetch(n,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "region": "'.concat(e.region,'", "source": "').concat(e.source,'"}')})},z=function(e){return G(e).then((function(n){return 401===n.status?C(e).then((function(n){return G(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(e){return e.ok?e.json():e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))})).then((function(e){return{videoId:e.uuid,uploadPath:e.uploadBasePath}}))},J=function(e){var n=new FormData,t="video/".concat(e.fileType);return n.append("file",new File(e.video,"videoTake.".concat(e.fileType),{type:t})),fetch("".concat(e.uploadPath,"/videoTake.").concat(e.fileType),{method:"POST",headers:{Accept:"*/*",Authorization:"Bearer ".concat(e.accessToken)},body:n}).then((function(n){var o=I(e.environment,"additionalInfoUrl");if(n.ok)return fetch("".concat(o,"/").concat(e.videoId),{method:"PUT",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "mimeType": "'.concat(t,'" }')});throw new Error("failed to upload")}))},H=function(e){var n=I(e.environment,"enrichUrl"),t=I(e.environment,"poseExtractionUrl");return Promise.all([e.enableMachineLearning?fetch(n,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "uuid": "'.concat(e.videoId,'" }')}):void 0,e.enableVto?fetch(t,{method:"POST",headers:{Accept:"*/*","Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:'{ "uuid": "'.concat(e.videoId,'" }')}):void 0])},Z=function(e){return J(e).then((function(n){return 401===n.status?C(e).then((function(n){return J(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(e){return e.ok?void 0:e.json().catch((function(){throw new Error("".concat(e.status,": ").concat(e.statusText))})).then((function(e){throw new Error(JSON.stringify(e))}))}))},X=function(e){return e.enableMachineLearning||e.enableVto?H(e).then((function(n){return n[0]&&n[0].ok&&401===n[0].status||n[1]&&n[1].ok&&401===n[1].status?C(e).then((function(n){return H(d(d({},e),{},{accessToken:n.accessToken,refreshToken:n.refreshToken}))})):n})).then((function(n){if(void 0!==n[0]&&!n[0].ok||void 0!==n[1]&&!n[1].ok)throw new O("failed to poll status with sessionId=".concat(e.videoId));var t=[],o=["POSES_EXTRACTION"];if(e.enableVto&&o.push("BASEL_MESH"),e.enableMachineLearning){o.push("ML_INFORMATION");var r="".concat(I(e.environment,"pdStatusUrl"),"/").concat(e.videoId);t.push(w(1e3,3e4,(function(){return k(e,r,["PD"])}),e.shouldCancel))}var i="".concat(I(e.environment,"statusUrl"),"/").concat(e.videoId);return t.push(w(1e3,3e4,(function(){return k(e,i,o)}),e.shouldCancel)),Promise.all(t).then((function(e){return e.every((function(e){return!!e}))}))})).then((function(n){if(n)return U(e);throw new O("failed to poll status with sessionId=".concat(e.videoId))})):Promise.reject(new E("enableMachineLearning and enableVto cannot both be set to false"))}},519:function(e,n,t){"use strict";var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=window.device,i={},a=[];window.device=i;var c=window.document.documentElement,s=window.navigator.userAgent.toLowerCase(),l=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function u(e,n){return-1!==e.indexOf(n)}function p(e){return u(s,e)}function f(e){return c.className.match(new RegExp(e,"i"))}function d(e){var n=null;f(e)||(n=c.className.replace(/^\s+|\s+$/g,""),c.className=n+" "+e)}function b(e){f(e)&&(c.className=c.className.replace(" "+e,""))}function m(){i.landscape()?(b("portrait"),d("landscape"),v("landscape")):(b("landscape"),d("portrait"),v("portrait")),I()}function v(e){for(var n=0;n<a.length;n++)a[n](e)}i.macos=function(){return p("mac")},i.ios=function(){return i.iphone()||i.ipod()||i.ipad()},i.iphone=function(){return!i.windows()&&p("iphone")},i.ipod=function(){return p("ipod")},i.ipad=function(){var e="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return p("ipad")||e},i.android=function(){return!i.windows()&&p("android")},i.androidPhone=function(){return i.android()&&p("mobile")},i.androidTablet=function(){return i.android()&&!p("mobile")},i.blackberry=function(){return p("blackberry")||p("bb10")},i.blackberryPhone=function(){return i.blackberry()&&!p("tablet")},i.blackberryTablet=function(){return i.blackberry()&&p("tablet")},i.windows=function(){return p("windows")},i.windowsPhone=function(){return i.windows()&&p("phone")},i.windowsTablet=function(){return i.windows()&&p("touch")&&!i.windowsPhone()},i.fxos=function(){return(p("(mobile")||p("(tablet"))&&p(" rv:")},i.fxosPhone=function(){return i.fxos()&&p("mobile")},i.fxosTablet=function(){return i.fxos()&&p("tablet")},i.meego=function(){return p("meego")},i.cordova=function(){return window.cordova&&"file:"===location.protocol},i.nodeWebkit=function(){return"object"===o(window.process)},i.mobile=function(){return i.androidPhone()||i.iphone()||i.ipod()||i.windowsPhone()||i.blackberryPhone()||i.fxosPhone()||i.meego()},i.tablet=function(){return i.ipad()||i.androidTablet()||i.blackberryTablet()||i.windowsTablet()||i.fxosTablet()},i.desktop=function(){return!i.tablet()&&!i.mobile()},i.television=function(){for(var e=0;e<l.length;){if(p(l[e]))return!0;e++}return!1},i.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?u(screen.orientation.type,"portrait"):i.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},i.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?u(screen.orientation.type,"landscape"):i.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},i.noConflict=function(){return window.device=r,this},i.ios()?i.ipad()?d("ios ipad tablet"):i.iphone()?d("ios iphone mobile"):i.ipod()&&d("ios ipod mobile"):i.macos()?d("macos desktop"):i.android()?i.androidTablet()?d("android tablet"):d("android mobile"):i.blackberry()?i.blackberryTablet()?d("blackberry tablet"):d("blackberry mobile"):i.windows()?i.windowsTablet()?d("windows tablet"):i.windowsPhone()?d("windows mobile"):d("windows desktop"):i.fxos()?i.fxosTablet()?d("fxos tablet"):d("fxos mobile"):i.meego()?d("meego mobile"):i.nodeWebkit()?d("node-webkit"):i.television()?d("television"):i.desktop()&&d("desktop"),i.cordova()&&d("cordova"),i.onChangeOrientation=function(e){"function"==typeof e&&a.push(e)};var h="resize";function y(e){for(var n=0;n<e.length;n++)if(i[e[n]]())return e[n];return"unknown"}function I(){i.orientation=y(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(h="orientationchange"),window.addEventListener?window.addEventListener(h,m,!1):window.attachEvent?window.attachEvent(h,m):window[h]=m,m(),i.type=y(["mobile","tablet","desktop"]),i.os=y(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),I(),n.a=i},522:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var o=t(93),r=t(94);var i=function(e){return e=e||Object.create(null),{on:function(n,t){(e[n]||(e[n]=[])).push(t)},off:function(n,t){e[n]&&e[n].splice(e[n].indexOf(t)>>>0,1)},emit:function(n,t){(e[n]||[]).slice().map((function(e){e(t)})),(e["*"]||[]).slice().map((function(e){e(n,t)}))}}},a=t(495).b.getInstance().getLoggerInfo("@luxottica/vm-eventbus","1.6.168","EventBus"),c=function(){function e(){Object(o.a)(this,e),a.info("event bus initialized: {}",e.emitter.constructor.name)}return Object(r.a)(e,null,[{key:"publish",value:function(n,t){a.debug("publishing event '{}': {}",n,JSON.stringify(t)),e.emitter.emit(n,t),a.debug("published  event '{}': {}",n,JSON.stringify(t))}},{key:"register",value:function(n,t){a.debug("registering event '{}': {}",n,JSON.stringify(t)),e.emitter.on(n,t),a.debug("registered  event '{}': {}",n,JSON.stringify(t))}}]),e}();c.emitter=i()}}]);
//# sourceMappingURL=3.chunk.js.map